<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hydpy.models.evap.evap_model &#8212; HydPy 6.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/classic.css?v=127cebf3" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
    
    <script src="../../../../_static/documentation_options.js?v=f13f159b"></script>
    <script src="../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">HydPy 6.2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">hydpy.models.evap.evap_model</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/HydPy_Logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="../../../../index.html">Table of Contents</a></h3>
    <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example_projects.html">Example Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference_manual.html">Reference Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../zbibliography.html">Bibliography</a></li>
</ul>

  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for hydpy.models.evap.evap_model</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. _`issue 118`: https://github.com/hydpy-dev/hydpy/issues/118</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># imports...</span>
<span class="c1"># ...from standard library</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">contextlib</span>

<span class="c1"># ...from HydPy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">importtools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">modeltools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.core.typingtools</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.cythons</span><span class="w"> </span><span class="kn">import</span> <span class="n">modelutils</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.interfaces</span><span class="w"> </span><span class="kn">import</span> <span class="n">petinterfaces</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.interfaces</span><span class="w"> </span><span class="kn">import</span> <span class="n">precipinterfaces</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.interfaces</span><span class="w"> </span><span class="kn">import</span> <span class="n">radiationinterfaces</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.interfaces</span><span class="w"> </span><span class="kn">import</span> <span class="n">tempinterfaces</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.interfaces</span><span class="w"> </span><span class="kn">import</span> <span class="n">stateinterfaces</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models.evap</span><span class="w"> </span><span class="kn">import</span> <span class="n">evap_parameters</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models.evap</span><span class="w"> </span><span class="kn">import</span> <span class="n">evap_control</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models.evap</span><span class="w"> </span><span class="kn">import</span> <span class="n">evap_derived</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models.evap</span><span class="w"> </span><span class="kn">import</span> <span class="n">evap_fixed</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models.evap</span><span class="w"> </span><span class="kn">import</span> <span class="n">evap_sequences</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models.evap</span><span class="w"> </span><span class="kn">import</span> <span class="n">evap_inputs</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models.evap</span><span class="w"> </span><span class="kn">import</span> <span class="n">evap_factors</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models.evap</span><span class="w"> </span><span class="kn">import</span> <span class="n">evap_fluxes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models.evap</span><span class="w"> </span><span class="kn">import</span> <span class="n">evap_logs</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models.evap</span><span class="w"> </span><span class="kn">import</span> <span class="n">evap_states</span>


<div class="viewcode-block" id="Calc_AirTemperature_TempModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_AirTemperature_TempModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_AirTemperature_TempModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query hydrological response units&#39; air temperature from a main model referenced</span>
<span class="sd">    as a sub-submodel and follows the |TempModel_V1| interface.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use the combination of |hland_96| and |evap_ret_tw2002| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.hland_96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; area(10.0)</span>
<span class="sd">        &gt;&gt;&gt; nmbzones(3)</span>
<span class="sd">        &gt;&gt;&gt; zonearea(5.0, 3.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; zonetype(FIELD)</span>
<span class="sd">        &gt;&gt;&gt; zonez(2.0)</span>
<span class="sd">        &gt;&gt;&gt; fc(100.0)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_aetmodel_v1(&quot;evap_aet_hbv96&quot;):</span>
<span class="sd">        ...     pass</span>
<span class="sd">        &gt;&gt;&gt; factors.tc = 2.0, 0.0, 5.0</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.calc_airtemperature_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.sequences.factors.airtemperature</span>
<span class="sd">        airtemperature(2.0, 0.0, 5.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">submodel</span><span class="o">.</span><span class="n">get_temperature</span><span class="p">(</span><span class="n">k</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_AirTemperature_TempModel_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_AirTemperature_TempModel_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_AirTemperature_TempModel_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |TempModel_V2| interface determine the air</span>
<span class="sd">    temperature of the hydrological response units.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use the combination of |evap_ret_tw2002| and |meteo_temp_io| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_ret_tw2002 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; hruarea(0.5, 0.3, 0.2)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_tempmodel_v2(&quot;meteo_temp_io&quot;):</span>
<span class="sd">        ...     temperatureaddend(1.0, 2.0, 4.0)</span>
<span class="sd">        ...     inputs.temperature = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_airtemperature_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature</span>
<span class="sd">        airtemperature(3.0, 4.0, 6.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">submodel</span><span class="o">.</span><span class="n">determine_temperature</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">submodel</span><span class="o">.</span><span class="n">get_temperature</span><span class="p">(</span><span class="n">k</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_AirTemperature_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_AirTemperature_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_AirTemperature_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |TempModel_V1| or |TempModel_V2| interface</span>
<span class="sd">    determine the air temperature of the individual hydrological response units.&quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span><span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V1</span><span class="p">,</span> <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span><span class="p">)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Calc_AirTemperature_TempModel_V1</span><span class="p">,</span> <span class="n">Calc_AirTemperature_TempModel_V2</span><span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">tempmodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_airtemperature_tempmodel_v1</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">tempmodel</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">tempmodel_typeid</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_airtemperature_tempmodel_v2</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">tempmodel</span><span class="p">)</span>
            <span class="p">)</span></div>

        <span class="c1"># ToDo:</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         assert_never(model.petmodel)</span>


<div class="viewcode-block" id="Update_LoggedAirTemperature_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_LoggedAirTemperature_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_LoggedAirTemperature_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log the air temperature values of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        The following example shows that each new method call successively moves the</span>
<span class="sd">        six memorised values to the right and stores the two respective new values on</span>
<span class="sd">        the leftmost position:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedairtemperature.shape = 3, 2</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedairtemperature = 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(model,</span>
<span class="sd">        ...                 model.update_loggedairtemperature_v1,</span>
<span class="sd">        ...                 last_example=4,</span>
<span class="sd">        ...                 parseqs=(factors.airtemperature,</span>
<span class="sd">        ...                          logs.loggedairtemperature))</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.airtemperature = [1.0, 2.0], [3.0, 6.0], [2.0, 4.0], [4.0, 8.0]</span>
<span class="sd">        &gt;&gt;&gt; del test.inits.loggedairtemperature</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |      airtemperature |                          loggedairtemperature |</span>
<span class="sd">        -----------------------------------------------------------------------------</span>
<span class="sd">        |   1 | 1.0             2.0 | 1.0  2.0  0.0  0.0  0.0                   0.0 |</span>
<span class="sd">        |   2 | 3.0             6.0 | 3.0  6.0  1.0  2.0  0.0                   0.0 |</span>
<span class="sd">        |   3 | 2.0             4.0 | 2.0  4.0  3.0  6.0  1.0                   2.0 |</span>
<span class="sd">        |   4 | 4.0             8.0 | 4.0  8.0  2.0  4.0  3.0                   6.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedAirTemperature</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="n">loggedairtemperature</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedairtemperature</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">loggedairtemperature</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Calc_DailyAirTemperature_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailyAirTemperature_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailyAirTemperature_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the average air temperature of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedairtemperature.shape = 3, 2</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedairtemperature = [[1.0, 2.0], [5.0, 6.0], [3.0, 4.0]]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailyairtemperature_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.dailyairtemperature</span>
<span class="sd">        dailyairtemperature(3.0, 4.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedAirTemperature</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyAirTemperature</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">dailyairtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">dailyairtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedairtemperature</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">dailyairtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/=</span> <span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span></div>



<div class="viewcode-block" id="Calc_MeanAirTemperature_TempModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_MeanAirTemperature_TempModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_MeanAirTemperature_TempModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query mean air temperature from a main model referenced as a sub-submodel and</span>
<span class="sd">    follows the |TempModel_V1| interface.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use the combination of |hland_96| and |evap_pet_hbv96| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.hland_96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; area(10.0)</span>
<span class="sd">        &gt;&gt;&gt; nmbzones(3)</span>
<span class="sd">        &gt;&gt;&gt; zonearea(5.0, 3.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; zonetype(FIELD)</span>
<span class="sd">        &gt;&gt;&gt; zonez(2.0)</span>
<span class="sd">        &gt;&gt;&gt; fc(200.0)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_aetmodel_v1(&quot;evap_aet_hbv96&quot;):</span>
<span class="sd">        ...     with model.add_petmodel_v1(&quot;evap_pet_hbv96&quot;):</span>
<span class="sd">        ...         pass</span>
<span class="sd">        &gt;&gt;&gt; inputs.t = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.petmodel.calc_meanairtemperature_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.petmodel.sequences.factors.meanairtemperature</span>
<span class="sd">        meanairtemperature(2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">MeanAirTemperature</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span><span class="o">.</span><span class="n">meanairtemperature</span> <span class="o">=</span> <span class="n">submodel</span><span class="o">.</span><span class="n">get_meantemperature</span><span class="p">()</span></div>



<div class="viewcode-block" id="Calc_MeanAirTemperature_TempModel_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_MeanAirTemperature_TempModel_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_MeanAirTemperature_TempModel_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |TempModel_V2| interface determine the</span>
<span class="sd">    mean air temperature.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use the combination of |evap_pet_hbv96| and |meteo_temp_io| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_pet_hbv96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; hruarea(0.5, 0.3, 0.2)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_tempmodel_v2(&quot;meteo_temp_io&quot;):</span>
<span class="sd">        ...     temperatureaddend(1.0, 2.0, 4.0)</span>
<span class="sd">        ...     inputs.temperature = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_meanairtemperature_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.meanairtemperature</span>
<span class="sd">        meanairtemperature(3.9)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">MeanAirTemperature</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">submodel</span><span class="o">.</span><span class="n">determine_temperature</span><span class="p">()</span>
        <span class="n">fac</span><span class="o">.</span><span class="n">meanairtemperature</span> <span class="o">=</span> <span class="n">submodel</span><span class="o">.</span><span class="n">get_meantemperature</span><span class="p">()</span></div>



<div class="viewcode-block" id="Calc_MeanAirTemperature_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_MeanAirTemperature_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_MeanAirTemperature_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |TempModel_V1| or |TempModel_V2| interface</span>
<span class="sd">    determine the air temperature.&quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span><span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V1</span><span class="p">,</span> <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span><span class="p">)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_MeanAirTemperature_TempModel_V1</span><span class="p">,</span>
        <span class="n">Calc_MeanAirTemperature_TempModel_V2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">MeanAirTemperature</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">tempmodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_meanairtemperature_tempmodel_v1</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">tempmodel</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">tempmodel_typeid</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_meanairtemperature_tempmodel_v2</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">tempmodel</span><span class="p">)</span>
            <span class="p">)</span></div>

        <span class="c1"># ToDo:</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         assert_never(model.petmodel)</span>


<div class="viewcode-block" id="Calc_WindSpeed2m_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_WindSpeed2m_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WindSpeed2m_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Adjust the measured wind speed to a height of two meters above the ground</span>
<span class="sd">    following :cite:t:`ref-Allen1998`.</span>

<span class="sd">    Basic equation (:cite:t:`ref-Allen1998`, equation 47, modified for higher</span>
<span class="sd">    precision):</span>

<span class="sd">      .. math::</span>
<span class="sd">        WindSpeed2m = WindSpeed \cdot</span>
<span class="sd">        \frac{ln((2 - d) / z_0)}{ln((MeasuringHeightWindSpeed - d) / z_0)}</span>
<span class="sd">        \\ \\</span>
<span class="sd">        d = 2 / 3 \cdot 0.12 \\</span>
<span class="sd">        z_0 = 0.123 \cdot 0.12</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; measuringheightwindspeed(10.0)</span>
<span class="sd">        &gt;&gt;&gt; inputs.windspeed = 5.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_windspeed2m_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.windspeed2m</span>
<span class="sd">        windspeed2m(3.738763)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">MeasuringHeightWindSpeed</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_inputs</span><span class="o">.</span><span class="n">WindSpeed</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">WindSpeed2m</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">d</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="mf">0.12</span>
        <span class="n">z0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.123</span> <span class="o">*</span> <span class="mf">0.12</span>
        <span class="n">fac</span><span class="o">.</span><span class="n">windspeed2m</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">windspeed</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">modelutils</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">z0</span><span class="p">)</span>
            <span class="o">/</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">con</span><span class="o">.</span><span class="n">measuringheightwindspeed</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">z0</span><span class="p">)</span>
        <span class="p">)</span></div>



<div class="viewcode-block" id="Return_AdjustedWindSpeed_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Return_AdjustedWindSpeed_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Return_AdjustedWindSpeed_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Adjust and return the measured wind speed to the defined height above the</span>
<span class="sd">    ground using the logarithmic wind profile.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        v_1 = v_0 \cdot \frac{ln(h_1 / z_0)}{ln(h_0 / z_0)}</span>
<span class="sd">        \\ \\</span>
<span class="sd">        v_1 = wind \ speed \ at \ h_1 \\</span>
<span class="sd">        h_1 = given \ height \\</span>
<span class="sd">        z_0 = RoughnessLengthGrass \\</span>
<span class="sd">        v_0 = WindSpeed \ (at \ h_0) \\</span>
<span class="sd">        h_0 = MeasuringHeightWindSpeed</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; measuringheightwindspeed(10.0)</span>
<span class="sd">        &gt;&gt;&gt; inputs.windspeed = 5.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(model.return_adjustedwindspeed_v1(2.0))</span>
<span class="sd">        4.007956</span>
<span class="sd">        &gt;&gt;&gt; round_(model.return_adjustedwindspeed_v1(0.5))</span>
<span class="sd">        3.153456</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">MeasuringHeightWindSpeed</span><span class="p">,)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fixed</span><span class="o">.</span><span class="n">RoughnessLengthGrass</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_inputs</span><span class="o">.</span><span class="n">WindSpeed</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fix</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">fixed</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">h</span> <span class="o">==</span> <span class="n">con</span><span class="o">.</span><span class="n">measuringheightwindspeed</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">inp</span><span class="o">.</span><span class="n">windspeed</span>
        <span class="k">return</span> <span class="n">inp</span><span class="o">.</span><span class="n">windspeed</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">modelutils</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">h</span> <span class="o">/</span> <span class="n">fix</span><span class="o">.</span><span class="n">roughnesslengthgrass</span><span class="p">)</span>
            <span class="o">/</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">measuringheightwindspeed</span> <span class="o">/</span> <span class="n">fix</span><span class="o">.</span><span class="n">roughnesslengthgrass</span><span class="p">)</span>
        <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_WindSpeed2m_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_WindSpeed2m_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WindSpeed2m_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adjust the measured wind speed to a height of 2 meters above the ground</span>
<span class="sd">    following :cite:t:`ref-LARSIM`.</span>

<span class="sd">    Method |Calc_WindSpeed2m_V2| relies on method |Return_AdjustedWindSpeed_V1|.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; measuringheightwindspeed(10.0)</span>
<span class="sd">        &gt;&gt;&gt; inputs.windspeed = 5.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_windspeed2m_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.windspeed2m</span>
<span class="sd">        windspeed2m(4.007956)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_AdjustedWindSpeed_V1</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">MeasuringHeightWindSpeed</span><span class="p">,)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fixed</span><span class="o">.</span><span class="n">RoughnessLengthGrass</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_inputs</span><span class="o">.</span><span class="n">WindSpeed</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">WindSpeed2m</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span><span class="o">.</span><span class="n">windspeed2m</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">return_adjustedwindspeed_v1</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span></div>



<div class="viewcode-block" id="Update_LoggedWindSpeed2m_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_LoggedWindSpeed2m_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_LoggedWindSpeed2m_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log the wind speed values 2 meters above the ground of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        The following example shows that each new method call successively moves the</span>
<span class="sd">        three memorised values to the right and stores the respective new value on the</span>
<span class="sd">        leftmost position:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedwindspeed2m.shape = 3</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedwindspeed2m = 0.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(model,</span>
<span class="sd">        ...                 model.update_loggedwindspeed2m_v1,</span>
<span class="sd">        ...                 last_example=4,</span>
<span class="sd">        ...                 parseqs=(factors.windspeed2m,</span>
<span class="sd">        ...                          logs.loggedwindspeed2m))</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.windspeed2m = 1.0, 3.0, 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; del test.inits.loggedwindspeed2m</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. | windspeed2m |           loggedwindspeed2m |</span>
<span class="sd">        ---------------------------------------------------</span>
<span class="sd">        |   1 |         1.0 | 1.0  0.0                0.0 |</span>
<span class="sd">        |   2 |         3.0 | 3.0  1.0                0.0 |</span>
<span class="sd">        |   3 |         2.0 | 2.0  3.0                1.0 |</span>
<span class="sd">        |   4 |         4.0 | 4.0  2.0                3.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">WindSpeed2m</span><span class="p">,)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedWindSpeed2m</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">loggedwindspeed2m</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedwindspeed2m</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">log</span><span class="o">.</span><span class="n">loggedwindspeed2m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">windspeed2m</span></div>



<div class="viewcode-block" id="Calc_DailyWindSpeed2m_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailyWindSpeed2m_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailyWindSpeed2m_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the average wind speed 2 meters above ground of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedwindspeed2m.shape = 3</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedwindspeed2m = 1.0, 5.0, 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailywindspeed2m_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.dailywindspeed2m</span>
<span class="sd">        dailywindspeed2m(3.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedWindSpeed2m</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyWindSpeed2m</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span><span class="o">.</span><span class="n">dailywindspeed2m</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">dailywindspeed2m</span> <span class="o">+=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedwindspeed2m</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">fac</span><span class="o">.</span><span class="n">dailywindspeed2m</span> <span class="o">/=</span> <span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span></div>



<div class="viewcode-block" id="Calc_WindSpeed10m_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_WindSpeed10m_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WindSpeed10m_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adjust the measured wind speed to a height of 10 meters above the ground</span>
<span class="sd">    following :cite:t:`ref-LARSIM`.</span>

<span class="sd">    Method |Calc_WindSpeed2m_V2| relies on method |Return_AdjustedWindSpeed_V1|.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; measuringheightwindspeed(3.0)</span>
<span class="sd">        &gt;&gt;&gt; inputs.windspeed = 5.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_windspeed10m_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.windspeed10m</span>
<span class="sd">        windspeed10m(5.871465)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_AdjustedWindSpeed_V1</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">MeasuringHeightWindSpeed</span><span class="p">,)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fixed</span><span class="o">.</span><span class="n">RoughnessLengthGrass</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_inputs</span><span class="o">.</span><span class="n">WindSpeed</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">WindSpeed10m</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span><span class="o">.</span><span class="n">windspeed10m</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">return_adjustedwindspeed_v1</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span></div>



<div class="viewcode-block" id="Update_LoggedRelativeHumidity_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_LoggedRelativeHumidity_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_LoggedRelativeHumidity_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log the relative humidity values of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        The following example shows that each new method call successively moves the</span>
<span class="sd">        three memorised values to the right and stores the new value on the leftmost</span>
<span class="sd">        position:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedrelativehumidity.shape = 3</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedrelativehumidity = 0.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(model,</span>
<span class="sd">        ...                 model.update_loggedrelativehumidity_v1,</span>
<span class="sd">        ...                 last_example=4,</span>
<span class="sd">        ...                 parseqs=(inputs.relativehumidity,</span>
<span class="sd">        ...                          logs.loggedrelativehumidity))</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.relativehumidity = 1.0, 3.0, 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; del test.inits.loggedrelativehumidity</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. | relativehumidity |           loggedrelativehumidity |</span>
<span class="sd">        -------------------------------------------------------------</span>
<span class="sd">        |   1 |              1.0 | 1.0  0.0                     0.0 |</span>
<span class="sd">        |   2 |              3.0 | 3.0  1.0                     0.0 |</span>
<span class="sd">        |   3 |              2.0 | 2.0  3.0                     1.0 |</span>
<span class="sd">        |   4 |              4.0 | 4.0  2.0                     3.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_inputs</span><span class="o">.</span><span class="n">RelativeHumidity</span><span class="p">,)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedRelativeHumidity</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">loggedrelativehumidity</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedrelativehumidity</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">log</span><span class="o">.</span><span class="n">loggedrelativehumidity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">relativehumidity</span></div>



<div class="viewcode-block" id="Calc_DailyRelativeHumidity_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailyRelativeHumidity_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailyRelativeHumidity_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the average of the relative humidity of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedrelativehumidity.shape = 3</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedrelativehumidity = 1.0, 5.0, 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailyrelativehumidity_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.dailyrelativehumidity</span>
<span class="sd">        dailyrelativehumidity(3.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedRelativeHumidity</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyRelativeHumidity</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span><span class="o">.</span><span class="n">dailyrelativehumidity</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">dailyrelativehumidity</span> <span class="o">+=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedrelativehumidity</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">fac</span><span class="o">.</span><span class="n">dailyrelativehumidity</span> <span class="o">/=</span> <span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span></div>



<div class="viewcode-block" id="Calc_SaturationVapourPressure_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SaturationVapourPressure_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SaturationVapourPressure_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the saturation vapour pressure according to :cite:t:`ref-Allen1998`.</span>

<span class="sd">    Basic equation (:cite:t:`ref-Allen1998`, equation 11):</span>
<span class="sd">      :math:`SaturationVapourPressure = 6.108 \cdot</span>
<span class="sd">      \exp \left( \frac{17.27 \cdot AirTemperature}{AirTemperature + 237.3} \right)`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 10.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_saturationvapourpressure_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressure</span>
<span class="sd">        saturationvapourpressure(12.279626)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.108</span> <span class="o">*</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                <span class="mf">17.27</span> <span class="o">*</span> <span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mf">237.3</span><span class="p">)</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Return_SaturationVapourPressure_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Return_SaturationVapourPressure_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Return_SaturationVapourPressure_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate and return the saturation vapour pressure according to</span>
<span class="sd">    :cite:t:`ref-Weischet1983`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`f(T) = 6.1078 \cdot 2.71828^{\frac{17.08085 \cdot T}{T + 234.175}}`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(model.return_saturationvapourpressure_v1(10.0))</span>
<span class="sd">        12.293852</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">airtemperature</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">6.1078</span> <span class="o">*</span> <span class="mf">2.71828</span> <span class="o">**</span> <span class="p">(</span>
            <span class="mf">17.08085</span> <span class="o">*</span> <span class="n">airtemperature</span> <span class="o">/</span> <span class="p">(</span><span class="n">airtemperature</span> <span class="o">+</span> <span class="mf">234.175</span><span class="p">)</span>
        <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_SaturationVapourPressure_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SaturationVapourPressure_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SaturationVapourPressure_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the saturation vapour pressure according to</span>
<span class="sd">    :cite:t:`ref-Weischet1983`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`SaturationVapourPressure =</span>
<span class="sd">      Return\_SaturationVapourPressure\_V1(AirTemperature)`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 10.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_saturationvapourpressure_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressure</span>
<span class="sd">        saturationvapourpressure(12.293852)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_SaturationVapourPressure_V1</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">return_saturationvapourpressure_v1</span><span class="p">(</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_DailySaturationVapourPressure_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailySaturationVapourPressure_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailySaturationVapourPressure_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the average of the saturation vapour pressure of the last 24 hours</span>
<span class="sd">    according to :cite:t:`ref-Weischet1983`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`DailySaturationVapourPressure =</span>
<span class="sd">      Return\_SaturationVapourPressure\_V1(DailyAirTemperature)`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; factors.dailyairtemperature = 10.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailysaturationvapourpressure_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.dailysaturationvapourpressure</span>
<span class="sd">        dailysaturationvapourpressure(12.293852)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_SaturationVapourPressure_V1</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyAirTemperature</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">DailySaturationVapourPressure</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">dailysaturationvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">model</span><span class="o">.</span><span class="n">return_saturationvapourpressure_v1</span><span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">dailyairtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_SaturationVapourPressureSlope_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SaturationVapourPressureSlope_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SaturationVapourPressureSlope_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the slope of the saturation vapour pressure curve according to</span>
<span class="sd">    :cite:t:`ref-Allen1998`.</span>

<span class="sd">    Basic equation (:cite:t:`ref-Allen1998`, equation 13):</span>
<span class="sd">      :math:`SaturationVapourPressureSlope = 4098 \cdot</span>
<span class="sd">      \frac{SaturationVapourPressure}{(AirTemperature + 237.3)^2}`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 10.0</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressure = 12.279626</span>
<span class="sd">        &gt;&gt;&gt; model.calc_saturationvapourpressureslope_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressureslope</span>
<span class="sd">        saturationvapourpressureslope(0.822828)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressureslope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="mf">4098.0</span>
                <span class="o">*</span> <span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="o">/</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mf">237.3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Return_SaturationVapourPressureSlope_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Return_SaturationVapourPressureSlope_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Return_SaturationVapourPressureSlope_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate and return the saturation vapour pressure slope according to</span>
<span class="sd">    :cite:t:`ref-Weischet1983`.</span>

<span class="sd">    Basic equation (derivative of |Return_SaturationVapourPressure_V1|:</span>
<span class="sd">      :math:`f(T) =</span>
<span class="sd">      \frac{24430.6 \cdot exp((17.08085 \cdot T) / (T + 234.175)}{(T + 234.175)^2}`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(model.return_saturationvapourpressureslope_v1(10.0))</span>
<span class="sd">        0.824774</span>

<span class="sd">        &gt;&gt;&gt; dx = 1e-6</span>
<span class="sd">        &gt;&gt;&gt; round_((model.return_saturationvapourpressure_v1(10.0 + dx) -</span>
<span class="sd">        ...         model.return_saturationvapourpressure_v1(10.0 - dx)) / 2 / dx)</span>
<span class="sd">        0.824775</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="mf">24430.6</span> <span class="o">*</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">17.08085</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mf">234.175</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mf">234.175</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_SaturationVapourPressureSlope_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SaturationVapourPressureSlope_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SaturationVapourPressureSlope_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the slope of the saturation vapour pressure curve according to</span>
<span class="sd">    :cite:t:`ref-Weischet1983`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`SaturationVapourPressureSlope =</span>
<span class="sd">      Return\_SaturationVapourPressureSlope\_V1(AirTemperature)`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 10.0, 0.0, -10.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_saturationvapourpressureslope_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressureslope</span>
<span class="sd">        saturationvapourpressureslope(0.824774, 0.445506, 0.226909)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_SaturationVapourPressureSlope_V1</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressureslope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">model</span><span class="o">.</span><span class="n">return_saturationvapourpressureslope_v1</span><span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_DailySaturationVapourPressureSlope_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailySaturationVapourPressureSlope_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailySaturationVapourPressureSlope_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Average the slope of the saturation vapour pressure curve according to</span>
<span class="sd">    :cite:t:`ref-Weischet1983` of the last 24 hours.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`DailySaturationVapourPressureSlope =</span>
<span class="sd">      Return\_SaturationVapourPressureSlope\_V1(DailyAirTemperature)`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; factors.dailyairtemperature = 10.0, 0.0, -10.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailysaturationvapourpressureslope_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.dailysaturationvapourpressureslope</span>
<span class="sd">        dailysaturationvapourpressureslope(0.824774, 0.445506, 0.226909)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_SaturationVapourPressureSlope_V1</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyAirTemperature</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">DailySaturationVapourPressureSlope</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">dailysaturationvapourpressureslope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">model</span><span class="o">.</span><span class="n">return_saturationvapourpressureslope_v1</span><span class="p">(</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">dailyairtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_ActualVapourPressure_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_ActualVapourPressure_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_ActualVapourPressure_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the actual vapour pressure according to :cite:t:`ref-Allen1998`.</span>

<span class="sd">    Basic equation (:cite:t:`ref-Allen1998`, equation 19, modified):</span>
<span class="sd">      :math:`ActualVapourPressure = SaturationVapourPressure \cdot</span>
<span class="sd">      RelativeHumidity / 100`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; inputs.relativehumidity = 60.0</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressure = 30.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_actualvapourpressure_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure</span>
<span class="sd">        actualvapourpressure(18.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_inputs</span><span class="o">.</span><span class="n">RelativeHumidity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">actualvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">inp</span><span class="o">.</span><span class="n">relativehumidity</span> <span class="o">/</span> <span class="mf">100.0</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_DailyActualVapourPressure_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailyActualVapourPressure_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailyActualVapourPressure_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the average of the actual vapour pressure of the last 24 hours.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`DailyActualVapourPressure = DailySaturationVapourPressure \cdot</span>
<span class="sd">      DailyRelativeHumidity / 100`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; factors.dailyrelativehumidity = 60.0</span>
<span class="sd">        &gt;&gt;&gt; factors.dailysaturationvapourpressure = 30.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailyactualvapourpressure_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.dailyactualvapourpressure</span>
<span class="sd">        dailyactualvapourpressure(18.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyRelativeHumidity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailySaturationVapourPressure</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyActualVapourPressure</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">dailyactualvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">dailysaturationvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">fac</span><span class="o">.</span><span class="n">dailyrelativehumidity</span> <span class="o">/</span> <span class="mf">100.0</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_DryAirPressure_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DryAirPressure_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DryAirPressure_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the dry air pressure :cite:p:`ref-DWD1987`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`DryAirPressure = AirPressure - ActualVapourPressure`</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 9.0, 11.0, 25.0</span>
<span class="sd">        &gt;&gt;&gt; inputs.atmosphericpressure = 1200.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dryairpressure_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.dryairpressure</span>
<span class="sd">        dryairpressure(1191.0, 1189.0, 1175.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_inputs</span><span class="o">.</span><span class="n">AtmosphericPressure</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">DryAirPressure</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">dryairpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">inp</span><span class="o">.</span><span class="n">atmosphericpressure</span> <span class="o">-</span> <span class="n">fac</span><span class="o">.</span><span class="n">actualvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_AirDensity_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_AirDensity_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_AirDensity_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the air density :cite:p:`ref-DWD1987`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`AirDensity = \frac{100}{AirTemperature + 273.15} \cdot</span>
<span class="sd">       \left( \frac{DryAirPressure}{GasConstantDryAir}</span>
<span class="sd">       + \frac{ActualVapourPressure}{GasConstantWaterVapour} \right)`</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; factors.dryairpressure = 1191.0, 1000.0, 1150.0</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 8.0, 7.0, 10.0</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 10.0, 12.0, 14.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_airdensity_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.airdensity</span>
<span class="sd">        airdensity(1.471419, 1.226998, 1.402691)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fixed</span><span class="o">.</span><span class="n">GasConstantDryAir</span><span class="p">,</span> <span class="n">evap_fixed</span><span class="o">.</span><span class="n">GasConstantWaterVapour</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DryAirPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">AirDensity</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fix</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">fixed</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">airdensity</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">100.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">dryairpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">fix</span><span class="o">.</span><span class="n">gasconstantdryair</span>
                <span class="o">+</span> <span class="n">fac</span><span class="o">.</span><span class="n">actualvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">fix</span><span class="o">.</span><span class="n">gasconstantwatervapour</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Process_RadiationModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Process_RadiationModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Process_RadiationModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |RadiationModel_V1| interface preprocess</span>
<span class="sd">    all eventually required data.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use the combination of |evap_ret_fao56| and |meteo_glob_fao56| as an</span>
<span class="sd">        example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-07-06&quot;, &quot;2000-07-07&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_ret_fao56 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v1(&quot;meteo_glob_fao56&quot;):</span>
<span class="sd">        ...     latitude(50.8)</span>
<span class="sd">        ...     angstromconstant(0.25)</span>
<span class="sd">        ...     angstromfactor(0.5)</span>
<span class="sd">        ...     inputs.sunshineduration = 9.25</span>
<span class="sd">        &gt;&gt;&gt; model.process_radiationmodel_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.radiationmodel.sequences.fluxes.globalradiation</span>
<span class="sd">        globalradiation(255.367464)</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span><span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V1</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">cast</span><span class="p">(</span>
                <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel</span>
            <span class="p">)</span><span class="o">.</span><span class="n">process_radiation</span><span class="p">()</span></div>

        <span class="c1"># ToDo:</span>
        <span class="c1">#     elif ...</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         assert_never(model.radiationmodel)</span>


<div class="viewcode-block" id="Calc_PossibleSunshineDuration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PossibleSunshineDuration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PossibleSunshineDuration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the possible sunshine duration from a submodel that complies with the</span>
<span class="sd">    |RadiationModel_V1| or |RadiationModel_V4| interface.</span>

<span class="sd">    Examples:</span>

<span class="sd">        We combine |evap_pet_ambav1| with submodels that comply with different</span>
<span class="sd">        interfaces.  First, with |meteo_glob_fao56|, which complies with</span>
<span class="sd">        |RadiationModel_V1|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_pet_ambav1 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v1(&quot;meteo_glob_fao56&quot;, update=False):</span>
<span class="sd">        ...     factors.possiblesunshineduration = 10.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_possiblesunshineduration()</span>
<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration</span>
<span class="sd">        possiblesunshineduration(10.0)</span>

<span class="sd">        Second, with |meteo_psun_sun_glob_io|, which complies with |RadiationModel_V4|:</span>

<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v4(&quot;meteo_psun_sun_glob_io&quot;, update=False):</span>
<span class="sd">        ...     inputs.possiblesunshineduration = 14.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_possiblesunshineduration()</span>
<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration</span>
<span class="sd">        possiblesunshineduration(14.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V1</span><span class="p">,</span>
        <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V4</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">PossibleSunshineDuration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">possiblesunshineduration</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V3</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel</span>
            <span class="p">)</span><span class="o">.</span><span class="n">get_possiblesunshineduration</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel_typeid</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">possiblesunshineduration</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V4</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel</span>
            <span class="p">)</span><span class="o">.</span><span class="n">get_possiblesunshineduration</span><span class="p">()</span></div>

        <span class="c1"># ToDo:</span>
        <span class="c1">#     elif ...</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         assert_never(model.radiationmodel)</span>


<div class="viewcode-block" id="Calc_SunshineDuration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SunshineDuration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SunshineDuration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the actual sunshine duration from a submodel that complies with the</span>
<span class="sd">    |RadiationModel_V1| or |RadiationModel_V4| interface.</span>

<span class="sd">    Examples:</span>

<span class="sd">        We combine |evap_pet_ambav1| with submodels that comply with different</span>
<span class="sd">        interfaces.  First, with |meteo_glob_fao56|, which complies with</span>
<span class="sd">        |RadiationModel_V1|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_pet_ambav1 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v1(&quot;meteo_glob_fao56&quot;, update=False):</span>
<span class="sd">        ...     inputs.sunshineduration = 10.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_sunshineduration()</span>
<span class="sd">        &gt;&gt;&gt; factors.sunshineduration</span>
<span class="sd">        sunshineduration(10.0)</span>

<span class="sd">        Second, with |meteo_psun_sun_glob_io|, which complies with |RadiationModel_V4|:</span>

<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v4(&quot;meteo_psun_sun_glob_io&quot;, update=False):</span>
<span class="sd">        ...     inputs.sunshineduration = 14.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_sunshineduration()</span>
<span class="sd">        &gt;&gt;&gt; factors.sunshineduration</span>
<span class="sd">        sunshineduration(14.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V1</span><span class="p">,</span>
        <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V4</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SunshineDuration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">sunshineduration</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V3</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel</span>
            <span class="p">)</span><span class="o">.</span><span class="n">get_sunshineduration</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel_typeid</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">sunshineduration</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V4</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel</span>
            <span class="p">)</span><span class="o">.</span><span class="n">get_sunshineduration</span><span class="p">()</span></div>

        <span class="c1"># ToDo:</span>
        <span class="c1">#     elif ...</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         assert_never(model.radiationmodel)</span>


<div class="viewcode-block" id="Calc_ClearSkySolarRadiation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_ClearSkySolarRadiation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_ClearSkySolarRadiation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the global radiation from a submodel that complies with the</span>
<span class="sd">    |RadiationModel_V1| or |RadiationModel_V3| interface.</span>

<span class="sd">    Examples:</span>

<span class="sd">        We combine |evap_ret_fao56| with submodels that comply with different</span>
<span class="sd">        interfaces.  First, with |meteo_glob_fao56|, which complies with</span>
<span class="sd">        |RadiationModel_V1|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_ret_fao56 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v1(&quot;meteo_glob_fao56&quot;, update=False):</span>
<span class="sd">        ...     fluxes.clearskysolarradiation = 100.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_clearskysolarradiation()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.clearskysolarradiation</span>
<span class="sd">        clearskysolarradiation(100.0)</span>

<span class="sd">        Second, with |meteo_clear_glob_io|, which complies with |RadiationModel_V3|:</span>

<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v3(&quot;meteo_clear_glob_io&quot;, update=False):</span>
<span class="sd">        ...     inputs.clearskysolarradiation = 300.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_clearskysolarradiation()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.clearskysolarradiation</span>
<span class="sd">        clearskysolarradiation(300.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V1</span><span class="p">,</span>
        <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V3</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ClearSkySolarRadiation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">clearskysolarradiation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel</span>
            <span class="p">)</span><span class="o">.</span><span class="n">get_clearskysolarradiation</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel_typeid</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">clearskysolarradiation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V3</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel</span>
            <span class="p">)</span><span class="o">.</span><span class="n">get_clearskysolarradiation</span><span class="p">()</span></div>

        <span class="c1"># ToDo:</span>
        <span class="c1">#     elif ...</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         assert_never(model.radiationmodel)</span>


<div class="viewcode-block" id="Calc_GlobalRadiation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_GlobalRadiation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_GlobalRadiation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the global radiation from a submodel that complies with the</span>
<span class="sd">    |RadiationModel_V1|, |RadiationModel_V2|, |RadiationModel_V3|, or</span>
<span class="sd">    |RadiationModel_V4| interface.</span>

<span class="sd">    Examples:</span>

<span class="sd">        We combine three main models with submodels that comply with the four</span>
<span class="sd">        radiation-related interfaces.  First, |evap_ret_fao56| with |meteo_glob_fao56|,</span>
<span class="sd">        which complies with |RadiationModel_V1|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_ret_fao56 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v1(&quot;meteo_glob_fao56&quot;, update=False):</span>
<span class="sd">        ...     fluxes.globalradiation = 100.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_globalradiation()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.globalradiation</span>
<span class="sd">        globalradiation(100.0)</span>

<span class="sd">        Second, |evap_ret_tw2002| with |meteo_glob_io|, which complies with</span>
<span class="sd">        |RadiationModel_V2|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.core.importtools import reverse_model_wildcard_import</span>
<span class="sd">        &gt;&gt;&gt; reverse_model_wildcard_import()</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_ret_tw2002 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v2(&quot;meteo_glob_io&quot;, update=False):</span>
<span class="sd">        ...     inputs.globalradiation = 200.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_globalradiation()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.globalradiation</span>
<span class="sd">        globalradiation(200.0)</span>

<span class="sd">        Third, |evap_ret_fao56| with |meteo_clear_glob_io|, which complies with</span>
<span class="sd">        |RadiationModel_V3|:</span>

<span class="sd">        &gt;&gt;&gt; reverse_model_wildcard_import()</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_ret_fao56 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v3(&quot;meteo_clear_glob_io&quot;, update=False):</span>
<span class="sd">        ...     inputs.globalradiation = 300.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_globalradiation()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.globalradiation</span>
<span class="sd">        globalradiation(300.0)</span>

<span class="sd">        Fourth, |evap_pet_ambav1| with |meteo_psun_sun_glob_io|, which complies with</span>
<span class="sd">        |RadiationModel_V4|:</span>

<span class="sd">        &gt;&gt;&gt; reverse_model_wildcard_import()</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_pet_ambav1 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v4(&quot;meteo_psun_sun_glob_io&quot;, update=False):</span>
<span class="sd">        ...     inputs.globalradiation = 400.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_globalradiation()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.globalradiation</span>
<span class="sd">        globalradiation(400.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V1</span><span class="p">,</span>
        <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V2</span><span class="p">,</span>
        <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V3</span><span class="p">,</span>
        <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V4</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">GlobalRadiation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">globalradiation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel</span>
            <span class="p">)</span><span class="o">.</span><span class="n">get_globalradiation</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel_typeid</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">globalradiation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V2</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel</span>
            <span class="p">)</span><span class="o">.</span><span class="n">get_globalradiation</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel_typeid</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">globalradiation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V3</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel</span>
            <span class="p">)</span><span class="o">.</span><span class="n">get_globalradiation</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel_typeid</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">globalradiation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V4</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">radiationmodel</span>
            <span class="p">)</span><span class="o">.</span><span class="n">get_globalradiation</span><span class="p">()</span></div>

        <span class="c1"># ToDo:</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         assert_never(model.radiationmodel)</span>


<div class="viewcode-block" id="Update_LoggedSunshineDuration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_LoggedSunshineDuration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_LoggedSunshineDuration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log the sunshine duration values of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        The following example shows that each new method call successively moves the</span>
<span class="sd">        three memorised values to the right and stores the new value on the leftmost</span>
<span class="sd">        position:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedsunshineduration.shape = 3</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedsunshineduration = 0.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(model,</span>
<span class="sd">        ...                 model.update_loggedsunshineduration_v1,</span>
<span class="sd">        ...                 last_example=4,</span>
<span class="sd">        ...                 parseqs=(factors.sunshineduration,</span>
<span class="sd">        ...                          logs.loggedsunshineduration))</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.sunshineduration = 1.0, 3.0, 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; del test.inits.loggedsunshineduration</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. | sunshineduration |           loggedsunshineduration |</span>
<span class="sd">        -------------------------------------------------------------</span>
<span class="sd">        |   1 |              1.0 | 1.0  0.0                     0.0 |</span>
<span class="sd">        |   2 |              3.0 | 3.0  1.0                     0.0 |</span>
<span class="sd">        |   3 |              2.0 | 2.0  3.0                     1.0 |</span>
<span class="sd">        |   4 |              4.0 | 4.0  2.0                     3.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SunshineDuration</span><span class="p">,)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedSunshineDuration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">loggedsunshineduration</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedsunshineduration</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">log</span><span class="o">.</span><span class="n">loggedsunshineduration</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">sunshineduration</span></div>



<div class="viewcode-block" id="Calc_DailySunshineDuration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailySunshineDuration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailySunshineDuration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the sunshine duration sum of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedsunshineduration.shape = 3</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedsunshineduration = 1.0, 5.0, 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailysunshineduration_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.dailysunshineduration</span>
<span class="sd">        dailysunshineduration(9.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedSunshineDuration</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">DailySunshineDuration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span><span class="o">.</span><span class="n">dailysunshineduration</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">dailysunshineduration</span> <span class="o">+=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedsunshineduration</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></div>



<div class="viewcode-block" id="Update_LoggedPossibleSunshineDuration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_LoggedPossibleSunshineDuration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_LoggedPossibleSunshineDuration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log the astronomically possible sunshine duration values of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        The following example shows that each new method call successively moves the</span>
<span class="sd">        three memorised values to the right and stores the new value on the leftmost</span>
<span class="sd">        position:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedpossiblesunshineduration.shape = 3</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedpossiblesunshineduration = 0.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(model,</span>
<span class="sd">        ...                 model.update_loggedpossiblesunshineduration_v1,</span>
<span class="sd">        ...                 last_example=4,</span>
<span class="sd">        ...                 parseqs=(factors.possiblesunshineduration,</span>
<span class="sd">        ...                          logs.loggedpossiblesunshineduration))</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.possiblesunshineduration = 1.0, 3.0, 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; del test.inits.loggedpossiblesunshineduration</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. | possiblesunshineduration |           loggedpossiblesunshineduration |</span>
<span class="sd">        -----------------------------------------------------------------------------</span>
<span class="sd">        |   1 |                      1.0 | 1.0  0.0                             0.0 |</span>
<span class="sd">        |   2 |                      3.0 | 3.0  1.0                             0.0 |</span>
<span class="sd">        |   3 |                      2.0 | 2.0  3.0                             1.0 |</span>
<span class="sd">        |   4 |                      4.0 | 4.0  2.0                             3.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">PossibleSunshineDuration</span><span class="p">,)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedPossibleSunshineDuration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">loggedpossiblesunshineduration</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">log</span><span class="o">.</span><span class="n">loggedpossiblesunshineduration</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">loggedpossiblesunshineduration</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">possiblesunshineduration</span></div>



<div class="viewcode-block" id="Calc_DailyPossibleSunshineDuration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailyPossibleSunshineDuration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailyPossibleSunshineDuration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the sunshine duration sum of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedpossiblesunshineduration.shape = 3</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedpossiblesunshineduration = 1.0, 5.0, 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailypossiblesunshineduration_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.dailypossiblesunshineduration</span>
<span class="sd">        dailypossiblesunshineduration(9.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedPossibleSunshineDuration</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyPossibleSunshineDuration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span><span class="o">.</span><span class="n">dailypossiblesunshineduration</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">dailypossiblesunshineduration</span> <span class="o">+=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedpossiblesunshineduration</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></div>



<div class="viewcode-block" id="Update_LoggedClearSkySolarRadiation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_LoggedClearSkySolarRadiation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_LoggedClearSkySolarRadiation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log the clear sky solar radiation values of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        The following example shows that each new method call successively moves the</span>
<span class="sd">        three memorised values to the right and stores the new value on the leftmost</span>
<span class="sd">        position:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedclearskysolarradiation.shape = 3</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedclearskysolarradiation = 0.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(model,</span>
<span class="sd">        ...                 model.update_loggedclearskysolarradiation_v1,</span>
<span class="sd">        ...                 last_example=4,</span>
<span class="sd">        ...                 parseqs=(fluxes.clearskysolarradiation,</span>
<span class="sd">        ...                          logs.loggedclearskysolarradiation))</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.clearskysolarradiation = 1.0, 3.0, 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; del test.inits.loggedclearskysolarradiation</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. | clearskysolarradiation |           loggedclearskysolarradiation\</span>
<span class="sd"> |</span>
<span class="sd">        -----------------------------------------------------------------------\</span>
<span class="sd">--</span>
<span class="sd">        |   1 |                    1.0 | 1.0  0.0                           0.0\</span>
<span class="sd"> |</span>
<span class="sd">        |   2 |                    3.0 | 3.0  1.0                           0.0\</span>
<span class="sd"> |</span>
<span class="sd">        |   3 |                    2.0 | 2.0  3.0                           1.0\</span>
<span class="sd"> |</span>
<span class="sd">        |   4 |                    4.0 | 4.0  2.0                           3.0\</span>
<span class="sd"> |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ClearSkySolarRadiation</span><span class="p">,)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedClearSkySolarRadiation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">loggedclearskysolarradiation</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedclearskysolarradiation</span><span class="p">[</span>
                <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="p">]</span>
        <span class="n">log</span><span class="o">.</span><span class="n">loggedclearskysolarradiation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">clearskysolarradiation</span></div>



<div class="viewcode-block" id="Update_LoggedGlobalRadiation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_LoggedGlobalRadiation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_LoggedGlobalRadiation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log the global radiation values of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        The following example shows that each new method call successively moves the</span>
<span class="sd">        three memorised values to the right and stores the new value on the leftmost</span>
<span class="sd">        position:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedglobalradiation.shape = 3</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedglobalradiation = 0.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(model,</span>
<span class="sd">        ...                 model.update_loggedglobalradiation_v1,</span>
<span class="sd">        ...                 last_example=4,</span>
<span class="sd">        ...                 parseqs=(fluxes.globalradiation,</span>
<span class="sd">        ...                          logs.loggedglobalradiation))</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.globalradiation = 1.0, 3.0, 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; del test.inits.loggedglobalradiation</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. | globalradiation |           loggedglobalradiation |</span>
<span class="sd">        -----------------------------------------------------------</span>
<span class="sd">        |   1 |             1.0 | 1.0  0.0                    0.0 |</span>
<span class="sd">        |   2 |             3.0 | 3.0  1.0                    0.0 |</span>
<span class="sd">        |   3 |             2.0 | 2.0  3.0                    1.0 |</span>
<span class="sd">        |   4 |             4.0 | 4.0  2.0                    3.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">GlobalRadiation</span><span class="p">,)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedGlobalRadiation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">loggedglobalradiation</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedglobalradiation</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">log</span><span class="o">.</span><span class="n">loggedglobalradiation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">globalradiation</span></div>



<div class="viewcode-block" id="Calc_DailyGlobalRadiation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailyGlobalRadiation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailyGlobalRadiation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Average the global radiation of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedglobalradiation.shape = 3</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedglobalradiation = 100.0, 800.0, 600.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailyglobalradiation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailyglobalradiation</span>
<span class="sd">        dailyglobalradiation(500.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedGlobalRadiation</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyGlobalRadiation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">dailyglobalradiation</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">dailyglobalradiation</span> <span class="o">+=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedglobalradiation</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">dailyglobalradiation</span> <span class="o">/=</span> <span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span></div>



<div class="viewcode-block" id="Calc_CurrentAlbedo_SnowAlbedoModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_CurrentAlbedo_SnowAlbedoModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_CurrentAlbedo_SnowAlbedoModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the current Earth surface albedo from a main model referenced as a</span>
<span class="sd">    sub-submodel and follows the |SnowAlbedoModel_V1| interface.&quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">CurrentAlbedo</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowAlbedoModel_V1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">currentalbedo</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">submodel</span><span class="o">.</span><span class="n">get_snowalbedo</span><span class="p">(</span><span class="n">k</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_CurrentAlbedo_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_CurrentAlbedo_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_CurrentAlbedo_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Take the land type- and month-specific albedo from parameter |Albedo| or a</span>
<span class="sd">    submodel that complies with the |SnowAlbedoModel_V1| interface.</span>

<span class="sd">    Examples:</span>

<span class="sd">        We use the combination of |lland_knauf| and |evap_aet_morsim| as an example and</span>
<span class="sd">        set different albedo values for the land types |lland_constants.ACKER| and</span>
<span class="sd">        |lland_constants.VERS| for January and February:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-01-30&quot;, &quot;2000-02-03&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland_knauf import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; ft(10.0)</span>
<span class="sd">        &gt;&gt;&gt; nhru(3)</span>
<span class="sd">        &gt;&gt;&gt; fhru(5.0, 3.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; gh(100.0)</span>
<span class="sd">        &gt;&gt;&gt; lnk(ACKER, VERS, VERS)</span>
<span class="sd">        &gt;&gt;&gt; measuringheightwindspeed(10.0)</span>
<span class="sd">        &gt;&gt;&gt; lai(3.0)</span>
<span class="sd">        &gt;&gt;&gt; wmax(100.0)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_aetmodel_v1(&quot;evap_aet_morsim&quot;):</span>
<span class="sd">        ...     albedo.acker_jan = 0.2</span>
<span class="sd">        ...     albedo.vers_jan = 0.3</span>
<span class="sd">        ...     albedo.acker_feb = 0.4</span>
<span class="sd">        ...     albedo.vers_feb = 0.5</span>

<span class="sd">        |SnowAlbedoModel_V1| submodels return |numpy.nan| values for snow-free</span>
<span class="sd">        conditions.  In such cases (see the first and second hydrological response</span>
<span class="sd">        unit), |Calc_CurrentAlbedo_V1| takes the relevant value from parameter</span>
<span class="sd">        |Albedo|.  If there is a snow cover (see the third response unit), the</span>
<span class="sd">        |SnowAlbedoModel_V1| submodel provides an albedo value and</span>
<span class="sd">        |Calc_CurrentAlbedo_V1| takes it without modification:</span>

<span class="sd">        &gt;&gt;&gt; model.aetmodel.idx_sim = 1</span>
<span class="sd">        &gt;&gt;&gt; fluxes.actualalbedo = nan, nan, 1.0</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.calc_currentalbedo_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.sequences.factors.currentalbedo</span>
<span class="sd">        currentalbedo(0.2, 0.3, 1.0)</span>

<span class="sd">        |Calc_CurrentAlbedo_V1| always falls back on using the land type- and</span>
<span class="sd">        month-specific values of parameter |Albedo| if no |SnowAlbedoModel_V1| submodel</span>
<span class="sd">        is available:</span>

<span class="sd">        &gt;&gt;&gt; del model.aetmodel.snowalbedomodel</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.idx_sim = 2</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.calc_currentalbedo_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.sequences.factors.currentalbedo</span>
<span class="sd">        currentalbedo(0.4, 0.5, 0.5)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span><span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowAlbedoModel_V1</span><span class="p">,)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Calc_CurrentAlbedo_SnowAlbedoModel_V1</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">Albedo</span><span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">CurrentAlbedo</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">snowalbedomodel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">currentalbedo</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">albedo</span><span class="p">[</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">hrutype</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_albedo_rowmin</span><span class="p">,</span>
                    <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_albedo_columnmin</span><span class="p">,</span>
                <span class="p">]</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">snowalbedomodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_currentalbedo_snowalbedomodel_v1</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowAlbedoModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">snowalbedomodel</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">currentalbedo</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">currentalbedo</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">albedo</span><span class="p">[</span>
                        <span class="n">con</span><span class="o">.</span><span class="n">hrutype</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_albedo_rowmin</span><span class="p">,</span>
                        <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_albedo_columnmin</span><span class="p">,</span>
                    <span class="p">]</span></div>



<div class="viewcode-block" id="Calc_CurrentAlbedo_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_CurrentAlbedo_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_CurrentAlbedo_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the earth&#39;s surface albedo based on the current leaf area index and</span>
<span class="sd">    snow conditions following :cite:t:`ref-Lpmeier2014`.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      .. math::</span>
<span class="sd">        CurrentAlbedo = \alpha_g + (\alpha_l - \alpha_g) \cdot min(lai/4, \ 1)</span>
<span class="sd">        \\ \\</span>
<span class="sd">        \alpha_g = \omega \cdot GroundAlbedoSnow + (1 - \omega) \cdot \alpha_g^* \\</span>
<span class="sd">        \alpha_g^*  = GroundAlbedo \cdot \begin{cases}</span>
<span class="sd">        1 &amp;|\ \overline{Soil} \ \lor \ p / e &lt; \tau \\</span>
<span class="sd">        0.5 &amp;|\ Soil \ \land \ p / e \geq \tau \end{cases} \\</span>
<span class="sd">        \tau = WetnessThreshold \\</span>
<span class="sd">        p = DailyPrecipitation \\</span>
<span class="sd">        e = DailyPotentialSoilEvapotranspiration \\</span>
<span class="sd">        \alpha_l = \omega \cdot LeafAlbedoSnow + (1 - \omega) \cdot LeafAlbedo \\</span>
<span class="sd">        \omega = SnowCover \\</span>
<span class="sd">        lai = LeafAreaIndex</span>

<span class="sd">    Examples:</span>

<span class="sd">        We use |lland_knauf| and |evap_aet_minhas| as main models to prepare an</span>
<span class="sd">        applicable |evap| instance (more precisely, an |evap_pet_ambav1| instance):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland_knauf import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nhru(5)</span>
<span class="sd">        &gt;&gt;&gt; lnk(WASSER, BODEN, ACKER, BAUMB, LAUBW)</span>
<span class="sd">        &gt;&gt;&gt; ft(10.0)</span>
<span class="sd">        &gt;&gt;&gt; fhru(0.2)</span>
<span class="sd">        &gt;&gt;&gt; gh(100.0)</span>
<span class="sd">        &gt;&gt;&gt; wmax(200.0)</span>
<span class="sd">        &gt;&gt;&gt; measuringheightwindspeed(10.0)</span>
<span class="sd">        &gt;&gt;&gt; lai.acker = 2.0</span>
<span class="sd">        &gt;&gt;&gt; lai.baumb = 3.0</span>
<span class="sd">        &gt;&gt;&gt; lai.may_laubw = 4.0</span>
<span class="sd">        &gt;&gt;&gt; lai.jun_laubw = 5.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-05-30&quot;, &quot;2000-06-03&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; with model.add_aetmodel_v1(&quot;evap_aet_minhas&quot;):</span>
<span class="sd">        ...     with model.add_petmodel_v2(&quot;evap_pet_ambav1&quot;) as ambav:</span>
<span class="sd">        ...         groundalbedo(wasser=0.1, boden=0.2, acker=0.2, baumb=0.2, laubw=0.2)</span>
<span class="sd">        ...         groundalbedosnow(0.8)</span>
<span class="sd">        ...         leafalbedo(acker=0.3, baumb=0.3, laubw=0.3)</span>
<span class="sd">        ...         leafalbedosnow(0.6)</span>
<span class="sd">        ...         wetnessthreshold(0.5)</span>
<span class="sd">        ...         factors.snowcover = 0.0</span>
<span class="sd">        ...         fluxes.dailyprecipitation = 1.0</span>
<span class="sd">        ...         fluxes.dailypotentialsoilevapotranspiration = 4.0</span>
<span class="sd">        &gt;&gt;&gt; factors = ambav.sequences.factors</span>
<span class="sd">        &gt;&gt;&gt; fluxes = ambav.sequences.fluxes</span>

<span class="sd">        The first example focuses on the general weighting of the ground&#39;s and the</span>
<span class="sd">        leaves&#39; albedo based on the current leaf area index.  For vegetation-free</span>
<span class="sd">        hydrological response units, |Calc_CurrentAlbedo_V2| only considers the</span>
<span class="sd">        ground&#39;s albedo:</span>

<span class="sd">        &gt;&gt;&gt; ambav.idx_sim = pub.timegrids.init[&quot;2000-05-31&quot;]</span>
<span class="sd">        &gt;&gt;&gt; ambav.calc_currentalbedo_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.currentalbedo</span>
<span class="sd">        currentalbedo(0.1, 0.2, 0.25, 0.275, 0.3)</span>

<span class="sd">        For a leaf area index of four, |Calc_CurrentAlbedo_V2| only considers the</span>
<span class="sd">        leaves&#39; albedo.  Hence, setting higher indexes than four does not change the</span>
<span class="sd">        results:</span>

<span class="sd">        &gt;&gt;&gt; ambav.idx_sim = pub.timegrids.init[&quot;2000-06-01&quot;]</span>
<span class="sd">        &gt;&gt;&gt; ambav.calc_currentalbedo_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.currentalbedo</span>
<span class="sd">        currentalbedo(0.1, 0.2, 0.25, 0.275, 0.3)</span>

<span class="sd">        For wet conditions, where the ratio of precipitation and potential soil</span>
<span class="sd">        evapotranspiration exceeds the defined wetness threshold,</span>
<span class="sd">        |Calc_CurrentAlbedo_V2| halves the ground&#39;s albedo of all response units with</span>
<span class="sd">        non-sealed soils:</span>

<span class="sd">        &gt;&gt;&gt; fluxes.dailyprecipitation = 2.0</span>
<span class="sd">        &gt;&gt;&gt; ambav.calc_currentalbedo_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.currentalbedo</span>
<span class="sd">        currentalbedo(0.1, 0.1, 0.2, 0.25, 0.3)</span>

<span class="sd">        For complete snow covers, |Calc_CurrentAlbedo_V2| relies on |GroundAlbedoSnow|</span>
<span class="sd">        and |LeafAlbedoSnow| instead of |GroundAlbedo| and |LeafAlbedo|:</span>

<span class="sd">        &gt;&gt;&gt; fluxes.dailyprecipitation = 1.0</span>
<span class="sd">        &gt;&gt;&gt; factors.snowcover = 1.0</span>
<span class="sd">        &gt;&gt;&gt; ambav.calc_currentalbedo_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.currentalbedo</span>
<span class="sd">        currentalbedo(0.8, 0.8, 0.7, 0.65, 0.6)</span>

<span class="sd">        For incomplete snow covers, |Calc_CurrentAlbedo_V2| weights the respective</span>
<span class="sd">        parameter pairs accordingly:</span>

<span class="sd">        &gt;&gt;&gt; factors.snowcover = 0.5</span>
<span class="sd">        &gt;&gt;&gt; ambav.calc_currentalbedo_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.currentalbedo</span>
<span class="sd">        currentalbedo(0.45, 0.5, 0.475, 0.4625, 0.45)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Plant</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">GroundAlbedo</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">GroundAlbedoSnow</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LeafAlbedo</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LeafAlbedoSnow</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LeafAreaIndex</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">WetnessThreshold</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SnowCover</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyPrecipitation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyPotentialSoilEvapotranspiration</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">CurrentAlbedo</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">w</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">snowcover</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">a_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">groundalbedo</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">soil</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">wetness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">dailyprecipitation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">wetnessthreshold</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">wetness</span> <span class="o">&gt;=</span> <span class="n">flu</span><span class="o">.</span><span class="n">dailypotentialsoilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                    <span class="n">a_s</span> <span class="o">/=</span> <span class="mf">2.0</span>
            <span class="n">a_g</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">groundalbedosnow</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">a_s</span>
            <span class="n">a_l</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">leafalbedosnow</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">leafalbedo</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">plant</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">lai</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">leafareaindex</span><span class="p">[</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">hrutype</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_leafareaindex_rowmin</span><span class="p">,</span>
                    <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_leafareaindex_columnmin</span><span class="p">,</span>
                <span class="p">]</span>
                <span class="k">if</span> <span class="n">lai</span> <span class="o">&lt;</span> <span class="mf">4.0</span><span class="p">:</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">currentalbedo</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_g</span> <span class="o">+</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">a_l</span> <span class="o">-</span> <span class="n">a_g</span><span class="p">)</span> <span class="o">*</span> <span class="n">lai</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">currentalbedo</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_l</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">currentalbedo</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_g</span></div>



<div class="viewcode-block" id="Calc_NetShortwaveRadiation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_NetShortwaveRadiation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_NetShortwaveRadiation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the net shortwave radiation for the hypothetical grass reference</span>
<span class="sd">    crop according to :cite:t:`ref-Allen1998`.</span>

<span class="sd">    Basic equation (:cite:t:`ref-Allen1998`, equation 38):</span>
<span class="sd">      :math:`NetShortwaveRadiation = (1.0 - 0.23) \cdot GlobalRadiation`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.globalradiation = 200.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_netshortwaveradiation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netshortwaveradiation</span>
<span class="sd">        netshortwaveradiation(154.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">GlobalRadiation</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetShortwaveRadiation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">netshortwaveradiation</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.23</span><span class="p">)</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">globalradiation</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">netshortwaveradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">netshortwaveradiation</span></div>



<div class="viewcode-block" id="Calc_NetShortwaveRadiation_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_NetShortwaveRadiation_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_NetShortwaveRadiation_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the net shortwave radiation for a time-variable albedo.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`NetShortwaveRadiation = (1.0 - CurrentAlbedo) \cdot GlobalRadiation`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.globalradiation = 100.0</span>
<span class="sd">        &gt;&gt;&gt; factors.currentalbedo = 0.25</span>
<span class="sd">        &gt;&gt;&gt; model.calc_netshortwaveradiation_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netshortwaveradiation</span>
<span class="sd">        netshortwaveradiation(75.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">CurrentAlbedo</span><span class="p">,</span> <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">GlobalRadiation</span><span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetShortwaveRadiation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">netshortwaveradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">globalradiation</span> <span class="o">*</span> <span class="p">(</span>
                <span class="mf">1.0</span> <span class="o">-</span> <span class="n">fac</span><span class="o">.</span><span class="n">currentalbedo</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_DailyNetShortwaveRadiation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailyNetShortwaveRadiation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailyNetShortwaveRadiation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the net shortwave radiation average for the last 24 hours.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`DailyNetShortwaveRadiation = (1-CurrentAlbedo) \cdot DailyGlobalRadiation`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; factors.currentalbedo(0.25)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailyglobalradiation = 100.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailynetshortwaveradiation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailynetshortwaveradiation</span>
<span class="sd">        dailynetshortwaveradiation(75.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyGlobalRadiation</span><span class="p">,</span> <span class="n">evap_factors</span><span class="o">.</span><span class="n">CurrentAlbedo</span><span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyNetShortwaveRadiation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">dailynetshortwaveradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="mf">1.0</span> <span class="o">-</span> <span class="n">fac</span><span class="o">.</span><span class="n">currentalbedo</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="p">)</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">dailyglobalradiation</span></div>



<div class="viewcode-block" id="Update_CloudCoverage_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_CloudCoverage_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_CloudCoverage_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Update the degree of cloud coverage.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        c_{new} =</span>
<span class="sd">        \begin{cases}</span>
<span class="sd">        s / s_0 &amp;|\ s_0 = h \\</span>
<span class="sd">        c_{old} &amp;|\ s_0 &lt; h \\</span>
<span class="sd">        \end{cases}</span>
<span class="sd">        \\ \\</span>
<span class="sd">        c = CloudCoverage \\</span>
<span class="sd">        s = SunshineDuration \\</span>
<span class="sd">        s_0 = PossibleSunshineDuration \\</span>
<span class="sd">        h = Hours</span>

<span class="sd">    Examples:</span>

<span class="sd">        For a daily simulation step size, |Update_CloudCoverage_V1| always uses the</span>
<span class="sd">        ratio of the actual and the astronomically possible sunshine duration to</span>
<span class="sd">        estimate the cloud coverage degree:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.days(1.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.sunshineduration = 8.0</span>
<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 10.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_cloudcoverage_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.cloudcoverage</span>
<span class="sd">        cloudcoverage(0.8)</span>

<span class="sd">        The finally calculated cloud coverage degree never exceeds one:</span>

<span class="sd">        &gt;&gt;&gt; factors.sunshineduration = 11.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_cloudcoverage_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.cloudcoverage</span>
<span class="sd">        cloudcoverage(1.0)</span>

<span class="sd">        Now, we switch to an hourly simulation step size:</span>

<span class="sd">        &gt;&gt;&gt; derived.days(1.0 / 24.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.hours(1.0)</span>

<span class="sd">        During the daytime, |Update_CloudCoverage_V1| always updates the cloud coverage</span>
<span class="sd">        degree as described above:</span>

<span class="sd">        &gt;&gt;&gt; factors.sunshineduration = 0.4</span>
<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 1.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_cloudcoverage_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.cloudcoverage</span>
<span class="sd">        cloudcoverage(0.4)</span>

<span class="sd">        From dusk until dawn, when the astronomically possible sunshine duration is</span>
<span class="sd">        shorter than the simulation step size, |Update_CloudCoverage_V1| leaves the</span>
<span class="sd">        previously calculated value untouched:</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 0.8</span>
<span class="sd">        &gt;&gt;&gt; model.update_cloudcoverage_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.cloudcoverage</span>
<span class="sd">        cloudcoverage(0.4)</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">Hours</span><span class="p">,</span> <span class="n">evap_derived</span><span class="o">.</span><span class="n">Days</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SunshineDuration</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">PossibleSunshineDuration</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_states</span><span class="o">.</span><span class="n">CloudCoverage</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">p0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">possiblesunshineduration</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">days</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">p0</span> <span class="o">&gt;=</span> <span class="n">der</span><span class="o">.</span><span class="n">hours</span><span class="p">):</span>
            <span class="n">sta</span><span class="o">.</span><span class="n">cloudcoverage</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">sunshineduration</span> <span class="o">/</span> <span class="n">p0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_AdjustedCloudCoverage_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_AdjustedCloudCoverage_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_AdjustedCloudCoverage_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the adjusted cloud coverage degree.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        AdjustedCloudCoverage = \omega \cdot c + (1 - \omega) \cdot n \cdot c</span>
<span class="sd">        \\ \\</span>
<span class="sd">        \omega = PossibleSunshineDuration / Hours \\</span>
<span class="sd">        c = CloudCoverage\\</span>
<span class="sd">        n = NightCloudFactor</span>

<span class="sd">    Examples:</span>

<span class="sd">        The above equation generally holds for night cloud factors not exceeding one:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nightcloudfactor(0.5)</span>
<span class="sd">        &gt;&gt;&gt; derived.hours(24.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 18.0</span>
<span class="sd">        &gt;&gt;&gt; states.cloudcoverage = 0.8</span>
<span class="sd">        &gt;&gt;&gt; model.calc_adjustedcloudcoverage_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.adjustedcloudcoverage</span>
<span class="sd">        adjustedcloudcoverage(0.7)</span>

<span class="sd">        For night cloud factors above one, |Calc_AdjustedCloudCoverage_V1| ensures the</span>
<span class="sd">        estimated nighttime cloud cover degree never exceeds one:</span>

<span class="sd">        &gt;&gt;&gt; nightcloudfactor(2.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_adjustedcloudcoverage_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.adjustedcloudcoverage</span>
<span class="sd">        adjustedcloudcoverage(0.85)</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NightCloudFactor</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">Hours</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">PossibleSunshineDuration</span><span class="p">,</span>
        <span class="n">evap_states</span><span class="o">.</span><span class="n">CloudCoverage</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">AdjustedCloudCoverage</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">w</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">possiblesunshineduration</span> <span class="o">/</span> <span class="n">der</span><span class="o">.</span><span class="n">hours</span>
        <span class="n">c</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">sta</span><span class="o">.</span><span class="n">cloudcoverage</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">nightcloudfactor</span>
        <span class="n">fac</span><span class="o">.</span><span class="n">adjustedcloudcoverage</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">c</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">c</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_NetLongwaveRadiation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_NetLongwaveRadiation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_NetLongwaveRadiation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the net longwave radiation according to :cite:t:`ref-Allen1998`.</span>

<span class="sd">    Basic equations (:cite:t:`ref-Allen1998`, equation 39, modified):</span>
<span class="sd">      :math:`NetLongwaveRadiation =</span>
<span class="sd">      \sigma \cdot (AirTemperature + 273.16)^4</span>
<span class="sd">      \cdot \left( 0.34 - 0.14 \sqrt{ActualVapourPressure / 10} \right) \cdot</span>
<span class="sd">      (1.35 \cdot GR / CSSR - 0.35)`</span>

<span class="sd">      .. math::</span>
<span class="sd">        GR =</span>
<span class="sd">        \begin{cases}</span>
<span class="sd">        GlobalRadiation &amp;|\ ClearSkySolarRadiation &gt; 0</span>
<span class="sd">        \\</span>
<span class="sd">        \sum{LoggedGlobalRadiation} &amp;|\ ClearSkySolarRadiation = 0</span>
<span class="sd">        \end{cases}</span>

<span class="sd">      .. math::</span>
<span class="sd">        CSSR =</span>
<span class="sd">        \begin{cases}</span>
<span class="sd">        ClearSkySolarRadiation &amp;|\ ClearSkySolarRadiation &gt; 0</span>
<span class="sd">        \\</span>
<span class="sd">        \sum{LoggedClearSkySolarRadiation} &amp;|\ ClearSkySolarRadiation = 0</span>
<span class="sd">        \end{cases}</span>

<span class="sd">      :math:`\sigma = 5.6747685185185184 \cdot 10^{-8}`</span>

<span class="sd">    Note that when clear sky radiation is zero at night, we use the global radiation</span>
<span class="sd">    and clear sky radiation sums of the last 24 hours.  Averaging over three hours</span>
<span class="sd">    before sunset, as :cite:t:`ref-Allen1998` suggests, could be more precise but is a</span>
<span class="sd">    more complicated and error-prone approach.</span>

<span class="sd">    Example:</span>

<span class="sd">        The following calculation agrees with example 11 of :cite:t:`ref-Allen1998`:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.globalradiation = 167.824074</span>
<span class="sd">        &gt;&gt;&gt; fluxes.clearskysolarradiation = 217.592593</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 22.1</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 21.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_netlongwaveradiation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netlongwaveradiation</span>
<span class="sd">        netlongwaveradiation(40.87786)</span>

<span class="sd">        &gt;&gt;&gt; fluxes.clearskysolarradiation = 0.0</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedclearskysolarradiation.shape = 1</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedclearskysolarradiation = 138.888889</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedglobalradiation.shape = 1</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedglobalradiation = 115.740741</span>
<span class="sd">        &gt;&gt;&gt; model.calc_netlongwaveradiation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netlongwaveradiation</span>
<span class="sd">        netlongwaveradiation(45.832275)</span>

<span class="sd">        When necessary, |Calc_NetLongwaveRadiation_V1| trims the fraction of global</span>
<span class="sd">        radiation and clear sky solar radiation to one to prevent calculating</span>
<span class="sd">        unrealistically high net longwave radiations:</span>

<span class="sd">        &gt;&gt;&gt; logs.loggedclearskysolarradiation = 1.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_netlongwaveradiation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netlongwaveradiation</span>
<span class="sd">        netlongwaveradiation(59.13842)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ClearSkySolarRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">GlobalRadiation</span><span class="p">,</span>
        <span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedGlobalRadiation</span><span class="p">,</span>
        <span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedClearSkySolarRadiation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetLongwaveRadiation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">flu</span><span class="o">.</span><span class="n">clearskysolarradiation</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">globalradiation</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">globalradiation</span>
            <span class="n">clearskysolarradiation</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">clearskysolarradiation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">globalradiation</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">clearskysolarradiation</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span><span class="p">):</span>
                <span class="n">clearskysolarradiation</span> <span class="o">+=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedclearskysolarradiation</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="n">globalradiation</span> <span class="o">+=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedglobalradiation</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">netlongwaveradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="mf">5.674768518518519e-08</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mf">273.16</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span>
                <span class="o">*</span> <span class="p">(</span><span class="mf">0.34</span> <span class="o">-</span> <span class="mf">0.14</span> <span class="o">*</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">actualvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">(</span><span class="mf">1.35</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">globalradiation</span> <span class="o">/</span> <span class="n">clearskysolarradiation</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.35</span><span class="p">)</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_NetLongwaveRadiation_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_NetLongwaveRadiation_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_NetLongwaveRadiation_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the net longwave radiation according to :cite:t:`ref-Lpmeier2014`,</span>
<span class="sd">    based on :cite:t:`ref-Holtslag1981`, :cite:t:`ref-Idso1969`, and</span>
<span class="sd">    :cite:t:`ref-Sellers1960`.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      .. math::</span>
<span class="sd">        NetLongwaveRadiation = RL_s - RL_a</span>
<span class="sd">        \\ \\</span>
<span class="sd">        RL_{s} = 0.97 \cdot \sigma \cdot (T + 273.1)^4 + 0.07 \cdot (1 - \alpha) \cdot G</span>
<span class="sd">        \\ \\</span>
<span class="sd">        RL_{a} = \left( 1 + C \cdot N^2 \right) \cdot \left(</span>
<span class="sd">        1 - 0.261 \cdot e^{-0.000777 \cdot T^2} \right) \cdot \sigma \cdot (T + 273.1)^4</span>
<span class="sd">        \\ \\</span>
<span class="sd">        \sigma = StefanBoltzmannConstant \\</span>
<span class="sd">        T = AirTemperature \\</span>
<span class="sd">        \alpha = CurrentAlbedo \\</span>
<span class="sd">        G = GlobalRadiation \\</span>
<span class="sd">        C = CloudTypeFactor \\</span>
<span class="sd">        N = AdjustedCloudCoverage</span>

<span class="sd">    Example:</span>

<span class="sd">        The following example is roughly comparable to the first example of</span>
<span class="sd">        |Calc_NetLongwaveRadiation_V1| taken from :cite:t:`ref-Allen1998` but results</span>
<span class="sd">        in a more than thrice as large net longwave radiation estimate:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; cloudtypefactor(0.2)</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.globalradiation = 167.824074</span>
<span class="sd">        &gt;&gt;&gt; factors.adjustedcloudcoverage = 167.824074 / 217.592593</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 22.1</span>
<span class="sd">        &gt;&gt;&gt; factors.currentalbedo = 0.23</span>
<span class="sd">        &gt;&gt;&gt; model.calc_netlongwaveradiation_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netlongwaveradiation</span>
<span class="sd">        netlongwaveradiation(30.940701)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">CloudTypeFactor</span><span class="p">)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fixed</span><span class="o">.</span><span class="n">StefanBoltzmannConstant</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">CurrentAlbedo</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AdjustedCloudCoverage</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">GlobalRadiation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetLongwaveRadiation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fix</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">fixed</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fix</span><span class="o">.</span><span class="n">stefanboltzmannconstant</span>
        <span class="n">g</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">globalradiation</span>
        <span class="n">f</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">con</span><span class="o">.</span><span class="n">cloudtypefactor</span> <span class="o">*</span> <span class="n">fac</span><span class="o">.</span><span class="n">adjustedcloudcoverage</span><span class="o">**</span><span class="mf">2.0</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">t</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">a</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">currentalbedo</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">rs</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.97</span> <span class="o">*</span> <span class="n">s</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mf">273.1</span><span class="p">)</span> <span class="o">**</span> <span class="mf">4.0</span> <span class="o">+</span> <span class="mf">0.07</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span>
            <span class="n">ra</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="p">(</span>
                <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.261</span> <span class="o">*</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.000777</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mf">2.0</span><span class="p">))</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mf">273.1</span><span class="p">)</span> <span class="o">**</span> <span class="mf">4.0</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">netlongwaveradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs</span> <span class="o">-</span> <span class="n">ra</span></div>



<div class="viewcode-block" id="Calc_DailyNetLongwaveRadiation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailyNetLongwaveRadiation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailyNetLongwaveRadiation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the average net longwave radiation of the last 24 hours according to</span>
<span class="sd">    :cite:t:`ref-LARSIM`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">       DailyNetLongwaveRadiation = \sigma\cdot T^4 \cdot</span>
<span class="sd">       \left( \epsilon - c \cdot \left(\frac{P} {T}\right)^{1/7} \right) \cdot</span>
<span class="sd">       \left (0.2 + 0.8 \cdot\frac{S}{S_p} \right)\\</span>
<span class="sd">       \\</span>
<span class="sd">       \sigma = StefanBoltzmannConstant \\</span>
<span class="sd">       T = DailyAirTemperature + 273.15 \\</span>
<span class="sd">       \epsilon = Emissivity \\</span>
<span class="sd">       c = FactorCounterRadiation \\</span>
<span class="sd">       P = DailyActualVapourPressure \\</span>
<span class="sd">       S = DailySunshineDuration\\</span>
<span class="sd">       S_p = DailyPossibleSunshineDuration</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; emissivity(0.95)</span>
<span class="sd">        &gt;&gt;&gt; factors.dailyairtemperature = 22.1, 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.dailyactualvapourpressure = 16.0, 6.0</span>
<span class="sd">        &gt;&gt;&gt; factors.dailysunshineduration = 12.0</span>
<span class="sd">        &gt;&gt;&gt; factors.dailypossiblesunshineduration = 14.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailynetlongwaveradiation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailynetlongwaveradiation</span>
<span class="sd">        dailynetlongwaveradiation(40.451915, 58.190798)</span>

<span class="sd">        When necessary, |Calc_DailyNetLongwaveRadiation_V1| trims the fraction of</span>
<span class="sd">        actual and possible sunshine duration to one to prevent calculating</span>
<span class="sd">        unrealistically high net longwave radiations:</span>

<span class="sd">        &gt;&gt;&gt; factors.dailysunshineduration = 24.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailynetlongwaveradiation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailynetlongwaveradiation</span>
<span class="sd">        dailynetlongwaveradiation(45.671517, 65.699288)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">Emissivity</span><span class="p">)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">StefanBoltzmannConstant</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">FactorCounterRadiation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyAirTemperature</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailySunshineDuration</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyPossibleSunshineDuration</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyNetLongwaveRadiation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fix</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">fixed</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">rel_sunshine</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">dailysunshineduration</span> <span class="o">/</span> <span class="n">fac</span><span class="o">.</span><span class="n">dailypossiblesunshineduration</span><span class="p">,</span> <span class="mf">1.0</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">t</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">dailyairtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mf">273.15</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">dailynetlongwaveradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="mf">0.2</span> <span class="o">+</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">rel_sunshine</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">fix</span><span class="o">.</span><span class="n">stefanboltzmannconstant</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">(</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">emissivity</span>
                    <span class="o">-</span> <span class="n">fix</span><span class="o">.</span><span class="n">factorcounterradiation</span>
                    <span class="o">*</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">dailyactualvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">t</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">7.0</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_NetRadiation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_NetRadiation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_NetRadiation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the total net radiation according to :cite:t:`ref-Allen1998` and</span>
<span class="sd">    according to :cite:t:`ref-Lpmeier2014`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`NetRadiation = NetShortwaveRadiation - NetLongwaveRadiation`</span>

<span class="sd">    Example:</span>

<span class="sd">        The following calculation agrees with example 12 of :cite:t:`ref-Allen1998`:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netshortwaveradiation  = 111.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netlongwaveradiation  = 35.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_netradiation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation</span>
<span class="sd">        netradiation(76.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetShortwaveRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetLongwaveRadiation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">netradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">netshortwaveradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">netlongwaveradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_NetRadiation_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_NetRadiation_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_NetRadiation_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the total net radiation according to :cite:t:`ref-LARSIM`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`NetRadiation = NetShortwaveRadiation - DailyNetLongwaveRadiation`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netshortwaveradiation = 300.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailynetlongwaveradiation = 200.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_netradiation_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation</span>
<span class="sd">        netradiation(100.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetShortwaveRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyNetLongwaveRadiation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">netradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">netshortwaveradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">dailynetlongwaveradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_DailyNetRadiation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailyNetRadiation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailyNetRadiation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the average of the net radiation of the last 24 hours.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`DailyNetRadiation = DailyNetShortwaveRadiation - DailyNetLongwaveRadiation`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailynetshortwaveradiation = 300.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailynetlongwaveradiation = 200.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailynetradiation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailynetradiation</span>
<span class="sd">        dailynetradiation(100.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyNetLongwaveRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyNetShortwaveRadiation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyNetRadiation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">dailynetradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">dailynetshortwaveradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">dailynetlongwaveradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_SoilHeatFlux_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SoilHeatFlux_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SoilHeatFlux_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the soil heat flux according to :cite:t:`ref-Allen1998`.</span>

<span class="sd">    Basic equation for daily timesteps (:cite:t:`ref-Allen1998`, equation 42):</span>
<span class="sd">      :math:`SoilHeatFlux = 0`</span>

<span class="sd">    Basic equation for (sub)hourly timesteps (:cite:t:`ref-Allen1998`, eq. 45 and 46 ):</span>
<span class="sd">      :math:`SoilHeatFlux = \Bigl \lbrace</span>
<span class="sd">      {</span>
<span class="sd">      {0.1 \cdot SoilHeatFlux \ | \ NetRadiation \geq 0}</span>
<span class="sd">      \atop</span>
<span class="sd">      {0.5 \cdot SoilHeatFlux \ | \ NetRadiation &lt; 0}</span>
<span class="sd">      }`</span>

<span class="sd">    Examples:</span>

<span class="sd">        For simulation time steps shorter than one day, we define all steps with</span>
<span class="sd">        positive |NetRadiation| as part of the daylight period and all with negative</span>
<span class="sd">        |NetRadiation| as part of the nighttime period.  The total |SoilHeatFlux| is</span>
<span class="sd">        zero if the summed |NetRadiation| during daytime is five times as high as the</span>
<span class="sd">        absolute summed |NetRadiation| during nighttime:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; derived.days(1/24)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 100.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilheatflux_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux</span>
<span class="sd">        soilheatflux(10.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = -20.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilheatflux_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux</span>
<span class="sd">        soilheatflux(-10.0)</span>

<span class="sd">        For any simulation step size of at least one day, method |Calc_SoilHeatFlux_V1|</span>
<span class="sd">        sets the |SoilHeatFlux| to zero, which :cite:t:`ref-Allen1998` suggests for</span>
<span class="sd">        daily simulation steps only:</span>

<span class="sd">        &gt;&gt;&gt; derived.days(1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 100.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilheatflux_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux</span>
<span class="sd">        soilheatflux(0.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = -20.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilheatflux_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux</span>
<span class="sd">        soilheatflux(0.0)</span>

<span class="sd">        Hence, be aware that function |Calc_SoilHeatFlux_V1| does not give the best</span>
<span class="sd">        results for intermediate (e.g. 12 hours) or larger step sizes (e.g. one month).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">Days</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">days</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">flu</span><span class="o">.</span><span class="n">netradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">flu</span><span class="o">.</span><span class="n">soilheatflux</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">netradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">flu</span><span class="o">.</span><span class="n">soilheatflux</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">netradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilheatflux</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Calc_SoilHeatFlux_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SoilHeatFlux_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SoilHeatFlux_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the MORECS-like soil heat flux roughly based on :cite:t:`ref-LARSIM`</span>
<span class="sd">    and :cite:t:`ref-Thompson1981`.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      :math:`SoilHeatFlux = \frac{PossibleSunshineDuration}</span>
<span class="sd">      {DailyPossibleSunshineDuration} \cdot G_D</span>
<span class="sd">      + \frac{(Hours - PossibleSunshineDuration)}</span>
<span class="sd">      {24-DailyPossibleSunshineDuration} \cdot G_N`</span>

<span class="sd">      :math:`G_N = AverageSoilHeatFlux - SoilHeatFlux_D`</span>

<span class="sd">      :math:`G_D = (0.3 - 0.03 \cdot LAI) \cdot DailyNetRadiation`</span>

<span class="sd">    The above equations are our interpretation of the relevant equations and</span>
<span class="sd">    explanations in the LARSIM user manual.  :math:`G_D` is the daytime sum of the soil</span>
<span class="sd">    heat flux, which depends on the daily sum of net radiation and the leaf area index.</span>
<span class="sd">    Curiously, |DailyNetRadiation| and :math:`G_D` become inversely related for leaf</span>
<span class="sd">    area index values higher than 10.  |AverageSoilHeatFlux| defines the daily energy</span>
<span class="sd">    change of the soil layer, which is why we use its difference to :math:`G_D` for</span>
<span class="sd">    estimating the nighttime sum of the soil heat flux (:math:`G_N`).</span>

<span class="sd">    .. note::</span>

<span class="sd">       The sudden jumps of the soil heat flux calculated by method</span>
<span class="sd">       |Calc_SoilHeatFlux_V2| sometimes result in strange-looking evapotranspiration</span>
<span class="sd">       time series.  Hence, we do not use |Calc_SoilHeatFlux_V2| in any application</span>
<span class="sd">       model for now but leave it for further discussion and use the simplified method</span>
<span class="sd">       |Calc_SoilHeatFlux_V3| instead.</span>

<span class="sd">    .. warning::</span>

<span class="sd">       We implemented this method when |lland| handled energy fluxes in MJ/m/T.</span>
<span class="sd">       Before using it in an application model, one probably needs to adjust it to the</span>
<span class="sd">       new energy flux unit W/m.</span>

<span class="sd">    Examples:</span>

<span class="sd">        Base model |evap| does not define any land cover types by itself but takes the</span>
<span class="sd">        ones of the respective main model.  Here, we manually introduce the land cover</span>
<span class="sd">        types `wood`, `trees`, `soil`, `acre`, and `water` to apply |evap| as a</span>
<span class="sd">        stand-alone model:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2019-05-30&quot;, &quot;2019-06-03&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.core.parametertools import Constants</span>
<span class="sd">        &gt;&gt;&gt; WOOD, TREES, BUSH, SOIL, WATER = 1, 2, 3, 4, 5</span>
<span class="sd">        &gt;&gt;&gt; constants = Constants(</span>
<span class="sd">        ...     WOOD=WOOD, TREES=TREES, BUSH=BUSH, SOIL=SOIL, WATER=WATER)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap.evap_control import HRUType, LeafAreaIndex</span>
<span class="sd">        &gt;&gt;&gt; with HRUType.modify_constants(constants), \</span>
<span class="sd">        ...         LeafAreaIndex.modify_rows(constants):</span>
<span class="sd">        ...     from hydpy.models.evap import *</span>
<span class="sd">        ...     parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(4)</span>

<span class="sd">        We perform the first test calculation for a daily simulation step size to start</span>
<span class="sd">        as simple as possible:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-05-30&quot;, &quot;2000-06-03&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>

<span class="sd">        We define six hydrological response units, of which only the first five need</span>
<span class="sd">        further parameterisation, as method |Calc_SoilHeatFlux_V2| generally sets</span>
<span class="sd">        |SoilHeatFlux| to zero for water areas:</span>

<span class="sd">        &gt;&gt;&gt; nmbhru(6)</span>
<span class="sd">        &gt;&gt;&gt; hrutype(SOIL, BUSH, BUSH, TREES, WOOD, WATER)</span>
<span class="sd">        &gt;&gt;&gt; water(False, False, False, False, False, True)</span>

<span class="sd">        We assign leaf area indices covering the usual range of values:</span>

<span class="sd">        &gt;&gt;&gt; leafareaindex.soil = 0.0</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.bush = 5.0</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.trees = 10.0</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.wood = 15.0</span>

<span class="sd">        We define a negative |AverageSoilHeatFlux| value for May (on average, energy</span>
<span class="sd">        moves from the soil body to the soil surface) and a positive one for June</span>
<span class="sd">        (energy moves from the surface to the body):</span>

<span class="sd">        &gt;&gt;&gt; averagesoilheatflux.may = -10.0</span>
<span class="sd">        &gt;&gt;&gt; averagesoilheatflux.jun = 20.0</span>

<span class="sd">        The following derived parameters need to be updated:</span>

<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.hours.update()</span>

<span class="sd">        For a daily simulation step size, the values of |PossibleSunshineDuration| (of</span>
<span class="sd">        the current simulation step) and |DailyPossibleSunshineDuration| must be</span>
<span class="sd">        identical:</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 14.0</span>
<span class="sd">        &gt;&gt;&gt; factors.dailypossiblesunshineduration = 14.0</span>

<span class="sd">        We set |DailyNetRadiation| to 100 W/m for most response units, except for the</span>
<span class="sd">        second bush unit:</span>

<span class="sd">        &gt;&gt;&gt; fluxes.dailynetradiation = 100.0, 100.0, -100.0, 100.0, 100.0, 100.0</span>

<span class="sd">        For the given daily simulation step size, method |Calc_SoilHeatFlux_V2|</span>
<span class="sd">        calculates soil surface fluxes identical to the |AverageSoilHeatFlux| value</span>
<span class="sd">        of the respective month:</span>

<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&quot;2000-05-31&quot;]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilheatflux_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux</span>
<span class="sd">        soilheatflux(-10.0, -10.0, -10.0, -10.0, -10.0, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&quot;2000-06-01&quot;]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilheatflux_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux</span>
<span class="sd">        soilheatflux(20.0, 20.0, 20.0, 20.0, 20.0, 0.0)</span>

<span class="sd">        Next, we switch to an hourly step size and focus on May:</span>

<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-05-30 00:00&quot;, &quot;2000-06-02 00:00&quot;, &quot;1h&quot;</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&quot;2000-05-31&quot;]</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.hours.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.days.update()</span>

<span class="sd">        During daytime (when the possible sunshine duration is one hour), the soil</span>
<span class="sd">        surface flux is positive for positive net radiation values and for leaf area</span>
<span class="sd">        index values below ten (see response units one and two).  Negative net</span>
<span class="sd">        radiation (response unit three) and leaf area indices above ten (response unit</span>
<span class="sd">        five) result in negative soil surface fluxes:</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 1.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilheatflux_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux</span>
<span class="sd">        soilheatflux(-2.142857, -1.071429, 1.071429, 0.0, 1.071429, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; day = fluxes.soilheatflux.values.copy()</span>

<span class="sd">        The nighttime soil surface fluxes (which we calculate by setting</span>
<span class="sd">        |PossibleSunshineDuration| to zero) somehow compensate for the daytime ones:</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 0.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilheatflux_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux</span>
<span class="sd">        soilheatflux(2.0, 0.5, -2.5, -1.0, -2.5, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; night = fluxes.soilheatflux.values.copy()</span>

<span class="sd">        This compensation enforces that the daily sum of the surface flux agrees</span>
<span class="sd">        with the actual value of |AverageSoilHeatFlux|, which we confirm by the</span>
<span class="sd">        following test calculation:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import print_vector</span>
<span class="sd">        &gt;&gt;&gt; print_vector(day * factors.dailypossiblesunshineduration +</span>
<span class="sd">        ...              night * (24.0 - factors.dailypossiblesunshineduration))</span>
<span class="sd">        -10.0, -10.0, -10.0, -10.0, -10.0, 0.0</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Water</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LeafAreaIndex</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">AverageSoilHeatFlux</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,</span> <span class="n">evap_derived</span><span class="o">.</span><span class="n">Hours</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">PossibleSunshineDuration</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyPossibleSunshineDuration</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyNetRadiation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">water</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilheatflux</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lai</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">leafareaindex</span><span class="p">[</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">hrutype</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_leafareaindex_rowmin</span><span class="p">,</span>
                    <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_leafareaindex_columnmin</span><span class="p">,</span>
                <span class="p">]</span>
                <span class="n">cr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">-</span> <span class="mf">0.03</span> <span class="o">*</span> <span class="n">lai</span>
                <span class="n">gd</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="n">cr</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">dailynetradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">gn</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">averagesoilheatflux</span><span class="p">[</span><span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]]</span> <span class="o">-</span> <span class="n">gd</span>
                <span class="n">gd_h</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">gd</span> <span class="o">/</span> <span class="n">fac</span><span class="o">.</span><span class="n">dailypossiblesunshineduration</span>
                <span class="n">gn_h</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">gn</span> <span class="o">/</span> <span class="p">(</span><span class="mf">24.0</span> <span class="o">-</span> <span class="n">fac</span><span class="o">.</span><span class="n">dailypossiblesunshineduration</span><span class="p">)</span>
                <span class="n">ps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">possiblesunshineduration</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilheatflux</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">ps</span> <span class="o">*</span> <span class="n">gd_h</span> <span class="o">+</span> <span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">hours</span> <span class="o">-</span> <span class="n">ps</span><span class="p">)</span> <span class="o">*</span> <span class="n">gn_h</span></div>



<div class="viewcode-block" id="Calc_SoilHeatFlux_V3">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SoilHeatFlux_V3">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SoilHeatFlux_V3</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Take the monthly average soil heat flux as the current soil heat flux.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      :math:`SoilHeatFlux = AverageSoilHeatFlux`</span>

<span class="sd">    .. note::</span>

<span class="sd">       Method |Calc_SoilHeatFlux_V3| is a workaround.  We might remove it as soon as</span>
<span class="sd">       the shortcomings of method |Calc_SoilHeatFlux_V2| are fixed.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-05-30 00:00&quot;, &quot;2000-06-02 00:00&quot;, &quot;1h&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; water(False, True)</span>
<span class="sd">        &gt;&gt;&gt; averagesoilheatflux.may = 12.0</span>
<span class="sd">        &gt;&gt;&gt; averagesoilheatflux.jun = -24.0</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.days.update()</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&quot;2000-05-31 23:00&quot;]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilheatflux_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux</span>
<span class="sd">        soilheatflux(12.0, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&quot;2000-06-01 00:00&quot;]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilheatflux_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux</span>
<span class="sd">        soilheatflux(-24.0, 0.0)</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Water</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">AverageSoilHeatFlux</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">water</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilheatflux</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilheatflux</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">averagesoilheatflux</span><span class="p">[</span><span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]]</span></div>



<div class="viewcode-block" id="Calc_SoilHeatFlux_V4">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SoilHeatFlux_V4">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SoilHeatFlux_V4</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the AMBAV-like soil heat flux based on :cite:t:`ref-Lpmeier2014`.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      .. math::</span>
<span class="sd">        G = max(a - b \cdot LAI, \ 0) \cdot R_n \\</span>
<span class="sd">        a = \omega \cdot 0.2 + (1 - \omega) \cdot 0.5 \\</span>
<span class="sd">        b = a \cdot 0.03 / 0.2</span>
<span class="sd">        \\ \\</span>
<span class="sd">        G = SoilHeatFlux \\</span>
<span class="sd">        LAI = LeafAreaIndex \\</span>
<span class="sd">        R_n = NetRadiation \\</span>
<span class="sd">        \omega = PossibleSunshineDuration / Hours</span>

<span class="sd">    Examples:</span>

<span class="sd">        Base model |evap| does not define any land cover types by itself but takes the</span>
<span class="sd">        ones of the respective main model.  Here, we manually introduce the land cover</span>
<span class="sd">        types `wood`, `trees`, `bush`, and `acre` to apply |evap| as a stand-alone</span>
<span class="sd">        model consisting of four hydrological response units:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-05-30&quot;, &quot;2000-06-03&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.core.parametertools import Constants</span>
<span class="sd">        &gt;&gt;&gt; WOOD, TREES, BUSH, ACRE, WATER = 1, 2, 3, 4, 5</span>
<span class="sd">        &gt;&gt;&gt; constants = Constants(WOOD=WOOD, TREES=TREES, BUSH=BUSH, ACRE=ACRE)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap.evap_control import HRUType, LeafAreaIndex</span>
<span class="sd">        &gt;&gt;&gt; with HRUType.modify_constants(constants), \</span>
<span class="sd">        ...         LeafAreaIndex.modify_rows(constants):</span>
<span class="sd">        ...     from hydpy.models.evap import *</span>
<span class="sd">        ...     parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(4)</span>

<span class="sd">        For water areas, the soil heat flux is generally zero:</span>

<span class="sd">        &gt;&gt;&gt; water(True)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilheatflux_v4()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux</span>
<span class="sd">        soilheatflux(0.0, 0.0, 0.0, 0.0)</span>

<span class="sd">        We focus on non-water areas using all the different defined land cover types in</span>
<span class="sd">        the following examples:</span>

<span class="sd">        &gt;&gt;&gt; hrutype(ACRE, BUSH, TREES, WOOD)</span>
<span class="sd">        &gt;&gt;&gt; water(False)</span>

<span class="sd">        The next calculation addressed the complete 31st of May, for which we set land</span>
<span class="sd">        cover-specific leaf area indices:</span>

<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&quot;2000-05-31&quot;]</span>
<span class="sd">        &gt;&gt;&gt; derived.hours.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.acre_may = 0.0</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.bush_may = 2.0</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.trees_may = 5.0</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.wood_may = 10.0</span>

<span class="sd">        We say the astronomically possible sunshine duration and the net radiation of</span>
<span class="sd">        that day to be 18 h and 200 W/m:</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 18.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 200.0</span>

<span class="sd">        The larger the leaf area index, the smaller the soil heat flux.  The dense</span>
<span class="sd">        canopies of trees can suppress them entirely:</span>

<span class="sd">        &gt;&gt;&gt; model.calc_soilheatflux_v4()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux</span>
<span class="sd">        soilheatflux(55.0, 38.5, 13.75, 0.0)</span>

<span class="sd">        Now, we switch to an hourly step size and to the time of sunrise on the 1st of</span>
<span class="sd">        June:</span>

<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-06-01 04:00&quot;, &quot;2000-06-01 08:00&quot;, &quot;1h&quot;</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&quot;2000-06-01 05:00&quot;]</span>
<span class="sd">        &gt;&gt;&gt; derived.hours.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>

<span class="sd">        We set slightly larger leaf area indices:</span>

<span class="sd">        &gt;&gt;&gt; leafareaindex.acre_jun = 0.0</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.bush_jun = 3.0</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.trees_jun = 6.0</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.wood_jun = 12.0</span>

<span class="sd">        We assume sunrise at 5:15 and a negative net radiation value:</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 0.25</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = -20.0</span>

<span class="sd">        Again, dense vegetation reduces the soil heat flux without changing its sign,</span>
<span class="sd">        and very dense vegetation suppresses it completely:</span>

<span class="sd">        &gt;&gt;&gt; model.calc_soilheatflux_v4()</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilheatflux_v4()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux</span>
<span class="sd">        soilheatflux(-8.5, -4.675, -0.85, 0.0)</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Water</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LeafAreaIndex</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">Hours</span><span class="p">,</span> <span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">PossibleSunshineDuration</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">w</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">possiblesunshineduration</span> <span class="o">/</span> <span class="n">der</span><span class="o">.</span><span class="n">hours</span>
        <span class="n">a</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="mf">0.2</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
        <span class="n">b</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="mf">0.03</span> <span class="o">/</span> <span class="mf">0.2</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">water</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilheatflux</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lai</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">leafareaindex</span><span class="p">[</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">hrutype</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_leafareaindex_rowmin</span><span class="p">,</span>
                    <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_leafareaindex_columnmin</span><span class="p">,</span>
                <span class="p">]</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilheatflux</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="n">lai</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">netradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Calc_PsychrometricConstant_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PsychrometricConstant_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PsychrometricConstant_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the psychrometric constant according to :cite:t:`ref-Allen1998`.</span>

<span class="sd">    Basic equation (:cite:t:`ref-Allen1998`, equation 8):</span>
<span class="sd">      :math:`PsychrometricConstant = 6.65 \cdot 10^{-4} \cdot AtmosphericPressure`</span>

<span class="sd">    Example:</span>

<span class="sd">        The following calculation agrees with example 2 of :cite:t:`ref-Allen1998`:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; inputs.atmosphericpressure = 818.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_psychrometricconstant_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.psychrometricconstant</span>
<span class="sd">        psychrometricconstant(0.54397)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_inputs</span><span class="o">.</span><span class="n">AtmosphericPressure</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span><span class="o">.</span><span class="n">psychrometricconstant</span> <span class="o">=</span> <span class="mf">6.65e-4</span> <span class="o">*</span> <span class="n">inp</span><span class="o">.</span><span class="n">atmosphericpressure</span></div>



<div class="viewcode-block" id="Calc_AerodynamicResistance_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_AerodynamicResistance_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_AerodynamicResistance_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the aerodynamic resistance according to :cite:t:`ref-LARSIM` and</span>
<span class="sd">    based on :cite:t:`ref-Thompson1981`.</span>

<span class="sd">    Basic equations (:math:`z_0` after :cite:t:`ref-Quast1997`):</span>
<span class="sd">      .. math::</span>
<span class="sd">        AerodynamicResistance = \begin{cases}</span>
<span class="sd">        \frac{6.25}{WindSpeed10m} \cdot ln\left(\frac{10}{z_0}\right)^2</span>
<span class="sd">        &amp;|\</span>
<span class="sd">        CropHeight &lt; 10</span>
<span class="sd">        \\</span>
<span class="sd">        \frac{94}{WindSpeed10m}</span>
<span class="sd">        &amp;|\</span>
<span class="sd">        CropHeight \geq 10</span>
<span class="sd">        \end{cases}</span>

<span class="sd">      :math:`z_0 = 0.021 + 0.163 \cdot CropHeight`</span>

<span class="sd">    Examples:</span>

<span class="sd">        Base model |evap| does not define any land cover types by itself but takes the</span>
<span class="sd">        ones of the respective main model.  Here, we manually introduce the land cover</span>
<span class="sd">        types of wood, trees, bush, acre, and water to apply |evap| as a stand-alone</span>
<span class="sd">        model:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-01-30&quot;, &quot;2000-02-03&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.core.parametertools import Constants</span>
<span class="sd">        &gt;&gt;&gt; WOOD, TREES, BUSH, ACRE, WATER = 1, 2, 3, 4, 5</span>
<span class="sd">        &gt;&gt;&gt; constants = Constants(</span>
<span class="sd">        ...     WOOD=WOOD, TREES=TREES, BUSH=BUSH, ACRE=ACRE, WATER=WATER)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap.evap_control import HRUType, CropHeight</span>
<span class="sd">        &gt;&gt;&gt; with HRUType.modify_constants(constants), CropHeight.modify_rows(constants):</span>
<span class="sd">        ...     from hydpy.models.evap import *</span>
<span class="sd">        ...     parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(5)</span>
<span class="sd">        &gt;&gt;&gt; hrutype(WATER, ACRE, BUSH, TREES, WOOD)</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>

<span class="sd">        Besides wind speed, aerodynamic resistance depends on the crop height, which</span>
<span class="sd">        typically differs between land types and, for vegetated surfaces, months.  In</span>
<span class="sd">        the first example, we set different crop heights for different land types to</span>
<span class="sd">        cover the relevant range of values:</span>

<span class="sd">        &gt;&gt;&gt; cropheight.water_jan = 0.0</span>
<span class="sd">        &gt;&gt;&gt; cropheight.acre_jan = 1.0</span>
<span class="sd">        &gt;&gt;&gt; cropheight.bush_jan = 5.0</span>
<span class="sd">        &gt;&gt;&gt; cropheight.trees_jan = 10.0</span>
<span class="sd">        &gt;&gt;&gt; cropheight.wood_jan = 30.0</span>
<span class="sd">        &gt;&gt;&gt; factors.windspeed10m = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = 1</span>
<span class="sd">        &gt;&gt;&gt; model.calc_aerodynamicresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance</span>
<span class="sd">        aerodynamicresistance(79.202731, 33.256788, 12.831028, 31.333333,</span>
<span class="sd">                              31.333333)</span>

<span class="sd">        The last example shows a decrease in resistance with increasing crop height for</span>
<span class="sd">        the first three hydrological response units only.  However, when  reaching a</span>
<span class="sd">        crop height of 10 m, the calculated resistance increases discontinuously (see</span>
<span class="sd">        the fourth response unit) and remains constant above (see the fifth response</span>
<span class="sd">        unit).  In the following example, we set unrealistic values to inspect this</span>
<span class="sd">        behaviour more closely:</span>

<span class="sd">        &gt;&gt;&gt; cropheight.water_feb = 8.0</span>
<span class="sd">        &gt;&gt;&gt; cropheight.acre_feb = 9.0</span>
<span class="sd">        &gt;&gt;&gt; cropheight.bush_feb = 10.0</span>
<span class="sd">        &gt;&gt;&gt; cropheight.trees_feb = 11.0</span>
<span class="sd">        &gt;&gt;&gt; cropheight.wood_feb = 12.0</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = 2</span>
<span class="sd">        &gt;&gt;&gt; model.calc_aerodynamicresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance</span>
<span class="sd">        aerodynamicresistance(8.510706, 7.561677, 31.333333, 31.333333,</span>
<span class="sd">                              31.333333)</span>

<span class="sd">        One could use a threshold crop height of 1.14 m instead of 10 m to remove this</span>
<span class="sd">        discontinuity:</span>

<span class="sd">        :math:`1.1404411695422059 = \frac{\frac{10}{\exp\sqrt{94/6.25}}-0.021}{0.163}`</span>

<span class="sd">        The last example shows the inverse relationship between resistance and wind</span>
<span class="sd">        speed.  For zero wind speed, resistance becomes infinite:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import print_vector</span>
<span class="sd">        &gt;&gt;&gt; cropheight(2.0)</span>
<span class="sd">        &gt;&gt;&gt; for ws in (0.0, 0.1, 1.0, 10.0):</span>
<span class="sd">        ...     factors.windspeed10m = ws</span>
<span class="sd">        ...     model.calc_aerodynamicresistance_v1()</span>
<span class="sd">        ...     print_vector([ws, factors.aerodynamicresistance[0]])</span>
<span class="sd">        0.0, inf</span>
<span class="sd">        0.1, 706.026613</span>
<span class="sd">        1.0, 70.602661</span>
<span class="sd">        10.0, 7.060266</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">CropHeight</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">WindSpeed10m</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">AerodynamicResistance</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">fac</span><span class="o">.</span><span class="n">windspeed10m</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">ch</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cropheight</span><span class="p">[</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">hrutype</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_cropheight_rowmin</span><span class="p">,</span>
                    <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_cropheight_columnmin</span><span class="p">,</span>
                <span class="p">]</span>
                <span class="k">if</span> <span class="n">ch</span> <span class="o">&lt;</span> <span class="mf">10.0</span><span class="p">:</span>
                    <span class="n">z0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.021</span> <span class="o">+</span> <span class="mf">0.163</span> <span class="o">*</span> <span class="n">ch</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">aerodynamicresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="mf">6.25</span> <span class="o">/</span> <span class="n">fac</span><span class="o">.</span><span class="n">windspeed10m</span> <span class="o">*</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">10.0</span> <span class="o">/</span> <span class="n">z0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">aerodynamicresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">94.0</span> <span class="o">/</span> <span class="n">fac</span><span class="o">.</span><span class="n">windspeed10m</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">aerodynamicresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">inf</span></div>



<div class="viewcode-block" id="Calc_AerodynamicResistance_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_AerodynamicResistance_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_AerodynamicResistance_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the aerodynamic resistance according to :cite:t:`ref-Lpmeier2014`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        AerodynamicResistance = AerodynamicResistanceFactor / WindSpeed10m</span>

<span class="sd">    Examples:</span>

<span class="sd">        We reuse the same example setting of method |Calc_AerodynamicResistance_V1| to</span>
<span class="sd">        allow for comparisons:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-01-30&quot;, &quot;2000-02-03&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.core.parametertools import Constants</span>
<span class="sd">        &gt;&gt;&gt; WOOD, TREES, BUSH, ACRE, WATER = 1, 2, 3, 4, 5</span>
<span class="sd">        &gt;&gt;&gt; constants = Constants(</span>
<span class="sd">        ...     WOOD=WOOD, TREES=TREES, BUSH=BUSH, ACRE=ACRE, WATER=WATER)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap.evap_control import HRUType, CropHeight</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap.evap_derived import AerodynamicResistanceFactor, RoughnessLength  # pylint: disable=line-too-long</span>
<span class="sd">        &gt;&gt;&gt; with HRUType.modify_constants(constants), CropHeight.modify_rows(constants), AerodynamicResistanceFactor.modify_rows(constants), RoughnessLength.modify_rows(constants) :  # pylint: disable=line-too-long</span>
<span class="sd">        ...     from hydpy.models.evap import *</span>
<span class="sd">        ...     parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(5)</span>
<span class="sd">        &gt;&gt;&gt; hrutype(WATER, ACRE, BUSH, TREES, WOOD)</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>

<span class="sd">        |Calc_AerodynamicResistance_V2| calculates larger resistances for crops smaller</span>
<span class="sd">        than 10 meters and equal resistances for crops larger than 10 meters:</span>

<span class="sd">        &gt;&gt;&gt; cropheight.water_jan = 0.0</span>
<span class="sd">        &gt;&gt;&gt; cropheight.acre_jan = 1.0</span>
<span class="sd">        &gt;&gt;&gt; cropheight.bush_jan = 5.0</span>
<span class="sd">        &gt;&gt;&gt; cropheight.trees_jan = 10.0</span>
<span class="sd">        &gt;&gt;&gt; cropheight.wood_jan = 30.0</span>
<span class="sd">        &gt;&gt;&gt; derived.roughnesslength.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.aerodynamicresistancefactor.update()</span>
<span class="sd">        &gt;&gt;&gt; factors.windspeed10m = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = 1</span>
<span class="sd">        &gt;&gt;&gt; model.calc_aerodynamicresistance_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance</span>
<span class="sd">        aerodynamicresistance(250.991726, 37.398301, 31.333333, 31.333333,</span>
<span class="sd">                              31.333333)</span>

<span class="sd">        For zero wind speed, resistance becomes infinite:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import print_vector</span>
<span class="sd">        &gt;&gt;&gt; factors.windspeed10m = 0.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_aerodynamicresistance_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance</span>
<span class="sd">        aerodynamicresistance(inf, inf, inf, inf, inf)</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,</span> <span class="n">evap_derived</span><span class="o">.</span><span class="n">AerodynamicResistanceFactor</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">WindSpeed10m</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">AerodynamicResistance</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">if</span> <span class="n">fac</span><span class="o">.</span><span class="n">windspeed10m</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">f</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">der</span><span class="o">.</span><span class="n">aerodynamicresistancefactor</span><span class="p">[</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">hrutype</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">der</span><span class="o">.</span><span class="n">_aerodynamicresistancefactor_rowmin</span><span class="p">,</span>
                    <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]</span> <span class="o">-</span> <span class="n">der</span><span class="o">.</span><span class="n">_aerodynamicresistancefactor_columnmin</span><span class="p">,</span>
                <span class="p">]</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">aerodynamicresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span> <span class="o">/</span> <span class="n">fac</span><span class="o">.</span><span class="n">windspeed10m</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">aerodynamicresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">inf</span></div>



<div class="viewcode-block" id="Calc_SoilSurfaceResistance_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SoilSurfaceResistance_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SoilSurfaceResistance_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the resistance of the bare soil surface according to</span>
<span class="sd">    :cite:t:`ref-LARSIM` and based on :cite:t:`ref-Thompson1981`.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      .. math::</span>
<span class="sd">        SoilSurfaceResistance = \begin{cases}</span>
<span class="sd">        100 &amp;|\ W_m&gt; 20</span>
<span class="sd">        \\</span>
<span class="sd">        \frac{100 \cdot W_m}{W_a + W_m/100} &amp;|\ W_m\leq 20</span>
<span class="sd">        \end{cases}</span>
<span class="sd">        \\ \\</span>
<span class="sd">        W_a = SoilWater \\</span>
<span class="sd">        W_m = MaxSoilWater</span>

<span class="sd">    Examples:</span>

<span class="sd">        For areas without relevant soils (for example, water areas and sealed</span>
<span class="sd">        surfaces), |Calc_SoilSurfaceResistance_V1| sets the soil surface resistance to</span>
<span class="sd">        |numpy.nan|.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(5)</span>
<span class="sd">        &gt;&gt;&gt; soil(False)</span>
<span class="sd">        &gt;&gt;&gt; maxsoilwater(0.0)</span>
<span class="sd">        &gt;&gt;&gt; soilmoisturelimit(0.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.soilwater = 0.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilsurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.soilsurfaceresistance</span>
<span class="sd">        soilsurfaceresistance(nan, nan, nan, nan, nan)</span>

<span class="sd">        For soils with a maximum water content larger than 20 mm, the soil</span>
<span class="sd">        surface resistance is generally 100.0 s/m:</span>

<span class="sd">        &gt;&gt;&gt; soil(True)</span>
<span class="sd">        &gt;&gt;&gt; maxsoilwater(20.1)</span>
<span class="sd">        &gt;&gt;&gt; factors.soilwater = 0.0, 5.0, 10.0, 15.0, 20.1</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilsurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.soilsurfaceresistance</span>
<span class="sd">        soilsurfaceresistance(100.0, 100.0, 100.0, 100.0, 100.0)</span>

<span class="sd">        For &quot;real&quot; soils, resistance decreases with increasing soil water contents</span>
<span class="sd">        until it reaches a minimum of 99 s/m:</span>

<span class="sd">        &gt;&gt;&gt; maxsoilwater(20.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.soilwater = 0.0, 5.0, 10.0, 15.0, 20.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilsurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.soilsurfaceresistance</span>
<span class="sd">        soilsurfaceresistance(10000.0, 384.615385, 196.078431, 131.578947,</span>
<span class="sd">                              99.009901)</span>

<span class="sd">        For zero maximum water contents, soil surface resistance is zero:</span>

<span class="sd">        &gt;&gt;&gt; maxsoilwater(0.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilsurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.soilsurfaceresistance</span>
<span class="sd">        soilsurfaceresistance(inf, inf, inf, inf, inf)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">MaxSoilWater</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SoilWater</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SoilSurfaceResistance</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">sw_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">maxsoilwater</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">con</span><span class="o">.</span><span class="n">soil</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">soilsurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">nan</span>
            <span class="k">elif</span> <span class="n">sw_max</span> <span class="o">&gt;</span> <span class="mf">20.0</span><span class="p">:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">soilsurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.0</span>
            <span class="k">elif</span> <span class="n">sw_max</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">sw_act</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">soilwater</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">sw_max</span><span class="p">)</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">soilsurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">sw_max</span> <span class="o">/</span> <span class="p">(</span><span class="n">sw_act</span> <span class="o">+</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">sw_max</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">soilsurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">inf</span></div>



<div class="viewcode-block" id="Update_LoggedPrecipitation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_LoggedPrecipitation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_LoggedPrecipitation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log the precipitation values of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        The following example shows that each new method call successively moves the</span>
<span class="sd">        six memorised values to the right and stores the respective two new values on</span>
<span class="sd">        the most left position:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedprecipitation.shape = 3, 2</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedprecipitation = 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(model,</span>
<span class="sd">        ...                 model.update_loggedprecipitation_v1,</span>
<span class="sd">        ...                 last_example=4,</span>
<span class="sd">        ...                 parseqs=(fluxes.precipitation,</span>
<span class="sd">        ...                          logs.loggedprecipitation))</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.precipitation = [1.0, 2.0], [3.0, 6.0], [2.0, 4.0], [4.0, 8.0]</span>
<span class="sd">        &gt;&gt;&gt; del test.inits.loggedprecipitation</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |      precipitation |                          loggedprecipitation |</span>
<span class="sd">        ---------------------------------------------------------------------------</span>
<span class="sd">        |   1 | 1.0            2.0 | 1.0  2.0  0.0  0.0  0.0                  0.0 |</span>
<span class="sd">        |   2 | 3.0            6.0 | 3.0  6.0  1.0  2.0  0.0                  0.0 |</span>
<span class="sd">        |   3 | 2.0            4.0 | 2.0  4.0  3.0  6.0  1.0                  2.0 |</span>
<span class="sd">        |   4 | 4.0            8.0 | 4.0  8.0  2.0  4.0  3.0                  6.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">Precipitation</span><span class="p">,)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedPrecipitation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="n">loggedprecipitation</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedprecipitation</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">loggedprecipitation</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">precipitation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Calc_DailyPrecipitation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailyPrecipitation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailyPrecipitation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the precipitation sum of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedprecipitation.shape = 3, 2</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedprecipitation = [1.0, 2.0], [5.0, 6.0], [3.0, 4.0]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailyprecipitation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailyprecipitation</span>
<span class="sd">        dailyprecipitation(9.0, 12.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedPrecipitation</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyPrecipitation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">dailyprecipitation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">dailyprecipitation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedprecipitation</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Update_LoggedPotentialSoilEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_LoggedPotentialSoilEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_LoggedPotentialSoilEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="c1"># pylint: disable=line-too-long</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log the potential soil evapotranspiration values of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        The following example shows that each new method call successively moves the</span>
<span class="sd">        six memorised values to the right and stores the two new values on the leftmost</span>
<span class="sd">        position:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedpotentialsoilevapotranspiration.shape = 3, 2</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedpotentialsoilevapotranspiration = 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(model,</span>
<span class="sd">        ...                 model.update_loggedpotentialsoilevapotranspiration_v1,</span>
<span class="sd">        ...                 last_example=4,</span>
<span class="sd">        ...                 parseqs=(fluxes.potentialsoilevapotranspiration,</span>
<span class="sd">        ...                          logs.loggedpotentialsoilevapotranspiration))</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.potentialsoilevapotranspiration = [1.0, 2.0], [3.0, 6.0], [2.0, 4.0], [4.0, 8.0]</span>
<span class="sd">        &gt;&gt;&gt; del test.inits.loggedpotentialsoilevapotranspiration</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |      potentialsoilevapotranspiration |                          loggedpotentialsoilevapotranspiration |</span>
<span class="sd">        ---------------------------------------------------------------------------------------------------------------</span>
<span class="sd">        |   1 | 1.0                              2.0 | 1.0  2.0  0.0  0.0  0.0                                    0.0 |</span>
<span class="sd">        |   2 | 3.0                              6.0 | 3.0  6.0  1.0  2.0  0.0                                    0.0 |</span>
<span class="sd">        |   3 | 2.0                              4.0 | 2.0  4.0  3.0  6.0  1.0                                    2.0 |</span>
<span class="sd">        |   4 | 4.0                              8.0 | 4.0  8.0  2.0  4.0  3.0                                    6.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialSoilEvapotranspiration</span><span class="p">,)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedPotentialSoilEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="n">loggedpotentialsoilevapotranspiration</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">loggedpotentialsoilevapotranspiration</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
                <span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">loggedpotentialsoilevapotranspiration</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">potentialsoilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_DailyPotentialSoilEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailyPotentialSoilEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailyPotentialSoilEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the potential soil evapotranspiration sum of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedpotentialsoilevapotranspiration.shape = 3, 2</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedpotentialsoilevapotranspiration = (</span>
<span class="sd">        ...     [1.0, 2.0], [5.0, 6.0], [3.0, 4.0])</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailypotentialsoilevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailypotentialsoilevapotranspiration</span>
<span class="sd">        dailypotentialsoilevapotranspiration(9.0, 12.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedPotentialSoilEvapotranspiration</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyPotentialSoilEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">dailypotentialsoilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">dailypotentialsoilevapotranspiration</span><span class="p">[</span>
                    <span class="n">k</span>
                <span class="p">]</span> <span class="o">+=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedpotentialsoilevapotranspiration</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Update_SoilResistance_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_SoilResistance_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_SoilResistance_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Update the soil surface resistance following :cite:t:`ref-Lpmeier2014`.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      .. math::</span>
<span class="sd">        r_{new} = \begin{cases}</span>
<span class="sd">        r_{old} + \Delta &amp;|\ p / e &lt; \tau \\</span>
<span class="sd">        w &amp;|\ p / e \geq \tau</span>
<span class="sd">        \end{cases} \\</span>
<span class="sd">        \\ \\</span>
<span class="sd">        r = SoilResistance \\</span>
<span class="sd">        w = WetSoilResistance \\</span>
<span class="sd">        \Delta = SoilResistanceIncrease \\</span>
<span class="sd">        \tau = WetnessThreshold \\</span>
<span class="sd">        p = DailyPrecipitation \\</span>
<span class="sd">        e = DailyPotentialSoilEvapotranspiration</span>

<span class="sd">    Example:</span>

<span class="sd">        |Update_SoilResistance_V1| generally sets the soil surface resistance to |nan|</span>
<span class="sd">        for all areas without relevant soils (see the first hydrological response</span>
<span class="sd">        unit).  For all other areas, it increases the resistance constantly as long as</span>
<span class="sd">        the precipitation sum over the last 24 hours is less than the potential</span>
<span class="sd">        evapotranspiration sum over the last 24 hours (second response unit) or</span>
<span class="sd">        otherwise sets it to the &quot;initial value&quot; for wet soil surfaces (third and</span>
<span class="sd">        fourth response unit):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1h&quot;)</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(4)</span>
<span class="sd">        &gt;&gt;&gt; soil(False, True, True, True)</span>
<span class="sd">        &gt;&gt;&gt; wetsoilresistance(50.0)</span>
<span class="sd">        &gt;&gt;&gt; wetnessthreshold(0.5)</span>
<span class="sd">        &gt;&gt;&gt; soilresistanceincrease(24.0)</span>
<span class="sd">        &gt;&gt;&gt; states.soilresistance = 60.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailyprecipitation = 3.0, 4.0, 5.0, 6.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailypotentialsoilevapotranspiration = 10.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.soilresistance</span>
<span class="sd">        soilresistance(nan, 61.0, 50.0, 50.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">WetSoilResistance</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">SoilResistanceIncrease</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">WetnessThreshold</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyPrecipitation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyPotentialSoilEvapotranspiration</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_states</span><span class="o">.</span><span class="n">SoilResistance</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">soil</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">wetness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">dailyprecipitation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">wetnessthreshold</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">wetness</span> <span class="o">&lt;</span> <span class="n">flu</span><span class="o">.</span><span class="n">dailypotentialsoilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                    <span class="n">sta</span><span class="o">.</span><span class="n">soilresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">con</span><span class="o">.</span><span class="n">soilresistanceincrease</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sta</span><span class="o">.</span><span class="n">soilresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">wetsoilresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sta</span><span class="o">.</span><span class="n">soilresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">nan</span></div>



<div class="viewcode-block" id="Calc_LanduseSurfaceResistance_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_LanduseSurfaceResistance_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_LanduseSurfaceResistance_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the resistance of vegetation surfaces, water surfaces and sealed</span>
<span class="sd">    surfaces according to :cite:t:`ref-LARSIM` and based on :cite:t:`ref-Thompson1981`.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      .. math::</span>
<span class="sd">        LanduseSurfaceResistance = r^* \cdot \begin{cases}</span>
<span class="sd">        3.5 \cdot (1 - W / \tau) + exp(0.2 \cdot \tau / W)&amp;|\ W \leq \tau</span>
<span class="sd">        \\</span>
<span class="sd">        exp(0.2) &amp;|\ W &gt; \tau</span>
<span class="sd">        \end{cases}</span>
<span class="sd">        \\ \\ \\</span>
<span class="sd">        r^*= \begin{cases}</span>
<span class="sd">        r&amp;|\ \overline{C}</span>
<span class="sd">        \\</span>
<span class="sd">        10\,000 &amp;|\ C \;\; \land \;\; (T \leq -5 \;\; \lor \;\; \Delta \geq 20)</span>
<span class="sd">        \\</span>
<span class="sd">        min\left(\frac{25 \cdot r}{(T + 5)</span>
<span class="sd">        \cdot (1 - \Delta / 20)}, \ 10\,000\right)</span>
<span class="sd">        &amp;|\ C \;\; \land \;\; (-5 &lt; T &lt; 20 \;\; \land \;\; \Delta &lt; 20)</span>
<span class="sd">        \\</span>
<span class="sd">        min\left(\frac{r}{1 - \Delta / 20}, \ 10\,000\right)</span>
<span class="sd">        &amp;|\ C \;\; \land \;\; (20 \leq T \;\; \land \;\; \Delta &lt; 20)</span>
<span class="sd">        \end{cases}</span>
<span class="sd">        \\ \\ \\</span>
<span class="sd">        W = SoilWater \\</span>
<span class="sd">        C = Conifer \\</span>
<span class="sd">        \tau = SoilMoistureLimit \cdot MaxSoilWater \\</span>
<span class="sd">        r = SurfaceResistance \\</span>
<span class="sd">        \Delta = SaturationVapourPressure - ActualVapourPressure \\</span>
<span class="sd">        T = AirTemperature</span>

<span class="sd">    Examples:</span>

<span class="sd">        Base model |evap| does not define any land cover types by itself but takes the</span>
<span class="sd">        ones of the respective main model.  Here, we manually introduce the land cover</span>
<span class="sd">        types `water`, `sealed`, `acre`, and `conifer` to apply |evap| as a stand-alone</span>
<span class="sd">        model:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-05-30&quot;, &quot;2000-06-03&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.core.parametertools import Constants</span>
<span class="sd">        &gt;&gt;&gt; WATER, SEALED, ACRE, CONIFER,  = 1, 2, 3, 4</span>
<span class="sd">        &gt;&gt;&gt; constants = Constants(</span>
<span class="sd">        ...     WATER=WATER, SEALED=SEALED, ACRE=ACRE, CONIFER=CONIFER)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap.evap_control import HRUType, SurfaceResistance</span>
<span class="sd">        &gt;&gt;&gt; with HRUType.modify_constants(constants), \</span>
<span class="sd">        ...         SurfaceResistance.modify_rows(constants):</span>
<span class="sd">        ...     from hydpy.models.evap import *</span>
<span class="sd">        ...     parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(4)</span>

<span class="sd">        Method |Calc_LanduseSurfaceResistance_V1| relies on multiple discontinuous</span>
<span class="sd">        relationships, works differently for different land types, and uses monthly</span>
<span class="sd">        varying parameters.  Hence, we start simple and introduce further complexities</span>
<span class="sd">        step by step.</span>

<span class="sd">        For response units without relevant soils (like those with sealed surfaces or</span>
<span class="sd">        surface water bodies), the original parameter values are in effect without any</span>
<span class="sd">        modification:</span>

<span class="sd">        &gt;&gt;&gt; hrutype(SEALED, SEALED, WATER, WATER)</span>
<span class="sd">        &gt;&gt;&gt; soil(False)</span>
<span class="sd">        &gt;&gt;&gt; conifer(False)</span>
<span class="sd">        &gt;&gt;&gt; surfaceresistance.water_may = 0.0</span>
<span class="sd">        &gt;&gt;&gt; surfaceresistance.sealed_may = 500.0</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = 1</span>
<span class="sd">        &gt;&gt;&gt; model.calc_landusesurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.landusesurfaceresistance</span>
<span class="sd">        landusesurfaceresistance(500.0, 500.0, 0.0, 0.0)</span>

<span class="sd">        For all &quot;soil areas&quot;, |Calc_LanduseSurfaceResistance_V1| slightly increases the</span>
<span class="sd">        original parameter value by a constant factor for wet soils (|SoilWater| &gt;</span>
<span class="sd">        |SoilMoistureLimit|) and increases it even more for dry soils (|SoilWater| &gt;</span>
<span class="sd">        |SoilMoistureLimit|).  For a completely dried-up soils, surface resistance</span>
<span class="sd">        becomes infinite:</span>

<span class="sd">        &gt;&gt;&gt; hrutype(ACRE)</span>
<span class="sd">        &gt;&gt;&gt; soil(True)</span>
<span class="sd">        &gt;&gt;&gt; soilmoisturelimit(0.0)</span>
<span class="sd">        &gt;&gt;&gt; surfaceresistance.acre_jun = 40.0</span>
<span class="sd">        &gt;&gt;&gt; factors.soilwater = 0.0, 10.0, 20.0, 30.0</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = 2</span>
<span class="sd">        &gt;&gt;&gt; model.calc_landusesurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.landusesurfaceresistance</span>
<span class="sd">        landusesurfaceresistance(inf, 48.85611, 48.85611, 48.85611)</span>

<span class="sd">        &gt;&gt;&gt; maxsoilwater(40.0)</span>
<span class="sd">        &gt;&gt;&gt; soilmoisturelimit(0.5)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_landusesurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.landusesurfaceresistance</span>
<span class="sd">        landusesurfaceresistance(inf, 129.672988, 48.85611, 48.85611)</span>

<span class="sd">        &gt;&gt;&gt; factors.soilwater = 17.0, 18.0, 19.0, 20.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_landusesurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.landusesurfaceresistance</span>
<span class="sd">        landusesurfaceresistance(71.611234, 63.953955, 56.373101, 48.85611)</span>

<span class="sd">        |Calc_LanduseSurfaceResistance_V1| treats coniferous trees special by</span>
<span class="sd">        increasing surface resistance further for low temperatures and high water</span>
<span class="sd">        vapour pressure deficits.  The highest resistance value occurs for air</span>
<span class="sd">        temperatures lower than -5 C or vapour pressure deficits higher than 20 hPa:</span>

<span class="sd">        &gt;&gt;&gt; hrutype(CONIFER)</span>
<span class="sd">        &gt;&gt;&gt; conifer(True)</span>
<span class="sd">        &gt;&gt;&gt; surfaceresistance.conifer_jun = 80.0</span>
<span class="sd">        &gt;&gt;&gt; factors.soilwater = 20.0</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 30.0</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressure = 30.0</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 0.0, 10.0, 20.0, 30.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_landusesurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.landusesurfaceresistance</span>
<span class="sd">        landusesurfaceresistance(12214.027582, 12214.027582, 195.424441,</span>
<span class="sd">                                 97.712221)</span>

<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 10.0, 10.1, 11.0, 12.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_landusesurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.landusesurfaceresistance</span>
<span class="sd">        landusesurfaceresistance(12214.027582, 12214.027582, 1954.244413,</span>
<span class="sd">                                 977.122207)</span>

<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 20.0</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = -10.0, 5.0, 20.0, 35.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_landusesurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.landusesurfaceresistance</span>
<span class="sd">        landusesurfaceresistance(12214.027582, 488.561103, 195.424441,</span>
<span class="sd">                                 195.424441)</span>

<span class="sd">        &gt;&gt;&gt; factors.airtemperature = -6.0, -5.0, -4.0, -3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_landusesurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.landusesurfaceresistance</span>
<span class="sd">        landusesurfaceresistance(12214.027582, 12214.027582, 4885.611033,</span>
<span class="sd">                                 2442.805516)</span>

<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 18.0, 19.0, 20.0, 21.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_landusesurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.landusesurfaceresistance</span>
<span class="sd">        landusesurfaceresistance(212.417871, 203.567126, 195.424441, 195.424441)</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Conifer</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">SurfaceResistance</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">MaxSoilWater</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">SoilMoistureLimit</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SoilWater</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">LanduseSurfaceResistance</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">r</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">surfaceresistance</span><span class="p">[</span>
                <span class="n">con</span><span class="o">.</span><span class="n">hrutype</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_surfaceresistance_rowmin</span><span class="p">,</span>
                <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_surfaceresistance_columnmin</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">conifer</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">d</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">fac</span><span class="o">.</span><span class="n">actualvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">d</span> <span class="o">&gt;=</span> <span class="mf">20.0</span><span class="p">):</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">landusesurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10000.0</span>
                <span class="k">elif</span> <span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">20.0</span><span class="p">:</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">landusesurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                        <span class="p">(</span><span class="mf">25.0</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mf">5.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">d</span><span class="p">),</span>
                        <span class="mf">10000.0</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">landusesurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">d</span><span class="p">),</span> <span class="mf">10000.0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">landusesurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">soil</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">sw</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">soilwater</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">sw</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">landusesurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">inf</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">thresh</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">soilmoisturelimit</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">maxsoilwater</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">sw</span> <span class="o">&lt;</span> <span class="n">thresh</span><span class="p">:</span>
                        <span class="n">fac</span><span class="o">.</span><span class="n">landusesurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">3.5</span> <span class="o">*</span> <span class="p">(</span>
                            <span class="mf">1.0</span> <span class="o">-</span> <span class="n">sw</span> <span class="o">/</span> <span class="n">thresh</span>
                        <span class="p">)</span> <span class="o">+</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">thresh</span> <span class="o">/</span> <span class="n">sw</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fac</span><span class="o">.</span><span class="n">landusesurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_ActualSurfaceResistance_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_ActualSurfaceResistance_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_ActualSurfaceResistance_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the actual surface resistance according to :cite:t:`ref-LARSIM`,</span>
<span class="sd">    based on :cite:t:`ref-Grant1975`.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      :math:`ActualSurfaceResistance =</span>
<span class="sd">      \left(\frac{w}{SR_{day}} + \frac{1 - w}{SR_{night}}\right)^{-1}`</span>

<span class="sd">      :math:`SR_{day} =</span>
<span class="sd">      \left(\frac{1-0.7^{LeafAreaIndex}}{LanduseSurfaceResistance} +</span>
<span class="sd">      \frac{0.7^{LeafAreaIndex}}{SoilSurfaceResistance}\right)^{-1}`</span>

<span class="sd">      :math:`SR_{night} =</span>
<span class="sd">      \left(\frac{LeafAreaIndex}{2500} + \frac{1}{SoilSurfaceResistance}\right)^{-1}`</span>

<span class="sd">      :math:`w = \frac{PossibleSunshineDuration}{Hours}`</span>

<span class="sd">    Examples:</span>

<span class="sd">        Base model |evap| does not define any land cover types by itself but takes the</span>
<span class="sd">        ones of the respective main model.  Here, we manually introduce the land cover</span>
<span class="sd">        types `wood`, `trees`, `bush`, `acre`, and `water` to apply |evap| as a</span>
<span class="sd">        stand-alone model:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2019-05-30&quot;, &quot;2019-06-03&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.core.parametertools import Constants</span>
<span class="sd">        &gt;&gt;&gt; WOOD, TREES, BUSH, ACRE, WATER = 1, 2, 3, 4, 5</span>
<span class="sd">        &gt;&gt;&gt; constants = Constants(</span>
<span class="sd">        ...     WOOD=WOOD, TREES=TREES, BUSH=BUSH, ACRE=ACRE, WATER=WATER)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap.evap_control import HRUType, LeafAreaIndex</span>
<span class="sd">        &gt;&gt;&gt; with HRUType.modify_constants(constants), \</span>
<span class="sd">        ...         LeafAreaIndex.modify_rows(constants):</span>
<span class="sd">        ...     from hydpy.models.evap import *</span>
<span class="sd">        ...     parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(4)</span>

<span class="sd">        For response units without relevant soils (like those with sealed surfaces or</span>
<span class="sd">        surface water bodies), method |Calc_ActualSurfaceResistance_V1| just uses the</span>
<span class="sd">        values of sequence |LanduseSurfaceResistance| as the effective surface</span>
<span class="sd">        resistance values:</span>

<span class="sd">        &gt;&gt;&gt; hrutype(WATER)</span>
<span class="sd">        &gt;&gt;&gt; soil(False)</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.hours.update()</span>
<span class="sd">        &gt;&gt;&gt; factors.soilsurfaceresistance = nan</span>
<span class="sd">        &gt;&gt;&gt; factors.landusesurfaceresistance = 500.0, 0.0, 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = 1</span>
<span class="sd">        &gt;&gt;&gt; model.calc_actualsurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance</span>
<span class="sd">        actualsurfaceresistance(500.0, 0.0, 0.0, 0.0)</span>

<span class="sd">        For all &quot;soil areas&quot;, the final soil resistance is a combination of</span>
<span class="sd">        |LanduseSurfaceResistance| and |SoilSurfaceResistance| that depends on the leaf</span>
<span class="sd">        area index:</span>

<span class="sd">        &gt;&gt;&gt; hrutype(ACRE, BUSH, TREES, WOOD)</span>
<span class="sd">        &gt;&gt;&gt; soil(True)</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.acre_may = 0.0</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.bush_may = 2.0</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.trees_may = 5.0</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.wood_may = 10.0</span>

<span class="sd">        All four hydrological response units have identical soil- and land-use-related</span>
<span class="sd">        surface resistance values:</span>

<span class="sd">        &gt;&gt;&gt; factors.soilsurfaceresistance = 200.0</span>
<span class="sd">        &gt;&gt;&gt; factors.landusesurfaceresistance = 100.0</span>

<span class="sd">        For a polar day, the actual resistance equals the soil surface resistance for</span>
<span class="sd">        zero leaf area indices (see the first response unit).  With an increasing leaf</span>
<span class="sd">        area index, actual resistance tends towards land-use-related resistance:</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 24.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_actualsurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance</span>
<span class="sd">        actualsurfaceresistance(200.0, 132.450331, 109.174477, 101.43261)</span>

<span class="sd">        For a polar night, |Calc_ActualSurfaceResistance_V1| performs a leaf area</span>
<span class="sd">        index-dependent interpolation between soil surface resistance and a fixed</span>
<span class="sd">        resistance value:</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 0.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_actualsurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance</span>
<span class="sd">        actualsurfaceresistance(200.0, 172.413793, 142.857143, 111.111111)</span>

<span class="sd">        For all days that are neither polar nights nor polar days, the values of the</span>
<span class="sd">        two examples above are weighted based on the possible sunshine duration of that</span>
<span class="sd">        day:</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 12.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_actualsurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance</span>
<span class="sd">        actualsurfaceresistance(200.0, 149.812734, 123.765057, 106.051498)</span>

<span class="sd">        The following examples demonstrate that method</span>
<span class="sd">        |Calc_ActualSurfaceResistance_V1| works the same way when applied on an hourly</span>
<span class="sd">        time basis during the daytime period (first example), during the nighttime</span>
<span class="sd">        (second example), and during dawn or dusk (third example):</span>

<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2019-05-31 22:00&quot;, &quot;2019-06-01 03:00&quot;, &quot;1h&quot;</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; hrutype(WOOD)</span>
<span class="sd">        &gt;&gt;&gt; soil(True)</span>
<span class="sd">        &gt;&gt;&gt; factors.soilsurfaceresistance = 200.0</span>
<span class="sd">        &gt;&gt;&gt; factors.landusesurfaceresistance = 100.0</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.hours.update()</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex.wood_jun = 5.0</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = 2</span>
<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 1.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_actualsurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance</span>
<span class="sd">        actualsurfaceresistance(109.174477)</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 0.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_actualsurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance</span>
<span class="sd">        actualsurfaceresistance(142.857143)</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 0.5</span>
<span class="sd">        &gt;&gt;&gt; model.calc_actualsurfaceresistance_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance</span>
<span class="sd">        actualsurfaceresistance(123.765057)</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LeafAreaIndex</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,</span> <span class="n">evap_derived</span><span class="o">.</span><span class="n">Hours</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">PossibleSunshineDuration</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SoilSurfaceResistance</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">LanduseSurfaceResistance</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualSurfaceResistance</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">soil</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">lai</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">leafareaindex</span><span class="p">[</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">hrutype</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_leafareaindex_rowmin</span><span class="p">,</span>
                    <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_leafareaindex_columnmin</span><span class="p">,</span>
                <span class="p">]</span>
                <span class="n">invsrday</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.7</span><span class="o">**</span><span class="n">lai</span><span class="p">)</span> <span class="o">/</span> <span class="n">fac</span><span class="o">.</span><span class="n">landusesurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="p">)</span> <span class="o">+</span> <span class="mf">0.7</span><span class="o">**</span><span class="n">lai</span> <span class="o">/</span> <span class="n">fac</span><span class="o">.</span><span class="n">soilsurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">invsrnight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">lai</span> <span class="o">/</span> <span class="mf">2500.0</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">fac</span><span class="o">.</span><span class="n">soilsurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">w</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">possiblesunshineduration</span> <span class="o">/</span> <span class="n">der</span><span class="o">.</span><span class="n">hours</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">actualsurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
                    <span class="n">w</span> <span class="o">*</span> <span class="n">invsrday</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">invsrnight</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">actualsurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">landusesurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Calc_ActualSurfaceResistance_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_ActualSurfaceResistance_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_ActualSurfaceResistance_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the actual surface resistance according to :cite:t:`ref-Lpmeier2014`</span>
<span class="sd">    and based on :cite:t:`ref-Thompson1981`.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      .. math::</span>
<span class="sd">        ActualSurfaceResistance = \left(\frac{\omega_{day}}{r_{day}} +</span>
<span class="sd">        \frac{1 - \omega_{day}}{r_{night}}\right)^{-1} \\</span>
<span class="sd">        \\ \\</span>
<span class="sd">        r_{day} = \left(\frac{1 - \omega_{soil}}{r_l} +</span>
<span class="sd">        \frac{\omega_{soil}}{r_s}\right)^{-1} \\ \\</span>
<span class="sd">        r_{night} = \left(\frac{lai}{2800} + \frac{1}{r_s}\right)^{-1} \\</span>
<span class="sd">        \\ \\</span>
<span class="sd">        \omega_{day} = PossibleSunshineDuration / Hours \\</span>
<span class="sd">        \omega_{soil} = \begin{cases} 0.8^{lai} &amp;|\ lai &lt; 1 \\</span>
<span class="sd">        0.7^{lai} &amp;|\ lai \geq 1 \end{cases} \\</span>
<span class="sd">        \\ \\</span>
<span class="sd">        lai = LeafAreaIndex \\</span>
<span class="sd">        r_s = SoilSurfaceResistance \\</span>
<span class="sd">        r_l = LeafResistance</span>

<span class="sd">    Examples:</span>

<span class="sd">        |Calc_ActualSurfaceResistance_V2| works similarly to method</span>
<span class="sd">        |Calc_ActualSurfaceResistance_V1|.  We build up a comparable setting but use</span>
<span class="sd">        |lland_dd| and |evap_aet_minhas| as main models to prepare an applicable |evap|</span>
<span class="sd">        instance (more precisely, an |evap_pet_ambav1| instance) more easily:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland_dd import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; nhru(5)</span>
<span class="sd">        &gt;&gt;&gt; lnk(WASSER, FLUSS, SEE, BODEN, BODEN)</span>
<span class="sd">        &gt;&gt;&gt; ft(10.0)</span>
<span class="sd">        &gt;&gt;&gt; fhru(0.2)</span>
<span class="sd">        &gt;&gt;&gt; gh(100.0)</span>
<span class="sd">        &gt;&gt;&gt; atg(-0.65)</span>
<span class="sd">        &gt;&gt;&gt; gsf(2.0)</span>
<span class="sd">        &gt;&gt;&gt; aggh(inf)</span>
<span class="sd">        &gt;&gt;&gt; agsh(inf)</span>
<span class="sd">        &gt;&gt;&gt; feis(0.01)</span>
<span class="sd">        &gt;&gt;&gt; bsf0(0.0)</span>
<span class="sd">        &gt;&gt;&gt; wmax(200.0)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-05-30&quot;, &quot;2000-06-03&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; with model.add_aetmodel_v1(&quot;evap_aet_minhas&quot;):</span>
<span class="sd">        ...     with model.add_petmodel_v2(&quot;evap_pet_ambav1&quot;) as ambav:</span>
<span class="sd">        ...         pass</span>
<span class="sd">        &gt;&gt;&gt; control = ambav.parameters.control</span>
<span class="sd">        &gt;&gt;&gt; derived = ambav.parameters.derived</span>
<span class="sd">        &gt;&gt;&gt; inputs = ambav.sequences.inputs</span>
<span class="sd">        &gt;&gt;&gt; factors = ambav.sequences.factors</span>
<span class="sd">        &gt;&gt;&gt; states = ambav.sequences.states</span>

<span class="sd">        For response units without relevant soils (like those with sealed surfaces) or</span>
<span class="sd">        with unvegetated soils, method |Calc_ActualSurfaceResistance_V2| generally</span>
<span class="sd">        performs no calculation but sets the effective surface resistance to zero or</span>
<span class="sd">        takes the defined soil resistance value:</span>

<span class="sd">        &gt;&gt;&gt; control.hrutype</span>
<span class="sd">        hrutype(WASSER, FLUSS, SEE, BODEN, BODEN)</span>
<span class="sd">        &gt;&gt;&gt; control.soil</span>
<span class="sd">        soil(boden=True, fluss=False, see=False, wasser=False)</span>
<span class="sd">        &gt;&gt;&gt; states.soilresistance = 300.0</span>
<span class="sd">        &gt;&gt;&gt; ambav.calc_actualsurfaceresistance_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance</span>
<span class="sd">        actualsurfaceresistance(0.0, 0.0, 0.0, 300.0, 300.0)</span>

<span class="sd">        For all &quot;soil areas&quot;, the final soil resistance is a combination of</span>
<span class="sd">        |LeafResistance| and |SoilResistance| that depends on the leaf area index,</span>
<span class="sd">        which is generally zero for non-vegetated land cover types:</span>

<span class="sd">        &gt;&gt;&gt; lnk(BODEN, ACKER, GRUE_E, GRUE_I, NADELW)</span>
<span class="sd">        &gt;&gt;&gt; model.update_parameters(ignore_errors=True)</span>
<span class="sd">        &gt;&gt;&gt; control.hrutype</span>
<span class="sd">        hrutype(BODEN, ACKER, GRUE_E, GRUE_I, NADELW)</span>
<span class="sd">        &gt;&gt;&gt; control.soil</span>
<span class="sd">        soil(True)</span>
<span class="sd">        &gt;&gt;&gt; control.plant</span>
<span class="sd">        plant(acker=True, boden=False, grue_e=True, grue_i=True, nadelw=True)</span>
<span class="sd">        &gt;&gt;&gt; control.leafareaindex.acker_may = 0.0</span>
<span class="sd">        &gt;&gt;&gt; control.leafareaindex.grue_e_may = 0.9999</span>
<span class="sd">        &gt;&gt;&gt; control.leafareaindex.grue_i_may = 1.0</span>
<span class="sd">        &gt;&gt;&gt; control.leafareaindex.baumb_may = 5.0</span>
<span class="sd">        &gt;&gt;&gt; control.leafareaindex.nadelw_may = 10.0</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = 1</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.hours.update()</span>

<span class="sd">        All five hydrological response units have identical soil and leaf resistance</span>
<span class="sd">        values:</span>

<span class="sd">        &gt;&gt;&gt; control.leafresistance(100.0)</span>
<span class="sd">        &gt;&gt;&gt; states.soilresistance = 200.0</span>

<span class="sd">        For a polar day, the results are identical to those of method</span>
<span class="sd">        |Calc_ActualSurfaceResistance_V1|, except that</span>
<span class="sd">        |Calc_ActualSurfaceResistance_V2| calculates larger values for leaf area</span>
<span class="sd">        indices smaller than one (which goes along with a sudden resistance decrease</span>
<span class="sd">        when reaching a leaf area index of one):</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 24.0</span>
<span class="sd">        &gt;&gt;&gt; ambav.calc_actualsurfaceresistance_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance</span>
<span class="sd">        actualsurfaceresistance(200.0, 200.0, 166.669146, 153.846154, 101.43261)</span>

<span class="sd">        For a polar night, |Calc_ActualSurfaceResistance_V2| calculates slightly higher</span>
<span class="sd">        values due to assuming a surface resistance of 2,800 s/m instead of 2,500 s/m</span>
<span class="sd">        for leaves with completely closed stomata:</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 0.0</span>
<span class="sd">        &gt;&gt;&gt; ambav.calc_actualsurfaceresistance_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance</span>
<span class="sd">        actualsurfaceresistance(200.0, 200.0, 186.667911, 186.666667, 116.666667)</span>

<span class="sd">        Accordingly, |Calc_ActualSurfaceResistance_V2| always determines slightly</span>
<span class="sd">        higher surface resistances in mixed cases:</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 12.0</span>
<span class="sd">        &gt;&gt;&gt; ambav.calc_actualsurfaceresistance_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance</span>
<span class="sd">        actualsurfaceresistance(200.0, 200.0, 176.102567, 168.674699, 108.517595)</span>

<span class="sd">        The following examples demonstrate that method</span>
<span class="sd">        |Calc_ActualSurfaceResistance_V2| works the same way when applied on an hourly</span>
<span class="sd">        time basis during the daytime period (first example), during the nighttime</span>
<span class="sd">        (second example), and during dawn or dusk (third example):</span>

<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2019-05-31 22:00&quot;, &quot;2019-06-01 03:00&quot;, &quot;1h&quot;</span>
<span class="sd">        &gt;&gt;&gt; nhru(1)</span>
<span class="sd">        &gt;&gt;&gt; lnk(NADELW)</span>
<span class="sd">        &gt;&gt;&gt; fhru(1.0)</span>
<span class="sd">        &gt;&gt;&gt; wmax(200.0)</span>
<span class="sd">        &gt;&gt;&gt; bsf0(0.0)</span>
<span class="sd">        &gt;&gt;&gt; gh(100.0)</span>
<span class="sd">        &gt;&gt;&gt; atg(-0.65)</span>
<span class="sd">        &gt;&gt;&gt; gsf(2.0)</span>
<span class="sd">        &gt;&gt;&gt; aggh(inf)</span>
<span class="sd">        &gt;&gt;&gt; agsh(inf)</span>
<span class="sd">        &gt;&gt;&gt; feis(0.01)</span>
<span class="sd">        &gt;&gt;&gt; model.update_parameters(ignore_errors=True)</span>
<span class="sd">        &gt;&gt;&gt; control.hrutype</span>
<span class="sd">        hrutype(NADELW)</span>
<span class="sd">        &gt;&gt;&gt; control.soil</span>
<span class="sd">        soil(True)</span>
<span class="sd">        &gt;&gt;&gt; control.plant</span>
<span class="sd">        plant(True)</span>
<span class="sd">        &gt;&gt;&gt; control.leafresistance(100.0)</span>
<span class="sd">        &gt;&gt;&gt; states.soilresistance = 200.0</span>
<span class="sd">        &gt;&gt;&gt; control.leafareaindex.nadelw_jun = 5.0</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.hours.update()</span>
<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 1.0</span>
<span class="sd">        &gt;&gt;&gt; ambav.idx_sim = 2</span>
<span class="sd">        &gt;&gt;&gt; ambav.calc_actualsurfaceresistance_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance</span>
<span class="sd">        actualsurfaceresistance(109.174477)</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 0.0</span>
<span class="sd">        &gt;&gt;&gt; ambav.calc_actualsurfaceresistance_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance</span>
<span class="sd">        actualsurfaceresistance(147.368421)</span>

<span class="sd">        &gt;&gt;&gt; factors.possiblesunshineduration = 0.5</span>
<span class="sd">        &gt;&gt;&gt; ambav.calc_actualsurfaceresistance_v2()</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance</span>
<span class="sd">        actualsurfaceresistance(125.428304)</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Plant</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LeafAreaIndex</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LeafResistance</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,</span> <span class="n">evap_derived</span><span class="o">.</span><span class="n">Hours</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">PossibleSunshineDuration</span><span class="p">,</span>
        <span class="n">evap_states</span><span class="o">.</span><span class="n">SoilResistance</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualSurfaceResistance</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">plant</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">lai</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">leafareaindex</span><span class="p">[</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">hrutype</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_leafareaindex_rowmin</span><span class="p">,</span>
                    <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_leafareaindex_columnmin</span><span class="p">,</span>
                <span class="p">]</span>
                <span class="n">w_soil</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.8</span> <span class="k">if</span> <span class="n">lai</span> <span class="o">&lt;</span> <span class="mf">1.0</span> <span class="k">else</span> <span class="mf">0.7</span><span class="p">)</span> <span class="o">**</span> <span class="n">lai</span>
                <span class="n">r_soil</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">sta</span><span class="o">.</span><span class="n">soilresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">r_leaf_day</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">leafresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">r_day_inv</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">w_soil</span> <span class="o">/</span> <span class="n">r_soil</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">w_soil</span><span class="p">)</span> <span class="o">/</span> <span class="n">r_leaf_day</span>
                <span class="n">r_leaf_night</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2800.0</span>
                <span class="n">r_night_inv</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">r_soil</span> <span class="o">+</span> <span class="n">lai</span> <span class="o">/</span> <span class="n">r_leaf_night</span>
                <span class="n">w_day</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">possiblesunshineduration</span> <span class="o">/</span> <span class="n">der</span><span class="o">.</span><span class="n">hours</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">actualsurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
                    <span class="n">w_day</span> <span class="o">*</span> <span class="n">r_day_inv</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">w_day</span><span class="p">)</span> <span class="o">*</span> <span class="n">r_night_inv</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">con</span><span class="o">.</span><span class="n">soil</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">actualsurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">sta</span><span class="o">.</span><span class="n">soilresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">actualsurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Calc_Precipitation_PrecipModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_Precipitation_PrecipModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_Precipitation_PrecipModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query precipitation from a main model that is referenced as a sub-submodel and</span>
<span class="sd">    follows the |PrecipModel_V1| interface.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use the combination of |hland_96| and |evap_pet_hbv96| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.hland_96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; area(10.0)</span>
<span class="sd">        &gt;&gt;&gt; nmbzones(3)</span>
<span class="sd">        &gt;&gt;&gt; zonearea(5.0, 3.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; zonetype(FIELD)</span>
<span class="sd">        &gt;&gt;&gt; zonez(2.0)</span>
<span class="sd">        &gt;&gt;&gt; fc(200.0)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_aetmodel_v1(&quot;evap_aet_hbv96&quot;):</span>
<span class="sd">        ...     with model.add_petmodel_v1(&quot;evap_pet_hbv96&quot;):</span>
<span class="sd">        ...         pass</span>
<span class="sd">        &gt;&gt;&gt; fluxes.pc(1.0, 3.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.petmodel.calc_precipitation_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.petmodel.sequences.fluxes.precipitation</span>
<span class="sd">        precipitation(1.0, 3.0, 2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">Precipitation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">precipitation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">submodel</span><span class="o">.</span><span class="n">get_precipitation</span><span class="p">(</span><span class="n">k</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_Precipitation_PrecipModel_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_Precipitation_PrecipModel_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_Precipitation_PrecipModel_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |PrecipModel_V2| interface determine the</span>
<span class="sd">    precipitation.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use the combination of |evap_pet_hbv96| and |meteo_precip_io| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_pet_hbv96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; hruarea(0.5, 0.3, 0.2)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_precipmodel_v2(&quot;meteo_precip_io&quot;):</span>
<span class="sd">        ...     precipitationfactor(0.5, 1.0, 2.0)</span>
<span class="sd">        ...     inputs.precipitation = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_precipitation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.precipitation</span>
<span class="sd">        precipitation(1.0, 2.0, 4.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">Precipitation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V2</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">submodel</span><span class="o">.</span><span class="n">determine_precipitation</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">precipitation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">submodel</span><span class="o">.</span><span class="n">get_precipitation</span><span class="p">(</span><span class="n">k</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_Precipitation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_Precipitation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_Precipitation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |PrecipModel_V1| or |PrecipModel_V2|</span>
<span class="sd">    interface determine precipitation.&quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V1</span><span class="p">,</span>
        <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Calc_Precipitation_PrecipModel_V1</span><span class="p">,</span> <span class="n">Calc_Precipitation_PrecipModel_V2</span><span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">Precipitation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">precipmodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_precipitation_precipmodel_v1</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">precipmodel</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">precipmodel_typeid</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_precipitation_precipmodel_v2</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V2</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">precipmodel</span><span class="p">)</span>
            <span class="p">)</span></div>

        <span class="c1"># ToDo:</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         assert_never(model.petmodel)</span>


<div class="viewcode-block" id="Calc_InterceptedWater_IntercModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_InterceptedWater_IntercModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_InterceptedWater_IntercModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the current amount of intercepted water from a submodel that follows the</span>
<span class="sd">    |IntercModel_V1| interface.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use the combination of |hland_96| and |evap_aet_hbv96| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.hland_96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; area(10.0)</span>
<span class="sd">        &gt;&gt;&gt; nmbzones(3)</span>
<span class="sd">        &gt;&gt;&gt; zonearea(5.0, 3.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; zonetype(FIELD)</span>
<span class="sd">        &gt;&gt;&gt; zonez(2.0)</span>
<span class="sd">        &gt;&gt;&gt; fc(100.0)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_aetmodel_v1(&quot;evap_aet_hbv96&quot;):</span>
<span class="sd">        ...     pass</span>
<span class="sd">        &gt;&gt;&gt; states.ic = 1.0, 3.0, 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.calc_interceptedwater_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.sequences.factors.interceptedwater</span>
<span class="sd">        interceptedwater(1.0, 3.0, 2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">InterceptedWater</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">IntercModel_V1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">interceptedwater</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">submodel</span><span class="o">.</span><span class="n">get_interceptedwater</span><span class="p">(</span><span class="n">k</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_InterceptedWater_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_InterceptedWater_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_InterceptedWater_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |IntercModel_V1| interface determine the</span>
<span class="sd">    current amount of intercepted water.&quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span><span class="n">stateinterfaces</span><span class="o">.</span><span class="n">IntercModel_V1</span><span class="p">,)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Calc_InterceptedWater_IntercModel_V1</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">InterceptedWater</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">intercmodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_interceptedwater_intercmodel_v1</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">stateinterfaces</span><span class="o">.</span><span class="n">IntercModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">intercmodel</span><span class="p">)</span>
            <span class="p">)</span></div>

        <span class="c1"># ToDo:</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         assert_never(model.petmodel)</span>


<div class="viewcode-block" id="Calc_SnowyCanopy_SnowyCanopyModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SnowyCanopy_SnowyCanopyModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SnowyCanopy_SnowyCanopyModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the current snow cover degree in the canopies of tree-like</span>
<span class="sd">    vegetation from a submodel that follows the |SnowyCanopyModel_V1| interface.&quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SnowyCanopy</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowyCanopyModel_V1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">snowycanopy</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">submodel</span><span class="o">.</span><span class="n">get_snowycanopy</span><span class="p">(</span><span class="n">k</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_SnowyCanopy_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SnowyCanopy_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SnowyCanopy_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the current snow cover degree in the canopies of tree-like</span>
<span class="sd">    vegetation from a submodel that follows the |SnowyCanopyModel_V1| interface, if</span>
<span class="sd">    available.</span>

<span class="sd">    Examples:</span>

<span class="sd">        We use the combination of |lland_knauf_ic| and |evap_aet_morsim| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-01-01&quot;, &quot;2001-01-01&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.lland_knauf_ic import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; ft(10.0)</span>
<span class="sd">        &gt;&gt;&gt; nhru(3)</span>
<span class="sd">        &gt;&gt;&gt; fhru(5.0, 3.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; gh(100.0)</span>
<span class="sd">        &gt;&gt;&gt; lnk(LAUBW, LAUBW, ACKER)</span>
<span class="sd">        &gt;&gt;&gt; measuringheightwindspeed(10.0)</span>
<span class="sd">        &gt;&gt;&gt; lai(3.0)</span>
<span class="sd">        &gt;&gt;&gt; wmax(100.0)</span>
<span class="sd">        &gt;&gt;&gt; states.stinz = 0.0, 0.1, 0.1</span>
<span class="sd">        &gt;&gt;&gt; with model.add_aetmodel_v1(&quot;evap_aet_morsim&quot;):</span>
<span class="sd">        ...     pass</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.calc_snowycanopy_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.sequences.factors.snowycanopy</span>
<span class="sd">        snowycanopy(0.0, 1.0, nan)</span>

<span class="sd">        Without a suitable submodel, |Calc_SnowyCanopy_V1| generally sets |SnowyCanopy|</span>
<span class="sd">        to |numpy.nan|:</span>

<span class="sd">        &gt;&gt;&gt; del model.aetmodel.snowycanopymodel</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.calc_snowycanopy_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.sequences.factors.snowycanopy</span>
<span class="sd">        snowycanopy(nan, nan, nan)</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span><span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowyCanopyModel_V1</span><span class="p">,)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Calc_SnowyCanopy_SnowyCanopyModel_V1</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SnowyCanopy</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">snowycanopymodel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">snowycanopy</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">snowycanopymodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_snowycanopy_snowycanopymodel_v1</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowyCanopyModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">snowycanopymodel</span><span class="p">)</span>
            <span class="p">)</span></div>

        <span class="c1"># ToDo:</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         assert_never(model.snowycanopymodel)</span>


<div class="viewcode-block" id="Calc_SoilWater_SoilWaterModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SoilWater_SoilWaterModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SoilWater_SoilWaterModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the current soil water amount from as submodel that follows the</span>
<span class="sd">    |SoilWaterModel_V1| interface.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use the combination of |hland_96| and |evap_aet_hbv96| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.hland_96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; area(10.0)</span>
<span class="sd">        &gt;&gt;&gt; nmbzones(3)</span>
<span class="sd">        &gt;&gt;&gt; zonearea(5.0, 3.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; zonetype(FIELD)</span>
<span class="sd">        &gt;&gt;&gt; zonez(2.0)</span>
<span class="sd">        &gt;&gt;&gt; fc(100.0)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_aetmodel_v1(&quot;evap_aet_hbv96&quot;):</span>
<span class="sd">        ...     pass</span>
<span class="sd">        &gt;&gt;&gt; states.sm = 10.0, 30.0, 20.0</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.calc_soilwater_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.sequences.factors.soilwater</span>
<span class="sd">        soilwater(10.0, 30.0, 20.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SoilWater</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SoilWaterModel_V1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">soilwater</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">submodel</span><span class="o">.</span><span class="n">get_soilwater</span><span class="p">(</span><span class="n">k</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_SoilWater_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SoilWater_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SoilWater_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |SoilWaterModel_V1| interface determine</span>
<span class="sd">    the current soil water amount.&quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span><span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SoilWaterModel_V1</span><span class="p">,)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Calc_SoilWater_SoilWaterModel_V1</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SoilWater</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">soilwatermodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_soilwater_soilwatermodel_v1</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SoilWaterModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">soilwatermodel</span><span class="p">)</span>
            <span class="p">)</span></div>

        <span class="c1"># ToDo:</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         assert_never(model.petmodel)</span>


<div class="viewcode-block" id="Calc_SnowCover_SnowCoverModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SnowCover_SnowCoverModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SnowCover_SnowCoverModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the current snow cover degree from a submodel that follows the</span>
<span class="sd">    |SnowCoverModel_V1| interface.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use the combination of |hland_96| and |evap_aet_hbv96| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.hland_96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; area(10.0)</span>
<span class="sd">        &gt;&gt;&gt; nmbzones(3)</span>
<span class="sd">        &gt;&gt;&gt; sclass(2)</span>
<span class="sd">        &gt;&gt;&gt; zonearea(5.0, 3.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; zonetype(FIELD)</span>
<span class="sd">        &gt;&gt;&gt; zonez(2.0)</span>
<span class="sd">        &gt;&gt;&gt; fc(100.0)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_aetmodel_v1(&quot;evap_aet_hbv96&quot;):</span>
<span class="sd">        ...     pass</span>
<span class="sd">        &gt;&gt;&gt; states.sp = [[0.0, 0.0, 1.0], [0.0, 1.0, 1.0]]</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.calc_snowcover_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.aetmodel.sequences.factors.snowcover</span>
<span class="sd">        snowcover(0.0, 0.5, 1.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SnowCover</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowCoverModel_V1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">snowcover</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">submodel</span><span class="o">.</span><span class="n">get_snowcover</span><span class="p">(</span><span class="n">k</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_SnowCover_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SnowCover_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SnowCover_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |SnowCoverModel_V1| interface determine</span>
<span class="sd">    the current snow cover degree.&quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span><span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowCoverModel_V1</span><span class="p">,)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Calc_SnowCover_SnowCoverModel_V1</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SnowCover</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">snowcovermodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_snowcover_snowcovermodel_v1</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowCoverModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">snowcovermodel</span><span class="p">)</span>
            <span class="p">)</span></div>

        <span class="c1"># ToDo:</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         assert_never(model.petmodel)</span>


<div class="viewcode-block" id="Return_Evaporation_PenmanMonteith_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Return_Evaporation_PenmanMonteith_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Return_Evaporation_PenmanMonteith_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the actual evapotranspiration with the Penman-Monteith equation</span>
<span class="sd">    according to :cite:t:`ref-LARSIM`, based on :cite:t:`ref-Thompson1981`.</span>

<span class="sd">    Basic equations:</span>

<span class="sd">    .. math::</span>
<span class="sd">      f_{PM}(r_s) =</span>
<span class="sd">      \frac{P&#39;_s \cdot (R_n - G) + C \cdot \rho \cdot c_p \cdot (P_s - P_a) / r_a}</span>
<span class="sd">      {H \cdot (P&#39;_s + \gamma \cdot C \cdot (1 + r_s / r_a))} \\</span>
<span class="sd">      \\</span>
<span class="sd">      C = 1 + \frac{b&#39; \cdot r_a}{\rho \cdot c_p} \\</span>
<span class="sd">      \\</span>
<span class="sd">      b&#39; = 4 \cdot \varepsilon \cdot \sigma \cdot (273.15 + T)^3 \\</span>
<span class="sd">      \\</span>
<span class="sd">      r_s = actualsurfaceresistance \\</span>
<span class="sd">      P&#39;_s = SaturationVapourPressureSlope  \\</span>
<span class="sd">      R_n = NetRadiation \\</span>
<span class="sd">      G = SoilHeatFlux \\</span>
<span class="sd">      \rho = AirDensitiy  \\</span>
<span class="sd">      c_p = HeatCapacityAir \\</span>
<span class="sd">      P_s = SaturationVapourPressure \\</span>
<span class="sd">      P_a = ActualVapourPressure \\</span>
<span class="sd">      r_a = AerodynamicResistance \\</span>
<span class="sd">      H = HeatOfCondensation \\</span>
<span class="sd">      \gamma = PsychrometricConstant \\</span>
<span class="sd">      \varepsilon = Emissivity \\</span>
<span class="sd">      T = AirTemperature \\</span>
<span class="sd">      \sigma = StefanBoltzmannConstant</span>

<span class="sd">    Hint: Correction factor `C` takes the difference between measured air temperature</span>
<span class="sd">    and actual surface temperature into account.</span>

<span class="sd">    Example:</span>

<span class="sd">        We build the following example on the first example of the documentation on</span>
<span class="sd">        method |Calc_WaterEvaporation_V3|, which relies on the Penman equation.  The</span>
<span class="sd">        total available energy (|NetRadiation| minus |SoilHeatFlux|) and the vapour</span>
<span class="sd">        saturation pressure deficit (|SaturationVapourPressure| minus</span>
<span class="sd">        |ActualVapourPressure| are identical.  To make the results roughly comparable,</span>
<span class="sd">        we use resistances suitable for water surfaces by setting</span>
<span class="sd">        |ActualSurfaceResistance| to zero and |AerodynamicResistance| to a reasonable</span>
<span class="sd">        precalculated value of 106 s/m:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(7)</span>
<span class="sd">        &gt;&gt;&gt; emissivity(0.96)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 10.0, 50.0, 100.0, 10.0, 10.0, 10.0, 100.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux = 10.0</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressure = 12.0</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressureslope = 0.8</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 12.0, 12.0, 12.0, 12.0, 6.0, 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.airdensity = 1.24</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance = 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance = 106.0</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 10.0</span>

<span class="sd">        For the first three hydrological response units with energy forcing only, there</span>
<span class="sd">        is a relatively small deviation to the results of method</span>
<span class="sd">        |Calc_WaterEvaporation_V3| due to the correction factor `C`, which is only</span>
<span class="sd">        implemented by method |Return_Evaporation_PenmanMonteith_V1|.  For response</span>
<span class="sd">        units four to six with dynamic forcing only, the results of method</span>
<span class="sd">        |Return_Evaporation_PenmanMonteith_V1| are more than twice as large as those</span>
<span class="sd">        of method |Calc_WaterEvaporation_V3|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import print_vector</span>
<span class="sd">        &gt;&gt;&gt; for hru in range(7):</span>
<span class="sd">        ...     deficit = (factors.saturationvapourpressure[hru] -</span>
<span class="sd">        ...                factors.actualvapourpressure[hru])</span>
<span class="sd">        ...     evap = model.return_evaporation_penmanmonteith_v1(</span>
<span class="sd">        ...         hru, factors.actualsurfaceresistance[hru])</span>
<span class="sd">        ...     energygain = fluxes.netradiation[hru] - fluxes.soilheatflux[hru]</span>
<span class="sd">        ...     print_vector([energygain, deficit, evap])</span>
<span class="sd">        0.0, 0.0, 0.0</span>
<span class="sd">        40.0, 0.0, 0.648881</span>
<span class="sd">        90.0, 0.0, 1.459982</span>
<span class="sd">        0.0, 0.0, 0.0</span>
<span class="sd">        0.0, 6.0, 2.031724</span>
<span class="sd">        0.0, 12.0, 4.063447</span>
<span class="sd">        90.0, 12.0, 5.523429</span>

<span class="sd">        Next, we repeat the above calculations using resistances suitable for vegetated</span>
<span class="sd">        surfaces (note that this also changes the results of the first three response</span>
<span class="sd">        units due to correction factor `C` depending on |AerodynamicResistance|):</span>

<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance = 80.0</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance = 40.0</span>
<span class="sd">        &gt;&gt;&gt; for hru in range(7):</span>
<span class="sd">        ...     deficit = (factors.saturationvapourpressure[hru] -</span>
<span class="sd">        ...                factors.actualvapourpressure[hru])</span>
<span class="sd">        ...     evap = model.return_evaporation_penmanmonteith_v1(</span>
<span class="sd">        ...         hru, factors.actualsurfaceresistance[hru])</span>
<span class="sd">        ...     energygain = fluxes.netradiation[hru] - fluxes.soilheatflux[hru]</span>
<span class="sd">        ...     print_vector([energygain, deficit, evap])</span>
<span class="sd">        0.0, 0.0, 0.0</span>
<span class="sd">        40.0, 0.0, 0.364933</span>
<span class="sd">        90.0, 0.0, 0.8211</span>
<span class="sd">        0.0, 0.0, 0.0</span>
<span class="sd">        0.0, 6.0, 2.469986</span>
<span class="sd">        0.0, 12.0, 4.939972</span>
<span class="sd">        90.0, 12.0, 5.761072</span>

<span class="sd">        The above results are sensitive to the ratio between |ActualSurfaceResistance|</span>
<span class="sd">        and |AerodynamicResistance|.  The following example demonstrates this</span>
<span class="sd">        sensitivity through varying |ActualSurfaceResistance| over a wide range:</span>

<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 100.0</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance = (</span>
<span class="sd">        ...     0.0, 20.0, 50.0, 100.0, 200.0, 500.0, 1000.0)</span>
<span class="sd">        &gt;&gt;&gt; for hru in range(7):</span>
<span class="sd">        ...     print_vector([factors.actualsurfaceresistance[hru],</span>
<span class="sd">        ...                   model.return_evaporation_penmanmonteith_v1(</span>
<span class="sd">        ...                       hru, factors.actualsurfaceresistance[hru])])</span>
<span class="sd">        0.0, 11.370311</span>
<span class="sd">        20.0, 9.144449</span>
<span class="sd">        50.0, 7.068767</span>
<span class="sd">        100.0, 5.128562</span>
<span class="sd">        200.0, 3.31099</span>
<span class="sd">        500.0, 1.604779</span>
<span class="sd">        1000.0, 0.863312</span>

<span class="sd">        One potential pitfall of the given Penman-Monteith equation is that</span>
<span class="sd">        |AerodynamicResistance| becomes infinite for zero wind speed.  We protect</span>
<span class="sd">        method |Return_Evaporation_PenmanMonteith_V1| against this problem (and the</span>
<span class="sd">        less likely problem of zero aerodynamic resistance) by limiting the value of</span>
<span class="sd">        |AerodynamicResistance| to the interval :math:`[10^{-6}, 10^6]`:</span>

<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 6.0</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance = 80.0</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance = (0.0, 1e-6, 1e-3, 1.0, 1e3, 1e6, inf)</span>
<span class="sd">        &gt;&gt;&gt; for hru in range(7):</span>
<span class="sd">        ...     print_vector([factors.aerodynamicresistance[hru],</span>
<span class="sd">        ...                   model.return_evaporation_penmanmonteith_v1(</span>
<span class="sd">        ...                       hru, factors.actualsurfaceresistance[hru])])</span>
<span class="sd">        0.0, 5.00683</span>
<span class="sd">        0.000001, 5.00683</span>
<span class="sd">        0.001, 5.006739</span>
<span class="sd">        1.0, 4.918573</span>
<span class="sd">        1000.0, 0.887816</span>
<span class="sd">        1000000.0, 0.001372</span>
<span class="sd">        inf, 0.001372</span>

<span class="sd">        Now, we change the simulation time step from one day to one hour to demonstrate</span>
<span class="sd">        that we can reproduce the first example&#39;s results:</span>

<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1h&quot;)</span>
<span class="sd">        &gt;&gt;&gt; fixed.heatofcondensation.restore()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 10.0, 50.0, 100.0, 10.0, 10.0, 10.0, 100.0</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 12.0, 12.0, 12.0, 12.0, 6.0, 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance = 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance = 106.0</span>
<span class="sd">        &gt;&gt;&gt; for hru in range(7):</span>
<span class="sd">        ...     deficit = (factors.saturationvapourpressure[hru] -</span>
<span class="sd">        ...                factors.actualvapourpressure[hru])</span>
<span class="sd">        ...     evap = 24.0 * model.return_evaporation_penmanmonteith_v1(</span>
<span class="sd">        ...         hru, factors.actualsurfaceresistance[hru])</span>
<span class="sd">        ...     energygain = fluxes.netradiation[hru] - fluxes.soilheatflux[hru]</span>
<span class="sd">        ...     print_vector([energygain, deficit, evap])</span>
<span class="sd">        0.0, 0.0, 0.0</span>
<span class="sd">        40.0, 0.0, 0.648881</span>
<span class="sd">        90.0, 0.0, 1.459982</span>
<span class="sd">        0.0, 0.0, 0.0</span>
<span class="sd">        0.0, 6.0, 2.031724</span>
<span class="sd">        0.0, 12.0, 4.063447</span>
<span class="sd">        90.0, 12.0, 5.523429</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">Emissivity</span><span class="p">,)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">StefanBoltzmannConstant</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatOfCondensation</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatCapacityAir</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirDensity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AerodynamicResistance</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">actualsurfaceresistance</span><span class="p">:</span> <span class="nb">float</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fix</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">fixed</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">ar</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">aerodynamicresistance</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mf">1e-6</span><span class="p">),</span> <span class="mf">1e6</span><span class="p">)</span>
        <span class="n">t</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">273.15</span> <span class="o">+</span> <span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">b</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">emissivity</span> <span class="o">*</span> <span class="n">fix</span><span class="o">.</span><span class="n">stefanboltzmannconstant</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">3</span>
        <span class="n">c</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">ar</span> <span class="o">/</span> <span class="n">fac</span><span class="o">.</span><span class="n">airdensity</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">fix</span><span class="o">.</span><span class="n">heatcapacityair</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressureslope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">netradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">soilheatflux</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="o">+</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">fac</span><span class="o">.</span><span class="n">airdensity</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">fix</span><span class="o">.</span><span class="n">heatcapacityair</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">fac</span><span class="o">.</span><span class="n">actualvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="o">/</span> <span class="n">ar</span>
            <span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressureslope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">fix</span><span class="o">.</span><span class="n">psychrometricconstant</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">actualsurfaceresistance</span> <span class="o">/</span> <span class="n">ar</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="o">/</span> <span class="n">fix</span><span class="o">.</span><span class="n">heatofcondensation</span>
        <span class="p">)</span></div>



<div class="viewcode-block" id="Return_Evaporation_PenmanMonteith_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Return_Evaporation_PenmanMonteith_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Return_Evaporation_PenmanMonteith_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the actual evapotranspiration with the Penman-Monteith equation</span>
<span class="sd">    according to :cite:t:`ref-Lpmeier2014`.</span>

<span class="sd">    Basic equation:</span>

<span class="sd">    .. math::</span>
<span class="sd">      f_{PM}(r_s) =</span>
<span class="sd">      \frac{P&#39;_s \cdot (R_n - G) + \rho \cdot c_p \cdot (P_s - P_a) / r_a}</span>
<span class="sd">      {H \cdot (P&#39;_s + \gamma \cdot (1 + r_s / r_a))} \\</span>
<span class="sd">      \\</span>
<span class="sd">      r_s = actualsurfaceresistance \\</span>
<span class="sd">      P&#39;_s = SaturationVapourPressureSlope  \\</span>
<span class="sd">      R_n = NetRadiation \\</span>
<span class="sd">      G = SoilHeatFlux \\</span>
<span class="sd">      \rho = AirDensitiy  \\</span>
<span class="sd">      c_p = HeatCapacityAir \\</span>
<span class="sd">      P_s = SaturationVapourPressure \\</span>
<span class="sd">      P_a = ActualVapourPressure \\</span>
<span class="sd">      r_a = AerodynamicResistance \\</span>
<span class="sd">      H = HeatOfCondensation \\</span>
<span class="sd">      \gamma = PsychrometricConstant</span>

<span class="sd">    Example:</span>

<span class="sd">        Method |Return_Evaporation_PenmanMonteith_V2| equals method</span>
<span class="sd">        |Return_Evaporation_PenmanMonteith_V1| except in neglecting the correction</span>
<span class="sd">        term `C`.  We repeat the examples of |Return_Evaporation_PenmanMonteith_V1| to</span>
<span class="sd">        demonstrate the effects of this difference:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(7)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 10.0, 50.0, 100.0, 10.0, 10.0, 10.0, 100.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux = 10.0</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressure = 12.0</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressureslope = 0.8</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 12.0, 12.0, 12.0, 12.0, 6.0, 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.airdensity = 1.24</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance = 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance = 106.0</span>

<span class="sd">        The estimated evapotranspiration values of method</span>
<span class="sd">        |Return_Evaporation_PenmanMonteith_V2| are slightly larger for the first three</span>
<span class="sd">        hydrological response units with pure energy forcing and smaller for response</span>
<span class="sd">        units four to six with pure dynamic forcing:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import print_vector</span>
<span class="sd">        &gt;&gt;&gt; for hru in range(7):</span>
<span class="sd">        ...     energygain = fluxes.netradiation[hru] - fluxes.soilheatflux[hru]</span>
<span class="sd">        ...     vapourdeficit = (factors.saturationvapourpressure[hru] -</span>
<span class="sd">        ...                      factors.actualvapourpressure[hru])</span>
<span class="sd">        ...     evap = model.return_evaporation_penmanmonteith_v2(</span>
<span class="sd">        ...         hru, factors.actualsurfaceresistance[hru])</span>
<span class="sd">        ...     print_vector([energygain, vapourdeficit, evap])</span>
<span class="sd">        0.0, 0.0, 0.0</span>
<span class="sd">        40.0, 0.0, 0.771689</span>
<span class="sd">        90.0, 0.0, 1.7363</span>
<span class="sd">        0.0, 0.0, 0.0</span>
<span class="sd">        0.0, 6.0, 1.701082</span>
<span class="sd">        0.0, 12.0, 3.402164</span>
<span class="sd">        90.0, 12.0, 5.138464</span>

<span class="sd">        This pattern stays the same using resistances suitable for vegetated surfaces:</span>

<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance = 80.0</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance = 40.0</span>
<span class="sd">        &gt;&gt;&gt; for hru in range(7):</span>
<span class="sd">        ...     energygain = fluxes.netradiation[hru] - fluxes.soilheatflux[hru]</span>
<span class="sd">        ...     vapourdeficit = (factors.saturationvapourpressure[hru] -</span>
<span class="sd">        ...                      factors.actualvapourpressure[hru])</span>
<span class="sd">        ...     evap = model.return_evaporation_penmanmonteith_v2(</span>
<span class="sd">        ...         hru, factors.actualsurfaceresistance[hru])</span>
<span class="sd">        ...     print_vector([energygain, vapourdeficit, evap])</span>
<span class="sd">        0.0, 0.0, 0.0</span>
<span class="sd">        40.0, 0.0, 0.406078</span>
<span class="sd">        90.0, 0.0, 0.913677</span>
<span class="sd">        0.0, 0.0, 0.0</span>
<span class="sd">        0.0, 6.0, 2.372133</span>
<span class="sd">        0.0, 12.0, 4.744266</span>
<span class="sd">        90.0, 12.0, 5.657942</span>

<span class="sd">        The following example shows that |Return_Evaporation_PenmanMonteith_V2| also</span>
<span class="sd">        restricts the aerodynamic resistance to the interval :math:`[10^{-6}, 10^6]` and</span>
<span class="sd">        that the missing `C` term prevents the estimated evapotranspiration from</span>
<span class="sd">        converging to zero with rising aerodynamic resistance:</span>

<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 100.0</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 6.0</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance = 80.0</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance = (0.0, 1e-6, 1e-3, 1.0, 1e3, 1e6, inf)</span>
<span class="sd">        &gt;&gt;&gt; for hru in range(7):</span>
<span class="sd">        ...     print_vector([factors.aerodynamicresistance[hru],</span>
<span class="sd">        ...                   model.return_evaporation_penmanmonteith_v2(</span>
<span class="sd">        ...                       hru, factors.actualsurfaceresistance[hru])])</span>
<span class="sd">        0.0, 5.00683</span>
<span class="sd">        0.000001, 5.00683</span>
<span class="sd">        0.001, 5.006739</span>
<span class="sd">        1.0, 4.91847</span>
<span class="sd">        1000.0, 1.849989</span>
<span class="sd">        1000000.0, 1.736417</span>
<span class="sd">        inf, 1.736417</span>

<span class="sd">        Now, we change the simulation time step from one day to one hour to demonstrate</span>
<span class="sd">        that we can reproduce the first example&#39;s results:</span>

<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1h&quot;)</span>
<span class="sd">        &gt;&gt;&gt; fixed.heatofcondensation.restore()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 10.0, 50.0, 100.0, 10.0, 10.0, 10.0, 100.0</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 12.0, 12.0, 12.0, 12.0, 6.0, 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance = 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance = 106.0</span>
<span class="sd">        &gt;&gt;&gt; for hru in range(7):</span>
<span class="sd">        ...     energygain = fluxes.netradiation[hru] - fluxes.soilheatflux[hru]</span>
<span class="sd">        ...     vapourdeficit = (factors.saturationvapourpressure[hru] -</span>
<span class="sd">        ...                      factors.actualvapourpressure[hru])</span>
<span class="sd">        ...     evap = 24.0 * model.return_evaporation_penmanmonteith_v2(</span>
<span class="sd">        ...         hru, factors.actualsurfaceresistance[hru])</span>
<span class="sd">        ...     print_vector([energygain, vapourdeficit, evap])</span>
<span class="sd">        0.0, 0.0, 0.0</span>
<span class="sd">        40.0, 0.0, 0.771689</span>
<span class="sd">        90.0, 0.0, 1.7363</span>
<span class="sd">        0.0, 0.0, 0.0</span>
<span class="sd">        0.0, 6.0, 1.701082</span>
<span class="sd">        0.0, 12.0, 3.402164</span>
<span class="sd">        90.0, 12.0, 5.138464</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatOfCondensation</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatCapacityAir</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirDensity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AerodynamicResistance</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">actualsurfaceresistance</span><span class="p">:</span> <span class="nb">float</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">fix</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">fixed</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">ar</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">aerodynamicresistance</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mf">1e-6</span><span class="p">),</span> <span class="mf">1e6</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressureslope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">netradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">soilheatflux</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="o">+</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">airdensity</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">fix</span><span class="o">.</span><span class="n">heatcapacityair</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">fac</span><span class="o">.</span><span class="n">actualvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="o">/</span> <span class="n">ar</span>
            <span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressureslope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">fix</span><span class="o">.</span><span class="n">psychrometricconstant</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">actualsurfaceresistance</span> <span class="o">/</span> <span class="n">ar</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span> <span class="o">/</span> <span class="n">fix</span><span class="o">.</span><span class="n">heatofcondensation</span></div>



<div class="viewcode-block" id="Calc_ReferenceEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_ReferenceEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_ReferenceEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the reference evapotranspiration constant according to</span>
<span class="sd">    :cite:t:`ref-Allen1998`.</span>

<span class="sd">    Basic equation (:cite:t:`ref-Allen1998`, equation 6):</span>
<span class="sd">      :math:`ReferenceEvapotranspiration =</span>
<span class="sd">      \frac{</span>
<span class="sd">      0.408 \cdot SaturationVapourPressureSlope \cdot (NetRadiation - SoilHeatFlux) +</span>
<span class="sd">      PsychrometricConstant \cdot</span>
<span class="sd">      \frac{37.5 \cdot Hours}{AirTemperature + 273}</span>
<span class="sd">      \cdot WindSpeed2m \cdot (SaturationVapourPressure - ActualVapourPressure)</span>
<span class="sd">      }</span>
<span class="sd">      {</span>
<span class="sd">      SaturationVapourPressureSlope +</span>
<span class="sd">      PsychrometricConstant \cdot (1 + 0.34 \cdot WindSpeed2m)</span>
<span class="sd">      }`</span>

<span class="sd">    Note that :cite:t:`ref-Allen1998` recommends the coefficient 37 for hourly</span>
<span class="sd">    simulations and 900 for daily simulations.  |Calc_ReferenceEvapotranspiration_V1|</span>
<span class="sd">    generally uses 37.5, which gives 900 when multiplied by 24.</span>

<span class="sd">    Example:</span>

<span class="sd">        The following calculation agrees with example 18 of :cite:t:`ref-Allen1998`,</span>
<span class="sd">        dealing with a daily simulation step:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(1)</span>
<span class="sd">        &gt;&gt;&gt; derived.days(1)</span>
<span class="sd">        &gt;&gt;&gt; derived.hours(24)</span>
<span class="sd">        &gt;&gt;&gt; factors.psychrometricconstant = 0.666</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 16.9</span>
<span class="sd">        &gt;&gt;&gt; factors.windspeed2m = 2.078</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 14.09</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressure = 19.97</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressureslope = 1.22</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 153.7037</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux = 0.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_referenceevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.referenceevapotranspiration</span>
<span class="sd">        referenceevapotranspiration(3.877117)</span>

<span class="sd">        The following calculation agrees with example 19 of :cite:t:`ref-Allen1998`,</span>
<span class="sd">        dealing with an hourly simulation step (note that there is a  difference due to</span>
<span class="sd">        using 37.5 instead of 37, which is smaller than the precision of the results</span>
<span class="sd">        tabulated by :cite:t:`ref-Allen1998`:</span>

<span class="sd">        &gt;&gt;&gt; derived.days(1/24)</span>
<span class="sd">        &gt;&gt;&gt; derived.hours(1)</span>
<span class="sd">        &gt;&gt;&gt; factors.psychrometricconstant = 0.673</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 38.0</span>
<span class="sd">        &gt;&gt;&gt; factors.windspeed2m = 3.3</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 34.45</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressure = 66.25</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressureslope = 3.58</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 485.8333</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux = 48.6111</span>
<span class="sd">        &gt;&gt;&gt; model.calc_referenceevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.referenceevapotranspiration</span>
<span class="sd">        referenceevapotranspiration(0.629106)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">Days</span><span class="p">,</span> <span class="n">evap_derived</span><span class="o">.</span><span class="n">Hours</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">WindSpeed2m</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ReferenceEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">referenceevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="mf">0.0352512</span>
                <span class="o">*</span> <span class="n">der</span><span class="o">.</span><span class="n">days</span>
                <span class="o">*</span> <span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressureslope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">netradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">soilheatflux</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="o">+</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">psychrometricconstant</span> <span class="o">*</span> <span class="mf">3.75</span> <span class="o">*</span> <span class="n">der</span><span class="o">.</span><span class="n">hours</span><span class="p">)</span>
                <span class="o">/</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mf">273.0</span><span class="p">)</span>
                <span class="o">*</span> <span class="n">fac</span><span class="o">.</span><span class="n">windspeed2m</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">fac</span><span class="o">.</span><span class="n">actualvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">saturationvapourpressureslope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">fac</span><span class="o">.</span><span class="n">psychrometricconstant</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.34</span> <span class="o">*</span> <span class="n">fac</span><span class="o">.</span><span class="n">windspeed2m</span><span class="p">)</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_ReferenceEvapotranspiration_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_ReferenceEvapotranspiration_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_ReferenceEvapotranspiration_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate reference evapotranspiration after Turc-Wendling.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`ReferenceEvapotranspiration =</span>
<span class="sd">      \frac{(8.64 \cdot GlobalRadiation + 93 \cdot CoastFactor) \cdot</span>
<span class="sd">      (AirTemperature + 22)}</span>
<span class="sd">      {165 \cdot (AirTemperature + 123) \cdot</span>
<span class="sd">      (1 + 0.00019 \cdot min(Altitude, 600))}`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; coastfactor(0.6)</span>
<span class="sd">        &gt;&gt;&gt; hrualtitude(200.0, 600.0, 1000.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 15.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.globalradiation = 200.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_referenceevapotranspiration_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.referenceevapotranspiration</span>
<span class="sd">        referenceevapotranspiration(2.792463, 2.601954, 2.601954)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUAltitude</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">CoastFactor</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span> <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">GlobalRadiation</span><span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ReferenceEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">referenceevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="mf">8.64</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">globalradiation</span> <span class="o">+</span> <span class="mf">93.0</span> <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">coastfactor</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mf">22.0</span><span class="p">)</span>
            <span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                <span class="mf">165.0</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mf">123.0</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.00019</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">hrualtitude</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mf">600.0</span><span class="p">))</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_ReferenceEvapotranspiration_V3">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_ReferenceEvapotranspiration_V3">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_ReferenceEvapotranspiration_V3</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Take the input reference evapotranspiration for each hydrological response</span>
<span class="sd">    unit.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`ReferenceEvapotranspiration_{fluxes} =</span>
<span class="sd">      ReferenceEvapotranspiration_{inputs}`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; inputs.referenceevapotranspiration = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_referenceevapotranspiration_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.referenceevapotranspiration</span>
<span class="sd">        referenceevapotranspiration(2.0, 2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_inputs</span><span class="o">.</span><span class="n">ReferenceEvapotranspiration</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ReferenceEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">referenceevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">referenceevapotranspiration</span></div>



<div class="viewcode-block" id="Calc_ReferenceEvapotranspiration_PETModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_ReferenceEvapotranspiration_PETModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_ReferenceEvapotranspiration_PETModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |PETModel_V1| interface calculate the</span>
<span class="sd">    reference evapotranspiration.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use |evap_ret_tw2002| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_pet_mlc import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; hruarea(0.5, 0.3, 0.2)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_retmodel_v1(&quot;evap_ret_tw2002&quot;):</span>
<span class="sd">        ...     hrualtitude(200.0, 600.0, 1000.0)</span>
<span class="sd">        ...     coastfactor(0.6)</span>
<span class="sd">        ...     evapotranspirationfactor(1.1)</span>
<span class="sd">        ...     fluxes.globalradiation = 200.0</span>
<span class="sd">        ...     with model.add_tempmodel_v2(&quot;meteo_temp_io&quot;):</span>
<span class="sd">        ...         temperatureaddend(1.0)</span>
<span class="sd">        ...         inputs.temperature = 14.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_referenceevapotranspiration_v4()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.referenceevapotranspiration</span>
<span class="sd">        referenceevapotranspiration(3.07171, 2.86215, 2.86215)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ReferenceEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">submodel</span><span class="o">.</span><span class="n">determine_potentialevapotranspiration</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">referenceevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">submodel</span><span class="o">.</span><span class="n">get_potentialevapotranspiration</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_ReferenceEvapotranspiration_V4">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_ReferenceEvapotranspiration_V4">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_ReferenceEvapotranspiration_V4</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |PETModel_V1| interface calculate the</span>
<span class="sd">    reference evapotranspiration.&quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span><span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Calc_ReferenceEvapotranspiration_PETModel_V1</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ReferenceEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">retmodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_referenceevapotranspiration_petmodel_v1</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">retmodel</span><span class="p">)</span>
            <span class="p">)</span></div>

        <span class="c1"># ToDo:</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         assert_never(model.petmodel)</span>


<div class="viewcode-block" id="Calc_ReferenceEvapotranspiration_V5">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_ReferenceEvapotranspiration_V5">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_ReferenceEvapotranspiration_V5</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Adjust the normal evapotranspiration to the difference between actual air</span>
<span class="sd">    temperature and normal air temperature :cite:p:`ref-Lindstrom1997HBV96`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`ReferenceEvapotranspiration = NormalEvapotranspiration \cdot</span>
<span class="sd">      (1 + AirTemperatureFactor \cdot (MeanAirTemperature - NormalAirTemperature))`</span>

<span class="sd">    Restriction:</span>
<span class="sd">      :math:`0 \leq ReferenceEvapotranspiration \leq 2 \cdot NormalEvapotranspiration`</span>

<span class="sd">    Examples:</span>

<span class="sd">        We prepare four hydrological response units with different values for the</span>
<span class="sd">        |AirTemperatureFactor| (the negative value of the first unit is not meaningful</span>
<span class="sd">        but applied for illustration):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;12h&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(4)</span>
<span class="sd">        &gt;&gt;&gt; airtemperaturefactor(-0.5, 0.0, 0.1, 0.5)</span>
<span class="sd">        &gt;&gt;&gt; inputs.normalairtemperature = 20.0</span>
<span class="sd">        &gt;&gt;&gt; inputs.normalevapotranspiration = 2.0</span>

<span class="sd">        With actual temperature equal to normal temperature, actual (uncorrected)</span>
<span class="sd">        evapotranspiration equals normal evapotranspiration:</span>

<span class="sd">        &gt;&gt;&gt; factors.meanairtemperature = 20.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_referenceevapotranspiration_v5()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.referenceevapotranspiration</span>
<span class="sd">        referenceevapotranspiration(2.0, 2.0, 2.0, 2.0)</span>

<span class="sd">        For an actual temperature of 5 C higher than normal, reference</span>
<span class="sd">        evapotranspiration is increased by 1 mm for the third unit.  For the first</span>
<span class="sd">        unit, reference evapotranspiration is 0 mm (the smallest value allowed), and</span>
<span class="sd">        for the fourth unit, it is the doubled normal value (the largest value</span>
<span class="sd">        allowed):</span>

<span class="sd">        &gt;&gt;&gt; factors.meanairtemperature  = 25.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_referenceevapotranspiration_v5()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.referenceevapotranspiration</span>
<span class="sd">        referenceevapotranspiration(0.0, 2.0, 3.0, 4.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">AirTemperatureFactor</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_inputs</span><span class="o">.</span><span class="n">NormalEvapotranspiration</span><span class="p">,</span>
        <span class="n">evap_inputs</span><span class="o">.</span><span class="n">NormalAirTemperature</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">MeanAirTemperature</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ReferenceEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">referenceevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">normalevapotranspiration</span> <span class="o">*</span> <span class="p">(</span>
                <span class="mf">1.0</span>
                <span class="o">+</span> <span class="n">con</span><span class="o">.</span><span class="n">airtemperaturefactor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">meanairtemperature</span> <span class="o">-</span> <span class="n">inp</span><span class="o">.</span><span class="n">normalairtemperature</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">referenceevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                <span class="nb">max</span><span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">referenceevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">),</span>
                <span class="mf">2.0</span> <span class="o">*</span> <span class="n">inp</span><span class="o">.</span><span class="n">normalevapotranspiration</span><span class="p">,</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_PotentialEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate month-specific potential evaporation based on reference</span>
<span class="sd">    evapotranspiration.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`PotentialEvapotranspiration = MonthFactor \cdot</span>
<span class="sd">      ReferenceEvapotranspiration`</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub, UnitTest</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &#39;2000-03-30&#39;, &#39;2000-04-03&#39;, &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; monthfactor.mar = 0.5</span>
<span class="sd">        &gt;&gt;&gt; monthfactor.apr = 2.0</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.referenceevapotranspiration = 1.0, 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&#39;2000-03-31&#39;]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialevapotranspiration</span>
<span class="sd">        potentialevapotranspiration(0.5, 1.0)</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&#39;2000-04-01&#39;]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialevapotranspiration</span>
<span class="sd">        potentialevapotranspiration(2.0, 4.0)</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">MonthFactor</span><span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ReferenceEvapotranspiration</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">monthfactor</span><span class="p">[</span>
                <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_monthfactor_entrymin</span>
            <span class="p">]</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">potentialevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">factor</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">referenceevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_PotentialEvapotranspiration_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialEvapotranspiration_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialEvapotranspiration_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate month- and land cover-specific potential evaporation based on</span>
<span class="sd">    reference evapotranspiration.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`PotentialEvapotranspiration = LandMonthFactor \cdot</span>
<span class="sd">      ReferenceEvapotranspiration`</span>

<span class="sd">    Examples:</span>

<span class="sd">        Base model |evap| does not define any land cover types by itself but takes the</span>
<span class="sd">        ones of the respective main model.  Here, we manually introduce the land cover</span>
<span class="sd">        types of grass, trees, and water to apply |evap| as a stand-alone model:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &#39;2000-03-30&#39;, &#39;2000-04-03&#39;, &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.core.parametertools import Constants</span>
<span class="sd">        &gt;&gt;&gt; GRASS, TREES, WATER = 1, 2, 3</span>
<span class="sd">        &gt;&gt;&gt; constants = Constants(GRASS=GRASS, TREES=TREES, WATER=WATER)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap.evap_control import HRUType, LandMonthFactor</span>
<span class="sd">        &gt;&gt;&gt; with HRUType.modify_constants(constants), \</span>
<span class="sd">        ...         LandMonthFactor.modify_rows(constants):</span>
<span class="sd">        ...     from hydpy.models.evap import *</span>
<span class="sd">        ...     parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; hrutype(TREES, WATER)</span>
<span class="sd">        &gt;&gt;&gt; landmonthfactor.trees_mar = 1.0</span>
<span class="sd">        &gt;&gt;&gt; landmonthfactor.trees_apr = 2.0</span>
<span class="sd">        &gt;&gt;&gt; landmonthfactor.water_mar = 0.5</span>
<span class="sd">        &gt;&gt;&gt; landmonthfactor.water_apr = 2.0</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.referenceevapotranspiration = 1.0, 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&#39;2000-03-31&#39;]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialevapotranspiration_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialevapotranspiration</span>
<span class="sd">        potentialevapotranspiration(1.0, 1.0)</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&#39;2000-04-01&#39;]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialevapotranspiration_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialevapotranspiration</span>
<span class="sd">        potentialevapotranspiration(2.0, 4.0)</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LandMonthFactor</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ReferenceEvapotranspiration</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">landmonthfactor</span><span class="p">[</span>
                <span class="n">con</span><span class="o">.</span><span class="n">hrutype</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_landmonthfactor_rowmin</span><span class="p">,</span>
                <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">_landmonthfactor_columnmin</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">potentialevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">factor</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">referenceevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_PotentialEvapotranspiration_V3">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialEvapotranspiration_V3">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialEvapotranspiration_V3</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Apply the altitude- and precipitation-related adjustment factors on reference</span>
<span class="sd">    evapotranspiration to determine potential evapotranspiration</span>
<span class="sd">    :cite:p:`ref-Lindstrom1997HBV96`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        PotentialEvapotranspiration = ReferenceEvapotranspiration \cdot</span>
<span class="sd">        \left(1 + AltitudeFactor \cdot \frac{HRUAltitude - Altitude}{100} \right) \cdot</span>
<span class="sd">        exp(-PrecipitationFactor \cdot Precipitation)</span>

<span class="sd">    Examples:</span>

<span class="sd">        Three hydrological response units are at an altitude of 300 m (but the entire</span>
<span class="sd">        basin&#39;s mean altitude is 200 m, for illustration purposes).  A reference</span>
<span class="sd">        evapotranspiration value of 2 mm and a precipitation value of 5 mm are</span>
<span class="sd">        available at each unit:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;12h&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; hrualtitude(300.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.referenceevapotranspiration = 2.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.precipitation = 5.0</span>
<span class="sd">        &gt;&gt;&gt; derived.altitude(200.0)</span>

<span class="sd">        The first two units illustrate the individual altitude-related</span>
<span class="sd">        (|AltitudeFactor|, first unit) and the precipitation-related adjustments</span>
<span class="sd">        (|PrecipitationFactor|, second unit).  The third zone illustrates the</span>
<span class="sd">        interaction between both adjustments:</span>

<span class="sd">        &gt;&gt;&gt; import math</span>
<span class="sd">        &gt;&gt;&gt; altitudefactor(0.1, 0.0, 0.1)</span>
<span class="sd">        &gt;&gt;&gt; precipitationfactor(0.0, -math.log(0.7)/10.0, -math.log(0.7)/10.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialevapotranspiration_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialevapotranspiration</span>
<span class="sd">        potentialevapotranspiration(1.8, 1.4, 1.26)</span>

<span class="sd">        Method |Calc_PotentialEvapotranspiration_V3| performs truncations required to</span>
<span class="sd">        prevent negative potential evapotranspiration:</span>

<span class="sd">        &gt;&gt;&gt; altitudefactor(2.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialevapotranspiration_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialevapotranspiration</span>
<span class="sd">        potentialevapotranspiration(0.0, 0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">AltitudeFactor</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUAltitude</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">PrecipitationFactor</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">Altitude</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ReferenceEvapotranspiration</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">Precipitation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">potentialevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">referenceevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="mf">1.0</span>
                <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">altitudefactor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">hrualtitude</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">der</span><span class="o">.</span><span class="n">altitude</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">flu</span><span class="o">.</span><span class="n">potentialevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">potentialevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">potentialevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                    <span class="o">-</span><span class="n">con</span><span class="o">.</span><span class="n">precipitationfactor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">precipitation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="p">)</span></div>



<div class="viewcode-block" id="Update_PotentialEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_PotentialEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_PotentialEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Damp the given potential evapotranspiration and update the corresponding log</span>
<span class="sd">    sequence.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        E_{mod, new} = \omega \cdot E_{orig, new} + (1 - \omega) \cdot E_{mod, old}</span>
<span class="sd">        \\ \\</span>
<span class="sd">        \omega = DampingFactor \\</span>
<span class="sd">        E = PotentialEvapotranspiration</span>

<span class="sd">    Example:</span>

<span class="sd">        We prepare four hydrological response units with different combinations of</span>
<span class="sd">        damping factors and &quot;old&quot; potential evapotranspiration values:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;12h&quot;)</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(4)</span>
<span class="sd">        &gt;&gt;&gt; dampingfactor(2.0, 2.0, 0.2, 0.2)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialevapotranspiration = 1.6, 2.4, 1.6, 2.4</span>

<span class="sd">        Note that the time-dependent parameter value is reduced due to the difference</span>
<span class="sd">        between the given parameter and the simulation step:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(dampingfactor.values)</span>
<span class="sd">        1.0, 1.0, 0.1, 0.1</span>

<span class="sd">        The evaporation value of the last simulation step is 2.0 mm:</span>

<span class="sd">        &gt;&gt;&gt; logs.loggedpotentialevapotranspiration = 2.0</span>

<span class="sd">        For the first two hydrological response units, the &quot;old&quot; potential</span>
<span class="sd">        evapotranspiration is modified by -0.4 mm and +0.4 mm, respectively.  For the</span>
<span class="sd">        other two response units, which weigh the &quot;new&quot; value with 10 %, the new value</span>
<span class="sd">        deviates from its logged counterpart only by -0.04 mm and +0.04 mm:</span>

<span class="sd">        &gt;&gt;&gt; model.update_potentialevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialevapotranspiration</span>
<span class="sd">        potentialevapotranspiration(1.6, 2.4, 1.96, 2.04)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedpotentialevapotranspiration</span>
<span class="sd">        loggedpotentialevapotranspiration(1.6, 2.4, 1.96, 2.04)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">DampingFactor</span><span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialEvapotranspiration</span><span class="p">,</span>
        <span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedPotentialEvapotranspiration</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">potentialevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">con</span><span class="o">.</span><span class="n">dampingfactor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">potentialevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">dampingfactor</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="o">*</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedpotentialevapotranspiration</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">loggedpotentialevapotranspiration</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">potentialevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Adjust_ReferenceEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Adjust_ReferenceEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Adjust_ReferenceEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Adjust the previously calculated reference evapotranspiration.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`ReferenceEvapotranspiration_{new} = EvapotranspirationFactor \cdot</span>
<span class="sd">      ReferenceEvapotranspiration_{old}`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; evapotranspirationfactor(0.5, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.referenceevapotranspiration = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.adjust_referenceevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.referenceevapotranspiration</span>
<span class="sd">        referenceevapotranspiration(1.0, 4.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">EvapotranspirationFactor</span><span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ReferenceEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">referenceevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="n">con</span><span class="o">.</span><span class="n">evapotranspirationfactor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Calc_MeanReferenceEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_MeanReferenceEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_MeanReferenceEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the average reference evapotranspiration.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`MeanReferenceEvapotranspiration =</span>
<span class="sd">      \sum_{i=1}^{NmbHRU} HRUAreaFraction_i \cdot ReferenceEvapotranspiration_i`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; derived.hruareafraction(0.8, 0.2)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.referenceevapotranspiration = 1.0, 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_meanreferenceevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.meanreferenceevapotranspiration</span>
<span class="sd">        meanreferenceevapotranspiration(1.2)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">HRUAreaFraction</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ReferenceEvapotranspiration</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">MeanReferenceEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">flu</span><span class="o">.</span><span class="n">meanreferenceevapotranspiration</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">meanreferenceevapotranspiration</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">der</span><span class="o">.</span><span class="n">hruareafraction</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">referenceevapotranspiration</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_MeanPotentialEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_MeanPotentialEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_MeanPotentialEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the average potential evapotranspiration.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`MeanPotentialEvapotranspiration =</span>
<span class="sd">      \sum_{i=1}^{NmbHRU} HRUAreaFraction_i \cdot PotentialEvapotranspiration_i`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; derived.hruareafraction(0.8, 0.2)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialevapotranspiration = 1.0, 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_meanpotentialevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.meanpotentialevapotranspiration</span>
<span class="sd">        meanpotentialevapotranspiration(1.2)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">HRUAreaFraction</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialEvapotranspiration</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">MeanPotentialEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">flu</span><span class="o">.</span><span class="n">meanpotentialevapotranspiration</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">meanpotentialevapotranspiration</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">der</span><span class="o">.</span><span class="n">hruareafraction</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">potentialevapotranspiration</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_PotentialWaterEvaporation_PETModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialWaterEvaporation_PETModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialWaterEvaporation_PETModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the already calculated potential evapotranspiration from a submodel that</span>
<span class="sd">    complies with the |PETModel_V1| interface and assume it to be water evaporation.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use |evap_aet_minhas| and |evap_ret_io| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_minhas import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_petmodel_v1(&quot;evap_ret_io&quot;):</span>
<span class="sd">        ...     hruarea(1.0, 3.0, 2.0)</span>
<span class="sd">        ...     fluxes.referenceevapotranspiration = 1.0, 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialwaterevaporation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialwaterevaporation</span>
<span class="sd">        potentialwaterevaporation(1.0, 2.0, 4.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialWaterEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">potentialwaterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">submodel</span><span class="o">.</span><span class="n">get_potentialevapotranspiration</span><span class="p">(</span>
                <span class="n">k</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_PotentialWaterEvaporation_PETModel_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialWaterEvaporation_PETModel_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialWaterEvaporation_PETModel_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |PETModel_V2| interface calculate</span>
<span class="sd">    potential water evaporation and query it.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use |evap_aet_minhas| and |evap_pet_ambav1| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-01-01&quot;, &quot;2000-01-02&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_minhas import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; interception(False, False, True)</span>
<span class="sd">        &gt;&gt;&gt; soil(False, False, True)</span>
<span class="sd">        &gt;&gt;&gt; water(True, True, False)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_petmodel_v2(&quot;evap_pet_ambav1&quot;):</span>
<span class="sd">        ...     hrutype(0)</span>
<span class="sd">        ...     plant(False)</span>
<span class="sd">        ...     measuringheightwindspeed(10.0)</span>
<span class="sd">        ...     groundalbedo(0.2)</span>
<span class="sd">        ...     groundalbedosnow(0.8)</span>
<span class="sd">        ...     leafalbedo(0.2)</span>
<span class="sd">        ...     leafalbedosnow(0.8)</span>
<span class="sd">        ...     leafareaindex(5.0)</span>
<span class="sd">        ...     cropheight(0.0)</span>
<span class="sd">        ...     cloudtypefactor(0.2)</span>
<span class="sd">        ...     nightcloudfactor(1.0)</span>
<span class="sd">        ...     inputs.relativehumidity = 80.0</span>
<span class="sd">        ...     inputs.windspeed = 2.0</span>
<span class="sd">        ...     inputs.atmosphericpressure = 1000.0</span>
<span class="sd">        ...     factors.sunshineduration = 6.0</span>
<span class="sd">        ...     factors.possiblesunshineduration = 16.0</span>
<span class="sd">        ...     fluxes.globalradiation = 190.0</span>
<span class="sd">        ...     with model.add_tempmodel_v2(&quot;meteo_temp_io&quot;):</span>
<span class="sd">        ...         hruarea(1.0)</span>
<span class="sd">        ...         temperatureaddend(0.0, 15.0, 0.0)</span>
<span class="sd">        ...         inputs.temperature = 15.0</span>
<span class="sd">        ...     with model.add_precipmodel_v2(&quot;meteo_precip_io&quot;):</span>
<span class="sd">        ...         hruarea(1.0)</span>
<span class="sd">        ...         precipitationfactor(1.0)</span>
<span class="sd">        ...         inputs.precipitation = 0.0</span>
<span class="sd">        ...     with model.add_snowcovermodel_v1(&quot;dummy_snowcover&quot;):</span>
<span class="sd">        ...         inputs.snowcover = 0.0</span>

<span class="sd">        &gt;&gt;&gt; model.petmodel.determine_potentialinterceptionevaporation()</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialwaterevaporation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialwaterevaporation</span>
<span class="sd">        potentialwaterevaporation(1.890672, 3.204855, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialWaterEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">submodel</span><span class="o">.</span><span class="n">determine_potentialwaterevaporation</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">potentialwaterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">submodel</span><span class="o">.</span><span class="n">get_potentialwaterevaporation</span><span class="p">(</span><span class="n">k</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_PotentialWaterEvaporation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialWaterEvaporation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialWaterEvaporation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Use a submodel that complies with the |PETModel_V1| or |PETModel_V2| interface</span>
<span class="sd">    to determine potential soil evapotranspiration.&quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span><span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span> <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V2</span><span class="p">)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_PotentialWaterEvaporation_PETModel_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialWaterEvaporation_PETModel_V2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialWaterEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">petmodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_potentialwaterevaporation_petmodel_v1</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">petmodel</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">petmodel_typeid</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_potentialwaterevaporation_petmodel_v2</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">petmodel</span><span class="p">)</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_WaterEvaporation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_WaterEvaporation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WaterEvaporation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the actual evaporation from water areas according to</span>
<span class="sd">    :cite:t:`ref-Lindstrom1997HBV96`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        WaterEvaporation =</span>
<span class="sd">        \begin{cases}</span>
<span class="sd">        PotentialWaterEvaporation &amp;|\ AirTemperature &gt; TemperatureThresholdIce</span>
<span class="sd">        \\</span>
<span class="sd">        0 &amp;|\ AirTemperature \leq TemperatureThresholdIce</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Example:</span>

<span class="sd">        The occurrence of an ice layer on the water&#39;s surface prohibits evaporation</span>
<span class="sd">        completely:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; water(True)</span>
<span class="sd">        &gt;&gt;&gt; temperaturethresholdice(1.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 0.0, 1.0, 2.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialwaterevaporation = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_waterevaporation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.waterevaporation</span>
<span class="sd">        waterevaporation(0.0, 0.0, 3.0)</span>

<span class="sd">        For non-water areas, water area evaporation is generally zero:</span>

<span class="sd">        &gt;&gt;&gt; water(False)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_waterevaporation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.waterevaporation</span>
<span class="sd">        waterevaporation(0.0, 0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Water</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">TemperatureThresholdIce</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialWaterEvaporation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">WaterEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">water</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">and</span> <span class="n">fac</span><span class="o">.</span><span class="n">airtemperature</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">con</span><span class="o">.</span><span class="n">temperaturethresholdice</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">waterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">potentialwaterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">waterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Calc_WaterEvaporation_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_WaterEvaporation_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WaterEvaporation_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Accept potential evaporation from water areas as the actual one.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`WaterEvaporation = PotentialWaterEvaporation`</span>

<span class="sd">    Example:</span>

<span class="sd">        For non-water areas, water area evaporation is generally zero:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; water(True, False)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialwaterevaporation = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_waterevaporation_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.waterevaporation</span>
<span class="sd">        waterevaporation(3.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">Water</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialWaterEvaporation</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">WaterEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">water</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">waterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">potentialwaterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">waterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Calc_WaterEvaporation_V3">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_WaterEvaporation_V3">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WaterEvaporation_V3</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the actual evaporation from water areas with the Penman equation</span>
<span class="sd">    according to :cite:t:`ref-LARSIM`, based on :cite:t:`ref-DVWK1996`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        WaterEvaporation = \frac{P&#39;_s\cdot R_n / H +</span>
<span class="sd">        Days \cdot \gamma\cdot (0.13 + 0.094 \cdot v) \cdot (P_s- P_a)}</span>
<span class="sd">        {P&#39;_s+ \gamma} \\</span>
<span class="sd">        \\</span>
<span class="sd">        P&#39;_s = DailySaturationVapourPressureSlope \\</span>
<span class="sd">        R_n = DailyNetRadiation \\</span>
<span class="sd">        H = HeatOfCondensation \\</span>
<span class="sd">        \gamma  = PsychrometricConstant \\</span>
<span class="sd">        v = DailyWindSpeed2m \\</span>
<span class="sd">        P_s = DailySaturationVapourPressure \\</span>
<span class="sd">        P_a = DailyActualVapourPressure</span>

<span class="sd">    Examples:</span>

<span class="sd">        We initialise seven hydrological response units.  In response units one to</span>
<span class="sd">        three, evaporation is due to radiative forcing only.  In response units four to</span>
<span class="sd">        six, evaporation is due to aerodynamic forcing only.  Response unit seven shows</span>
<span class="sd">        the combined effect of both forces:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(7)</span>
<span class="sd">        &gt;&gt;&gt; water(True)</span>
<span class="sd">        &gt;&gt;&gt; derived.days.update()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailynetradiation = 0.0, 50.0, 100.0, 0.0, 0.0, 0.0, 100.0</span>
<span class="sd">        &gt;&gt;&gt; factors.dailywindspeed2m = 2.0</span>
<span class="sd">        &gt;&gt;&gt; factors.dailysaturationvapourpressure = 12.0</span>
<span class="sd">        &gt;&gt;&gt; factors.dailysaturationvapourpressureslope = 0.8</span>
<span class="sd">        &gt;&gt;&gt; factors.dailyactualvapourpressure = 12.0, 12.0, 12.0, 12.0, 6.0, 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_waterevaporation_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.waterevaporation</span>
<span class="sd">        waterevaporation(0.0, 0.964611, 1.929222, 0.0, 0.858928, 1.717856,</span>
<span class="sd">                         3.647077)</span>

<span class="sd">        The above results apply to a daily simulation time step.  The following example</span>
<span class="sd">        demonstrates that |Calc_WaterEvaporation_V3| calculates equivalent results for</span>
<span class="sd">        hourly time steps:</span>

<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1h&quot;)</span>
<span class="sd">        &gt;&gt;&gt; derived.days.update()</span>
<span class="sd">        &gt;&gt;&gt; fixed.heatofcondensation.restore()</span>
<span class="sd">        &gt;&gt;&gt; model.calc_waterevaporation_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.waterevaporation *= 24.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.waterevaporation</span>
<span class="sd">        waterevaporation(0.0, 0.964611, 1.929222, 0.0, 0.858928, 1.717856,</span>
<span class="sd">                         3.647077)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">Water</span><span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">Days</span><span class="p">,)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatOfCondensation</span><span class="p">,</span> <span class="n">evap_fixed</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailySaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailySaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyWindSpeed2m</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyNetRadiation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">WaterEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fix</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">fixed</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">water</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">waterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">dailysaturationvapourpressureslope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">dailynetradiation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="o">/</span> <span class="n">fix</span><span class="o">.</span><span class="n">heatofcondensation</span>
                    <span class="o">+</span> <span class="n">fix</span><span class="o">.</span><span class="n">psychrometricconstant</span>
                    <span class="o">*</span> <span class="n">der</span><span class="o">.</span><span class="n">days</span>
                    <span class="o">*</span> <span class="p">(</span><span class="mf">0.13</span> <span class="o">+</span> <span class="mf">0.094</span> <span class="o">*</span> <span class="n">fac</span><span class="o">.</span><span class="n">dailywindspeed2m</span><span class="p">)</span>
                    <span class="o">*</span> <span class="p">(</span>
                        <span class="n">fac</span><span class="o">.</span><span class="n">dailysaturationvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">-</span> <span class="n">fac</span><span class="o">.</span><span class="n">dailyactualvapourpressure</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">dailysaturationvapourpressureslope</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="o">+</span> <span class="n">fix</span><span class="o">.</span><span class="n">psychrometricconstant</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">waterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Calc_WaterEvaporation_V4">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_WaterEvaporation_V4">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WaterEvaporation_V4</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the evaporation from water areas by applying the Penman-Monteith</span>
<span class="sd">    equation with zero surface resistance.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        WaterEvaporation = \begin{cases}</span>
<span class="sd">        f_{PM}(0.0)  &amp;|\ Water</span>
<span class="sd">        \\</span>
<span class="sd">        0 &amp;|\ \overline{Water}</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Examples:</span>

<span class="sd">        Usually, one would not consider soil heat fluxes when calculating evaporation</span>
<span class="sd">        from water areas.  However, |Calc_WaterEvaporation_V4| takes |SoilHeatFlux|</span>
<span class="sd">        into account, so it should usually be set to zero beforehand. Due to</span>
<span class="sd">        considering it, the following results agree with the first example on method</span>
<span class="sd">        |Calc_PotentialInterceptionEvaporation_V2|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(7)</span>
<span class="sd">        &gt;&gt;&gt; water(True)</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressure = 12.0</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressureslope = 0.8</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 12.0, 12.0, 12.0, 12.0, 6.0, 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.airdensity = 1.24</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance = 106.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 10.0, 50.0, 100.0, 10.0, 10.0, 10.0, 100.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux = 10.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_waterevaporation_v4()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.waterevaporation</span>
<span class="sd">        waterevaporation(0.0, 0.771689, 1.7363, 0.0, 1.701082, 3.402164,</span>
<span class="sd">                         5.138464)</span>

<span class="sd">        Water evaporation is always zero for hydrological response units dealing with</span>
<span class="sd">        non-water areas:</span>

<span class="sd">        &gt;&gt;&gt; water(False)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_waterevaporation_v4()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.waterevaporation</span>
<span class="sd">        waterevaporation(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_Evaporation_PenmanMonteith_V2</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">Water</span><span class="p">)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatOfCondensation</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatCapacityAir</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirDensity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AerodynamicResistance</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">WaterEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">water</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">evap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">return_evaporation_penmanmonteith_v2</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">waterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">evap</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">waterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Update_LoggedWaterEvaporation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_LoggedWaterEvaporation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_LoggedWaterEvaporation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="c1"># pylint: disable=line-too-long</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log the water evaporation values of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        The following example shows that each new method call successively moves the</span>
<span class="sd">        six memorised values to the right and stores the respective two new values on</span>
<span class="sd">        the leftmost position:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedwaterevaporation.shape = 3, 2</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedwaterevaporation = 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(model,</span>
<span class="sd">        ...                 model.update_loggedwaterevaporation_v1,</span>
<span class="sd">        ...                 last_example=4,</span>
<span class="sd">        ...                 parseqs=(fluxes.waterevaporation,</span>
<span class="sd">        ...                          logs.loggedwaterevaporation))</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.waterevaporation = [1.0, 2.0], [3.0, 6.0], [2.0, 4.0], [4.0, 8.0]</span>
<span class="sd">        &gt;&gt;&gt; del test.inits.loggedwaterevaporation</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |      waterevaporation |                          loggedwaterevaporation |</span>
<span class="sd">        ---------------------------------------------------------------------------------</span>
<span class="sd">        |   1 | 1.0               2.0 | 1.0  2.0  0.0  0.0  0.0                     0.0 |</span>
<span class="sd">        |   2 | 3.0               6.0 | 3.0  6.0  1.0  2.0  0.0                     0.0 |</span>
<span class="sd">        |   3 | 2.0               4.0 | 2.0  4.0  3.0  6.0  1.0                     2.0 |</span>
<span class="sd">        |   4 | 4.0               8.0 | 4.0  8.0  2.0  4.0  3.0                     6.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">WaterEvaporation</span><span class="p">,)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedWaterEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="n">loggedwaterevaporation</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedwaterevaporation</span><span class="p">[</span>
                    <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span>
                <span class="p">]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">loggedwaterevaporation</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">waterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Calc_DailyWaterEvaporation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_DailyWaterEvaporation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DailyWaterEvaporation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the water evaporation sum of the last 24 hours.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; derived.nmblogentries(3)</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedwaterevaporation.shape = 3, 2</span>
<span class="sd">        &gt;&gt;&gt; logs.loggedwaterevaporation = [[1.0, 2.0], [5.0, 6.0], [3.0, 4.0]]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dailywaterevaporation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailywaterevaporation</span>
<span class="sd">        dailywaterevaporation(9.0, 12.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedWaterEvaporation</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyWaterEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">dailywaterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">nmblogentries</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">dailywaterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">log</span><span class="o">.</span><span class="n">loggedwaterevaporation</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Calc_InterceptionEvaporation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_InterceptionEvaporation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_InterceptionEvaporation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the actual interception evaporation by setting it equal to potential</span>
<span class="sd">    evapotranspiration.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        InterceptionEvaporation =</span>
<span class="sd">        \begin{cases}</span>
<span class="sd">        PotentialInterceptionEvaporation &amp;|\ InterceptedWater &gt; 0</span>
<span class="sd">        \\</span>
<span class="sd">        0 &amp;|\ InterceptedWater = 0</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Examples:</span>

<span class="sd">        The availability of intercepted water may restrict the possible interception</span>
<span class="sd">        evaporation:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(4)</span>
<span class="sd">        &gt;&gt;&gt; interception(True)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation(1.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.interceptedwater(1.5, 1.0, 0.5, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_interceptionevaporation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation</span>
<span class="sd">        interceptionevaporation(1.0, 1.0, 0.5, 0.0)</span>

<span class="sd">        Interception evaporation is always zero for hydrological response units not</span>
<span class="sd">        considering interception:</span>

<span class="sd">        &gt;&gt;&gt; interception(False)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_interceptionevaporation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation</span>
<span class="sd">        interceptionevaporation(0.0, 0.0, 0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">Interception</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">InterceptedWater</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">InterceptionEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">interception</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">interceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                    <span class="n">flu</span><span class="o">.</span><span class="n">potentialinterceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">fac</span><span class="o">.</span><span class="n">interceptedwater</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">interceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Calc_PotentialInterceptionEvaporation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialInterceptionEvaporation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialInterceptionEvaporation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the potential interception evaporation using an extended</span>
<span class="sd">    Penman-Monteith equation with zero surface resistance.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        PotentialInterceptionEvaporation = \begin{cases}</span>
<span class="sd">        f_{PM}(0.0)  &amp;|\ Interception</span>
<span class="sd">        \\</span>
<span class="sd">        0 &amp;|\ \overline{Interception}</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Examples:</span>

<span class="sd">        The following settings agree with the first example on method</span>
<span class="sd">        |Return_Evaporation_PenmanMonteith_V1|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(7)</span>
<span class="sd">        &gt;&gt;&gt; interception(True)</span>
<span class="sd">        &gt;&gt;&gt; emissivity(0.96)</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressure = 12.0</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressureslope = 0.8</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 12.0, 12.0, 12.0, 12.0, 6.0, 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.airdensity = 1.24</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance = 106.0</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 10.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 10.0, 50.0, 100.0, 10.0, 10.0, 10.0, 100.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux = 10.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialinterceptionevaporation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation</span>
<span class="sd">        potentialinterceptionevaporation(0.0, 0.648881, 1.459982, 0.0, 2.031724,</span>
<span class="sd">                                         4.063447, 5.523429)</span>

<span class="sd">        Interception evaporation is always zero for hydrological response units not</span>
<span class="sd">        considering interception:</span>

<span class="sd">        &gt;&gt;&gt; interception(False)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialinterceptionevaporation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation</span>
<span class="sd">        potentialinterceptionevaporation(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_Evaporation_PenmanMonteith_V1</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Interception</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Emissivity</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">StefanBoltzmannConstant</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatOfCondensation</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatCapacityAir</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirDensity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AerodynamicResistance</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">interception</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">potentialinterceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">return_evaporation_penmanmonteith_v1</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">potentialinterceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Calc_PotentialInterceptionEvaporation_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialInterceptionEvaporation_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialInterceptionEvaporation_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the potential interception evaporation by applying the Penman-Monteith</span>
<span class="sd">    equation with zero surface resistance.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        PotentialInterceptionEvaporation = \begin{cases}</span>
<span class="sd">        f_{PM}(0.0)  &amp;|\ Interception</span>
<span class="sd">        \\</span>
<span class="sd">        0 &amp;|\ \overline{Interception}</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Examples:</span>

<span class="sd">        The following settings agree with the first example on method</span>
<span class="sd">        |Return_Evaporation_PenmanMonteith_V2|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(7)</span>
<span class="sd">        &gt;&gt;&gt; interception(True)</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressure = 12.0</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressureslope = 0.8</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 12.0, 12.0, 12.0, 12.0, 6.0, 0.0, 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.airdensity = 1.24</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance = 106.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 10.0, 50.0, 100.0, 10.0, 10.0, 10.0, 100.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux = 10.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialinterceptionevaporation_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation</span>
<span class="sd">        potentialinterceptionevaporation(0.0, 0.771689, 1.7363, 0.0, 1.701082,</span>
<span class="sd">                                         3.402164, 5.138464)</span>

<span class="sd">        Interception evaporation is always zero for hydrological response units not</span>
<span class="sd">        considering interception:</span>

<span class="sd">        &gt;&gt;&gt; interception(False)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialinterceptionevaporation_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation</span>
<span class="sd">        potentialinterceptionevaporation(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_Evaporation_PenmanMonteith_V2</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">Interception</span><span class="p">)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatOfCondensation</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatCapacityAir</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirDensity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AerodynamicResistance</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">interception</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">evap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">return_evaporation_penmanmonteith_v2</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">potentialinterceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">evap</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">potentialinterceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Calc_PotentialInterceptionEvaporation_PETModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialInterceptionEvaporation_PETModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialInterceptionEvaporation_PETModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |PETModel_V1| interface calculate</span>
<span class="sd">    potential evapotranspiration and assume it as potential interception evaporation.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use |evap_aet_minhas| and |evap_ret_io| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_minhas import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_petmodel_v1(&quot;evap_ret_io&quot;):</span>
<span class="sd">        ...     hruarea(1.0, 3.0, 2.0)</span>
<span class="sd">        ...     evapotranspirationfactor(0.5, 1.0, 2.0)</span>
<span class="sd">        ...     inputs.referenceevapotranspiration = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialinterceptionevaporation_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation</span>
<span class="sd">        potentialinterceptionevaporation(1.0, 2.0, 4.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">submodel</span><span class="o">.</span><span class="n">determine_potentialevapotranspiration</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">potentialinterceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">submodel</span><span class="o">.</span><span class="n">get_potentialevapotranspiration</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_PotentialInterceptionEvaporation_PETModel_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialInterceptionEvaporation_PETModel_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialInterceptionEvaporation_PETModel_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |PETModel_V2| interface calculate</span>
<span class="sd">    potential interception evaporation and query it.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use |evap_aet_minhas| and |evap_pet_ambav1| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-01-01&quot;, &quot;2000-01-02&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_minhas import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; interception(False, True, True)</span>
<span class="sd">        &gt;&gt;&gt; soil(False, True, True)</span>
<span class="sd">        &gt;&gt;&gt; water(True, False, False)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_petmodel_v2(&quot;evap_pet_ambav1&quot;):</span>
<span class="sd">        ...     hrutype(0)</span>
<span class="sd">        ...     plant(True)</span>
<span class="sd">        ...     measuringheightwindspeed(10.0)</span>
<span class="sd">        ...     groundalbedo(0.2)</span>
<span class="sd">        ...     groundalbedosnow(0.8)</span>
<span class="sd">        ...     leafalbedo(0.2)</span>
<span class="sd">        ...     leafalbedosnow(0.8)</span>
<span class="sd">        ...     leafareaindex(5.0)</span>
<span class="sd">        ...     cropheight(10.0)</span>
<span class="sd">        ...     cloudtypefactor(0.2)</span>
<span class="sd">        ...     nightcloudfactor(1.0)</span>
<span class="sd">        ...     inputs.relativehumidity = 80.0</span>
<span class="sd">        ...     inputs.windspeed = 2.0</span>
<span class="sd">        ...     inputs.atmosphericpressure = 1000.0</span>
<span class="sd">        ...     factors.sunshineduration = 6.0</span>
<span class="sd">        ...     factors.possiblesunshineduration = 16.0</span>
<span class="sd">        ...     fluxes.globalradiation = 190.0</span>
<span class="sd">        ...     with model.add_tempmodel_v2(&quot;meteo_temp_io&quot;):</span>
<span class="sd">        ...         hruarea(1.0)</span>
<span class="sd">        ...         temperatureaddend(0.0)</span>
<span class="sd">        ...         inputs.temperature = 15.0</span>
<span class="sd">        ...     with model.add_precipmodel_v2(&quot;meteo_precip_io&quot;):</span>
<span class="sd">        ...         hruarea(1.0)</span>
<span class="sd">        ...         precipitationfactor(1.0)</span>
<span class="sd">        ...         inputs.precipitation = 0.0</span>
<span class="sd">        ...     with model.add_snowcovermodel_v1(&quot;dummy_snowcover&quot;):</span>
<span class="sd">        ...         inputs.snowcover = 0.0, 0.0, 1.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialinterceptionevaporation_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation</span>
<span class="sd">        potentialinterceptionevaporation(0.0, 3.301949, 1.146759)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">submodel</span><span class="o">.</span><span class="n">determine_potentialinterceptionevaporation</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">potentialinterceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">submodel</span><span class="o">.</span><span class="n">get_potentialinterceptionevaporation</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_PotentialInterceptionEvaporation_V3">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialInterceptionEvaporation_V3">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialInterceptionEvaporation_V3</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Use a submodel that complies with the |PETModel_V1| or |PETModel_V2| interface</span>
<span class="sd">    to determine evaporation from water areas.&quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span><span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span> <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V2</span><span class="p">)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_PotentialInterceptionEvaporation_PETModel_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialInterceptionEvaporation_PETModel_V2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">petmodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_potentialinterceptionevaporation_petmodel_v1</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">petmodel</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">petmodel_typeid</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_potentialinterceptionevaporation_petmodel_v2</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">petmodel</span><span class="p">)</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_InterceptionEvaporation_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_InterceptionEvaporation_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_InterceptionEvaporation_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the actual interception evaporation by setting it equal to potential</span>
<span class="sd">    interception evaporation.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        InterceptionEvaporation =</span>
<span class="sd">        \begin{cases}</span>
<span class="sd">        min(PotentialInterceptionEvaporation, \ InterceptedWater) &amp;|\</span>
<span class="sd">        Interception \land ( Tree \lor SnowCover = 0 )</span>
<span class="sd">        \\</span>
<span class="sd">        0 &amp;|\ \overline{Interception} \lor ( \overline{Tree} \land SnowCover &gt; 0 )</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Examples:</span>

<span class="sd">        We prepare two hydrological response units.  The first one is tree-like, while</span>
<span class="sd">        the second one is not:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; interception(True)</span>
<span class="sd">        &gt;&gt;&gt; tree(True, False)</span>
<span class="sd">        &gt;&gt;&gt; factors.interceptedwater = 1.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation = 1.0</span>

<span class="sd">        Without any snow cover, the vegetation type does not make a difference:</span>

<span class="sd">        &gt;&gt;&gt; factors.snowcover = 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.snowycanopy = 0.0, nan</span>
<span class="sd">        &gt;&gt;&gt; model.calc_interceptionevaporation_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation</span>
<span class="sd">        interceptionevaporation(1.0, 1.0)</span>

<span class="sd">        For tree-like vegetation, a snow layer (on the ground) does not affect</span>
<span class="sd">        interception evaporation.  For other vegetation types, even incomplete covering</span>
<span class="sd">        suppresses interception evaporation completely:</span>

<span class="sd">        &gt;&gt;&gt; factors.snowcover = 0.1</span>
<span class="sd">        &gt;&gt;&gt; model.calc_interceptionevaporation_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation</span>
<span class="sd">        interceptionevaporation(1.0, 0.0)</span>

<span class="sd">        For tree-like vegetation, snow interception (in the canopy) suppresses</span>
<span class="sd">        interception evaporation completely:</span>

<span class="sd">        &gt;&gt;&gt; factors.snowcover = 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.snowycanopy = 1.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_interceptionevaporation_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation</span>
<span class="sd">        interceptionevaporation(0.0, 1.0)</span>

<span class="sd">        The availability of intercepted water may restrict the possible interception</span>
<span class="sd">        evaporation:</span>

<span class="sd">        &gt;&gt;&gt; factors.snowycanopy = 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.interceptedwater = 0.5, 0.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_interceptionevaporation_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation</span>
<span class="sd">        interceptionevaporation(0.5, 0.0)</span>

<span class="sd">        Interception evaporation is always zero for hydrological response units not</span>
<span class="sd">        considering interception:</span>

<span class="sd">        &gt;&gt;&gt; interception(False)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_interceptionevaporation_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation</span>
<span class="sd">        interceptionevaporation(0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Interception</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Tree</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">InterceptedWater</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SnowCover</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SnowyCanopy</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">InterceptionEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">con</span><span class="o">.</span><span class="n">interception</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">tree</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">snowcover</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">))</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">tree</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">snowycanopy</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">))</span>
            <span class="p">):</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">interceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                    <span class="n">flu</span><span class="o">.</span><span class="n">potentialinterceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">fac</span><span class="o">.</span><span class="n">interceptedwater</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">interceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Calc_PotentialSoilEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialSoilEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialSoilEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the potential evapotranspiration from the soil by applying the</span>
<span class="sd">    Penman-Monteith equation with an actual surface resistance that does not consider</span>
<span class="sd">    the current soil moisture.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        PotentialSoilEvapotranspiration = \begin{cases}</span>
<span class="sd">        f_{PM}(ActualSurfaceResistance)  &amp;|\ Soil</span>
<span class="sd">        \\</span>
<span class="sd">        0 &amp;|\ \overline{Soil}</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Examples:</span>

<span class="sd">        We prepare two hydrological response units, of which only the first one&#39;s soil</span>
<span class="sd">        is accessible for evapotranspiration losses.  The other settings agree with the</span>
<span class="sd">        last response unit in the second example on method</span>
<span class="sd">        |Return_Evaporation_PenmanMonteith_V2|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; soil(True, False)</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressure = 12.0</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressureslope = 0.8</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.airdensity = 1.24</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance = 40.0</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance = 80.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 100.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux = 10.0</span>

<span class="sd">        The determined potential evapotranspiration value for the first response unit</span>
<span class="sd">        agrees with the corresponding |Return_Evaporation_PenmanMonteith_V2| example.</span>
<span class="sd">        For the soil-free unit, it is zero:</span>

<span class="sd">        &gt;&gt;&gt; model.calc_potentialsoilevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialsoilevapotranspiration</span>
<span class="sd">        potentialsoilevapotranspiration(5.657942, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_Evaporation_PenmanMonteith_V2</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatOfCondensation</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatCapacityAir</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirDensity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AerodynamicResistance</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualSurfaceResistance</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialSoilEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">soil</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">r</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">actualsurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">pet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">return_evaporation_penmanmonteith_v2</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">potentialsoilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">pet</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">potentialsoilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Calc_PotentialSoilEvapotranspiration_PETModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialSoilEvapotranspiration_PETModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialSoilEvapotranspiration_PETModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the already calculated potential evapotranspiration from a submodel that</span>
<span class="sd">    complies with the |PETModel_V1| interface and assume it as potential soil</span>
<span class="sd">    evapotranspiration.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use |evap_aet_minhas| and |evap_ret_io| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_minhas import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_petmodel_v1(&quot;evap_ret_io&quot;):</span>
<span class="sd">        ...     hruarea(1.0, 3.0, 2.0)</span>
<span class="sd">        ...     fluxes.referenceevapotranspiration = 1.0, 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialsoilevapotranspiration_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialsoilevapotranspiration</span>
<span class="sd">        potentialsoilevapotranspiration(1.0, 2.0, 4.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialSoilEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">potentialsoilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">submodel</span><span class="o">.</span><span class="n">get_potentialevapotranspiration</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_PotentialSoilEvapotranspiration_PETModel_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialSoilEvapotranspiration_PETModel_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialSoilEvapotranspiration_PETModel_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Let a submodel that complies with the |PETModel_V2| interface calculate</span>
<span class="sd">    potential soil evapotranspiration and query it.</span>

<span class="sd">    Example:</span>

<span class="sd">        We use |evap_aet_minhas| and |evap_pet_ambav1| as an example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-01-01&quot;, &quot;2000-01-02&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_minhas import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(3)</span>
<span class="sd">        &gt;&gt;&gt; interception(False, True, True)</span>
<span class="sd">        &gt;&gt;&gt; soil(False, True, True)</span>
<span class="sd">        &gt;&gt;&gt; water(True, False, False)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_petmodel_v2(&quot;evap_pet_ambav1&quot;):</span>
<span class="sd">        ...     hrutype(0)</span>
<span class="sd">        ...     plant(True)</span>
<span class="sd">        ...     measuringheightwindspeed(10.0)</span>
<span class="sd">        ...     leafalbedo(0.2)</span>
<span class="sd">        ...     leafalbedosnow(0.8)</span>
<span class="sd">        ...     groundalbedo(0.2)</span>
<span class="sd">        ...     groundalbedosnow(0.8)</span>
<span class="sd">        ...     leafareaindex(5.0)</span>
<span class="sd">        ...     cropheight(10.0)</span>
<span class="sd">        ...     leafresistance(40.0)</span>
<span class="sd">        ...     wetsoilresistance(100.0)</span>
<span class="sd">        ...     soilresistanceincrease(1.0)</span>
<span class="sd">        ...     wetnessthreshold(0.5)</span>
<span class="sd">        ...     cloudtypefactor(0.2)</span>
<span class="sd">        ...     nightcloudfactor(1.0)</span>
<span class="sd">        ...     inputs.relativehumidity = 80.0</span>
<span class="sd">        ...     inputs.windspeed = 2.0</span>
<span class="sd">        ...     inputs.atmosphericpressure = 1000.0</span>
<span class="sd">        ...     factors.sunshineduration = 6.0</span>
<span class="sd">        ...     factors.possiblesunshineduration = 16.0</span>
<span class="sd">        ...     fluxes.globalradiation = 190.0</span>
<span class="sd">        ...     with model.add_tempmodel_v2(&quot;meteo_temp_io&quot;):</span>
<span class="sd">        ...         hruarea(1.0)</span>
<span class="sd">        ...         temperatureaddend(0.0)</span>
<span class="sd">        ...         inputs.temperature = 15.0</span>
<span class="sd">        ...     with model.add_precipmodel_v2(&quot;meteo_precip_io&quot;):</span>
<span class="sd">        ...         hruarea(1.0)</span>
<span class="sd">        ...         precipitationfactor(1.0)</span>
<span class="sd">        ...         inputs.precipitation = 0.0</span>
<span class="sd">        ...     with model.add_snowcovermodel_v1(&quot;dummy_snowcover&quot;):</span>
<span class="sd">        ...         inputs.snowcover = 0.0, 0.0, 1.0</span>
<span class="sd">        &gt;&gt;&gt; model.petmodel.determine_potentialinterceptionevaporation()</span>
<span class="sd">        &gt;&gt;&gt; model.calc_potentialsoilevapotranspiration_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialsoilevapotranspiration</span>
<span class="sd">        potentialsoilevapotranspiration(0.0, 2.324763, 0.807385)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialSoilEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">submodel</span><span class="p">:</span> <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">submodel</span><span class="o">.</span><span class="n">determine_potentialsoilevapotranspiration</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">potentialsoilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">submodel</span><span class="o">.</span><span class="n">get_potentialsoilevapotranspiration</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_PotentialSoilEvapotranspiration_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_PotentialSoilEvapotranspiration_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_PotentialSoilEvapotranspiration_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Use a submodel that complies with the |PETModel_V1| or |PETModel_V2| interface</span>
<span class="sd">    to determine potential soil evapotranspiration.&quot;&quot;&quot;</span>

    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span><span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span> <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V2</span><span class="p">)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_PotentialSoilEvapotranspiration_PETModel_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialSoilEvapotranspiration_PETModel_V2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialSoilEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">petmodel_typeid</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_potentialsoilevapotranspiration_petmodel_v1</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">petmodel</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">petmodel_typeid</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">calc_potentialsoilevapotranspiration_petmodel_v2</span><span class="p">(</span>
                <span class="n">cast</span><span class="p">(</span><span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">petmodel</span><span class="p">)</span>
            <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_SoilEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SoilEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SoilEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the actual soil evapotranspiration according to</span>
<span class="sd">    :cite:t:`ref-Lindstrom1997HBV96`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        et_s = pet_s \cdot \frac{s}{l \cdot m}</span>
<span class="sd">        \\ \\</span>
<span class="sd">        et_s = SoilEvapotranspiration \\</span>
<span class="sd">        pet_s = PotentialSoilEvapotranspiration \\</span>
<span class="sd">        s = SoilWater \\</span>
<span class="sd">        l = SoilMoistureLimit \\</span>
<span class="sd">        m = MaxSoilWater</span>

<span class="sd">    Examples:</span>

<span class="sd">        We initialise seven hydrological response units with different soil water</span>
<span class="sd">        contents, including two that fall below and above the lowest and highest</span>
<span class="sd">        possible soil moisture, respectively, to show that</span>
<span class="sd">        |Calc_SoilEvapotranspiration_V1| works stably in case of eventual numerical</span>
<span class="sd">        errors:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(7)</span>
<span class="sd">        &gt;&gt;&gt; soil(True)</span>
<span class="sd">        &gt;&gt;&gt; maxsoilwater(200.0)</span>
<span class="sd">        &gt;&gt;&gt; soilmoisturelimit(0.5)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialsoilevapotranspiration = 2.0</span>
<span class="sd">        &gt;&gt;&gt; factors.soilwater = -1.0, 0.0, 50.0, 100.0, 150.0, 200.0, 201.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(0.0, 0.0, 1.0, 2.0, 2.0, 2.0, 2.0)</span>

<span class="sd">        When setting |SoilMoistureLimit| to zero, |Calc_SoilEvapotranspiration_V1| sets</span>
<span class="sd">        actual soil evapotranspiration equal to possible soil evapotranspiration,</span>
<span class="sd">        except for negative soil moisture:</span>

<span class="sd">        &gt;&gt;&gt; soilmoisturelimit(0.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(0.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0)</span>

<span class="sd">        Setting |SoilMoistureLimit| to one does not result in any explanatory</span>
<span class="sd">        behaviour:</span>

<span class="sd">        &gt;&gt;&gt; soilmoisturelimit(1.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(0.0, 0.0, 0.5, 1.0, 1.5, 2.0, 2.0)</span>

<span class="sd">        Condensation does not depend on actual soil moisture.  Hence,</span>
<span class="sd">        |Calc_SoilEvapotranspiration_V1| generally sets actual soil evapotranspiration</span>
<span class="sd">        equal to potential soil evapotranspiration if negative:</span>

<span class="sd">        &gt;&gt;&gt; soilmoisturelimit(0.5)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialsoilevapotranspiration = -1.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0)</span>

<span class="sd">        For non-soil units, soil evapotranspiration is generally zero:</span>

<span class="sd">        &gt;&gt;&gt; soil(False)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialevapotranspiration = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">MaxSoilWater</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">SoilMoistureLimit</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SoilWater</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialSoilEvapotranspiration</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">soil</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">potentialsoilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">fac</span><span class="o">.</span><span class="n">soilwater</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">thresh</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">soilmoisturelimit</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">maxsoilwater</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">fac</span><span class="o">.</span><span class="n">soilwater</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">thresh</span><span class="p">:</span>
                            <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="n">fac</span><span class="o">.</span><span class="n">soilwater</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">thresh</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Calc_SoilEvapotranspiration_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SoilEvapotranspiration_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SoilEvapotranspiration_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the actual soil evapotranspiration according to</span>
<span class="sd">    :cite:t:`ref-Minhas1974`.</span>

<span class="sd">    The applied equation deviates from the original by using the formulation of</span>
<span class="sd">    :cite:t:`ref-Disse1995`, which is mathematically identical but simpler to</span>
<span class="sd">    parameterise and does not explicitly account for the permanent wilting point.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">       et_s = pet_s \cdot \frac</span>
<span class="sd">       {1 - exp\left(-f\cdot \frac{w}{m } \right)}</span>
<span class="sd">       {1 + exp\left(-f\cdot \frac{w}{m } \right) - 2 \cdot exp(-f)}</span>
<span class="sd">        \\ \\</span>
<span class="sd">        et_s = SoilEvapotranspiration \\</span>
<span class="sd">        pet_s = PotentialSoilEvapotranspiration \\</span>
<span class="sd">        f = DisseFactor \\</span>
<span class="sd">        w = SoilWater \\</span>
<span class="sd">        m = MaxSoilWater</span>

<span class="sd">    Examples:</span>

<span class="sd">        We initialise five hydrological response units with different soil water</span>
<span class="sd">        contents, including two that fall below and above the lowest and highest</span>
<span class="sd">        possible soil moisture, respectively, to show that</span>
<span class="sd">        |Calc_SoilEvapotranspiration_V2| works stably in case of eventual numerical</span>
<span class="sd">        errors:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(5)</span>
<span class="sd">        &gt;&gt;&gt; soil(True)</span>
<span class="sd">        &gt;&gt;&gt; dissefactor(5.0)</span>
<span class="sd">        &gt;&gt;&gt; maxsoilwater(100.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialsoilevapotranspiration = 2.0</span>
<span class="sd">        &gt;&gt;&gt; factors.soilwater = -1.0, 0.0, 50.0, 100.0, 101.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilevapotranspiration_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(0.0, 0.0, 1.717962, 2.0, 2.0)</span>

<span class="sd">        Condensation does not depend on actual soil moisture.  Hence,</span>
<span class="sd">        |Calc_SoilEvapotranspiration_V2| generally sets actual soil evapotranspiration</span>
<span class="sd">        equal to potential soil evapotranspiration if negative:</span>

<span class="sd">        &gt;&gt;&gt; fluxes.potentialsoilevapotranspiration = -2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilevapotranspiration_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(-2.0, -2.0, -2.0, -2.0, -2.0)</span>

<span class="sd">        For non-soil units, soil evapotranspiration is always zero:</span>

<span class="sd">        &gt;&gt;&gt; soil(False)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilevapotranspiration_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(0.0, 0.0, 0.0, 0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">MaxSoilWater</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">DisseFactor</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SoilWater</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialSoilEvapotranspiration</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">soil</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">potentialsoilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">moisture</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">soilwater</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">maxsoilwater</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">moisture</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="k">elif</span> <span class="n">moisture</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">:</span>
                        <span class="n">temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">con</span><span class="o">.</span><span class="n">dissefactor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">moisture</span><span class="p">)</span>
                        <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">temp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                            <span class="mf">1.0</span> <span class="o">+</span> <span class="n">temp</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">con</span><span class="o">.</span><span class="n">dissefactor</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                        <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Calc_SoilEvapotranspiration_V3">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Calc_SoilEvapotranspiration_V3">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SoilEvapotranspiration_V3</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the evapotranspiration from the soil by applying the Penman-Monteith</span>
<span class="sd">    equation with an actual surface resistance considering the current soil moisture.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        SoilEvapotranspiration = \begin{cases}</span>
<span class="sd">        f_{PM}(ActualSurfaceResistance)  &amp;|\ Soil \land (Tree \lor SnowCover = 0 )</span>
<span class="sd">        \\</span>
<span class="sd">        0 &amp;|\ \overline{Soil } \lor ( \overline{Tree} \land SnowCover &gt; 0 )</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Examples:</span>

<span class="sd">        We prepare two hydrological response units.  The first one is tree-like, while</span>
<span class="sd">        the second one is not.  The other settings agree with the last response unit in</span>
<span class="sd">        the second example on method |Return_Evaporation_PenmanMonteith_V1|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; soil(True)</span>
<span class="sd">        &gt;&gt;&gt; tree(True, False)</span>
<span class="sd">        &gt;&gt;&gt; emissivity(0.96)</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressure = 12.0</span>
<span class="sd">        &gt;&gt;&gt; factors.saturationvapourpressureslope = 0.8</span>
<span class="sd">        &gt;&gt;&gt; factors.actualvapourpressure = 0.0</span>
<span class="sd">        &gt;&gt;&gt; factors.airdensity = 1.24</span>
<span class="sd">        &gt;&gt;&gt; factors.aerodynamicresistance = 40.0</span>
<span class="sd">        &gt;&gt;&gt; factors.actualsurfaceresistance = 80.0</span>
<span class="sd">        &gt;&gt;&gt; factors.airtemperature = 10.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.netradiation = 100.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilheatflux = 10.0</span>

<span class="sd">        Without any snow cover, the vegetation type does not make a difference:</span>

<span class="sd">        &gt;&gt;&gt; factors.snowcover(0.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilevapotranspiration_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(5.761072, 5.761072)</span>

<span class="sd">        For tree-like vegetation, a snow layer (on the ground) does not affect soil</span>
<span class="sd">        evapotranspiration.  For other vegetation types, even incomplete covering</span>
<span class="sd">        suppresses interception evaporation completely:</span>

<span class="sd">        &gt;&gt;&gt; factors.snowcover(0.1)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilevapotranspiration_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(5.761072, 0.0)</span>

<span class="sd">        Soil evapotranspiration is always zero for soil-less hydrological response</span>
<span class="sd">        units:</span>

<span class="sd">        &gt;&gt;&gt; soil(False)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_soilevapotranspiration_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_Evaporation_PenmanMonteith_V1</span><span class="p">,)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Tree</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Emissivity</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">StefanBoltzmannConstant</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatOfCondensation</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatCapacityAir</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SnowCover</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirDensity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AerodynamicResistance</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualSurfaceResistance</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">soil</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">tree</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">fac</span><span class="o">.</span><span class="n">snowcover</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">):</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">return_evaporation_penmanmonteith_v1</span><span class="p">(</span>
                        <span class="n">k</span><span class="p">,</span> <span class="n">fac</span><span class="o">.</span><span class="n">actualsurfaceresistance</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Update_SoilEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_SoilEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_SoilEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Reduce actual soil evapotranspiration if the sum of interception evaporation</span>
<span class="sd">    and soil evapotranspiration exceeds potential evapotranspiration, according to</span>
<span class="sd">    :cite:t:`ref-Lindstrom1997HBV96`.</span>

<span class="sd">    :cite:t:`ref-Lindstrom1997HBV96` does not distinguish between potential</span>
<span class="sd">    interception evaporation and potential soil evapotranspiration.  Hence, the</span>
<span class="sd">    following equation is generalised to deal with situations where both terms are</span>
<span class="sd">    unequal.  See `issue 118`_ for further information.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        et_s^{new} = et_s^{old} - r \cdot \Big(</span>
<span class="sd">        et_s^{old} + e_i - \big(r \cdot pe_i + (1 - r) \cdot (pet_s + pe_i) / 2 \big)</span>
<span class="sd">        \Big)</span>
<span class="sd">        \\ \\</span>
<span class="sd">        et_s = SoilEvapotranspiration \\</span>
<span class="sd">        r = ExcessReduction \\</span>
<span class="sd">        e_i = InterceptionEvaporation \\</span>
<span class="sd">        pet = PotentialEvapotranspiration</span>

<span class="sd">    Examples:</span>

<span class="sd">        We initialise six hydrological response units with different unmodified soil</span>
<span class="sd">        evapotranspiration values, including a negative one (condensation).  When</span>
<span class="sd">        setting |ExcessReduction| to one, |Update_SoilEvapotranspiration_V1| does not</span>
<span class="sd">        allow the sum of interception evaporation and soil evapotranspiration to exceed</span>
<span class="sd">        potential interception evaporation:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(6)</span>
<span class="sd">        &gt;&gt;&gt; soil(True)</span>
<span class="sd">        &gt;&gt;&gt; excessreduction(1.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation = 2.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialsoilevapotranspiration = 1.5</span>
<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation = 1.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration = -0.5, 0.0, 0.5, 1.0, 1.5, 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(-0.5, 0.0, 0.5, 1.0, 1.0, 1.0)</span>

<span class="sd">        When setting |ExcessReduction| to one, |Update_SoilEvapotranspiration_V1| does</span>
<span class="sd">        not reduce any exceedances:</span>

<span class="sd">        &gt;&gt;&gt; excessreduction(0.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration = -0.5, 0.0, 0.5, 1.0, 1.5, 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(-0.5, 0.0, 0.5, 1.0, 1.5, 2.0)</span>

<span class="sd">        When setting |ExcessReduction| to 0.5, |Update_SoilEvapotranspiration_V1| takes</span>
<span class="sd">        the average of potential interception evaporation and the average of potential</span>
<span class="sd">        interception evaporation and soil evapotranspiration as the threshold and</span>
<span class="sd">        halves each exceedance above this threshold:</span>

<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation = 2.5</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialsoilevapotranspiration = 0.5</span>
<span class="sd">        &gt;&gt;&gt; excessreduction(0.5)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration = -0.5, 0.0, 0.5, 1.0, 1.5, 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(-0.5, 0.0, 0.5, 1.0, 1.25, 1.5)</span>

<span class="sd">        In the unfortunate case of interception evaporation exceeding potential</span>
<span class="sd">        evapotranspiration, previously positive soil evapotranspiration values can</span>
<span class="sd">        become negative:</span>

<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation = 3.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration = -0.5, 0.0, 0.5, 1.0, 1.5, 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(-0.75, -0.5, -0.25, 0.0, 0.25, 0.5)</span>

<span class="sd">        For negative potential evapotranspiration (condensation),</span>
<span class="sd">        |Update_SoilEvapotranspiration_V1| reverses its behaviour to prevent the sum of</span>
<span class="sd">        interception and soil condensation from exceeding potential condensation (too</span>
<span class="sd">        much):</span>

<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation = -2.5</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialsoilevapotranspiration = -0.5</span>
<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation = -1.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration = 0.5, -0.0, -0.5, -1.0, -1.5, -2.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(0.5, 0.0, -0.5, -1.0, -1.25, -1.5)</span>

<span class="sd">        For non-soil units, soil evapotranspiration is generally zero:</span>

<span class="sd">        &gt;&gt;&gt; soil(False)</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilevapotranspiration_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(0.0, 0.0, 0.0, 0.0, 0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">ExcessReduction</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialSoilEvapotranspiration</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">InterceptionEvaporation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">soil</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">r</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">excessreduction</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">pei</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">potentialinterceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">pets</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">potentialsoilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">pet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">pei</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pei</span> <span class="o">+</span> <span class="n">pets</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
                <span class="n">ets</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">ei</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">interceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">excess</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">ets</span> <span class="o">+</span> <span class="n">ei</span> <span class="o">-</span> <span class="n">pet</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pet</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">excess</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">):</span>
                    <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">excess</span>
                <span class="k">elif</span> <span class="p">(</span><span class="n">pet</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">excess</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">):</span>
                    <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">excess</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Update_SoilEvapotranspiration_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_SoilEvapotranspiration_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_SoilEvapotranspiration_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Reduce actual soil evapotranspiration due to snow covering.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      .. math::</span>
<span class="sd">        et_s^{new} = (1 - c) \cdot et_s^{old}</span>
<span class="sd">        \\ \\</span>
<span class="sd">        et_s = SoilEvapotranspiration \\</span>
<span class="sd">        c = SnowCover</span>

<span class="sd">    Examples:</span>

<span class="sd">        We initialise five hydrological response units with different snow cover</span>
<span class="sd">        degrees:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(5)</span>
<span class="sd">        &gt;&gt;&gt; soil(True)</span>
<span class="sd">        &gt;&gt;&gt; factors.snowcover = 0.0, 0.25, 0.5, 0.75, 1.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilevapotranspiration_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(2.0, 1.5, 1.0, 0.5, 0.0)</span>

<span class="sd">        For non-soil units, soil evapotranspiration is generally zero:</span>

<span class="sd">        &gt;&gt;&gt; soil(False)</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilevapotranspiration_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(0.0, 0.0, 0.0, 0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_factors</span><span class="o">.</span><span class="n">SnowCover</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">soil</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">snowcover</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">):</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">fac</span><span class="o">.</span><span class="n">snowcover</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Update_SoilEvapotranspiration_V3">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Update_SoilEvapotranspiration_V3">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Update_SoilEvapotranspiration_V3</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Reduce actual soil evapotranspiration if interception evaporation occurs</span>
<span class="sd">    simultaneously following :cite:t:`ref-Wigmosta1994`.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`SoilEvapotranspiration_{new} =</span>
<span class="sd">      \frac{PotentialInterceptionEvaporation - InterceptionEvaporation}</span>
<span class="sd">      {PotentialInterceptionEvaporation} \cdot SoilEvapotranspiration_{old}`</span>

<span class="sd">    Example:</span>

<span class="sd">        For response units with relevant interception and soil storage, method</span>
<span class="sd">        |Update_SoilEvapotranspiration_V3| applies the given base equation:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(4)</span>
<span class="sd">        &gt;&gt;&gt; interception(True)</span>
<span class="sd">        &gt;&gt;&gt; soil(True)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation = 3.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation = 0.0, 1.0, 2.0, 3.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilevapotranspiration_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(2.0, 1.333333, 0.666667, 0.0)</span>

<span class="sd">        The same holds for negative values (condensation) and mixtures of positive and</span>
<span class="sd">        negative values (possibly due to different energy balances when only soil</span>
<span class="sd">        evapotranspiration takes the soil heat flux into account):</span>

<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation = -3.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation = 0.0, -1.0, -2.0, -3.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration = -2.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilevapotranspiration_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(-2.0, -1.333333, -0.666667, 0.0)</span>

<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation = 3.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation = 0.0, 1.0, 2.0, 3.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration = -2.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilevapotranspiration_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(-2.0, -1.333333, -0.666667, 0.0)</span>

<span class="sd">        |Update_SoilEvapotranspiration_V3| sets the soil evapotranspiration to zero if</span>
<span class="sd">        potential interception evaporation is also zero:</span>

<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation = 0.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation = 0.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilevapotranspiration_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(0.0, 0.0, 0.0, 0.0)</span>

<span class="sd">        For response units that do not consider interception,</span>
<span class="sd">        |Update_SoilEvapotranspiration_V3| never modifies soil evapotranspiration:</span>

<span class="sd">        &gt;&gt;&gt; interception(False)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation = 3.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilevapotranspiration_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(2.0, 2.0, 2.0, 2.0)</span>

<span class="sd">        For response units without relevant soil storage,</span>
<span class="sd">        |Update_SoilEvapotranspiration_V3| generally sets soil evapotranspiration to</span>
<span class="sd">        zero:</span>

<span class="sd">        &gt;&gt;&gt; soil(False)</span>
<span class="sd">        &gt;&gt;&gt; model.update_soilevapotranspiration_v3()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration</span>
<span class="sd">        soilevapotranspiration(0.0, 0.0, 0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Interception</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">InterceptionEvaporation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">soil</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">interception</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">flu</span><span class="o">.</span><span class="n">potentialinterceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="p">(</span>
                            <span class="n">flu</span><span class="o">.</span><span class="n">potentialinterceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                            <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">interceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="p">)</span> <span class="o">/</span> <span class="n">flu</span><span class="o">.</span><span class="n">potentialinterceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Determine_PotentialEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Determine_PotentialEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Determine_PotentialEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Interface method that applies the complete application model by executing all</span>
<span class="sd">    &quot;run methods&quot;.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">run</span><span class="p">()</span></div>



<div class="viewcode-block" id="Get_PotentialEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Get_PotentialEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_PotentialEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current reference evapotranspiration from the selected hydrological</span>
<span class="sd">    response unit.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.referenceevapotranspiration = 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_potentialevapotranspiration_v1(0))</span>
<span class="sd">        2.0</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_potentialevapotranspiration_v1(1))</span>
<span class="sd">        4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">ReferenceEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">flu</span><span class="o">.</span><span class="n">referenceevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Get_PotentialEvapotranspiration_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Get_PotentialEvapotranspiration_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_PotentialEvapotranspiration_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current potential evapotranspiration from the selected hydrological</span>
<span class="sd">    response unit.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialevapotranspiration = 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_potentialevapotranspiration_v2(0))</span>
<span class="sd">        2.0</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_potentialevapotranspiration_v2(1))</span>
<span class="sd">        4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">flu</span><span class="o">.</span><span class="n">potentialevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Get_MeanPotentialEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Get_MeanPotentialEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_MeanPotentialEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the averaged reference evapotranspiration.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.meanreferenceevapotranspiration = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.get_meanpotentialevapotranspiration_v1()</span>
<span class="sd">        3.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">MeanReferenceEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">flu</span><span class="o">.</span><span class="n">meanreferenceevapotranspiration</span></div>



<div class="viewcode-block" id="Get_MeanPotentialEvapotranspiration_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Get_MeanPotentialEvapotranspiration_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_MeanPotentialEvapotranspiration_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the averaged potential evapotranspiration.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.meanpotentialevapotranspiration = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.get_meanpotentialevapotranspiration_v2()</span>
<span class="sd">        3.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">MeanPotentialEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">flu</span><span class="o">.</span><span class="n">meanpotentialevapotranspiration</span></div>



<div class="viewcode-block" id="Determine_PotentialInterceptionEvaporation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Determine_PotentialInterceptionEvaporation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Determine_PotentialInterceptionEvaporation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the potential interception evaporation according to AMBAV 1.0</span>
<span class="sd">    :cite:p:`ref-Lpmeier2014`.&quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Process_RadiationModel_V1</span><span class="p">,</span>
        <span class="n">Calc_PossibleSunshineDuration_V1</span><span class="p">,</span>
        <span class="n">Calc_SunshineDuration_V1</span><span class="p">,</span>
        <span class="n">Calc_GlobalRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_AirTemperature_V1</span><span class="p">,</span>
        <span class="n">Calc_WindSpeed10m_V1</span><span class="p">,</span>
        <span class="n">Calc_SaturationVapourPressure_V1</span><span class="p">,</span>
        <span class="n">Calc_SaturationVapourPressureSlope_V1</span><span class="p">,</span>
        <span class="n">Calc_ActualVapourPressure_V1</span><span class="p">,</span>
        <span class="n">Calc_DryAirPressure_V1</span><span class="p">,</span>
        <span class="n">Calc_AirDensity_V1</span><span class="p">,</span>
        <span class="n">Calc_AerodynamicResistance_V2</span><span class="p">,</span>
        <span class="n">Calc_SnowCover_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyPrecipitation_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyPotentialSoilEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Calc_CurrentAlbedo_V2</span><span class="p">,</span>
        <span class="n">Calc_NetShortwaveRadiation_V2</span><span class="p">,</span>
        <span class="n">Update_CloudCoverage_V1</span><span class="p">,</span>
        <span class="n">Calc_AdjustedCloudCoverage_V1</span><span class="p">,</span>
        <span class="n">Calc_NetLongwaveRadiation_V2</span><span class="p">,</span>
        <span class="n">Calc_NetRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_SoilHeatFlux_V4</span><span class="p">,</span>
        <span class="n">Calc_PotentialInterceptionEvaporation_V2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Interception</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Plant</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Water</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">MeasuringHeightWindSpeed</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">GroundAlbedo</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">GroundAlbedoSnow</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LeafAlbedo</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LeafAlbedoSnow</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LeafAreaIndex</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">WetnessThreshold</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">CloudTypeFactor</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NightCloudFactor</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_derived</span><span class="o">.</span><span class="n">Hours</span><span class="p">,</span>
        <span class="n">evap_derived</span><span class="o">.</span><span class="n">Days</span><span class="p">,</span>
        <span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,</span>
        <span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,</span>
        <span class="n">evap_derived</span><span class="o">.</span><span class="n">AerodynamicResistanceFactor</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">StefanBoltzmannConstant</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">GasConstantDryAir</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">GasConstantWaterVapour</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatOfCondensation</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatCapacityAir</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">RoughnessLengthGrass</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_inputs</span><span class="o">.</span><span class="n">WindSpeed</span><span class="p">,</span>
        <span class="n">evap_inputs</span><span class="o">.</span><span class="n">AtmosphericPressure</span><span class="p">,</span>
        <span class="n">evap_inputs</span><span class="o">.</span><span class="n">RelativeHumidity</span><span class="p">,</span>
        <span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedPrecipitation</span><span class="p">,</span>
        <span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedPotentialSoilEvapotranspiration</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_states</span><span class="o">.</span><span class="n">CloudCoverage</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SunshineDuration</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">PossibleSunshineDuration</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">GlobalRadiation</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">WindSpeed10m</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DryAirPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirDensity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AerodynamicResistance</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SnowCover</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">CurrentAlbedo</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AdjustedCloudCoverage</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyPrecipitation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyPotentialSoilEvapotranspiration</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetShortwaveRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetLongwaveRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Determine_InterceptionEvaporation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Determine_InterceptionEvaporation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Determine_InterceptionEvaporation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the actual interception evaporation according to</span>
<span class="sd">    :cite:t:`ref-Lindstrom1997HBV96`.&quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_PotentialInterceptionEvaporation_V3</span><span class="p">,</span>
        <span class="n">Calc_InterceptedWater_V1</span><span class="p">,</span>
        <span class="n">Calc_InterceptionEvaporation_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">Interception</span><span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">InterceptedWater</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">InterceptionEvaporation</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Determine_InterceptionEvaporation_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Determine_InterceptionEvaporation_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Determine_InterceptionEvaporation_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the actual interception evaporation according to</span>
<span class="sd">    :cite:t:`ref-Thompson1981` and :cite:t:`ref-LARSIM`.&quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Process_RadiationModel_V1</span><span class="p">,</span>
        <span class="n">Calc_PossibleSunshineDuration_V1</span><span class="p">,</span>
        <span class="n">Calc_SunshineDuration_V1</span><span class="p">,</span>
        <span class="n">Calc_GlobalRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_AirTemperature_V1</span><span class="p">,</span>
        <span class="n">Update_LoggedAirTemperature_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyAirTemperature_V1</span><span class="p">,</span>
        <span class="n">Calc_WindSpeed10m_V1</span><span class="p">,</span>
        <span class="n">Update_LoggedRelativeHumidity_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyRelativeHumidity_V1</span><span class="p">,</span>
        <span class="n">Calc_SaturationVapourPressure_V2</span><span class="p">,</span>
        <span class="n">Calc_DailySaturationVapourPressure_V1</span><span class="p">,</span>
        <span class="n">Calc_SaturationVapourPressureSlope_V2</span><span class="p">,</span>
        <span class="n">Calc_DailySaturationVapourPressureSlope_V1</span><span class="p">,</span>
        <span class="n">Calc_ActualVapourPressure_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyActualVapourPressure_V1</span><span class="p">,</span>
        <span class="n">Calc_DryAirPressure_V1</span><span class="p">,</span>
        <span class="n">Calc_AirDensity_V1</span><span class="p">,</span>
        <span class="n">Calc_AerodynamicResistance_V1</span><span class="p">,</span>
        <span class="n">Calc_SnowCover_V1</span><span class="p">,</span>
        <span class="n">Calc_SnowyCanopy_V1</span><span class="p">,</span>
        <span class="n">Update_LoggedSunshineDuration_V1</span><span class="p">,</span>
        <span class="n">Calc_DailySunshineDuration_V1</span><span class="p">,</span>
        <span class="n">Update_LoggedPossibleSunshineDuration_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyPossibleSunshineDuration_V1</span><span class="p">,</span>
        <span class="n">Calc_CurrentAlbedo_V1</span><span class="p">,</span>
        <span class="n">Calc_NetShortwaveRadiation_V2</span><span class="p">,</span>
        <span class="n">Calc_DailyNetLongwaveRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_NetRadiation_V2</span><span class="p">,</span>
        <span class="n">Calc_SoilHeatFlux_V3</span><span class="p">,</span>
        <span class="n">Calc_PotentialInterceptionEvaporation_V1</span><span class="p">,</span>
        <span class="n">Calc_InterceptedWater_V1</span><span class="p">,</span>
        <span class="n">Calc_InterceptionEvaporation_V2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Interception</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Tree</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Water</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">MeasuringHeightWindSpeed</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Albedo</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">CropHeight</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Emissivity</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">AverageSoilHeatFlux</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,</span> <span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">StefanBoltzmannConstant</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">FactorCounterRadiation</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">GasConstantDryAir</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">GasConstantWaterVapour</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatOfCondensation</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatCapacityAir</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">RoughnessLengthGrass</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_inputs</span><span class="o">.</span><span class="n">WindSpeed</span><span class="p">,</span>
        <span class="n">evap_inputs</span><span class="o">.</span><span class="n">AtmosphericPressure</span><span class="p">,</span>
        <span class="n">evap_inputs</span><span class="o">.</span><span class="n">RelativeHumidity</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedAirTemperature</span><span class="p">,</span>
        <span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedRelativeHumidity</span><span class="p">,</span>
        <span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedSunshineDuration</span><span class="p">,</span>
        <span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedPossibleSunshineDuration</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">PossibleSunshineDuration</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SunshineDuration</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">GlobalRadiation</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyAirTemperature</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">WindSpeed10m</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyRelativeHumidity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailySaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailySaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DryAirPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirDensity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AerodynamicResistance</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SnowCover</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SnowyCanopy</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailySunshineDuration</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyPossibleSunshineDuration</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">CurrentAlbedo</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetShortwaveRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyNetLongwaveRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">InterceptedWater</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">InterceptionEvaporation</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Determine_PotentialSoilEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Determine_PotentialSoilEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Determine_PotentialSoilEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the actual evapotranspiration from the soil according to AMBAV 1.0</span>
<span class="sd">    :cite:p:`ref-Lpmeier2014`.&quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Update_SoilResistance_V1</span><span class="p">,</span>
        <span class="n">Calc_ActualSurfaceResistance_V2</span><span class="p">,</span>
        <span class="n">Calc_PotentialSoilEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Update_LoggedPotentialSoilEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Calc_Precipitation_V1</span><span class="p">,</span>
        <span class="n">Update_LoggedPrecipitation_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Plant</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LeafAreaIndex</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">WetSoilResistance</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">SoilResistanceIncrease</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">WetnessThreshold</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LeafResistance</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,</span>
        <span class="n">evap_derived</span><span class="o">.</span><span class="n">Hours</span><span class="p">,</span>
        <span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatOfCondensation</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatCapacityAir</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">PossibleSunshineDuration</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirDensity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AerodynamicResistance</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyPrecipitation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyPotentialSoilEvapotranspiration</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_states</span><span class="o">.</span><span class="n">SoilResistance</span><span class="p">,</span>
        <span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedPrecipitation</span><span class="p">,</span>
        <span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedPotentialSoilEvapotranspiration</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualSurfaceResistance</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialSoilEvapotranspiration</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">Precipitation</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Determine_SoilEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Determine_SoilEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Determine_SoilEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the actual evapotranspiration from the soil according to</span>
<span class="sd">    :cite:t:`ref-Lindstrom1997HBV96`.&quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_SoilWater_V1</span><span class="p">,</span>
        <span class="n">Calc_SnowCover_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialSoilEvapotranspiration_V2</span><span class="p">,</span>
        <span class="n">Calc_SoilEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Update_SoilEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Update_SoilEvapotranspiration_V2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">MaxSoilWater</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">SoilMoistureLimit</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">ExcessReduction</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">InterceptionEvaporation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SoilWater</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SnowCover</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialSoilEvapotranspiration</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilEvapotranspiration</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Determine_SoilEvapotranspiration_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Determine_SoilEvapotranspiration_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Determine_SoilEvapotranspiration_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the actual evapotranspiration from the soil according to</span>
<span class="sd">    :cite:t:`ref-Minhas1974`.&quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_SoilWater_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialSoilEvapotranspiration_V2</span><span class="p">,</span>
        <span class="n">Calc_SoilEvapotranspiration_V2</span><span class="p">,</span>
        <span class="n">Update_SoilEvapotranspiration_V3</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Interception</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">MaxSoilWater</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">DisseFactor</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">InterceptionEvaporation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SoilWater</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialSoilEvapotranspiration</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilEvapotranspiration</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Determine_SoilEvapotranspiration_V3">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Determine_SoilEvapotranspiration_V3">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Determine_SoilEvapotranspiration_V3</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the actual evapotranspiration from the soil according to</span>
<span class="sd">    :cite:t:`ref-Thompson1981` and :cite:t:`ref-LARSIM`.&quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_SoilWater_V1</span><span class="p">,</span>
        <span class="n">Calc_SnowCover_V1</span><span class="p">,</span>
        <span class="n">Calc_SoilSurfaceResistance_V1</span><span class="p">,</span>
        <span class="n">Calc_LanduseSurfaceResistance_V1</span><span class="p">,</span>
        <span class="n">Calc_ActualSurfaceResistance_V1</span><span class="p">,</span>
        <span class="n">Calc_SoilEvapotranspiration_V3</span><span class="p">,</span>
        <span class="n">Update_SoilEvapotranspiration_V3</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Interception</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Tree</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Conifer</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">LeafAreaIndex</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">SurfaceResistance</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Emissivity</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">MaxSoilWater</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">SoilMoistureLimit</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">Hours</span><span class="p">,</span> <span class="n">evap_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">StefanBoltzmannConstant</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatOfCondensation</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatCapacityAir</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">PossibleSunshineDuration</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirDensity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AerodynamicResistance</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">InterceptionEvaporation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SoilWater</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SnowCover</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SoilSurfaceResistance</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">LanduseSurfaceResistance</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualSurfaceResistance</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilEvapotranspiration</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Determine_PotentialWaterEvaporation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Determine_PotentialWaterEvaporation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Determine_PotentialWaterEvaporation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the potential evaporation from open water areas according to AMBAV 1.0</span>
<span class="sd">    :cite:p:`ref-Lpmeier2014`.&quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_WaterEvaporation_V4</span><span class="p">,</span>
        <span class="n">Update_LoggedWaterEvaporation_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyWaterEvaporation_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">Water</span><span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">,)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatOfCondensation</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatCapacityAir</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">SaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">ActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirDensity</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AerodynamicResistance</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">NetRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilHeatFlux</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedWaterEvaporation</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">WaterEvaporation</span><span class="p">,</span> <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyWaterEvaporation</span><span class="p">)</span></div>



<div class="viewcode-block" id="Determine_WaterEvaporation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Determine_WaterEvaporation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Determine_WaterEvaporation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the actual evapotranspiration from open water areas according to</span>
<span class="sd">    :cite:t:`ref-Lindstrom1997HBV96`.&quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_AirTemperature_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialWaterEvaporation_V1</span><span class="p">,</span>
        <span class="n">Calc_WaterEvaporation_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Water</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">TemperatureThresholdIce</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">AirTemperature</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialWaterEvaporation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">WaterEvaporation</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Determine_WaterEvaporation_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Determine_WaterEvaporation_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Determine_WaterEvaporation_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Accept potential evapotranspiration as the actual evaporation from water</span>
<span class="sd">    areas.&quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Calc_PotentialWaterEvaporation_V1</span><span class="p">,</span> <span class="n">Calc_WaterEvaporation_V2</span><span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">Water</span><span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialWaterEvaporation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">WaterEvaporation</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Determine_WaterEvaporation_V3">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Determine_WaterEvaporation_V3">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Determine_WaterEvaporation_V3</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the actual evapotranspiration from open water areas according to</span>
<span class="sd">    :cite:t:`ref-LARSIM`, based on :cite:t:`ref-DVWK1996`.&quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_WindSpeed2m_V2</span><span class="p">,</span>
        <span class="n">Update_LoggedWindSpeed2m_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyWindSpeed2m_V1</span><span class="p">,</span>
        <span class="n">Update_LoggedGlobalRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyGlobalRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyNetShortwaveRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyNetRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_WaterEvaporation_V3</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">Water</span><span class="p">,</span>
        <span class="n">evap_control</span><span class="o">.</span><span class="n">MeasuringHeightWindSpeed</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">Days</span><span class="p">,</span> <span class="n">evap_derived</span><span class="o">.</span><span class="n">NmbLogEntries</span><span class="p">)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">HeatOfCondensation</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">PsychrometricConstant</span><span class="p">,</span>
        <span class="n">evap_fixed</span><span class="o">.</span><span class="n">RoughnessLengthGrass</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedWindSpeed2m</span><span class="p">,</span> <span class="n">evap_logs</span><span class="o">.</span><span class="n">LoggedGlobalRadiation</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_inputs</span><span class="o">.</span><span class="n">WindSpeed</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">CurrentAlbedo</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailySaturationVapourPressure</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailySaturationVapourPressureSlope</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyActualVapourPressure</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">GlobalRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyNetLongwaveRadiation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">WindSpeed2m</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyGlobalRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyNetShortwaveRadiation</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyNetRadiation</span><span class="p">,</span>
        <span class="n">evap_factors</span><span class="o">.</span><span class="n">DailyWindSpeed2m</span><span class="p">,</span>
        <span class="n">evap_fluxes</span><span class="o">.</span><span class="n">WaterEvaporation</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Get_WaterEvaporation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Get_WaterEvaporation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_WaterEvaporation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current water area evaporation from the selected hydrological response</span>
<span class="sd">    unit.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.waterevaporation = 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_waterevaporation_v1(0))</span>
<span class="sd">        2.0</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_waterevaporation_v1(1))</span>
<span class="sd">        4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">WaterEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">flu</span><span class="o">.</span><span class="n">waterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Get_PotentialWaterEvaporation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Get_PotentialWaterEvaporation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_PotentialWaterEvaporation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the water area evaporation sum of the last 24 hours from the selected</span>
<span class="sd">    hydrological response unit.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;12h&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; derived.days.update()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.dailywaterevaporation = 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_potentialwaterevaporation_v1(0))</span>
<span class="sd">        1.0</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_potentialwaterevaporation_v1(1))</span>
<span class="sd">        2.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_derived</span><span class="o">.</span><span class="n">Days</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">DailyWaterEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">der</span><span class="o">.</span><span class="n">days</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">dailywaterevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Get_PotentialInterceptionEvaporation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Get_PotentialInterceptionEvaporation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_PotentialInterceptionEvaporation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current potential interception evaporation from the selected hydrological</span>
<span class="sd">    response unit.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialinterceptionevaporation = 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_potentialinterceptionevaporation_v1(0))</span>
<span class="sd">        2.0</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_potentialinterceptionevaporation_v1(1))</span>
<span class="sd">        4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialInterceptionEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">flu</span><span class="o">.</span><span class="n">potentialinterceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Get_InterceptionEvaporation_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Get_InterceptionEvaporation_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_InterceptionEvaporation_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current actual interception evaporation from the selected hydrological</span>
<span class="sd">    response unit.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.interceptionevaporation = 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_interceptionevaporation_v1(0))</span>
<span class="sd">        2.0</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_interceptionevaporation_v1(1))</span>
<span class="sd">        4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">InterceptionEvaporation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">flu</span><span class="o">.</span><span class="n">interceptionevaporation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Get_PotentialSoilEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Get_PotentialSoilEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_PotentialSoilEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current potential soil evapotranspiration from the selected hydrological</span>
<span class="sd">    response unit.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.potentialsoilevapotranspiration = 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_potentialsoilevapotranspiration_v1(0))</span>
<span class="sd">        2.0</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_potentialsoilevapotranspiration_v1(1))</span>
<span class="sd">        4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">PotentialSoilEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">flu</span><span class="o">.</span><span class="n">potentialsoilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Get_SoilEvapotranspiration_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Get_SoilEvapotranspiration_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_SoilEvapotranspiration_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current soil evapotranspiration from the selected hydrological response</span>
<span class="sd">    unit.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.soilevapotranspiration = 2.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_soilevapotranspiration_v1(0))</span>
<span class="sd">        2.0</span>
<span class="sd">        &gt;&gt;&gt; round_(model.get_soilevapotranspiration_v1(1))</span>
<span class="sd">        4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">evap_fluxes</span><span class="o">.</span><span class="n">SoilEvapotranspiration</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">flu</span><span class="o">.</span><span class="n">soilevapotranspiration</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>



<div class="viewcode-block" id="Model">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Model">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Model</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;|evap.DOCNAME.complete|.&quot;&quot;&quot;</span>

    <span class="n">DOCNAME</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">DocName</span><span class="p">(</span><span class="n">short</span><span class="o">=</span><span class="s2">&quot;Evap&quot;</span><span class="p">)</span>
    <span class="n">__HYDPY_ROOTMODEL__</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">INLET_METHODS</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">OBSERVER_METHODS</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">RECEIVER_METHODS</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">RUN_METHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_AirTemperature_V1</span><span class="p">,</span>
        <span class="n">Update_LoggedAirTemperature_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyAirTemperature_V1</span><span class="p">,</span>
        <span class="n">Calc_WindSpeed2m_V1</span><span class="p">,</span>
        <span class="n">Calc_WindSpeed2m_V2</span><span class="p">,</span>
        <span class="n">Update_LoggedWindSpeed2m_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyWindSpeed2m_V1</span><span class="p">,</span>
        <span class="n">Calc_WindSpeed10m_V1</span><span class="p">,</span>
        <span class="n">Update_LoggedRelativeHumidity_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyRelativeHumidity_V1</span><span class="p">,</span>
        <span class="n">Calc_SaturationVapourPressure_V1</span><span class="p">,</span>
        <span class="n">Calc_SaturationVapourPressure_V2</span><span class="p">,</span>
        <span class="n">Calc_DailySaturationVapourPressure_V1</span><span class="p">,</span>
        <span class="n">Calc_SaturationVapourPressureSlope_V1</span><span class="p">,</span>
        <span class="n">Calc_SaturationVapourPressureSlope_V2</span><span class="p">,</span>
        <span class="n">Calc_DailySaturationVapourPressureSlope_V1</span><span class="p">,</span>
        <span class="n">Calc_ActualVapourPressure_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyActualVapourPressure_V1</span><span class="p">,</span>
        <span class="n">Calc_DryAirPressure_V1</span><span class="p">,</span>
        <span class="n">Calc_AirDensity_V1</span><span class="p">,</span>
        <span class="n">Process_RadiationModel_V1</span><span class="p">,</span>
        <span class="n">Calc_PossibleSunshineDuration_V1</span><span class="p">,</span>
        <span class="n">Calc_SunshineDuration_V1</span><span class="p">,</span>
        <span class="n">Calc_ClearSkySolarRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_GlobalRadiation_V1</span><span class="p">,</span>
        <span class="n">Update_LoggedSunshineDuration_V1</span><span class="p">,</span>
        <span class="n">Calc_DailySunshineDuration_V1</span><span class="p">,</span>
        <span class="n">Update_LoggedPossibleSunshineDuration_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyPossibleSunshineDuration_V1</span><span class="p">,</span>
        <span class="n">Update_LoggedClearSkySolarRadiation_V1</span><span class="p">,</span>
        <span class="n">Update_LoggedGlobalRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_CurrentAlbedo_V1</span><span class="p">,</span>
        <span class="n">Calc_CurrentAlbedo_V2</span><span class="p">,</span>
        <span class="n">Calc_DailyGlobalRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_NetShortwaveRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_NetShortwaveRadiation_V2</span><span class="p">,</span>
        <span class="n">Calc_DailyNetShortwaveRadiation_V1</span><span class="p">,</span>
        <span class="n">Update_CloudCoverage_V1</span><span class="p">,</span>
        <span class="n">Calc_AdjustedCloudCoverage_V1</span><span class="p">,</span>
        <span class="n">Calc_NetLongwaveRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_NetLongwaveRadiation_V2</span><span class="p">,</span>
        <span class="n">Calc_DailyNetLongwaveRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_NetRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_NetRadiation_V2</span><span class="p">,</span>
        <span class="n">Calc_DailyNetRadiation_V1</span><span class="p">,</span>
        <span class="n">Calc_SoilHeatFlux_V1</span><span class="p">,</span>
        <span class="n">Calc_SoilHeatFlux_V2</span><span class="p">,</span>
        <span class="n">Calc_SoilHeatFlux_V3</span><span class="p">,</span>
        <span class="n">Calc_SoilHeatFlux_V4</span><span class="p">,</span>
        <span class="n">Calc_PsychrometricConstant_V1</span><span class="p">,</span>
        <span class="n">Calc_AerodynamicResistance_V1</span><span class="p">,</span>
        <span class="n">Calc_AerodynamicResistance_V2</span><span class="p">,</span>
        <span class="n">Calc_SoilSurfaceResistance_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyPrecipitation_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyPotentialSoilEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Update_SoilResistance_V1</span><span class="p">,</span>
        <span class="n">Calc_LanduseSurfaceResistance_V1</span><span class="p">,</span>
        <span class="n">Calc_ActualSurfaceResistance_V1</span><span class="p">,</span>
        <span class="n">Calc_ActualSurfaceResistance_V2</span><span class="p">,</span>
        <span class="n">Calc_ReferenceEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Calc_ReferenceEvapotranspiration_V2</span><span class="p">,</span>
        <span class="n">Calc_ReferenceEvapotranspiration_V3</span><span class="p">,</span>
        <span class="n">Calc_ReferenceEvapotranspiration_V4</span><span class="p">,</span>
        <span class="n">Calc_ReferenceEvapotranspiration_V5</span><span class="p">,</span>
        <span class="n">Adjust_ReferenceEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialEvapotranspiration_V2</span><span class="p">,</span>
        <span class="n">Calc_PotentialEvapotranspiration_V3</span><span class="p">,</span>
        <span class="n">Update_PotentialEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Calc_MeanReferenceEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Calc_MeanPotentialEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Calc_InterceptedWater_V1</span><span class="p">,</span>
        <span class="n">Calc_SoilWater_V1</span><span class="p">,</span>
        <span class="n">Calc_SnowCover_V1</span><span class="p">,</span>
        <span class="n">Calc_SnowyCanopy_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialWaterEvaporation_V1</span><span class="p">,</span>
        <span class="n">Calc_WaterEvaporation_V1</span><span class="p">,</span>
        <span class="n">Calc_WaterEvaporation_V2</span><span class="p">,</span>
        <span class="n">Calc_WaterEvaporation_V3</span><span class="p">,</span>
        <span class="n">Calc_WaterEvaporation_V4</span><span class="p">,</span>
        <span class="n">Update_LoggedWaterEvaporation_V1</span><span class="p">,</span>
        <span class="n">Calc_DailyWaterEvaporation_V1</span><span class="p">,</span>
        <span class="n">Calc_InterceptionEvaporation_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialInterceptionEvaporation_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialInterceptionEvaporation_V2</span><span class="p">,</span>
        <span class="n">Calc_PotentialInterceptionEvaporation_V3</span><span class="p">,</span>
        <span class="n">Calc_InterceptionEvaporation_V2</span><span class="p">,</span>
        <span class="n">Calc_PotentialSoilEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialSoilEvapotranspiration_V2</span><span class="p">,</span>
        <span class="n">Calc_SoilEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Calc_SoilEvapotranspiration_V2</span><span class="p">,</span>
        <span class="n">Calc_SoilEvapotranspiration_V3</span><span class="p">,</span>
        <span class="n">Update_SoilEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Update_SoilEvapotranspiration_V2</span><span class="p">,</span>
        <span class="n">Update_SoilEvapotranspiration_V3</span><span class="p">,</span>
        <span class="n">Update_LoggedPrecipitation_V1</span><span class="p">,</span>
        <span class="n">Update_LoggedPotentialSoilEvapotranspiration_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">INTERFACE_METHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Determine_PotentialEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Get_PotentialEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Get_PotentialEvapotranspiration_V2</span><span class="p">,</span>
        <span class="n">Get_MeanPotentialEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Get_MeanPotentialEvapotranspiration_V2</span><span class="p">,</span>
        <span class="n">Determine_InterceptionEvaporation_V1</span><span class="p">,</span>
        <span class="n">Determine_InterceptionEvaporation_V2</span><span class="p">,</span>
        <span class="n">Determine_PotentialInterceptionEvaporation_V1</span><span class="p">,</span>
        <span class="n">Determine_SoilEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Determine_SoilEvapotranspiration_V2</span><span class="p">,</span>
        <span class="n">Determine_SoilEvapotranspiration_V3</span><span class="p">,</span>
        <span class="n">Determine_WaterEvaporation_V1</span><span class="p">,</span>
        <span class="n">Determine_WaterEvaporation_V2</span><span class="p">,</span>
        <span class="n">Determine_WaterEvaporation_V3</span><span class="p">,</span>
        <span class="n">Get_WaterEvaporation_V1</span><span class="p">,</span>
        <span class="n">Get_PotentialWaterEvaporation_V1</span><span class="p">,</span>
        <span class="n">Get_PotentialInterceptionEvaporation_V1</span><span class="p">,</span>
        <span class="n">Get_InterceptionEvaporation_V1</span><span class="p">,</span>
        <span class="n">Get_PotentialSoilEvapotranspiration_V1</span><span class="p">,</span>
        <span class="n">Get_SoilEvapotranspiration_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ADD_METHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Return_AdjustedWindSpeed_V1</span><span class="p">,</span>
        <span class="n">Return_SaturationVapourPressure_V1</span><span class="p">,</span>
        <span class="n">Return_SaturationVapourPressureSlope_V1</span><span class="p">,</span>
        <span class="n">Return_Evaporation_PenmanMonteith_V1</span><span class="p">,</span>
        <span class="n">Return_Evaporation_PenmanMonteith_V2</span><span class="p">,</span>
        <span class="n">Calc_ReferenceEvapotranspiration_PETModel_V1</span><span class="p">,</span>
        <span class="n">Calc_AirTemperature_TempModel_V1</span><span class="p">,</span>
        <span class="n">Calc_AirTemperature_TempModel_V2</span><span class="p">,</span>
        <span class="n">Calc_Precipitation_PrecipModel_V1</span><span class="p">,</span>
        <span class="n">Calc_Precipitation_PrecipModel_V2</span><span class="p">,</span>
        <span class="n">Calc_InterceptedWater_IntercModel_V1</span><span class="p">,</span>
        <span class="n">Calc_SoilWater_SoilWaterModel_V1</span><span class="p">,</span>
        <span class="n">Calc_SnowCover_SnowCoverModel_V1</span><span class="p">,</span>
        <span class="n">Calc_SnowyCanopy_SnowyCanopyModel_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialInterceptionEvaporation_PETModel_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialInterceptionEvaporation_PETModel_V2</span><span class="p">,</span>
        <span class="n">Calc_PotentialSoilEvapotranspiration_PETModel_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialSoilEvapotranspiration_PETModel_V2</span><span class="p">,</span>
        <span class="n">Calc_PotentialWaterEvaporation_PETModel_V1</span><span class="p">,</span>
        <span class="n">Calc_PotentialWaterEvaporation_PETModel_V2</span><span class="p">,</span>
        <span class="n">Calc_CurrentAlbedo_SnowAlbedoModel_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">OUTLET_METHODS</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">SENDER_METHODS</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span>
        <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V1</span><span class="p">,</span>
        <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span><span class="p">,</span>
        <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V1</span><span class="p">,</span>
        <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">SUBMODELS</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">retmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span><span class="p">(</span><span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">)</span>
    <span class="n">retmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">retmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="n">petmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span><span class="p">(</span><span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">)</span>
    <span class="n">petmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">petmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="n">tempmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span><span class="p">(</span>
        <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V1</span><span class="p">,</span> <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span>
    <span class="p">)</span>
    <span class="n">tempmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">tempmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="n">precipmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span><span class="p">(</span>
        <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V1</span><span class="p">,</span> <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V2</span>
    <span class="p">)</span>
    <span class="n">precipmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">precipmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="n">radiationmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span><span class="p">(</span>
        <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V1</span><span class="p">,</span>
        <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V2</span><span class="p">,</span>
        <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V3</span><span class="p">,</span>
        <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V4</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">radiationmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">radiationmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="n">intercmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span><span class="p">(</span><span class="n">stateinterfaces</span><span class="o">.</span><span class="n">IntercModel_V1</span><span class="p">)</span>
    <span class="n">intercmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">intercmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="n">soilwatermodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span><span class="p">(</span><span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SoilWaterModel_V1</span><span class="p">)</span>
    <span class="n">soilwatermodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">soilwatermodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="n">snowcovermodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span><span class="p">(</span><span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowCoverModel_V1</span><span class="p">)</span>
    <span class="n">snowcovermodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">snowcovermodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="n">snowycanopymodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span><span class="p">(</span>
        <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowyCanopyModel_V1</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">snowycanopymodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">snowycanopymodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="n">snowalbedomodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span><span class="p">(</span>
        <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowAlbedoModel_V1</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">snowalbedomodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">snowalbedomodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span></div>



<div class="viewcode-block" id="Sub_ETModel">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Sub_ETModel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Sub_ETModel</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for submodels that comply with the submodel interfaces defined in</span>
<span class="sd">    modules |petinterfaces| and |aetinterfaces|.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Sub_ETModel.share_configuration">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Sub_ETModel.share_configuration">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">share_configuration</span><span class="p">(</span>
        <span class="n">sharable_configuration</span><span class="p">:</span> <span class="n">SharableConfiguration</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Take the `landtype_constants` data to adjust the parameters</span>
<span class="sd">        |evap_control.HRUType| and |evap_control.LandMonthFactor|, the</span>
<span class="sd">        `landtype_refindices` parameter instance to adjust the index references of all</span>
<span class="sd">        parameters inherited from |evap_parameters.ZipParameter1D| and the `refweights`</span>
<span class="sd">        parameter instance to adjust the weight references of all sequences inherited</span>
<span class="sd">        from |evap_sequences.FactorSequence1D| or |evap_sequences.FluxSequence1D|,</span>
<span class="sd">        temporarily:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.core.parametertools import Constants, NameParameter, Parameter</span>
<span class="sd">        &gt;&gt;&gt; consts = Constants(GRASS=1, TREES=3, WATER=2)</span>
<span class="sd">        &gt;&gt;&gt; class LandType(NameParameter):</span>
<span class="sd">        ...     __name__ = &quot;temp.py&quot;</span>
<span class="sd">        ...     constants = consts</span>
<span class="sd">        &gt;&gt;&gt; class Subarea(Parameter):</span>
<span class="sd">        ...     ...</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap.evap_model import Sub_ETModel</span>
<span class="sd">        &gt;&gt;&gt; with Sub_ETModel.share_configuration(</span>
<span class="sd">        ...         {&quot;landtype_constants&quot;: consts,</span>
<span class="sd">        ...          &quot;landtype_refindices&quot;: LandType,</span>
<span class="sd">        ...          &quot;refweights&quot;: Subarea}):</span>
<span class="sd">        ...     from hydpy.models.evap.evap_control import HRUType, LandMonthFactor</span>
<span class="sd">        ...     HRUType.constants</span>
<span class="sd">        ...     LandMonthFactor.rowmin, LandMonthFactor.rownames</span>
<span class="sd">        ...     from hydpy.models.evap.evap_parameters import ZipParameter1D</span>
<span class="sd">        ...     ZipParameter1D.refindices.__name__</span>
<span class="sd">        ...     ZipParameter1D._refweights.__name__</span>
<span class="sd">        ...     from hydpy.models.evap.evap_sequences import FactorSequence1D, \</span>
<span class="sd">FluxSequence1D</span>
<span class="sd">        ...     FactorSequence1D._refweights.__name__</span>
<span class="sd">        ...     FluxSequence1D._refweights.__name__</span>
<span class="sd">        {&#39;GRASS&#39;: 1, &#39;TREES&#39;: 3, &#39;WATER&#39;: 2}</span>
<span class="sd">        (1, (&#39;grass&#39;, &#39;water&#39;, &#39;trees&#39;))</span>
<span class="sd">        &#39;LandType&#39;</span>
<span class="sd">        &#39;Subarea&#39;</span>
<span class="sd">        &#39;Subarea&#39;</span>
<span class="sd">        &#39;Subarea&#39;</span>
<span class="sd">        &gt;&gt;&gt; HRUType.constants</span>
<span class="sd">        {&#39;ANY&#39;: 0}</span>
<span class="sd">        &gt;&gt;&gt; LandMonthFactor.rowmin, LandMonthFactor.rownames</span>
<span class="sd">        (0, (&#39;ANY&#39;,))</span>
<span class="sd">        &gt;&gt;&gt; ZipParameter1D.refindices</span>
<span class="sd">        &gt;&gt;&gt; ZipParameter1D._refweights</span>
<span class="sd">        &gt;&gt;&gt; FactorSequence1D._refweights</span>
<span class="sd">        &gt;&gt;&gt; FluxSequence1D._refweights</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="o">.</span><span class="n">modify_constants</span><span class="p">(</span>
            <span class="n">sharable_configuration</span><span class="p">[</span><span class="s2">&quot;landtype_constants&quot;</span><span class="p">]</span>
        <span class="p">),</span> <span class="n">evap_parameters</span><span class="o">.</span><span class="n">LandMonthParameter</span><span class="o">.</span><span class="n">modify_rows</span><span class="p">(</span>
            <span class="n">sharable_configuration</span><span class="p">[</span><span class="s2">&quot;landtype_constants&quot;</span><span class="p">]</span>
        <span class="p">),</span> <span class="n">evap_parameters</span><span class="o">.</span><span class="n">ZipParameter1D</span><span class="o">.</span><span class="n">modify_refindices</span><span class="p">(</span>
            <span class="n">sharable_configuration</span><span class="p">[</span><span class="s2">&quot;landtype_refindices&quot;</span><span class="p">]</span>
        <span class="p">),</span> <span class="n">evap_parameters</span><span class="o">.</span><span class="n">ZipParameter1D</span><span class="o">.</span><span class="n">modify_refweights</span><span class="p">(</span>
            <span class="n">sharable_configuration</span><span class="p">[</span><span class="s2">&quot;refweights&quot;</span><span class="p">]</span>
        <span class="p">),</span> <span class="n">evap_parameters</span><span class="o">.</span><span class="n">ZipParameter1D</span><span class="o">.</span><span class="n">modify_refweights</span><span class="p">(</span>
            <span class="n">sharable_configuration</span><span class="p">[</span><span class="s2">&quot;refweights&quot;</span><span class="p">]</span>
        <span class="p">),</span> <span class="n">evap_sequences</span><span class="o">.</span><span class="n">FactorSequence1D</span><span class="o">.</span><span class="n">modify_refweights</span><span class="p">(</span>
            <span class="n">sharable_configuration</span><span class="p">[</span><span class="s2">&quot;refweights&quot;</span><span class="p">]</span>
        <span class="p">),</span> <span class="n">evap_sequences</span><span class="o">.</span><span class="n">FluxSequence1D</span><span class="o">.</span><span class="n">modify_refweights</span><span class="p">(</span>
            <span class="n">sharable_configuration</span><span class="p">[</span><span class="s2">&quot;refweights&quot;</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="k">yield</span></div>


    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">NmbHRU</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_nmbzones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nmbzones</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the number of hydrological response units.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_ret_tw2002 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; model.prepare_nmbzones(2)</span>
<span class="sd">        &gt;&gt;&gt; nmbhru</span>
<span class="sd">        nmbhru(2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">nmbhru</span><span class="p">(</span><span class="n">nmbzones</span><span class="p">)</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">HRUArea</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_subareas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subareas</span><span class="p">:</span> <span class="n">VectorInputFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the area of all hydrological response units in km.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_ret_tw2002 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; model.prepare_subareas([1.0, 3.0])</span>
<span class="sd">        &gt;&gt;&gt; hruarea</span>
<span class="sd">        hruarea(1.0, 3.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">hruarea</span><span class="p">(</span><span class="n">subareas</span><span class="p">)</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">HRUAltitude</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_elevations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elevations</span><span class="p">:</span> <span class="n">VectorInputFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;If such a parameter exists, set the altitude of all hydrological response</span>
<span class="sd">        units in m.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import prepare_model</span>
<span class="sd">        &gt;&gt;&gt; petmodel = prepare_model(&quot;evap_pet_hbv96&quot;)</span>
<span class="sd">        &gt;&gt;&gt; petmodel.parameters.control.nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; petmodel.prepare_elevations([1.0, 3.0])</span>
<span class="sd">        &gt;&gt;&gt; petmodel.parameters.control.hrualtitude</span>
<span class="sd">        hrualtitude(1.0, 3.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">hrualtitude</span><span class="p">(</span><span class="n">elevations</span><span class="p">)</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">HRUType</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_zonetypes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zonetypes</span><span class="p">:</span> <span class="n">VectorInputInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;If such a parameter exists, set the hydrological response unit types.</span>

<span class="sd">        &gt;&gt;&gt; GRASS, TREES, WATER = 1, 3, 2</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.core.parametertools import Constants</span>
<span class="sd">        &gt;&gt;&gt; constants = Constants(GRASS=GRASS, TREES=TREES, WATER=WATER)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap.evap_control import HRUType</span>
<span class="sd">        &gt;&gt;&gt; with HRUType.modify_constants(constants):</span>
<span class="sd">        ...     from hydpy.models.evap_pet_mlc import *</span>
<span class="sd">        ...     parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; model.prepare_zonetypes([TREES, WATER])</span>
<span class="sd">        &gt;&gt;&gt; hrutype</span>
<span class="sd">        hrutype(TREES, WATER)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">hrutype</span><span class="p">(</span><span class="n">zonetypes</span><span class="p">)</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">Water</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_water</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">water</span><span class="p">:</span> <span class="n">VectorInputBool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the flag indicating whether or not the respective hydrological response</span>
<span class="sd">        units are water areas.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_hbv96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; model.prepare_water([True, False])</span>
<span class="sd">        &gt;&gt;&gt; water</span>
<span class="sd">        water(True, False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">water</span><span class="p">(</span><span class="n">water</span><span class="p">)</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">Interception</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_interception</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interception</span><span class="p">:</span> <span class="n">VectorInputBool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the flag indicating whether or not the respective hydrological response</span>
<span class="sd">        units consider interception evaporation.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_hbv96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; model.prepare_interception([True, False])</span>
<span class="sd">        &gt;&gt;&gt; interception</span>
<span class="sd">        interception(True, False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">interception</span><span class="p">(</span><span class="n">interception</span><span class="p">)</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">Soil</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_soil</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">soil</span><span class="p">:</span> <span class="n">VectorInputBool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the flag indicating whether or not the respective hydrological response</span>
<span class="sd">        units consider evapotranspiration from the soil.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_hbv96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; model.prepare_soil([True, False])</span>
<span class="sd">        &gt;&gt;&gt; soil</span>
<span class="sd">        soil(True, False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">soil</span><span class="p">(</span><span class="n">soil</span><span class="p">)</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">Plant</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_plant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plant</span><span class="p">:</span> <span class="n">VectorInputBool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the flag indicating whether or not the respective hydrological response</span>
<span class="sd">        units contain vegetation.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import prepare_model</span>
<span class="sd">        &gt;&gt;&gt; ambav = prepare_model(&quot;evap_pet_ambav1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; ambav.parameters.control.nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; ambav.prepare_plant([True, False])</span>
<span class="sd">        &gt;&gt;&gt; ambav.parameters.control.plant</span>
<span class="sd">        plant(True, False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">plant</span><span class="p">(</span><span class="n">plant</span><span class="p">)</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">Tree</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">VectorInputBool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the flag indicating whether or not the respective hydrological response</span>
<span class="sd">        units contain tree-like vegetation.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_morsim import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; model.prepare_tree([True, False])</span>
<span class="sd">        &gt;&gt;&gt; tree</span>
<span class="sd">        tree(True, False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">tree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">Conifer</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_conifer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conifer</span><span class="p">:</span> <span class="n">VectorInputBool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the flag indicating whether or not the respective hydrological response</span>
<span class="sd">        units contain conifer-like vegetation.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_morsim import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; model.prepare_conifer([True, False])</span>
<span class="sd">        &gt;&gt;&gt; conifer</span>
<span class="sd">        conifer(True, False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">conifer</span><span class="p">(</span><span class="n">conifer</span><span class="p">)</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">LeafAreaIndex</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_leafareaindex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">leafareaindex</span><span class="p">:</span> <span class="n">MatrixInputFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the leaf area index in m/m.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_morsim import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; model.prepare_leafareaindex(10.0)</span>
<span class="sd">        &gt;&gt;&gt; leafareaindex</span>
<span class="sd">        leafareaindex(ANY=[10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0,</span>
<span class="sd">                           10.0, 10.0, 10.0])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">leafareaindex</span><span class="p">(</span><span class="n">leafareaindex</span><span class="p">)</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">MeasuringHeightWindSpeed</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_measuringheightwindspeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measuringheightwindspeed</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the height above the ground of the wind speed measurements in m.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_morsim import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; model.prepare_measuringheightwindspeed(10.0)</span>
<span class="sd">        &gt;&gt;&gt; measuringheightwindspeed</span>
<span class="sd">        measuringheightwindspeed(10.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">measuringheightwindspeed</span><span class="p">(</span><span class="n">measuringheightwindspeed</span><span class="p">)</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">evap_control</span><span class="o">.</span><span class="n">MaxSoilWater</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_maxsoilwater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxsoilwater</span><span class="p">:</span> <span class="n">VectorInputFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the maximum soil water content in mm.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_hbv96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; model.prepare_maxsoilwater([100.0, 200.0])</span>
<span class="sd">        &gt;&gt;&gt; maxsoilwater</span>
<span class="sd">        maxsoilwater(100.0, 200.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">maxsoilwater</span><span class="p">(</span><span class="n">maxsoilwater</span><span class="p">)</span></div>



<div class="viewcode-block" id="Main_RET_PETModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_RET_PETModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_RET_PETModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that use submodels named `retmodel`</span>
<span class="sd">    and comply with the |PETModel_V1| interface.&quot;&quot;&quot;</span>

    <span class="n">retmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">retmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">retmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;retmodel&quot;</span><span class="p">,</span>
        <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span>
        <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">,</span>
        <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="o">.</span><span class="n">prepare_subareas</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_retmodel_v1</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">retmodel</span><span class="p">:</span> <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>  <span class="c1"># pylint: disable=unused-argument</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given `retmodel` that follows the |PETModel_V1| interface and</span>
<span class="sd">        is responsible for calculating the reference evapotranspiration.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-01-01&quot;, &quot;2001-01-01&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_pet_m import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; hruarea(2.0, 8.0)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_retmodel_v1(&quot;evap_ret_io&quot;):</span>
<span class="sd">        ...     nmbhru</span>
<span class="sd">        nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; model.retmodel.parameters.control.hruarea</span>
<span class="sd">        hruarea(2.0, 8.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span>
        <span class="n">retmodel</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">nmbhru</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">retmodel</span><span class="o">.</span><span class="n">prepare_subareas</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">hruarea</span><span class="o">.</span><span class="n">values</span><span class="p">)</span></div>



<div class="viewcode-block" id="Main_PET_PETModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_PET_PETModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_PET_PETModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that use submodels named `petmodel`</span>
<span class="sd">    and comply with the |PETModel_V1| interface.&quot;&quot;&quot;</span>

    <span class="n">petmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">petmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">petmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;petmodel&quot;</span><span class="p">,</span>
        <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span>
        <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_petmodel_v1</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">petmodel</span><span class="p">:</span> <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V1</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>  <span class="c1"># pylint: disable=unused-argument</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given `petmodel` that follows the |PETModel_V1| interface and</span>
<span class="sd">        is responsible for calculating potential evapotranspiration.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-01-01&quot;, &quot;2001-01-01&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_hbv96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_petmodel_v1(&quot;evap_ret_io&quot;):</span>
<span class="sd">        ...     hruarea(8.0, 2.0)</span>
<span class="sd">        ...     nmbhru</span>
<span class="sd">        nmbhru(2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span>
        <span class="n">petmodel</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">nmbhru</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>



<div class="viewcode-block" id="Main_PET_PETModel_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_PET_PETModel_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_PET_PETModel_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that use submodels named `petmodel`</span>
<span class="sd">    and comply with the |PETModel_V2| interface.&quot;&quot;&quot;</span>

    <span class="n">petmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">petmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">petmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;petmodel&quot;</span><span class="p">,</span>
        <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V2</span><span class="p">,</span>
        <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V2</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">,</span>
        <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V2</span><span class="o">.</span><span class="n">prepare_interception</span><span class="p">,</span>
        <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V2</span><span class="o">.</span><span class="n">prepare_soil</span><span class="p">,</span>
        <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V2</span><span class="o">.</span><span class="n">prepare_water</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_petmodel_v2</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">petmodel</span><span class="p">:</span> <span class="n">petinterfaces</span><span class="o">.</span><span class="n">PETModel_V2</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>  <span class="c1"># pylint: disable=unused-argument</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given `petmodel` that follows the |PETModel_V2| interface and</span>
<span class="sd">        is responsible for calculating potential evapotranspiration.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-01-01&quot;, &quot;2001-01-01&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_hbv96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; interception(True)</span>
<span class="sd">        &gt;&gt;&gt; soil(True)</span>
<span class="sd">        &gt;&gt;&gt; water(False)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_petmodel_v2(&quot;evap_pet_ambav1&quot;):</span>
<span class="sd">        ...     nmbhru</span>
<span class="sd">        ...     interception</span>
<span class="sd">        ...     soil</span>
<span class="sd">        ...     water</span>
<span class="sd">        nmbhru(2)</span>
<span class="sd">        interception(True)</span>
<span class="sd">        soil(True)</span>
<span class="sd">        water(False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span>
        <span class="n">petmodel</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">nmbhru</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">petmodel</span><span class="o">.</span><span class="n">prepare_interception</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">interception</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">petmodel</span><span class="o">.</span><span class="n">prepare_soil</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">soil</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">petmodel</span><span class="o">.</span><span class="n">prepare_water</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">water</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>



<div class="viewcode-block" id="Main_TempModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_TempModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_TempModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">,</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelInterface</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that can use main models as their</span>
<span class="sd">    sub-submodels if they comply with the |TempModel_V1| interface.&quot;&quot;&quot;</span>

    <span class="n">tempmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">tempmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">tempmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

<div class="viewcode-block" id="Main_TempModel_V1.add_mainmodel_as_subsubmodel">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_TempModel_V1.add_mainmodel_as_subsubmodel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mainmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add the given main model as a submodel if it complies with the</span>
<span class="sd">        |TempModel_V1| interface.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import prepare_model</span>
<span class="sd">        &gt;&gt;&gt; evap = prepare_model(&quot;evap_pet_hbv96&quot;)</span>
<span class="sd">        &gt;&gt;&gt; evap.add_mainmodel_as_subsubmodel(prepare_model(&quot;evap_ret_io&quot;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; evap.tempmodel</span>
<span class="sd">        &gt;&gt;&gt; evap.tempmodel_is_mainmodel</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; evap.tempmodel_typeid</span>
<span class="sd">        0</span>

<span class="sd">        &gt;&gt;&gt; hland = prepare_model(&quot;hland_96&quot;)</span>
<span class="sd">        &gt;&gt;&gt; evap.add_mainmodel_as_subsubmodel(hland)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.tempmodel is hland</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.tempmodel_is_mainmodel</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.tempmodel_typeid</span>
<span class="sd">        1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">,</span> <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tempmodel</span> <span class="o">=</span> <span class="n">mainmodel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tempmodel_is_mainmodel</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tempmodel_typeid</span> <span class="o">=</span> <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V1</span><span class="o">.</span><span class="n">typeid</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Main_TempModel_V2A">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_TempModel_V2A">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_TempModel_V2A</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that support submodels that comply</span>
<span class="sd">    with the |TempModel_V2| interface and provide subarea size information.&quot;&quot;&quot;</span>

    <span class="n">tempmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">tempmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">tempmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;tempmodel&quot;</span><span class="p">,</span>
        <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span><span class="p">,</span>
        <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">,</span>
        <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span><span class="o">.</span><span class="n">prepare_subareas</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_tempmodel_v2</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tempmodel</span><span class="p">:</span> <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>  <span class="c1"># pylint: disable=unused-argument</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given precipitation model that follows the |TempModel_V2|</span>
<span class="sd">        interface and set the number and the subareas of its zones.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_pet_hbv96 import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; hruarea(2.0, 8.0)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_tempmodel_v2(&quot;meteo_temp_io&quot;):</span>
<span class="sd">        ...     nmbhru</span>
<span class="sd">        ...     hruarea</span>
<span class="sd">        ...     temperatureaddend(1.0, 2.0)</span>
<span class="sd">        nmbhru(2)</span>
<span class="sd">        hruarea(2.0, 8.0)</span>
<span class="sd">        &gt;&gt;&gt; model.tempmodel.parameters.control.temperatureaddend</span>
<span class="sd">        temperatureaddend(1.0, 2.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span>
        <span class="n">tempmodel</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">nmbhru</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">tempmodel</span><span class="o">.</span><span class="n">prepare_subareas</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">hruarea</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>



<div class="viewcode-block" id="Main_TempModel_V2B">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_TempModel_V2B">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_TempModel_V2B</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that support submodels that comply</span>
<span class="sd">    with the |TempModel_V2| interface and do not provide subarea size information.&quot;&quot;&quot;</span>

    <span class="n">tempmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">tempmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">tempmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;tempmodel&quot;</span><span class="p">,</span>
        <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span><span class="p">,</span>
        <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_tempmodel_v2</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tempmodel</span><span class="p">:</span> <span class="n">tempinterfaces</span><span class="o">.</span><span class="n">TempModel_V2</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>  <span class="c1"># pylint: disable=unused-argument</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given precipitation model that follows the |TempModel_V2|</span>
<span class="sd">        interface and set the number of its zones.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_hbv96 import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_tempmodel_v2(&quot;meteo_temp_io&quot;):</span>
<span class="sd">        ...     nmbhru</span>
<span class="sd">        ...     hruarea(0.8, 0.2)</span>
<span class="sd">        ...     temperatureaddend(1.0, 2.0)</span>
<span class="sd">        nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; model.tempmodel.parameters.control.hruarea</span>
<span class="sd">        hruarea(0.8, 0.2)</span>
<span class="sd">        &gt;&gt;&gt; model.tempmodel.parameters.control.temperatureaddend</span>
<span class="sd">        temperatureaddend(1.0, 2.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span>
        <span class="n">tempmodel</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">nmbhru</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>



<div class="viewcode-block" id="Main_PrecipModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_PrecipModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_PrecipModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">,</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelInterface</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that can use main models as their</span>
<span class="sd">    sub-submodels if they comply with the |PrecipModel_V1| interface.&quot;&quot;&quot;</span>

    <span class="n">precipmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">precipmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">precipmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

<div class="viewcode-block" id="Main_PrecipModel_V1.add_mainmodel_as_subsubmodel">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_PrecipModel_V1.add_mainmodel_as_subsubmodel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mainmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add the given main model as a submodel if it complies with the</span>
<span class="sd">        |PrecipModel_V1| interface.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import prepare_model</span>
<span class="sd">        &gt;&gt;&gt; evap = prepare_model(&quot;evap_pet_hbv96&quot;)</span>
<span class="sd">        &gt;&gt;&gt; evap.add_mainmodel_as_subsubmodel(prepare_model(&quot;evap_ret_io&quot;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; evap.precipmodel</span>
<span class="sd">        &gt;&gt;&gt; evap.precipmodel_is_mainmodel</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; evap.precipmodel_typeid</span>
<span class="sd">        0</span>

<span class="sd">        &gt;&gt;&gt; hland = prepare_model(&quot;hland_96&quot;)</span>
<span class="sd">        &gt;&gt;&gt; evap.add_mainmodel_as_subsubmodel(hland)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.precipmodel is hland</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.precipmodel_is_mainmodel</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.precipmodel_typeid</span>
<span class="sd">        1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">,</span> <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">precipmodel</span> <span class="o">=</span> <span class="n">mainmodel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">precipmodel_is_mainmodel</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">precipmodel_typeid</span> <span class="o">=</span> <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V1</span><span class="o">.</span><span class="n">typeid</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Main_PrecipModel_V2A">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_PrecipModel_V2A">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_PrecipModel_V2A</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that support submodels that comply</span>
<span class="sd">    with the |PrecipModel_V2| interface.&quot;&quot;&quot;</span>

    <span class="n">precipmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">precipmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">precipmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;precipmodel&quot;</span><span class="p">,</span>
        <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V2</span><span class="p">,</span>
        <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V2</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">,</span>
        <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V2</span><span class="o">.</span><span class="n">prepare_subareas</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_precipmodel_v2</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">precipmodel</span><span class="p">:</span> <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V2</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>  <span class="c1"># pylint: disable=unused-argument</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given precipitation model that follows the |PrecipModel_V2|</span>
<span class="sd">        interface and set the number and the subareas of its zones.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_pet_hbv96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; hruarea(2.0, 8.0)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_precipmodel_v2(&quot;meteo_precip_io&quot;):</span>
<span class="sd">        ...     nmbhru</span>
<span class="sd">        ...     hruarea</span>
<span class="sd">        ...     precipitationfactor(1.0, 2.0)</span>
<span class="sd">        nmbhru(2)</span>
<span class="sd">        hruarea(2.0, 8.0)</span>
<span class="sd">        &gt;&gt;&gt; model.precipmodel.parameters.control.precipitationfactor</span>
<span class="sd">        precipitationfactor(1.0, 2.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span>
        <span class="n">precipmodel</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">nmbhru</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">precipmodel</span><span class="o">.</span><span class="n">prepare_subareas</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">hruarea</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>



<div class="viewcode-block" id="Main_PrecipModel_V2B">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_PrecipModel_V2B">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_PrecipModel_V2B</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that support submodels that comply</span>
<span class="sd">    with the |PrecipModel_V2| interface.&quot;&quot;&quot;</span>

    <span class="n">precipmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">precipmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">precipmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;precipmodel&quot;</span><span class="p">,</span>
        <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V2</span><span class="p">,</span>
        <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V2</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_precipmodel_v2</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">precipmodel</span><span class="p">:</span> <span class="n">precipinterfaces</span><span class="o">.</span><span class="n">PrecipModel_V2</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>  <span class="c1"># pylint: disable=unused-argument</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given precipitation model that follows the |PrecipModel_V2|</span>
<span class="sd">        interface and set the number of its zones.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_pet_ambav1 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_precipmodel_v2(&quot;meteo_precip_io&quot;):</span>
<span class="sd">        ...     nmbhru</span>
<span class="sd">        ...     hruarea(0.8, 0.2)</span>
<span class="sd">        ...     precipitationfactor(1.0, 2.0)</span>
<span class="sd">        nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; model.precipmodel.parameters.control.hruarea</span>
<span class="sd">        hruarea(0.8, 0.2)</span>
<span class="sd">        &gt;&gt;&gt; model.precipmodel.parameters.control.precipitationfactor</span>
<span class="sd">        precipitationfactor(1.0, 2.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span>
        <span class="n">precipmodel</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">nmbhru</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>



<div class="viewcode-block" id="Main_RadiationModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_RadiationModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_RadiationModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that support submodels that comply</span>
<span class="sd">    with the |RadiationModel_V1| interface.&quot;&quot;&quot;</span>

    <span class="n">radiationmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">radiationmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">radiationmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;radiationmodel&quot;</span><span class="p">,</span> <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V1</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_radiationmodel_v1</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">radiationmodel</span><span class="p">:</span> <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V1</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given radiation model that follows the |RadiationModel_V1|</span>
<span class="sd">        interface.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-01-01&quot;, &quot;2000-01-02&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_ret_tw2002 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v1(&quot;meteo_glob_fao56&quot;):</span>
<span class="sd">        ...     latitude(50.0)</span>
<span class="sd">        ...     longitude(5.0)</span>
<span class="sd">        &gt;&gt;&gt; model.radiationmodel.parameters.control.latitude</span>
<span class="sd">        latitude(50.0)</span>
<span class="sd">        &quot;&quot;&quot;</span></div>



<div class="viewcode-block" id="Main_RadiationModel_V2">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_RadiationModel_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_RadiationModel_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that support submodels that comply</span>
<span class="sd">    with the |RadiationModel_V2| interface.&quot;&quot;&quot;</span>

    <span class="n">radiationmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">radiationmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">radiationmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;radiationmodel&quot;</span><span class="p">,</span> <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V2</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_radiationmodel_v2</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">radiationmodel</span><span class="p">:</span> <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V2</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given radiation model that follows the |RadiationModel_V2|</span>
<span class="sd">        interface.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-01-01&quot;, &quot;2000-01-02&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_ret_tw2002 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v2(&quot;meteo_glob_io&quot;):</span>
<span class="sd">        ...     inputs.globalradiation = 100.0</span>
<span class="sd">        &gt;&gt;&gt; model.radiationmodel.sequences.inputs.globalradiation</span>
<span class="sd">        globalradiation(100.0)</span>
<span class="sd">        &quot;&quot;&quot;</span></div>



<div class="viewcode-block" id="Main_RadiationModel_V3">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_RadiationModel_V3">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_RadiationModel_V3</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that support submodels that comply</span>
<span class="sd">    with the |RadiationModel_V3| interface.&quot;&quot;&quot;</span>

    <span class="n">radiationmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">radiationmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">radiationmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;radiationmodel&quot;</span><span class="p">,</span> <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V3</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_radiationmodel_v3</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">radiationmodel</span><span class="p">:</span> <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V3</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given radiation model that follows the |RadiationModel_V3|</span>
<span class="sd">        interface.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-01-01&quot;, &quot;2000-01-02&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_ret_fao56 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v3(&quot;meteo_clear_glob_io&quot;):</span>
<span class="sd">        ...     inputs.clearskysolarradiation = 200.0</span>
<span class="sd">        ...     inputs.globalradiation = 100.0</span>
<span class="sd">        &gt;&gt;&gt; model.radiationmodel.sequences.inputs.clearskysolarradiation</span>
<span class="sd">        clearskysolarradiation(200.0)</span>
<span class="sd">        &gt;&gt;&gt; model.radiationmodel.sequences.inputs.globalradiation</span>
<span class="sd">        globalradiation(100.0)</span>
<span class="sd">        &quot;&quot;&quot;</span></div>



<div class="viewcode-block" id="Main_RadiationModel_V4">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_RadiationModel_V4">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_RadiationModel_V4</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that support submodels that comply</span>
<span class="sd">    with the |RadiationModel_V4| interface.&quot;&quot;&quot;</span>

    <span class="n">radiationmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">radiationmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">radiationmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;radiationmodel&quot;</span><span class="p">,</span> <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V4</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_radiationmodel_v4</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">radiationmodel</span><span class="p">:</span> <span class="n">radiationinterfaces</span><span class="o">.</span><span class="n">RadiationModel_V4</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given radiation model that follows the |RadiationModel_V4|</span>
<span class="sd">        interface.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &quot;2000-01-01&quot;, &quot;2000-01-02&quot;, &quot;1d&quot;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_pet_ambav1 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; with model.add_radiationmodel_v4(&quot;meteo_psun_sun_glob_io&quot;):</span>
<span class="sd">        ...     inputs.possiblesunshineduration = 12.0</span>
<span class="sd">        ...     inputs.sunshineduration = 6.0</span>
<span class="sd">        ...     inputs.globalradiation = 100.0</span>
<span class="sd">        &gt;&gt;&gt; model.radiationmodel.sequences.inputs.possiblesunshineduration</span>
<span class="sd">        possiblesunshineduration(12.0)</span>
<span class="sd">        &gt;&gt;&gt; model.radiationmodel.sequences.inputs.sunshineduration</span>
<span class="sd">        sunshineduration(6.0)</span>
<span class="sd">        &gt;&gt;&gt; model.radiationmodel.sequences.inputs.globalradiation</span>
<span class="sd">        globalradiation(100.0)</span>
<span class="sd">        &quot;&quot;&quot;</span></div>



<div class="viewcode-block" id="Main_IntercModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_IntercModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_IntercModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">,</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelInterface</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that can use main models as their</span>
<span class="sd">    sub-submodels if they comply with the |IntercModel_V1| interface.&quot;&quot;&quot;</span>

    <span class="n">intercmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">intercmodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">intercmodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

<div class="viewcode-block" id="Main_IntercModel_V1.add_mainmodel_as_subsubmodel">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_IntercModel_V1.add_mainmodel_as_subsubmodel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mainmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add the given main model as a submodel if it complies with the</span>
<span class="sd">        |IntercModel_V1| interface.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import prepare_model</span>
<span class="sd">        &gt;&gt;&gt; evap = prepare_model(&quot;evap_aet_hbv96&quot;)</span>
<span class="sd">        &gt;&gt;&gt; evap.add_mainmodel_as_subsubmodel(prepare_model(&quot;evap_ret_io&quot;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; evap.intercmodel</span>
<span class="sd">        &gt;&gt;&gt; evap.intercmodel_is_mainmodel</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; evap.intercmodel_typeid</span>
<span class="sd">        0</span>

<span class="sd">        &gt;&gt;&gt; hland = prepare_model(&quot;hland_96&quot;)</span>
<span class="sd">        &gt;&gt;&gt; evap.add_mainmodel_as_subsubmodel(hland)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.intercmodel is hland</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.intercmodel_is_mainmodel</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.intercmodel_typeid</span>
<span class="sd">        1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">,</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">IntercModel_V1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">intercmodel</span> <span class="o">=</span> <span class="n">mainmodel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">intercmodel_is_mainmodel</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">intercmodel_typeid</span> <span class="o">=</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">IntercModel_V1</span><span class="o">.</span><span class="n">typeid</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">)</span></div>


    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;intercmodel&quot;</span><span class="p">,</span>
        <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">IntercModel_V1</span><span class="p">,</span>
        <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">IntercModel_V1</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_intercmodel_v1</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">intercmodel</span><span class="p">:</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">IntercModel_V1</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>  <span class="c1"># pylint: disable=unused-argument</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given interception model that follows the |IntercModel_V1|</span>
<span class="sd">        interface and set the number of its zones.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_hbv96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_intercmodel_v1(&quot;dummy_interceptedwater&quot;):</span>
<span class="sd">        ...     nmbhru</span>
<span class="sd">        nmbhru(2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span>
        <span class="n">intercmodel</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">nmbhru</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>



<div class="viewcode-block" id="Main_SoilWaterModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_SoilWaterModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_SoilWaterModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">,</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelInterface</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that can use main models as their</span>
<span class="sd">    sub-submodels if they comply with the |SoilWaterModel_V1| interface.&quot;&quot;&quot;</span>

    <span class="n">soilwatermodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">soilwatermodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">soilwatermodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

<div class="viewcode-block" id="Main_SoilWaterModel_V1.add_mainmodel_as_subsubmodel">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_SoilWaterModel_V1.add_mainmodel_as_subsubmodel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mainmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add the given main model as a submodel if it complies with the</span>
<span class="sd">        |SoilWaterModel_V1| interface.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import prepare_model</span>
<span class="sd">        &gt;&gt;&gt; evap = prepare_model(&quot;evap_aet_hbv96&quot;)</span>
<span class="sd">        &gt;&gt;&gt; evap.add_mainmodel_as_subsubmodel(prepare_model(&quot;evap_ret_io&quot;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; evap.soilwatermodel</span>
<span class="sd">        &gt;&gt;&gt; evap.soilwatermodel_is_mainmodel</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; evap.soilwatermodel_typeid</span>
<span class="sd">        0</span>

<span class="sd">        &gt;&gt;&gt; hland = prepare_model(&quot;hland_96&quot;)</span>
<span class="sd">        &gt;&gt;&gt; evap.add_mainmodel_as_subsubmodel(hland)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.soilwatermodel is hland</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.soilwatermodel_is_mainmodel</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.soilwatermodel_typeid</span>
<span class="sd">        1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">,</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SoilWaterModel_V1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">soilwatermodel</span> <span class="o">=</span> <span class="n">mainmodel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">soilwatermodel_is_mainmodel</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">soilwatermodel_typeid</span> <span class="o">=</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SoilWaterModel_V1</span><span class="o">.</span><span class="n">typeid</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">)</span></div>


    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;soilwatermodel&quot;</span><span class="p">,</span>
        <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SoilWaterModel_V1</span><span class="p">,</span>
        <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SoilWaterModel_V1</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_soilwatermodel_v1</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">soilwatermodel</span><span class="p">:</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SoilWaterModel_V1</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>  <span class="c1"># pylint: disable=unused-argument</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given soil water model that follows the |SoilWaterModel_V1|</span>
<span class="sd">        interface and set the number of its zones.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_hbv96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_soilwatermodel_v1(&quot;dummy_soilwater&quot;):</span>
<span class="sd">        ...     nmbhru</span>
<span class="sd">        nmbhru(2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span>
        <span class="n">soilwatermodel</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">nmbhru</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>



<div class="viewcode-block" id="Main_SnowCoverModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_SnowCoverModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_SnowCoverModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">,</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelInterface</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that can use main models as their</span>
<span class="sd">    sub-submodels if they comply with the |SnowCoverModel_V1| interface.&quot;&quot;&quot;</span>

    <span class="n">snowcovermodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">snowcovermodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">snowcovermodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

<div class="viewcode-block" id="Main_SnowCoverModel_V1.add_mainmodel_as_subsubmodel">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_SnowCoverModel_V1.add_mainmodel_as_subsubmodel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mainmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add the given main model as a submodel if it complies with the</span>
<span class="sd">        |SnowCoverModel_V1| interface.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import prepare_model</span>
<span class="sd">        &gt;&gt;&gt; evap = prepare_model(&quot;evap_aet_hbv96&quot;)</span>
<span class="sd">        &gt;&gt;&gt; evap.add_mainmodel_as_subsubmodel(prepare_model(&quot;evap_ret_io&quot;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; evap.snowcovermodel</span>
<span class="sd">        &gt;&gt;&gt; evap.snowcovermodel_is_mainmodel</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; evap.snowcovermodel_typeid</span>
<span class="sd">        0</span>

<span class="sd">        &gt;&gt;&gt; hland = prepare_model(&quot;hland_96&quot;)</span>
<span class="sd">        &gt;&gt;&gt; evap.add_mainmodel_as_subsubmodel(hland)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.snowcovermodel is hland</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.snowcovermodel_is_mainmodel</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.snowcovermodel_typeid</span>
<span class="sd">        1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">,</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowCoverModel_V1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">snowcovermodel</span> <span class="o">=</span> <span class="n">mainmodel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">snowcovermodel_is_mainmodel</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">snowcovermodel_typeid</span> <span class="o">=</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowCoverModel_V1</span><span class="o">.</span><span class="n">typeid</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">)</span></div>


    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;snowcovermodel&quot;</span><span class="p">,</span>
        <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowCoverModel_V1</span><span class="p">,</span>
        <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowCoverModel_V1</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_snowcovermodel_v1</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">snowcovermodel</span><span class="p">:</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowCoverModel_V1</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>  <span class="c1"># pylint: disable=unused-argument</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given snow cover model that follows the</span>
<span class="sd">        |SnowCoverModel_V1| interface and set the number of its zones.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_hbv96 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_snowcovermodel_v1(&quot;dummy_snowcover&quot;):</span>
<span class="sd">        ...     nmbhru</span>
<span class="sd">        nmbhru(2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span>
        <span class="n">snowcovermodel</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">nmbhru</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>



<div class="viewcode-block" id="Main_SnowyCanopyModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_SnowyCanopyModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_SnowyCanopyModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">,</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelInterface</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that can use main models as their</span>
<span class="sd">    sub-submodels if they comply with the |SnowyCanopyModel_V1| interface.&quot;&quot;&quot;</span>

    <span class="n">snowycanopymodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">snowycanopymodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">snowycanopymodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

<div class="viewcode-block" id="Main_SnowyCanopyModel_V1.add_mainmodel_as_subsubmodel">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_SnowyCanopyModel_V1.add_mainmodel_as_subsubmodel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mainmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add the given main model as a submodel if it complies with the</span>
<span class="sd">        |SnowyCanopyModel_V1| interface.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import prepare_model</span>
<span class="sd">        &gt;&gt;&gt; evap = prepare_model(&quot;evap_aet_morsim&quot;)</span>
<span class="sd">        &gt;&gt;&gt; evap.add_mainmodel_as_subsubmodel(prepare_model(&quot;evap_ret_io&quot;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; evap.snowycanopymodel</span>
<span class="sd">        &gt;&gt;&gt; evap.snowycanopymodel_is_mainmodel</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; evap.snowycanopymodel_typeid</span>
<span class="sd">        0</span>

<span class="sd">        &gt;&gt;&gt; lland = prepare_model(&quot;lland_knauf_ic&quot;)</span>
<span class="sd">        &gt;&gt;&gt; evap.add_mainmodel_as_subsubmodel(lland)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.snowycanopymodel is lland</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.snowycanopymodel_is_mainmodel</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.snowycanopymodel_typeid</span>
<span class="sd">        1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">,</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowyCanopyModel_V1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">snowycanopymodel</span> <span class="o">=</span> <span class="n">mainmodel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">snowycanopymodel_is_mainmodel</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">snowycanopymodel_typeid</span> <span class="o">=</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowyCanopyModel_V1</span><span class="o">.</span><span class="n">typeid</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">)</span></div>


    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;snowycanopymodel&quot;</span><span class="p">,</span>
        <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowyCanopyModel_V1</span><span class="p">,</span>
        <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowyCanopyModel_V1</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_snowycanopymodel_v1</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">snowycanopymodel</span><span class="p">:</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowyCanopyModel_V1</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>  <span class="c1"># pylint: disable=unused-argument</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given snow cover model that follows the</span>
<span class="sd">        |SnowyCanopyModel_V1| interface and set the number of its zones.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_morsim import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_snowycanopymodel_v1(&quot;dummy_snowycanopy&quot;):</span>
<span class="sd">        ...     nmbhru</span>
<span class="sd">        nmbhru(2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span>
        <span class="n">snowycanopymodel</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">nmbhru</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>



<div class="viewcode-block" id="Main_SnowAlbedoModel_V1">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_SnowAlbedoModel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Main_SnowAlbedoModel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">,</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelInterface</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |evap.DOCNAME.long| models that can use main models as their</span>
<span class="sd">    sub-submodels if they comply with the |SnowAlbedoModel_V1| interface.&quot;&quot;&quot;</span>

    <span class="n">snowalbedomodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelProperty</span>
    <span class="n">snowalbedomodel_is_mainmodel</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelIsMainmodelProperty</span><span class="p">()</span>
    <span class="n">snowalbedomodel_typeid</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelTypeIDProperty</span><span class="p">()</span>

<div class="viewcode-block" id="Main_SnowAlbedoModel_V1.add_mainmodel_as_subsubmodel">
<a class="viewcode-back" href="../../../../evap.html#hydpy.models.evap.evap_model.Main_SnowAlbedoModel_V1.add_mainmodel_as_subsubmodel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mainmodel</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add the given main model as a submodel if it complies with the</span>
<span class="sd">        |SnowAlbedoModel_V1| interface.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import prepare_model</span>
<span class="sd">        &gt;&gt;&gt; evap = prepare_model(&quot;evap_aet_morsim&quot;)</span>
<span class="sd">        &gt;&gt;&gt; evap.add_mainmodel_as_subsubmodel(prepare_model(&quot;evap_ret_io&quot;))</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; evap.snowalbedomodel</span>
<span class="sd">        &gt;&gt;&gt; evap.snowalbedomodel_is_mainmodel</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; evap.snowalbedomodel_typeid</span>
<span class="sd">        0</span>

<span class="sd">        &gt;&gt;&gt; lland = prepare_model(&quot;lland_knauf&quot;)</span>
<span class="sd">        &gt;&gt;&gt; evap.add_mainmodel_as_subsubmodel(lland)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.snowalbedomodel is lland</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.snowalbedomodel_is_mainmodel</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; evap.snowalbedomodel_typeid</span>
<span class="sd">        1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">,</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowAlbedoModel_V1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">snowalbedomodel</span> <span class="o">=</span> <span class="n">mainmodel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">snowalbedomodel_is_mainmodel</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">snowalbedomodel_typeid</span> <span class="o">=</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowAlbedoModel_V1</span><span class="o">.</span><span class="n">typeid</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_mainmodel_as_subsubmodel</span><span class="p">(</span><span class="n">mainmodel</span><span class="p">)</span></div>


    <span class="nd">@importtools</span><span class="o">.</span><span class="n">prepare_submodel</span><span class="p">(</span>
        <span class="s2">&quot;snowalbedomodel&quot;</span><span class="p">,</span>
        <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowAlbedoModel_V1</span><span class="p">,</span>
        <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowAlbedoModel_V1</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_snowalbedomodel_v1</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">snowalbedomodel</span><span class="p">:</span> <span class="n">stateinterfaces</span><span class="o">.</span><span class="n">SnowAlbedoModel_V1</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>  <span class="c1"># pylint: disable=unused-argument</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the given albedo model that follows the |SnowAlbedoModel_V1|</span>
<span class="sd">        interface and set the number of its zones.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.evap_aet_morsim import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbhru(2)</span>
<span class="sd">        &gt;&gt;&gt; with model.add_snowalbedomodel_v1(&quot;dummy_snowalbedo&quot;):</span>
<span class="sd">        ...     nmbhru</span>
<span class="sd">        nmbhru(2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span>
        <span class="n">snowalbedomodel</span><span class="o">.</span><span class="n">prepare_nmbzones</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">nmbhru</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">HydPy 6.2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">hydpy.models.evap.evap_model</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2013-2025, HydPy Developers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.0.4.
    </div>
  </body>
</html>
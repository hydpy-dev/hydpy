<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>netcdftools &#8212; HydPy 5.0.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css?v=127cebf3" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
    
    <script src="_static/documentation_options.js?v=f98c4cc8"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="objecttools" href="objecttools.html" />
    <link rel="prev" title="modeltools" href="modeltools.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="objecttools.html" title="objecttools"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="modeltools.html" title="modeltools"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HydPy 5.0.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="framework.html" >Framework Tools</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="core.html" accesskey="U">Core Tools</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">netcdftools</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/HydPy_Logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to.html">How to…</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="framework.html">Framework Tools</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="core.html">Core Tools</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="aliastools.html">aliastools</a></li>
<li class="toctree-l3"><a class="reference internal" href="autodoctools.html">autodoctools</a></li>
<li class="toctree-l3"><a class="reference internal" href="auxfiletools.html">auxfiletools</a></li>
<li class="toctree-l3"><a class="reference internal" href="devicetools.html">devicetools</a></li>
<li class="toctree-l3"><a class="reference internal" href="exceptiontools.html">exceptiontools</a></li>
<li class="toctree-l3"><a class="reference internal" href="filetools.html">filetools</a></li>
<li class="toctree-l3"><a class="reference internal" href="hydpytools.html">hydpytools</a></li>
<li class="toctree-l3"><a class="reference internal" href="importtools.html">importtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="indextools.html">indextools</a></li>
<li class="toctree-l3"><a class="reference internal" href="itemtools.html">itemtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="masktools.html">masktools</a></li>
<li class="toctree-l3"><a class="reference internal" href="modeltools.html">modeltools</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">netcdftools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.dimmapping"><code class="docutils literal notranslate"><span class="pre">dimmapping</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.varmapping"><code class="docutils literal notranslate"><span class="pre">varmapping</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.fillvalue"><code class="docutils literal notranslate"><span class="pre">fillvalue</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.str2chars"><code class="docutils literal notranslate"><span class="pre">str2chars()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.chars2str"><code class="docutils literal notranslate"><span class="pre">chars2str()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.create_dimension"><code class="docutils literal notranslate"><span class="pre">create_dimension()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.create_variable"><code class="docutils literal notranslate"><span class="pre">create_variable()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.query_variable"><code class="docutils literal notranslate"><span class="pre">query_variable()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.query_timegrid"><code class="docutils literal notranslate"><span class="pre">query_timegrid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.query_array"><code class="docutils literal notranslate"><span class="pre">query_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.get_filepath"><code class="docutils literal notranslate"><span class="pre">get_filepath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo"><code class="docutils literal notranslate"><span class="pre">JITAccessInfo</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo.ncvariable"><code class="docutils literal notranslate"><span class="pre">JITAccessInfo.ncvariable</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo.realisation"><code class="docutils literal notranslate"><span class="pre">JITAccessInfo.realisation</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo.timedelta"><code class="docutils literal notranslate"><span class="pre">JITAccessInfo.timedelta</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo.columns"><code class="docutils literal notranslate"><span class="pre">JITAccessInfo.columns</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo.data"><code class="docutils literal notranslate"><span class="pre">JITAccessInfo.data</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessHandler"><code class="docutils literal notranslate"><span class="pre">JITAccessHandler</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessHandler.readers"><code class="docutils literal notranslate"><span class="pre">JITAccessHandler.readers</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessHandler.writers"><code class="docutils literal notranslate"><span class="pre">JITAccessHandler.writers</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessHandler.read_slices"><code class="docutils literal notranslate"><span class="pre">JITAccessHandler.read_slices()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessHandler.write_slices"><code class="docutils literal notranslate"><span class="pre">JITAccessHandler.write_slices()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface"><code class="docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.log"><code class="docutils literal notranslate"><span class="pre">NetCDFInterface.log()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.read"><code class="docutils literal notranslate"><span class="pre">NetCDFInterface.read()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.write"><code class="docutils literal notranslate"><span class="pre">NetCDFInterface.write()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess"><code class="docutils literal notranslate"><span class="pre">NetCDFInterface.provide_jitaccess()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.foldernames"><code class="docutils literal notranslate"><span class="pre">NetCDFInterface.foldernames</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.filenames"><code class="docutils literal notranslate"><span class="pre">NetCDFInterface.filenames</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.variablenames"><code class="docutils literal notranslate"><span class="pre">NetCDFInterface.variablenames</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.Subdevice2Index"><code class="docutils literal notranslate"><span class="pre">Subdevice2Index</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.Subdevice2Index.dict_"><code class="docutils literal notranslate"><span class="pre">Subdevice2Index.dict_</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.Subdevice2Index.name_sequence"><code class="docutils literal notranslate"><span class="pre">Subdevice2Index.name_sequence</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.Subdevice2Index.name_ncfile"><code class="docutils literal notranslate"><span class="pre">Subdevice2Index.name_ncfile</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.Subdevice2Index.get_index"><code class="docutils literal notranslate"><span class="pre">Subdevice2Index.get_index()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.name"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableBase.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.filepath"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableBase.filepath</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.log"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableBase.log()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.subdevicenames"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableBase.subdevicenames</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.array"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableBase.array</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.insert_subdevices"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableBase.insert_subdevices()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevices"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableBase.query_subdevices()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableBase.query_subdevice2index()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.read"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableBase.read()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.write"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableBase.write()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.shape"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableAgg.shape</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.array"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableAgg.array</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.subdevicenames"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableAgg.subdevicenames</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.read"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableAgg.read()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat.shape"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableFlat.shape</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat.array"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableFlat.array</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat.subdevicenames"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableFlat.subdevicenames</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat.read"><code class="docutils literal notranslate"><span class="pre">NetCDFVariableFlat.read()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="objecttools.html">objecttools</a></li>
<li class="toctree-l3"><a class="reference internal" href="optiontools.html">optiontools</a></li>
<li class="toctree-l3"><a class="reference internal" href="parametertools.html">parametertools</a></li>
<li class="toctree-l3"><a class="reference internal" href="printtools.html">printtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="propertytools.html">propertytools</a></li>
<li class="toctree-l3"><a class="reference internal" href="pubtools.html">pubtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="selectiontools.html">selectiontools</a></li>
<li class="toctree-l3"><a class="reference internal" href="sequencetools.html">sequencetools</a></li>
<li class="toctree-l3"><a class="reference internal" href="seriestools.html">seriestools</a></li>
<li class="toctree-l3"><a class="reference internal" href="testtools.html">testtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="timetools.html">timetools</a></li>
<li class="toctree-l3"><a class="reference internal" href="typingtools.html">typingtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="variabletools.html">variabletools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="execution.html">Execution Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="cythons.html">Cython Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="auxiliaries.html">Auxiliary Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modelcollection.html">Model Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="zbibliography.html">Bibliography</a></li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="modeltools.html"
                          title="previous chapter">modeltools</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="objecttools.html"
                          title="next chapter">objecttools</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/netcdftools.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="netcdftools">
<span id="id1"></span><h1>netcdftools<a class="headerlink" href="#netcdftools" title="Link to this heading">¶</a></h1>
<p id="module-hydpy.core.netcdftools">This module extends the features of module <a class="reference internal" href="filetools.html#module-hydpy.core.filetools" title="hydpy.core.filetools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">filetools</span></code></a> for loading data from and
storing data to netCDF4 files, consistent with the <a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html">NetCDF Climate and Forecast (CF)
Metadata Conventions</a>.</p>
<p>Usually, we apply the features implemented in this module only indirectly by using
the context managers <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.netcdfreading" title="hydpy.core.filetools.SequenceManager.netcdfreading"><code class="xref py py-func docutils literal notranslate"><span class="pre">netcdfreading()</span></code></a> and
<a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.netcdfwriting" title="hydpy.core.filetools.SequenceManager.netcdfwriting"><code class="xref py py-func docutils literal notranslate"><span class="pre">netcdfwriting()</span></code></a>.  However, here we try to be a little more explicit by
using their underlying methods.  Therefore, we need to follow three steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Call either method <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.open_netcdfreader" title="hydpy.core.filetools.SequenceManager.open_netcdfreader"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_netcdfreader()</span></code></a> or method
<a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.open_netcdfwriter" title="hydpy.core.filetools.SequenceManager.open_netcdfwriter"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_netcdfwriter()</span></code></a> of the <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> object available in
module <code class="xref py py-mod docutils literal notranslate"><span class="pre">pub</span></code> to prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object for reading or writing.</p></li>
<li><p>Call either the usual reading or writing methods of other HydPy classes like
method <a class="reference internal" href="hydpytools.html#hydpy.core.hydpytools.HydPy.load_fluxseries" title="hydpy.core.hydpytools.HydPy.load_fluxseries"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_fluxseries()</span></code></a> of class <a class="reference internal" href="hydpytools.html#hydpy.core.hydpytools.HydPy" title="hydpy.core.hydpytools.HydPy"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydPy</span></code></a> or method
<a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Elements.save_stateseries" title="hydpy.core.devicetools.Elements.save_stateseries"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_stateseries()</span></code></a> of class <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Elements" title="hydpy.core.devicetools.Elements"><code class="xref py py-class docutils literal notranslate"><span class="pre">Elements</span></code></a>.  The prepared <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a>
object collects all requests of those sequences one wants to read from or write to
NetCDF files.</p></li>
<li><p>Finalise reading or writing by calling either method
<a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.close_netcdfreader" title="hydpy.core.filetools.SequenceManager.close_netcdfreader"><code class="xref py py-func docutils literal notranslate"><span class="pre">close_netcdfreader()</span></code></a> or <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.close_netcdfwriter" title="hydpy.core.filetools.SequenceManager.close_netcdfwriter"><code class="xref py py-func docutils literal notranslate"><span class="pre">close_netcdfwriter()</span></code></a>.</p></li>
</ol>
</div></blockquote>
<p>Step 2 is a logging process only, telling the <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object which data needs
to be read or written.  The actual reading from or writing to NetCDF files is triggered
by step 3.</p>
<p>During step 2, the <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object and its subobjects are accessible, allowing
to inspect their current state or modify their behaviour.</p>
<p>The following real code examples show how to perform these three steps both for reading
and writing data, based on the example configuration defined by function
<a class="reference internal" href="examples.html#hydpy.examples.prepare_io_example_1" title="hydpy.examples.prepare_io_example_1"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_io_example_1()</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
</pre></div>
</div>
<p>(1) We prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object for writing data by calling the method
<a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.open_netcdfwriter" title="hydpy.core.filetools.SequenceManager.open_netcdfwriter"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_netcdfwriter()</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">pub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">open_netcdfwriter</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>We tell the <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> to write all the time-series data to NetCDF files:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">filetype</span> <span class="o">=</span> <span class="s2">&quot;nc&quot;</span>
</pre></div>
</div>
<p>(3) We store all the time-series handled by the <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Node" title="hydpy.core.devicetools.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> and <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Element" title="hydpy.core.devicetools.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a> objects of the
example dataset by calling <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Nodes.save_allseries" title="hydpy.core.devicetools.Nodes.save_allseries"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_allseries()</span></code></a> of class <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Nodes" title="hydpy.core.devicetools.Nodes"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nodes</span></code></a> and
<a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Elements.save_allseries" title="hydpy.core.devicetools.Elements.save_allseries"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_allseries()</span></code></a> of class <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Elements" title="hydpy.core.devicetools.Elements"><code class="xref py py-class docutils literal notranslate"><span class="pre">Elements</span></code></a>.  (In real cases, you would not write the
<cite>with TestIO():</cite> line.  This code block makes sure we pollute the IO testing directory
instead of our current working directory):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">nodes</span><span class="o">.</span><span class="n">save_allseries</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">elements</span><span class="o">.</span><span class="n">save_allseries</span><span class="p">()</span>
</pre></div>
</div>
<p>(4) We again log all sequences, but after telling the <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> to average each
time series spatially:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">aggregation</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">nodes</span><span class="o">.</span><span class="n">save_allseries</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">elements</span><span class="o">.</span><span class="n">save_allseries</span><span class="p">()</span>
</pre></div>
</div>
<p>(5) We can now navigate into the details of the logged time series data via the
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object and its subobjects.  For example, we can query the logged flux
sequence objects of type <a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a> belonging to application model <a class="reference internal" href="lland_v1.html#module-hydpy.models.lland_v1" title="hydpy.models.lland_v1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lland_v1</span></code></a>
(those of elements <cite>element1</cite> and <cite>element2</cite>; the trailing numbers are the indices of
the relevant hydrological response units):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span> <span class="o">=</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">netcdfwriter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span><span class="o">.</span><span class="n">lland_v1_flux_nkor</span><span class="o">.</span><span class="n">subdevicenames</span>
<span class="go">(&#39;element1_0&#39;, &#39;element2_0&#39;, &#39;element2_1&#39;)</span>
</pre></div>
</div>
<p>(6) In the example discussed here, all sequences belong to the same folder (<cite>default</cite>).
Storing sequences in separate folders goes hand in hand with storing them in separate
NetCDF files.  In such cases, you must include the folder in the attribute name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span><span class="o">.</span><span class="n">foldernames</span>
<span class="go">(&#39;default&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span><span class="o">.</span><span class="n">default_lland_v1_flux_nkor</span><span class="o">.</span><span class="n">subdevicenames</span>
<span class="go">(&#39;element1_0&#39;, &#39;element2_0&#39;, &#39;element2_1&#39;)</span>
</pre></div>
</div>
<p>(7) We close the <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object, which is the moment where the writing
process happens.  After that, the interface object is not available anymore:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">close_netcdfwriter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">netcdfwriter</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">hydpy.core.exceptiontools.AttributeNotReady</span>: <span class="n">The sequence file manager does currently handle no NetCDF writer object.</span>
</pre></div>
</div>
<p>(8) We set the time series values of two test sequences to zero to demonstrate that
reading the data back in actually works:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="o">.</span><span class="n">node2</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>(9) We move up a gear and and prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object for reading data, log
all <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.NodeSequence" title="hydpy.core.sequencetools.NodeSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeSequence</span></code></a> and <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.ModelSequence" title="hydpy.core.sequencetools.ModelSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelSequence</span></code></a> objects, and read their time series data from
the created NetCDF file.  We temporarily disable the <a class="reference internal" href="optiontools.html#hydpy.core.optiontools.Options.checkseries" title="hydpy.core.optiontools.Options.checkseries"><code class="xref py py-const docutils literal notranslate"><span class="pre">checkseries</span></code></a> option to
prevent raising an exception when reading incomplete data from the files:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">checkseries</span><span class="p">(</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">open_netcdfreader</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">nodes</span><span class="o">.</span><span class="n">load_simseries</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">elements</span><span class="o">.</span><span class="n">load_allseries</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">close_netcdfreader</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple" start="10">
<li><p>We check if the data is available via the test sequences again:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="o">.</span><span class="n">node2</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span>
<span class="go">InfoArray([64., 65., 66., 67.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="o">.</span><span class="n">series</span>
<span class="go">InfoArray([[16., 17.],</span>
<span class="go">           [18., 19.],</span>
<span class="go">           [20., 21.],</span>
<span class="go">           [22., 23.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">netcdfreader</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The sequence file manager does currently handle no NetCDF reader object.</span>
</pre></div>
</div>
<p>(11) We cannot invert spatial aggregation.  Hence reading averaged time series is left
for postprocessing tools.  To show that writing the averaged series worked, we access
both relevant NetCDF files more directly using the underlying NetCDF4 library (note
that averaging 1-dimensional time series as those of node sequence <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sim" title="hydpy.core.sequencetools.Sim"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sim</span></code></a> is allowed for
the sake of consistency):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;project/series/default/node_sim_q_mean.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;sim_q&quot;</span><span class="p">][:])</span>
<span class="go">array([[60.],</span>
<span class="go">       [61.],</span>
<span class="go">       [62.],</span>
<span class="go">       [63.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;project/series/default/lland_v1_flux_nkor_mean.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">][:])[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="go">array([16.5, 18.5, 20.5, 22.5])</span>
</pre></div>
</div>
<p>Besides the testing-related specialities, the described workflow is more or less
standard but allows for different modifications.  We illustrate them in the
documentation of the other features implemented in module <a class="reference internal" href="#module-hydpy.core.netcdftools" title="hydpy.core.netcdftools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">netcdftools</span></code></a> but also the
documentation on class <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> of module <a class="reference internal" href="filetools.html#module-hydpy.core.filetools" title="hydpy.core.filetools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">filetools</span></code></a> and class <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a>
of module <a class="reference internal" href="sequencetools.html#module-hydpy.core.sequencetools" title="hydpy.core.sequencetools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sequencetools</span></code></a>.</p>
<p>Using the NetCDF format allows reading or writing data “just in time” during simulation
runs.  The documentation of class “HydPy” explains how to select and set the relevant
<a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> objects for this option.  See the documentation on method
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess" title="hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess"><code class="xref py py-func docutils literal notranslate"><span class="pre">provide_jitaccess()</span></code></a> of class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> for more in-depth
information.</p>
<p>Module <a class="reference internal" href="#module-hydpy.core.netcdftools" title="hydpy.core.netcdftools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">netcdftools</span></code></a> implements the following members:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.str2chars" title="hydpy.core.netcdftools.str2chars"><code class="xref py py-func docutils literal notranslate"><span class="pre">str2chars()</span></code></a> Return a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> object containing the byte characters (second axis) of all given strings (first axis).</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.chars2str" title="hydpy.core.netcdftools.chars2str"><code class="xref py py-func docutils literal notranslate"><span class="pre">chars2str()</span></code></a> Inversion function of <a class="reference internal" href="#hydpy.core.netcdftools.str2chars" title="hydpy.core.netcdftools.str2chars"><code class="xref py py-func docutils literal notranslate"><span class="pre">str2chars()</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.create_dimension" title="hydpy.core.netcdftools.create_dimension"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_dimension()</span></code></a> Add a new dimension with the given name and length to the given NetCDF file.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.create_variable" title="hydpy.core.netcdftools.create_variable"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_variable()</span></code></a> Add a new variable with the given name, datatype, and dimensions to the given NetCDF file.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.query_variable" title="hydpy.core.netcdftools.query_variable"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_variable()</span></code></a> Return the variable with the given name from the given NetCDF file.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.query_timegrid" title="hydpy.core.netcdftools.query_timegrid"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_timegrid()</span></code></a> Return the <a class="reference internal" href="timetools.html#hydpy.core.timetools.Timegrid" title="hydpy.core.timetools.Timegrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timegrid</span></code></a> defined by the given NetCDF file.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.query_array" title="hydpy.core.netcdftools.query_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_array()</span></code></a> Return the data of the variable with the given name from the given NetCDF file.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.get_filepath" title="hydpy.core.netcdftools.get_filepath"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_filepath()</span></code></a> Return the path of the given NetCDF file.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo" title="hydpy.core.netcdftools.JITAccessInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">JITAccessInfo</span></code></a> Helper class for structuring reading from or writing to a NetCDF file “just in time” during a simulation run for a specific <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a> object.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessHandler" title="hydpy.core.netcdftools.JITAccessHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">JITAccessHandler</span></code></a> Handler used by the <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> object available in module <code class="xref py py-mod docutils literal notranslate"><span class="pre">pub</span></code> for reading data from and/or writing data to NetCDF files at each step of a simulation run.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> Interface between <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> and multiple NetCDF files.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.Subdevice2Index" title="hydpy.core.netcdftools.Subdevice2Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subdevice2Index</span></code></a> Return type of method <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index" title="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_subdevice2index()</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> Base class for <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a> and <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a> Relates objects of a specific <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> subclass with a single NetCDF variable for writing aggregated time series data.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a> Relates objects of a specific <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> subclass with a single NetCDF variable for reading or writing their complete time-series data.</p></li>
</ul>
</div></blockquote>
<hr class="docutils" />
<dl class="py data">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.dimmapping">
<span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">dimmapping</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'nmb_characters':</span> <span class="pre">'char_leng_name',</span> <span class="pre">'nmb_subdevices':</span> <span class="pre">'stations',</span> <span class="pre">'nmb_timepoints':</span> <span class="pre">'time'}</span></em><a class="headerlink" href="#hydpy.core.netcdftools.dimmapping" title="Link to this definition">¶</a></dt>
<dd><p>Dimension-related terms within NetCDF files.</p>
<p>You can change this mapping if it does not suit your requirements.  For example, change 
the value of the keyword “nmb_subdevices” if you prefer to call this dimension 
“location” instead of “stations” within NetCDF files:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">dimmapping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dimmapping</span><span class="p">[</span><span class="s2">&quot;nmb_subdevices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;location&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.varmapping">
<span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">varmapping</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'subdevices':</span> <span class="pre">'station_id',</span> <span class="pre">'timepoints':</span> <span class="pre">'time'}</span></em><a class="headerlink" href="#hydpy.core.netcdftools.varmapping" title="Link to this definition">¶</a></dt>
<dd><p>Variable-related terms within NetCDF files.</p>
<p>You can change this mapping if it does not suit your requirements.  For example, change 
the value of the keyword “timepoints” if you prefer to call this variable “period” 
instead of “time” within NetCDF files:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">varmapping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">varmapping</span><span class="p">[</span><span class="s2">&quot;timepoints&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;period&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.fillvalue">
<span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">fillvalue</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">nan</span></em><a class="headerlink" href="#hydpy.core.netcdftools.fillvalue" title="Link to this definition">¶</a></dt>
<dd><p>Default fill value for writing NetCDF files.</p>
<p>You can set another <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> value before writing a NetCDF file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="kn">import</span> <span class="n">netcdftools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">netcdftools</span><span class="o">.</span><span class="n">fillvalue</span> <span class="o">=</span> <span class="o">-</span><span class="mf">777.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.str2chars">
<span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">str2chars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.11)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.25)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)"><span class="pre">bytes</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#str2chars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.str2chars" title="Link to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> object containing the byte characters (second axis) of
all given strings (first axis).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">str2chars</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">str2chars</span><span class="p">([</span><span class="s1">&#39;street&#39;</span><span class="p">,</span> <span class="s1">&#39;St.&#39;</span><span class="p">,</span> <span class="s1">&#39;Straße&#39;</span><span class="p">,</span> <span class="s1">&#39;Str.&#39;</span><span class="p">])</span>
<span class="go">array([[b&#39;s&#39;, b&#39;t&#39;, b&#39;r&#39;, b&#39;e&#39;, b&#39;e&#39;, b&#39;t&#39;, b&#39;&#39;],</span>
<span class="go">       [b&#39;S&#39;, b&#39;t&#39;, b&#39;.&#39;, b&#39;&#39;, b&#39;&#39;, b&#39;&#39;, b&#39;&#39;],</span>
<span class="go">       [b&#39;S&#39;, b&#39;t&#39;, b&#39;r&#39;, b&#39;a&#39;, b&#39;Ã&#39;, b&#39;&#39;, b&#39;e&#39;],</span>
<span class="go">       [b&#39;S&#39;, b&#39;t&#39;, b&#39;r&#39;, b&#39;.&#39;, b&#39;&#39;, b&#39;&#39;, b&#39;&#39;]], dtype=&#39;|S1&#39;)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">str2chars</span><span class="p">([])</span>
<span class="go">array([], shape=(0, 0), dtype=&#39;|S1&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.chars2str">
<span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">chars2str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.25)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)"><span class="pre">bytes</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#chars2str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.chars2str" title="Link to this definition">¶</a></dt>
<dd><p>Inversion function of <a class="reference internal" href="#hydpy.core.netcdftools.str2chars" title="hydpy.core.netcdftools.str2chars"><code class="xref py py-func docutils literal notranslate"><span class="pre">str2chars()</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">chars2str</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chars2str</span><span class="p">([[</span><span class="sa">b</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">],</span>
<span class="gp">... </span>           <span class="p">[</span><span class="sa">b</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">],</span>
<span class="gp">... </span>           <span class="p">[</span><span class="sa">b</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xc3</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x9f</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;e&quot;</span><span class="p">],</span>
<span class="gp">... </span>           <span class="p">[</span><span class="sa">b</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">]])</span>
<span class="go">[&#39;street&#39;, &#39;St.&#39;, &#39;Straße&#39;, &#39;Str.&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chars2str</span><span class="p">([])</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chars2str</span><span class="p">([[</span><span class="sa">b</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;t&quot;</span><span class="p">],</span>
<span class="gp">... </span>           <span class="p">[</span><span class="sa">b</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">],</span>
<span class="gp">... </span>           <span class="p">[</span><span class="sa">b</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xc3</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;e&quot;</span><span class="p">],</span>
<span class="gp">... </span>           <span class="p">[</span><span class="sa">b</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">]])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Cannot decode `b&#39;Stra\xc3e&#39;` (not UTF-8 compliant).</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.create_dimension">
<span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">create_dimension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#create_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.create_dimension" title="Link to this definition">¶</a></dt>
<dd><p>Add a new dimension with the given name and length to the given NetCDF file.</p>
<p>Essentially, <a class="reference internal" href="#hydpy.core.netcdftools.create_dimension" title="hydpy.core.netcdftools.create_dimension"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_dimension()</span></code></a> only calls the equally named method of the NetCDF
library but adds information to possible error messages:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">create_dimension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;dim1&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dim</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s2">&quot;dim1&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dim</span><span class="o">.</span><span class="n">size</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">dim</span>
<span class="go">5</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;dim1&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>    
<span class="go">While trying to add dimension `dim1` with length `5` to the NetCDF file `test.nc`, the following error occurred: ...</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.create_variable">
<span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">create_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.11)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#create_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.create_variable" title="Link to this definition">¶</a></dt>
<dd><p>Add a new variable with the given name, datatype, and dimensions to the given
NetCDF file.</p>
<p>Essentially, <a class="reference internal" href="#hydpy.core.netcdftools.create_variable" title="hydpy.core.netcdftools.create_variable"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_variable()</span></code></a> only calls the equally named method of the NetCDF
library but adds information to possible error messages:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">create_variable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">create_variable</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var1&quot;</span><span class="p">,</span> <span class="s2">&quot;f8&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;dim1&quot;</span><span class="p">,))</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">))</span>    
<span class="go">While trying to add variable `var1` with datatype `f8` and dimensions `(&#39;dim1&#39;,)` to the NetCDF file `test.nc`, the following error occurred: ...</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">create_dimension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;dim1&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_variable</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var1&quot;</span><span class="p">,</span> <span class="s2">&quot;f8&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;dim1&quot;</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;var1&quot;</span><span class="p">][:])</span>
<span class="go">array([nan, nan, nan, nan, nan])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.query_variable">
<span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">query_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Variable</span></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#query_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.query_variable" title="Link to this definition">¶</a></dt>
<dd><p>Return the variable with the given name from the given NetCDF file.</p>
<p>Essentially, <a class="reference internal" href="#hydpy.core.netcdftools.query_variable" title="hydpy.core.netcdftools.query_variable"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_variable()</span></code></a> only queries the variable via keyword access using
the NetCDF library but adds information to possible error messages:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">query_variable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">file_</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;model.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query_variable</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span> <span class="s2">&quot;flux_prec&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">NetCDF file `model.nc` does not contain variable `flux_prec`.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">create_variable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_variable</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span> <span class="s2">&quot;flux_prec&quot;</span><span class="p">,</span> <span class="s2">&quot;f8&quot;</span><span class="p">,</span> <span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">query_variable</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span> <span class="s2">&quot;flux_prec&quot;</span><span class="p">),</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Variable</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">file_</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.query_timegrid">
<span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">query_timegrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><span class="pre">IOSequence</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="timetools.html#hydpy.core.timetools.Timegrid" title="hydpy.core.timetools.Timegrid"><span class="pre">Timegrid</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#query_timegrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.query_timegrid" title="Link to this definition">¶</a></dt>
<dd><p>Return the <a class="reference internal" href="timetools.html#hydpy.core.timetools.Timegrid" title="hydpy.core.timetools.Timegrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timegrid</span></code></a> defined by the given NetCDF file.</p>
<p><a class="reference internal" href="#hydpy.core.netcdftools.query_timegrid" title="hydpy.core.netcdftools.query_timegrid"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_timegrid()</span></code></a> relies on the <cite>timereference</cite> attribute of the given NetCDF file,
if available, and falls back to the global <a class="reference internal" href="optiontools.html#hydpy.core.optiontools.Options.timestampleft" title="hydpy.core.optiontools.Options.timestampleft"><code class="xref py py-const docutils literal notranslate"><span class="pre">timestampleft</span></code></a> option when
necessary.  The NetCDF files of the <cite>LahnH</cite> example project (and all other NetCDF
files written by <em>HydPy</em>) include such information:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_full_example_2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hp</span><span class="p">,</span> <span class="n">pub</span><span class="p">,</span> <span class="n">TestIO</span> <span class="o">=</span> <span class="n">prepare_full_example_2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;LahnH/series/default/hland_v1_input_p.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ncfile</span><span class="o">.</span><span class="n">timereference</span>
<span class="go">&#39;left interval boundary&#39;</span>
</pre></div>
</div>
<p>We start our examples considering the input sequence <a class="reference internal" href="hland.html#hydpy.models.hland.hland_inputs.P" title="hydpy.models.hland.hland_inputs.P"><code class="xref py py-class docutils literal notranslate"><span class="pre">P</span></code></a>, which
handles precipitation sums.  <a class="reference internal" href="#hydpy.core.netcdftools.query_timegrid" title="hydpy.core.netcdftools.query_timegrid"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_timegrid()</span></code></a> requires an instance of
<a class="reference internal" href="hland.html#hydpy.models.hland.hland_inputs.P" title="hydpy.models.hland.hland_inputs.P"><code class="xref py py-class docutils literal notranslate"><span class="pre">P</span></code></a> to determine that each value of the time series of the NetCDF file
references a time interval and not a time point:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">land_dill</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">p</span>
</pre></div>
</div>
<p>If the file-specific setting does not collide with the current value of
<a class="reference internal" href="optiontools.html#hydpy.core.optiontools.Options.timestampleft" title="hydpy.core.optiontools.Options.timestampleft"><code class="xref py py-const docutils literal notranslate"><span class="pre">timestampleft</span></code></a>, <a class="reference internal" href="#hydpy.core.netcdftools.query_timegrid" title="hydpy.core.netcdftools.query_timegrid"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_timegrid()</span></code></a> works silently:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">query_timegrid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">query_timegrid</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">Timegrid(&quot;1996-01-01 00:00:00&quot;,</span>
<span class="go">         &quot;2007-01-01 00:00:00&quot;,</span>
<span class="go">         &quot;1d&quot;)</span>
</pre></div>
</div>
<p>If a file-specific setting is missing, <a class="reference internal" href="#hydpy.core.netcdftools.query_timegrid" title="hydpy.core.netcdftools.query_timegrid"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_timegrid()</span></code></a> applies the current
<a class="reference internal" href="optiontools.html#hydpy.core.optiontools.Options.timestampleft" title="hydpy.core.optiontools.Options.timestampleft"><code class="xref py py-const docutils literal notranslate"><span class="pre">timestampleft</span></code></a> value:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">del</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">timereference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.testtools</span> <span class="kn">import</span> <span class="n">warn_later</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">query_timegrid</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">Timegrid(&quot;1996-01-01 00:00:00&quot;,</span>
<span class="go">         &quot;2007-01-01 00:00:00&quot;,</span>
<span class="go">         &quot;1d&quot;)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">,</span> <span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">timestampleft</span><span class="p">(</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">query_timegrid</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">Timegrid(&quot;1995-12-31 00:00:00&quot;,</span>
<span class="go">         &quot;2006-12-31 00:00:00&quot;,</span>
<span class="go">         &quot;1d&quot;)</span>
</pre></div>
</div>
<p>If the file-specific setting and <a class="reference internal" href="optiontools.html#hydpy.core.optiontools.Options.timestampleft" title="hydpy.core.optiontools.Options.timestampleft"><code class="xref py py-const docutils literal notranslate"><span class="pre">timestampleft</span></code></a> conflict, <a class="reference internal" href="#hydpy.core.netcdftools.query_timegrid" title="hydpy.core.netcdftools.query_timegrid"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_timegrid()</span></code></a>
favours the file attribute and warns about this assumption:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ncfile</span><span class="o">.</span><span class="n">timereference</span> <span class="o">=</span> <span class="s2">&quot;right interval boundary&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">warn_later</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">query_timegrid</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>  
<span class="go">Timegrid(&quot;1995-12-31 00:00:00&quot;,</span>
<span class="go">         &quot;2006-12-31 00:00:00&quot;,</span>
<span class="go">         &quot;1d&quot;)</span>
<span class="go">UserWarning: The `timereference` attribute (`right interval boundary`) of the NetCDF file `...hland_v1_input_p.nc` conflicts with the current value of the global `timestampleft` option (`True`).  The file-specific information is prioritised.</span>
</pre></div>
</div>
<p>State sequences like <a class="reference internal" href="hland.html#hydpy.models.hland.hland_states.SM" title="hydpy.models.hland.hland_states.SM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SM</span></code></a> handle data for specific time points instead
of time intervals.  Their <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence.series" title="hydpy.core.sequencetools.IOSequence.series"><code class="xref py py-const docutils literal notranslate"><span class="pre">series</span></code></a> vector contains the calculated values
for the end of each simulation step.  Hence, without file-specific information,
<a class="reference internal" href="#hydpy.core.netcdftools.query_timegrid" title="hydpy.core.netcdftools.query_timegrid"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_timegrid()</span></code></a> ignores the <a class="reference internal" href="optiontools.html#hydpy.core.optiontools.Options.timestampleft" title="hydpy.core.optiontools.Options.timestampleft"><code class="xref py py-const docutils literal notranslate"><span class="pre">timestampleft</span></code></a> option and follows the <cite>right
interval boundary</cite> convention:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sm</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">land_dill</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">del</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">timereference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">query_timegrid</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">sm</span><span class="p">)</span>
<span class="go">Timegrid(&quot;1995-12-31 00:00:00&quot;,</span>
<span class="go">         &quot;2006-12-31 00:00:00&quot;,</span>
<span class="go">         &quot;1d&quot;)</span>
</pre></div>
</div>
<p>Add a <cite>timereference</cite> attribute with the value <cite>current time</cite> to explicitly include
this information in a NetCDF file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ncfile</span><span class="o">.</span><span class="n">timereference</span> <span class="o">=</span> <span class="s2">&quot;current time&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">query_timegrid</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">sm</span><span class="p">)</span>
<span class="go">Timegrid(&quot;1995-12-31 00:00:00&quot;,</span>
<span class="go">         &quot;2006-12-31 00:00:00&quot;,</span>
<span class="go">         &quot;1d&quot;)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#hydpy.core.netcdftools.query_timegrid" title="hydpy.core.netcdftools.query_timegrid"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_timegrid()</span></code></a> raises special warnings when a NetCDF file’s <cite>timereference</cite>
attribute conflicts with its judgement whether the contained data addresses time
intervals or time points:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">warn_later</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">query_timegrid</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>  
<span class="go">Timegrid(&quot;1995-12-31 00:00:00&quot;,</span>
<span class="go">         &quot;2006-12-31 00:00:00&quot;,</span>
<span class="go">         &quot;1d&quot;)</span>
<span class="go">UserWarning: The `timereference` attribute (`current time`) of the NetCDF file `...hland_v1_input_p.nc` conflicts with the type of the relevant sequence (`P`).  The file-specific information is prioritised.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ncfile</span><span class="o">.</span><span class="n">timereference</span> <span class="o">=</span> <span class="s2">&quot;left interval boundary&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">warn_later</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">query_timegrid</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">sm</span><span class="p">)</span>  
<span class="go">Timegrid(&quot;1996-01-01 00:00:00&quot;,</span>
<span class="go">         &quot;2007-01-01 00:00:00&quot;,</span>
<span class="go">         &quot;1d&quot;)</span>
<span class="go">UserWarning: The `timereference` attribute (`left interval boundary`) of the NetCDF file `...hland_v1_input_p.nc` conflicts with the type of the relevant sequence (`SM`).  The file-specific information is prioritised.</span>
</pre></div>
</div>
<p><a class="reference internal" href="#hydpy.core.netcdftools.query_timegrid" title="hydpy.core.netcdftools.query_timegrid"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_timegrid()</span></code></a> also raises specific warnings for misstated <cite>timereference</cite>
attributes describing the different fallbacks for data related to time intervals
and time points:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ncfile</span><span class="o">.</span><span class="n">timereference</span> <span class="o">=</span> <span class="s2">&quot;wrong&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">warn_later</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">query_timegrid</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>  
<span class="go">Timegrid(&quot;1996-01-01 00:00:00&quot;,</span>
<span class="go">         &quot;2007-01-01 00:00:00&quot;,</span>
<span class="go">         &quot;1d&quot;)</span>
<span class="go">UserWarning: The value of the `timereference` attribute (`wrong`) of the NetCDF file `...hland_v1_input_p.nc` is not among the accepted values (`left...`, `right...`, `current...`).  Assuming `left interval boundary` according to the current value of the global `timestampleft` option.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">warn_later</span><span class="p">(),</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">query_timegrid</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">sm</span><span class="p">)</span>  
<span class="go">Timegrid(&quot;1995-12-31 00:00:00&quot;,</span>
<span class="go">         &quot;2006-12-31 00:00:00&quot;,</span>
<span class="go">         &quot;1d&quot;)</span>
<span class="go">UserWarning: The value of the `timereference` attribute (`wrong`) of the NetCDF file `...hland_v1_input_p.nc` is not among the accepted values (`left...`, `right...`, `current...`).  Assuming `current time` according to the type of the relevant sequence (`SM`).</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.query_array">
<span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">query_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.25)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#query_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.query_array" title="Link to this definition">¶</a></dt>
<dd><p>Return the data of the variable with the given name from the given NetCDF file.</p>
<p>The following example shows that <a class="reference internal" href="#hydpy.core.netcdftools.query_array" title="hydpy.core.netcdftools.query_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_array()</span></code></a> returns <code class="xref py py-const docutils literal notranslate"><span class="pre">nan</span></code> entries for
representing missing values even when the respective NetCDF variable defines a
different fill value:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="kn">import</span> <span class="n">netcdftools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span><span class="p">,</span> <span class="n">create_dimension</span><span class="p">,</span> <span class="n">create_variable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;stations&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">netcdftools</span><span class="o">.</span><span class="n">fillvalue</span> <span class="o">=</span> <span class="o">-</span><span class="mf">999.0</span>
<span class="gp">... </span>        <span class="n">create_variable</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;f8&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;stations&quot;</span><span class="p">))</span>
<span class="gp">... </span>        <span class="n">netcdftools</span><span class="o">.</span><span class="n">fillvalue</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">query_variable</span><span class="p">,</span> <span class="n">query_array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query_variable</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">)[:]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([[-999., -999., -999.],</span>
<span class="go">       [-999., -999., -999.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query_array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">)</span>
<span class="go">array([[nan, nan, nan],</span>
<span class="go">       [nan, nan, nan]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Usually, <em>HydPy</em> expects all data variables in NetCDF files to be 2-dimensional,
with time on the first and location on the second axis.  However, <a class="reference internal" href="#hydpy.core.netcdftools.query_array" title="hydpy.core.netcdftools.query_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_array()</span></code></a>
allows for an exception for compatibility with <a class="reference external" href="https://oss.deltares.nl/web/delft-fews">Delft-FEWS</a>.  When working with
ensembles, <a class="reference external" href="https://oss.deltares.nl/web/delft-fews">Delft-FEWS</a> defines a third dimension called <cite>realization</cite> and puts it
between the first dimension (<cite>time</cite>) and the last dimension (<cite>stations</cite>).  In our
experience, this additional dimension is always of length one, meaning we can
safely ignore it:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;realization&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;stations&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">var</span> <span class="o">=</span> <span class="n">create_variable</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;f8&quot;</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;realization&quot;</span><span class="p">,</span> <span class="s2">&quot;stations&quot;</span><span class="p">))</span>
<span class="gp">... </span>        <span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">][:]</span> <span class="o">=</span> <span class="p">[[[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">]]]</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="n">query_variable</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">)[:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 1, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query_array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query_array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">)</span>
<span class="go">array([[1.1, 1.2, 1.3],</span>
<span class="go">       [2.1, 2.2, 2.3]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p><a class="reference internal" href="#hydpy.core.netcdftools.query_array" title="hydpy.core.netcdftools.query_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_array()</span></code></a> raises errors if dimensionality is smaller than two or larger than
three or if there are three dimensions and the length of the second dimension is
not one:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">var</span> <span class="o">=</span> <span class="n">create_variable</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;f8&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,))</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">query_array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">Variable `var` of NetCDF file `test.nc` must be 2-dimensional (or 3-dimensional with a length of one on the second axis) but has the shape `(2,)`.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;realization&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;stations&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">var</span> <span class="o">=</span> <span class="n">create_variable</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;f8&quot;</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;realization&quot;</span><span class="p">,</span> <span class="s2">&quot;stations&quot;</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">query_array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">Variable `var` of NetCDF file `test.nc` must be 2-dimensional (or 3-dimensional with a length of one on the second axis) but has the shape `(2, 2, 3)`.</span>
</pre></div>
</div>
<p>The skipping of the <cite>realization</cite> axis is very specific to <a class="reference external" href="https://oss.deltares.nl/web/delft-fews">Delft-FEWS</a>.  To
prevent hiding problems when reading erroneous data from other sources,
<a class="reference internal" href="#hydpy.core.netcdftools.query_array" title="hydpy.core.netcdftools.query_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_array()</span></code></a> emits the following warning if the name of the second dimension is
not <cite>realization</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.testtools</span> <span class="kn">import</span> <span class="n">warn_later</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;realisation&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;stations&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">var</span> <span class="o">=</span> <span class="n">create_variable</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;f8&quot;</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;realisation&quot;</span><span class="p">,</span> <span class="s2">&quot;stations&quot;</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">,</span> <span class="n">warn_later</span><span class="p">():</span>
<span class="gp">... </span>        <span class="n">query_array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">)</span>
<span class="go">array([[nan, nan, nan],</span>
<span class="go">       [nan, nan, nan]])</span>
<span class="go">UserWarning: Variable `var` of NetCDF file `test.nc` is 3-dimensional and the length of the second dimension is one, but its name is `realisation` instead of `realization`.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.get_filepath">
<span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">get_filepath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#get_filepath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.get_filepath" title="Link to this definition">¶</a></dt>
<dd><p>Return the path of the given NetCDF file.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">get_filepath</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">get_filepath</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="go">&#39;test.nc&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.JITAccessInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">JITAccessInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncvariable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">netcdf4.Variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">realisation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">timedelta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">NDArrayFloat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#JITAccessInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.JITAccessInfo" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a></p>
<p>Helper class for structuring reading from or writing to a NetCDF file “just in
time” during a simulation run for a specific <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a> object.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.JITAccessInfo.ncvariable">
<span class="sig-name descname"><span class="pre">ncvariable</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Variable</span></em><a class="headerlink" href="#hydpy.core.netcdftools.JITAccessInfo.ncvariable" title="Link to this definition">¶</a></dt>
<dd><p>Variable for the direct access to the relevant section of the NetCDF file.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.JITAccessInfo.realisation">
<span class="sig-name descname"><span class="pre">realisation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#hydpy.core.netcdftools.JITAccessInfo.realisation" title="Link to this definition">¶</a></dt>
<dd><p>Flag that indicates if the relevant <a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo.ncvariable" title="hydpy.core.netcdftools.JITAccessInfo.ncvariable"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ncvariable</span></code></a> comes with an
additional <cite>realization</cite> dimension (explained in the documentation on function
<a class="reference internal" href="#hydpy.core.netcdftools.query_array" title="hydpy.core.netcdftools.query_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_array()</span></code></a>)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.JITAccessInfo.timedelta">
<span class="sig-name descname"><span class="pre">timedelta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></em><a class="headerlink" href="#hydpy.core.netcdftools.JITAccessInfo.timedelta" title="Link to this definition">¶</a></dt>
<dd><p>Difference between the relevant row of the NetCDF file and the current 
simulation index (as defined by <a class="reference internal" href="modeltools.html#hydpy.core.modeltools.Idx_Sim" title="hydpy.core.modeltools.Idx_Sim"><code class="xref py py-class docutils literal notranslate"><span class="pre">Idx_Sim</span></code></a>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.JITAccessInfo.columns">
<span class="sig-name descname"><span class="pre">columns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.JITAccessInfo.columns" title="Link to this definition">¶</a></dt>
<dd><p>Indices of the relevant columns of the NetCDF file correctly ordered with 
respect to <a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo.data" title="hydpy.core.netcdftools.JITAccessInfo.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.JITAccessInfo.data">
<span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.25)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.JITAccessInfo.data" title="Link to this definition">¶</a></dt>
<dd><p>Bridge to transfer data between the NetCDF file and the (cythonized) 
hydrological models.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.JITAccessHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">JITAccessHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">readers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo" title="hydpy.core.netcdftools.JITAccessInfo"><span class="pre">JITAccessInfo</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo" title="hydpy.core.netcdftools.JITAccessInfo"><span class="pre">JITAccessInfo</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#JITAccessHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.JITAccessHandler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a></p>
<p>Handler used by the <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> object available in module <code class="xref py py-mod docutils literal notranslate"><span class="pre">pub</span></code> for
reading data from and/or writing data to NetCDF files at each step of a simulation
run.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.JITAccessHandler.readers">
<span class="sig-name descname"><span class="pre">readers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo" title="hydpy.core.netcdftools.JITAccessInfo"><span class="pre">JITAccessInfo</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.JITAccessHandler.readers" title="Link to this definition">¶</a></dt>
<dd><p>All <a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo" title="hydpy.core.netcdftools.JITAccessInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">JITAccessInfo</span></code></a> objects responsible for reading data during the simulation 
run.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.JITAccessHandler.writers">
<span class="sig-name descname"><span class="pre">writers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo" title="hydpy.core.netcdftools.JITAccessInfo"><span class="pre">JITAccessInfo</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.JITAccessHandler.writers" title="Link to this definition">¶</a></dt>
<dd><p>All <a class="reference internal" href="#hydpy.core.netcdftools.JITAccessInfo" title="hydpy.core.netcdftools.JITAccessInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">JITAccessInfo</span></code></a> objects responsible for writing data during the simulation 
run.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.JITAccessHandler.read_slices">
<span class="sig-name descname"><span class="pre">read_slices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#JITAccessHandler.read_slices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.JITAccessHandler.read_slices" title="Link to this definition">¶</a></dt>
<dd><p>Read the time slice relevant for the current simulation step from each
NetCDF file selected for reading.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.JITAccessHandler.write_slices">
<span class="sig-name descname"><span class="pre">write_slices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#JITAccessHandler.write_slices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.JITAccessHandler.write_slices" title="Link to this definition">¶</a></dt>
<dd><p>Write the time slice relevant for the current simulation step from each
NetCDF file selected for writing.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFInterface">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">NetCDFInterface</span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFInterface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFInterface" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interface between <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> and multiple NetCDF files.</p>
<p>The core task of class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> is to distribute different <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a>
objects on multiple instances of class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a>.</p>
<p>(1) We prepare a <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> object and some devices handling different
sequences by applying function <a class="reference internal" href="examples.html#hydpy.examples.prepare_io_example_1" title="hydpy.examples.prepare_io_example_1"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_io_example_1()</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
</pre></div>
</div>
<p>(2) We collect all sequences used in the following examples except
<a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a> of element <cite>element1</cite>, which we reserve for special tests:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sequences</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;hland_v1&quot;</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">sp</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;element1&quot;</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">)</span>
</pre></div>
</div>
<p>(3) We prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object and log and write all test sequences
except <a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a> of element <cite>element1</cite>.  <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> initialises
one <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a> and one <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a> object for each <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a>
subtype:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFInterface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">NetCDFInterface</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">pub</span><span class="p">,</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">sequences</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">_</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">sequence</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">_</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">sequence</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span>
<span class="go">14</span>
</pre></div>
</div>
<p>We change the relevant directory before logging the reserved sequence.
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> initialises two new <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> objects, despite other
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> objects related to the same sequence type being already
available:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nkor</span> <span class="o">=</span> <span class="n">elements</span><span class="o">.</span><span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">currentdir</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor</span><span class="p">,</span> <span class="n">nkor</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor</span><span class="p">,</span> <span class="n">nkor</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span>
<span class="go">16</span>
</pre></div>
</div>
<p>You can query all relevant folder names, filenames and variable names via
properties <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.foldernames" title="hydpy.core.netcdftools.NetCDFInterface.foldernames"><code class="xref py py-const docutils literal notranslate"><span class="pre">foldernames</span></code></a>, <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.filenames" title="hydpy.core.netcdftools.NetCDFInterface.filenames"><code class="xref py py-const docutils literal notranslate"><span class="pre">filenames</span></code></a>, and
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.variablenames" title="hydpy.core.netcdftools.NetCDFInterface.variablenames"><code class="xref py py-const docutils literal notranslate"><span class="pre">variablenames</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">print_values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">interface</span><span class="o">.</span><span class="n">foldernames</span><span class="p">)</span>
<span class="go">default, test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">interface</span><span class="o">.</span><span class="n">filenames</span><span class="p">)</span>
<span class="go">hland_v1_state_sp, hland_v1_state_sp_mean, lland_v1_flux_nkor,</span>
<span class="go">lland_v1_flux_nkor_mean, lland_v1_input_nied,</span>
<span class="go">lland_v1_input_nied_mean, lland_v2_flux_nkor, lland_v2_flux_nkor_mean,</span>
<span class="go">lland_v2_input_nied, lland_v2_input_nied_mean, node_sim_q,</span>
<span class="go">node_sim_q_mean, node_sim_t, node_sim_t_mean</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">variablenames</span>
<span class="go">(&#39;flux_nkor&#39;, &#39;input_nied&#39;, &#39;sim_q&#39;, &#39;sim_t&#39;, &#39;state_sp&#39;)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> provides attribute access to its <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> instances,
both via their filenames and the combination of its folder names and filenames:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">node_sim_q</span> <span class="ow">is</span> <span class="n">interface</span><span class="o">.</span><span class="n">default_node_sim_q</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">interface</span><span class="p">))</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="nb">object</span><span class="o">.</span><span class="fm">__dir__</span><span class="p">(</span><span class="n">interface</span><span class="p">))))</span>
<span class="go">default_hland_v1_state_sp, default_hland_v1_state_sp_mean,</span>
<span class="go">default_lland_v1_flux_nkor, default_lland_v1_flux_nkor_mean,</span>
<span class="go">default_lland_v1_input_nied, default_lland_v1_input_nied_mean,</span>
<span class="go">default_lland_v2_flux_nkor, default_lland_v2_flux_nkor_mean,</span>
<span class="go">default_lland_v2_input_nied, default_lland_v2_input_nied_mean,</span>
<span class="go">default_node_sim_q, default_node_sim_q_mean, default_node_sim_t,</span>
<span class="go">default_node_sim_t_mean, hland_v1_state_sp, hland_v1_state_sp_mean,</span>
<span class="go">lland_v1_input_nied, lland_v1_input_nied_mean, lland_v2_flux_nkor,</span>
<span class="go">lland_v2_flux_nkor_mean, lland_v2_input_nied,</span>
<span class="go">lland_v2_input_nied_mean, node_sim_q, node_sim_q_mean, node_sim_t,</span>
<span class="go">node_sim_t_mean, test_lland_v1_flux_nkor, test_lland_v1_flux_nkor_mean</span>
</pre></div>
</div>
<p>If multiple NetCDF files have the same name, you must prefix the relevant folder
name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">lland_v1_flux_nkor</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">The current NetCDFInterface object handles multiple NetCDF files named `lland_v1_flux_nkor`.  Please be more specific.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">interface</span><span class="p">,</span> <span class="s2">&quot;default_lland_v1_flux_nkor&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> raises the following error for completely wrong attribute names:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">lland_v1</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">The current NetCDFInterface object neither handles a NetCDF file named `lland_v1` nor does it define a member named `lland_v1`.</span>
</pre></div>
</div>
<p>(4) We write all NetCDF files into the <cite>default</cite> folder of the testing directory,
defined by <a class="reference internal" href="examples.html#hydpy.examples.prepare_io_example_1" title="hydpy.examples.prepare_io_example_1"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_io_example_1()</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">interface</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
<p>(5) We define a shorter initialisation period and re-activate the time series of
the test sequences:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">pub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span> <span class="o">=</span> <span class="s2">&quot;02.01.2000&quot;</span><span class="p">,</span> <span class="s2">&quot;04.01.2000&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">sequences</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">sequence</span><span class="o">.</span><span class="n">prepare_series</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">sequence</span><span class="o">.</span><span class="n">prepare_series</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nkor</span><span class="o">.</span><span class="n">prepare_series</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nkor</span><span class="o">.</span><span class="n">prepare_series</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>(6) We again initialise class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a>, log all test sequences, and read
the test data of the defined subperiod:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">NetCDFInterface</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor</span><span class="p">,</span> <span class="n">nkor</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">currentdir</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">sequences</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">_</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">interface</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="o">.</span><span class="n">node1</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span>
<span class="go">InfoArray([61., 62.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="o">.</span><span class="n">series</span>
<span class="go">InfoArray([[18., 19.],</span>
<span class="go">           [20., 21.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span><span class="o">.</span><span class="n">element4</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">sp</span><span class="o">.</span><span class="n">series</span>
<span class="go">InfoArray([[[74., 75., 76.],</span>
<span class="go">            [77., 78., 79.]],</span>

<span class="go">           [[80., 81., 82.],</span>
<span class="go">            [83., 84., 85.]]])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFInterface.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><span class="pre">IOSequence</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">infoarray</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.InfoArray" title="hydpy.core.sequencetools.InfoArray"><span class="pre">InfoArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><span class="pre">NetCDFVariableFlat</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><span class="pre">NetCDFVariableAgg</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFInterface.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFInterface.log" title="Link to this definition">¶</a></dt>
<dd><p>Prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> object suitable for the given <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a>
object, when necessary, and pass the given arguments to its
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.log" title="hydpy.core.netcdftools.NetCDFVariableBase.log"><code class="xref py py-func docutils literal notranslate"><span class="pre">log()</span></code></a> method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFInterface.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFInterface.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFInterface.read" title="Link to this definition">¶</a></dt>
<dd><p>Call method <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.read" title="hydpy.core.netcdftools.NetCDFVariableBase.read"><code class="xref py py-func docutils literal notranslate"><span class="pre">read()</span></code></a> of all handled <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a>
objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFInterface.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFInterface.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFInterface.write" title="Link to this definition">¶</a></dt>
<dd><p>Call method <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.write" title="hydpy.core.netcdftools.NetCDFVariableBase.write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> of all handled <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a>
objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess">
<span class="sig-name descname"><span class="pre">provide_jitaccess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deviceorder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.11)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Node" title="hydpy.core.devicetools.Node"><span class="pre">Node</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Element" title="hydpy.core.devicetools.Element"><span class="pre">Element</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.11)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hydpy.core.netcdftools.JITAccessHandler" title="hydpy.core.netcdftools.JITAccessHandler"><span class="pre">JITAccessHandler</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFInterface.provide_jitaccess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess" title="Link to this definition">¶</a></dt>
<dd><p>Allow method <a class="reference internal" href="hydpytools.html#hydpy.core.hydpytools.HydPy.simulate" title="hydpy.core.hydpytools.HydPy.simulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">simulate()</span></code></a> of class <a class="reference internal" href="hydpytools.html#hydpy.core.hydpytools.HydPy" title="hydpy.core.hydpytools.HydPy"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydPy</span></code></a> to read data from or write
data to NetCDF files “just in time” during simulation runs.</p>
<p>We consider it unlikely users need ever to call the method
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess" title="hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess"><code class="xref py py-func docutils literal notranslate"><span class="pre">provide_jitaccess()</span></code></a> directly.  See the documentation on class
<a class="reference internal" href="hydpytools.html#hydpy.core.hydpytools.HydPy" title="hydpy.core.hydpytools.HydPy"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydPy</span></code></a> on applying it indirectly.  However, the following explanations might
give some additional insights into the options and limitations of the related
functionalities.</p>
<p>You can only either read from or write to each NetCDF file.  We think this
should rarely be a limitation for the anticipated workflows.  One particular
situation where one could eventually try to read and write simultaneously is
when trying to overwrite some of the available input data.  The following
example tries to read the input data for all “headwater” catchments from
specific NetCDF files but defines zero input values for all “non-headwater”
catchments and tries to write them into the same files:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_full_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prepare_full_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">HydPy</span><span class="p">,</span> <span class="n">print_values</span><span class="p">,</span> <span class="n">pub</span><span class="p">,</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">hp</span> <span class="o">=</span> <span class="n">HydPy</span><span class="p">(</span><span class="s2">&quot;LahnH&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span> <span class="o">=</span> <span class="s2">&quot;1996-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;1996-01-05&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">prepare_network</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">prepare_models</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">load_conditions</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">headwaters</span> <span class="o">=</span> <span class="n">pub</span><span class="o">.</span><span class="n">selections</span><span class="p">[</span><span class="s2">&quot;headwaters&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span>
<span class="gp">... </span>    <span class="n">nonheadwaters</span> <span class="o">=</span> <span class="n">pub</span><span class="o">.</span><span class="n">selections</span><span class="p">[</span><span class="s2">&quot;nonheadwaters&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span>
<span class="gp">... </span>    <span class="n">headwaters</span><span class="o">.</span><span class="n">prepare_inputseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">read_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">nonheadwaters</span><span class="o">.</span><span class="n">prepare_inputseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">nonheadwaters</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">sequence</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">While trying to prepare NetCDF files for reading or writing data &quot;just in time&quot; during the current simulation run, the following error occurred: For a specific NetCDF file, you can either read or write data during a simulation run but for file `...hland_v1_input_p.nc` both is requested.</span>
</pre></div>
</div>
<p>Clearly, each NetCDF file we want to read data from needs to span the current
simulation period:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">firstdate</span> <span class="o">=</span> <span class="s2">&quot;1990-01-01&quot;</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">firstdate</span> <span class="o">=</span> <span class="s2">&quot;1995-01-01&quot;</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">prepare_inputseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">read_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">While trying to prepare NetCDF files for reading or writing data &quot;just in time&quot; during the current simulation run, the following error occurred: The data of the NetCDF `...hland_v1_input_p.nc` (Timegrid(&quot;1996-01-01 00:00:00&quot;, &quot;2007-01-01 00:00:00&quot;, &quot;1d&quot;)) does not correctly cover the current simulation period (Timegrid(&quot;1995-01-01 00:00:00&quot;, &quot;1996-01-05 00:00:00&quot;, &quot;1d&quot;)).</span>
</pre></div>
</div>
<p>However, each NetCDF file selected for writing must also cover the complete
initialisation period.  If there is no adequately named NetCDF file,
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess" title="hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess"><code class="xref py py-func docutils literal notranslate"><span class="pre">provide_jitaccess()</span></code></a> creates a new one for the current
initialisation period.  If an adequately named file exists,
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess" title="hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess"><code class="xref py py-func docutils literal notranslate"><span class="pre">provide_jitaccess()</span></code></a> uses it without any attempt to extend it
temporally or spatially.  The following example shows the insertion of the
output data of two subsequent simulation runs into the same NetCDF files:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span> <span class="o">=</span> <span class="s2">&quot;1996-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;1996-01-05&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">prepare_inputseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">read_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">prepare_factorseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">lastdate</span> <span class="o">=</span> <span class="s2">&quot;1996-01-03&quot;</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">firstdate</span> <span class="o">=</span> <span class="s2">&quot;1996-01-03&quot;</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">lastdate</span> <span class="o">=</span> <span class="s2">&quot;1996-01-05&quot;</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">hp</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="s2">&quot;land_dill&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">tmean</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="go">-0.572053, -1.084746, -2.767055, -6.242055</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;LahnH/series/default/hland_v1_factor_tmean.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">print_values</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;factor_tmean&quot;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">-0.572053, -1.084746, -2.767055, -6.242055</span>
</pre></div>
</div>
<p>Under particular circumstances, the data variable of a NetCDF file can be
3-dimensional.  The documentation on function <a class="reference internal" href="#hydpy.core.netcdftools.query_array" title="hydpy.core.netcdftools.query_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_array()</span></code></a> explains this in
detail.  The following example demonstrates that reading and writing such
3-dimensional variables “just in time” works correctly.  Therefore, we add a
<cite>realization</cite> dimension to the input file <cite>hland_v1_input_t.nc</cite> (part of the
example project data) and the output file <cite>hland_v1_factor_tmean.nc</cite> (written
in the previous example) and use them for redefining their data variables with
this additional dimension.  As expected, the results are the same as in the
previous example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;input_t&quot;</span><span class="p">,</span> <span class="s2">&quot;factor_tmean&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">filepath</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;LahnH/series/default/hland_v1_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.nc&quot;</span>
<span class="gp">... </span>        <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">ncfile</span><span class="o">.</span><span class="n">renameVariable</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;old&quot;</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">_</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s2">&quot;realization&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">var</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span>
<span class="gp">... </span>                <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;f8&quot;</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;realization&quot;</span><span class="p">,</span> <span class="s2">&quot;stations&quot;</span><span class="p">))</span>
<span class="gp">... </span>            <span class="n">var</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;old&quot;</span><span class="p">][:]</span> <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;input_t&quot;</span> <span class="k">else</span> <span class="o">-</span><span class="mf">999.0</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span> <span class="o">=</span> <span class="s2">&quot;1996-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;1996-01-05&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">print_values</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;factor_tmean&quot;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">-0.572053, -1.084746, -2.767055, -6.242055</span>
</pre></div>
</div>
<p>If we try to write the output of a simulation run beyond the original
initial initialisation period into the same files,
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess" title="hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess"><code class="xref py py-func docutils literal notranslate"><span class="pre">provide_jitaccess()</span></code></a> raises an equal error as above:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span> <span class="o">=</span> <span class="s2">&quot;1996-01-05&quot;</span><span class="p">,</span> <span class="s2">&quot;1996-01-10&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">prepare_inputseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">read_jit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">prepare_factorseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">While trying to prepare NetCDF files for reading or writing data &quot;just in time&quot; during the current simulation run, the following error occurred: The data of the NetCDF `...hland_v1_factor_tmean.nc` (Timegrid(&quot;1996-01-01 00:00:00&quot;, &quot;1996-01-05 00:00:00&quot;, &quot;1d&quot;)) does not correctly cover the current simulation period (Timegrid(&quot;1996-01-05 00:00:00&quot;, &quot;1996-01-10 00:00:00&quot;, &quot;1d&quot;)).</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hp</span><span class="o">.</span><span class="n">prepare_factorseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Regarding the spatial dimension, things are similar.  You can write data for
different sequences in subsequent simulation runs, but you need to ensure all
required data columns are available right from the start.  Hence, relying on
the automatic file generation of <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess" title="hydpy.core.netcdftools.NetCDFInterface.provide_jitaccess"><code class="xref py py-func docutils literal notranslate"><span class="pre">provide_jitaccess()</span></code></a> fails in
the following example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span> <span class="o">=</span> <span class="s2">&quot;1996-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;1996-01-05&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">prepare_inputseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">read_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">headwaters</span><span class="o">.</span><span class="n">prepare_fluxseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">nonheadwaters</span><span class="o">.</span><span class="n">prepare_fluxseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">While trying to prepare NetCDF files for reading or writing data &quot;just in time&quot; during the current simulation run, the following error occurred: No data for sequence `flux_pc` and (sub)device `land_lahn_2_0` in NetCDF file `...hland_v1_flux_pc.nc` available.</span>
</pre></div>
</div>
<p>One way to prepare complete NetCDF files that are <em>HydPy</em> compatible is to work
with an ordinary NetCDF writer object via <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.netcdfwriting" title="hydpy.core.filetools.SequenceManager.netcdfwriting"><code class="xref py py-func docutils literal notranslate"><span class="pre">netcdfwriting()</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">filetype</span><span class="p">(</span><span class="s2">&quot;nc&quot;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">prepare_fluxseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">prepare_fluxseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">netcdfwriting</span><span class="p">():</span>
<span class="gp">... </span>        <span class="n">hp</span><span class="o">.</span><span class="n">save_fluxseries</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">headwaters</span><span class="o">.</span><span class="n">prepare_fluxseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">load_conditions</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">hp</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">search_keywords</span><span class="p">(</span><span class="s2">&quot;catchment&quot;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">print_values</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">qt</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="go">11.78038, 8.901179, 7.131072, 6.017787</span>
<span class="go">9.647824, 8.517795, 7.781311, 7.344944</span>
<span class="go">20.58932, 8.66144, 7.281198, 6.402232</span>
<span class="go">11.674045, 10.110371, 8.991987, 8.212314</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath_qt</span> <span class="o">=</span> <span class="s2">&quot;LahnH/series/default/hland_v1_flux_qt.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">filepath_qt</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">jdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">print_values</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;flux_qt&quot;</span><span class="p">][:,</span> <span class="n">jdx</span><span class="p">])</span>
<span class="go">11.78038, 8.901179, 7.131072, 6.017787</span>
<span class="go">9.647824, 8.517795, 7.781311, 7.344944</span>
<span class="go">0.0, 0.0, 0.0, 0.0</span>
<span class="go">0.0, 0.0, 0.0, 0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">headwaters</span><span class="o">.</span><span class="n">prepare_fluxseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">nonheadwaters</span><span class="o">.</span><span class="n">prepare_fluxseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">load_conditions</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">filepath_qt</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>  <span class="c1">#</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">jdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<span class="gp">... </span>            <span class="n">print_values</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;flux_qt&quot;</span><span class="p">][:,</span> <span class="n">jdx</span><span class="p">])</span>
<span class="go">11.78038, 8.901179, 7.131072, 6.017787</span>
<span class="go">9.647824, 8.517795, 7.781311, 7.344944</span>
<span class="go">20.58932, 8.66144, 7.281198, 6.402232</span>
<span class="go">11.674045, 10.110371, 8.991987, 8.212314</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hp</span><span class="o">.</span><span class="n">prepare_fluxseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>There should be no limitation for reading data “just in time” and using
different <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Node.deploymode" title="hydpy.core.devicetools.Node.deploymode"><code class="xref py py-const docutils literal notranslate"><span class="pre">deploymode</span></code></a> options.  For demonstration, we first calculate the
time series of the <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sim" title="hydpy.core.sequencetools.Sim"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sim</span></code></a> sequences of all nodes, assign them to the
corresponding <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Obs" title="hydpy.core.sequencetools.Obs"><code class="xref py py-class docutils literal notranslate"><span class="pre">Obs</span></code></a> sequences afterwards, and then start another simulation to
(again) write both the simulated and the observed values to NetCDF files:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">prepare_simseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">prepare_obsseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">load_conditions</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hp</span><span class="o">.</span><span class="n">nodes</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">load_conditions</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">hp</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">print_values</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="go">11.78038, 8.901179, 7.131072, 6.017787</span>
<span class="go">9.647824, 8.517795, 7.781311, 7.344944</span>
<span class="go">42.3697, 27.210443, 22.930066, 20.20133</span>
<span class="go">54.043745, 37.320814, 31.922053, 28.413644</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">hp</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">print_values</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="go">11.78038, 8.901179, 7.131072, 6.017787</span>
<span class="go">9.647824, 8.517795, 7.781311, 7.344944</span>
<span class="go">42.3697, 27.210443, 22.930066, 20.20133</span>
<span class="go">54.043745, 37.320814, 31.922053, 28.413644</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath_sim</span> <span class="o">=</span> <span class="s2">&quot;LahnH/series/default/node_sim_q.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">filepath_sim</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">jdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">print_values</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;sim_q&quot;</span><span class="p">][:,</span> <span class="n">jdx</span><span class="p">])</span>
<span class="go">11.78038, 8.901179, 7.131072, 6.017787</span>
<span class="go">9.647824, 8.517795, 7.781311, 7.344944</span>
<span class="go">42.3697, 27.210443, 22.930066, 20.20133</span>
<span class="go">54.043745, 37.320814, 31.922053, 28.413644</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath_obs</span> <span class="o">=</span> <span class="s2">&quot;LahnH/series/default/node_obs_q.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">filepath_obs</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">jdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">print_values</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;obs_q&quot;</span><span class="p">][:,</span> <span class="n">jdx</span><span class="p">])</span>
<span class="go">11.78038, 8.901179, 7.131072, 6.017787</span>
<span class="go">9.647824, 8.517795, 7.781311, 7.344944</span>
<span class="go">42.3697, 27.210443, 22.930066, 20.20133</span>
<span class="go">54.043745, 37.320814, 31.922053, 28.413644</span>
</pre></div>
</div>
<p>Now we stop all sequences from writing to NetCDF files, remove the two
headwater elements from the currently active selection, and start another
simulation run.  The time series of both headwater nodes are zero due to the
missing inflow from their inlet headwater sub-catchments.  The non-headwater
nodes only receive inflow from the two non-headwater sub-catchments:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">prepare_simseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">prepare_obsseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_jit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">update_devices</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">hp</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="n">hp</span><span class="o">.</span><span class="n">elements</span> <span class="o">-</span> <span class="n">headwaters</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">load_conditions</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">hp</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">print_values</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="go">0.0, 0.0, 0.0, 0.0</span>
<span class="go">0.0, 0.0, 0.0, 0.0</span>
<span class="go">30.58932, 8.66144, 7.281198, 6.402232</span>
<span class="go">42.263365, 18.771811, 16.273185, 14.614546</span>
</pre></div>
</div>
<p>Finally, we set the <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Node.deploymode" title="hydpy.core.devicetools.Node.deploymode"><code class="xref py py-const docutils literal notranslate"><span class="pre">deploymode</span></code></a> of the headwater nodes <cite>dill</cite> and
<cite>lahn_1</cite> to <cite>oldsim</cite> and <cite>obs</cite>, respectively, and read their previously written
time series “just in time”.  As expected, the values of the two non-headwater
nodes are identical to those of our initial example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s2">&quot;dill&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">prepare_simseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">read_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s2">&quot;dill&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">deploymode</span> <span class="o">=</span> <span class="s2">&quot;oldsim&quot;</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s2">&quot;lahn_1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">prepare_obsseries</span><span class="p">(</span><span class="n">allocate_ram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">read_jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s2">&quot;lahn_1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">deploymode</span> <span class="o">=</span> <span class="s2">&quot;obs&quot;</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">load_conditions</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">hp</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">print_values</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="go">11.78038, 8.901179, 7.131072, 6.017787</span>
<span class="go">0.0, 0.0, 0.0, 0.0</span>
<span class="go">42.3697, 27.210443, 22.930066, 20.20133</span>
<span class="go">54.043745, 37.320814, 31.922053, 28.413644</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFInterface.foldernames">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">foldernames</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFInterface.foldernames" title="Link to this definition">¶</a></dt>
<dd><p>The names of all folders the sequences shall be read from or written to.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFInterface.filenames">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">filenames</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFInterface.filenames" title="Link to this definition">¶</a></dt>
<dd><p>The names of all relevant <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> objects.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFInterface.variablenames">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variablenames</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFInterface.variablenames" title="Link to this definition">¶</a></dt>
<dd><p>The names of all handled <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> objects.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.Subdevice2Index">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">Subdevice2Index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_ncfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#Subdevice2Index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.Subdevice2Index" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Return type of method <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index" title="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_subdevice2index()</span></code></a>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.Subdevice2Index.dict_">
<span class="sig-name descname"><span class="pre">dict_</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.Subdevice2Index.dict_" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.Subdevice2Index.name_sequence">
<span class="sig-name descname"><span class="pre">name_sequence</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></em><a class="headerlink" href="#hydpy.core.netcdftools.Subdevice2Index.name_sequence" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.Subdevice2Index.name_ncfile">
<span class="sig-name descname"><span class="pre">name_ncfile</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></em><a class="headerlink" href="#hydpy.core.netcdftools.Subdevice2Index.name_ncfile" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.Subdevice2Index.get_index">
<span class="sig-name descname"><span class="pre">get_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_subdevice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#Subdevice2Index.get_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.Subdevice2Index.get_index" title="Link to this definition">¶</a></dt>
<dd><p>Item access to the wrapped <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> object with a specialised error message.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">NetCDFVariableBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Base class for <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a> and <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableBase.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></em><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.name" title="Link to this definition">¶</a></dt>
<dd><p>Name of the NetCDF variable within the NetCDF file.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableBase.filepath">
<span class="sig-name descname"><span class="pre">filepath</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></em><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.filepath" title="Link to this definition">¶</a></dt>
<dd><p>Path to the relevant NetCDF file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableBase.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><span class="pre">IOSequence</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">infoarray</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.InfoArray" title="hydpy.core.sequencetools.InfoArray"><span class="pre">InfoArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.log" title="Link to this definition">¶</a></dt>
<dd><p>Log the given <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> object either for reading or writing data.</p>
<p>When writing data, the second argument should be an <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.InfoArray" title="hydpy.core.sequencetools.InfoArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">InfoArray</span></code></a>.  When reading
data, this argument is irrelevant. Pass <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>For writing, the <cite>infoarray</cite> argument allows for passing alternative data that
replaces the original series of the <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> object, which helps write
modified (e.g. spatially averaged) time series.</p>
<p>The logged time-series data is available via attribute access:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableBase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">make_abc_testable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NCVar</span> <span class="o">=</span> <span class="n">make_abc_testable</span><span class="p">(</span><span class="n">NetCDFVariableBase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NCVar</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="s2">&quot;filepath.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nkor</span> <span class="o">=</span> <span class="n">elements</span><span class="o">.</span><span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor</span><span class="p">,</span> <span class="n">nkor</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;element1&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">ncvar</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">element1</span><span class="o">.</span><span class="n">sequence</span> <span class="ow">is</span> <span class="n">nkor</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;element2&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">ncvar</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">element2</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">The NetCDFVariable object `flux_nkor` does neither handle time series data under the (sub)device name `element2` nor does it define a member named `element2`.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableBase.subdevicenames">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subdevicenames</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.subdevicenames" title="Link to this definition">¶</a></dt>
<dd><p>The names of all relevant (sub)devices.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableBase.array">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">array</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.25)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.array" title="Link to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> containing the values of all logged sequences.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableBase.insert_subdevices">
<span class="sig-name descname"><span class="pre">insert_subdevices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase.insert_subdevices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.insert_subdevices" title="Link to this definition">¶</a></dt>
<dd><p>Insert a variable of the names of the (sub)devices of the logged sequences
into the given NetCDF file.</p>
<p>We prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> subclass with fixed (sub)device names:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableBase</span><span class="p">,</span> <span class="n">chars2str</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">make_abc_testable</span><span class="p">,</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span> <span class="o">=</span> <span class="n">make_abc_testable</span><span class="p">(</span><span class="n">NetCDFVariableBase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span><span class="o">.</span><span class="n">subdevicenames</span> <span class="o">=</span> <span class="s2">&quot;element1&quot;</span><span class="p">,</span> <span class="s2">&quot;element_2&quot;</span><span class="p">,</span> <span class="s2">&quot;element_ß&quot;</span>
</pre></div>
</div>
<p>The first dimension of the added variable corresponds to the number of
(sub)devices, and the second dimension to the number of characters of the
longest (sub)device name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;filename.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">insert_subdevices</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;station_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dimensions</span>
<span class="go">(&#39;stations&#39;, &#39;char_leng_name&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;station_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 10)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chars2str</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;station_id&quot;</span><span class="p">][:]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="go">[&#39;element1&#39;, &#39;element_2&#39;, &#39;element_ß&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevices">
<span class="sig-name descname"><span class="pre">query_subdevices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase.query_subdevices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevices" title="Link to this definition">¶</a></dt>
<dd><p>Query the names of the (sub)devices of the logged sequences from the given
NetCDF file.</p>
<p>We apply the function <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevices" title="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevices"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_subdevices()</span></code></a> on an empty NetCDF
file.  The error message shows that the method tries to query the (sub)device
names:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableBase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">make_abc_testable</span><span class="p">,</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span> <span class="o">=</span> <span class="n">make_abc_testable</span><span class="p">(</span><span class="n">NetCDFVariableBase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span><span class="o">.</span><span class="n">subdevicenames</span> <span class="o">=</span> <span class="s2">&quot;element1&quot;</span><span class="p">,</span> <span class="s2">&quot;element_2&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="s2">&quot;flux_prec&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;filename.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">query_subdevices</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">NetCDF file `filename.nc` does neither contain a variable named `flux_prec_station_id` nor `station_id` for defining the coordinate locations of variable `flux_prec`.</span>
</pre></div>
</div>
<p>After inserting the (sub)device names, they can be queried and returned:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">insert_subdevices</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span><span class="p">(</span><span class="s2">&quot;flux_prec&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query_subdevices</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="go">[&#39;element1&#39;, &#39;element_2&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index">
<span class="sig-name descname"><span class="pre">query_subdevice2index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#hydpy.core.netcdftools.Subdevice2Index" title="hydpy.core.netcdftools.Subdevice2Index"><span class="pre">Subdevice2Index</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase.query_subdevice2index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index" title="Link to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#hydpy.core.netcdftools.Subdevice2Index" title="hydpy.core.netcdftools.Subdevice2Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subdevice2Index</span></code></a> object that maps the (sub)device names to their
position within the given NetCDF file.</p>
<p>Method <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index" title="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_subdevice2index()</span></code></a> relies on
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevices" title="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevices"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_subdevices()</span></code></a>.  The returned <a class="reference internal" href="#hydpy.core.netcdftools.Subdevice2Index" title="hydpy.core.netcdftools.Subdevice2Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subdevice2Index</span></code></a> object
remembers the NetCDF file from which the (sub)device names stem, allowing for
clear error messages:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableBase</span><span class="p">,</span> <span class="n">str2chars</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">make_abc_testable</span><span class="p">,</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;filename.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span> <span class="o">=</span> <span class="n">make_abc_testable</span><span class="p">(</span><span class="n">NetCDFVariableBase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span><span class="o">.</span><span class="n">subdevicenames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;element3&quot;</span><span class="p">,</span> <span class="s2">&quot;element1&quot;</span><span class="p">,</span> <span class="s2">&quot;element1_1&quot;</span><span class="p">,</span> <span class="s2">&quot;element2&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="s2">&quot;flux_prec&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">insert_subdevices</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subdevice2index</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">query_subdevice2index</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subdevice2index</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="s2">&quot;element1_1&quot;</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subdevice2index</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="s2">&quot;element3&quot;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subdevice2index</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="s2">&quot;element5&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">No data for sequence `flux_prec` and (sub)device `element5` in NetCDF file `filename.nc` available.</span>
</pre></div>
</div>
<p>Additionally, <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index" title="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_subdevice2index()</span></code></a> checks for duplicates:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;station_id&quot;</span><span class="p">][:]</span> <span class="o">=</span> <span class="n">str2chars</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s2">&quot;element3&quot;</span><span class="p">,</span> <span class="s2">&quot;element1&quot;</span><span class="p">,</span> <span class="s2">&quot;element1_1&quot;</span><span class="p">,</span> <span class="s2">&quot;element1&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">query_subdevice2index</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The NetCDF file `filename.nc` contains duplicate (sub)device names for variable `flux_prec` (the first found duplicate is `element1`).</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableBase.read">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.read" title="Link to this definition">¶</a></dt>
<dd><p>Read the data from a NetCDF file.</p>
<p>Raise a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> if the relevant <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> subclass does not
support reading data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableBase.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.write" title="Link to this definition">¶</a></dt>
<dd><p>Write the data to a new NetCDF file.</p>
<p>See the general documentation on class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a> for some examples.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableAgg">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">NetCDFVariableAgg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableAgg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a></p>
<p>Relates objects of a specific <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> subclass with a single NetCDF
variable for writing aggregated time series data.</p>
<p>Essentially, class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a> is very similar to class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a>
but a little bit simpler, as it cannot read data from NetCDF files and always
writes one column of data for each logged <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> object.  The following
examples are a selection of the more thoroughly explained examples of the
documentation on class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">,</span> <span class="n">element3</span><span class="p">,</span> <span class="n">element4</span><span class="p">)</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableAgg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nied</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;input_nied_mean&quot;</span><span class="p">,</span> <span class="s2">&quot;nied.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nkor</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;flux_nkor_mean&quot;</span><span class="p">,</span> <span class="s2">&quot;nkor.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_sp</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;state_sp_mean&quot;</span><span class="p">,</span> <span class="s2">&quot;sp.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">nied</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span>
<span class="gp">... </span>    <span class="n">var_nied</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nied</span><span class="p">,</span> <span class="n">nied</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">... </span>    <span class="n">nkor</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">... </span>    <span class="n">var_nkor</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor</span><span class="p">,</span> <span class="n">nkor</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">element4</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">sp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_sp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">pub</span><span class="p">,</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">var_nied</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">var_nkor</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">var_sp</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
<p>As <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a> provides no reading functionality, we show that the
aggregated values are readily available using the external NetCDF4 library:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;nied.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;input_nied_mean&quot;</span><span class="p">][:])</span>
<span class="go">array([[0., 4.],</span>
<span class="go">       [1., 5.],</span>
<span class="go">       [2., 6.],</span>
<span class="go">       [3., 7.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;nkor.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;flux_nkor_mean&quot;</span><span class="p">][:])</span>
<span class="go">array([[12. , 16.5],</span>
<span class="go">       [13. , 18.5],</span>
<span class="go">       [14. , 20.5],</span>
<span class="go">       [15. , 22.5]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">(),</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;sp.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;state_sp_mean&quot;</span><span class="p">][:])</span>
<span class="go">array([[70.5],</span>
<span class="go">       [76.5],</span>
<span class="go">       [82.5],</span>
<span class="go">       [88.5]])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableAgg.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableAgg.shape" title="Link to this definition">¶</a></dt>
<dd><p>Required shape of <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.array" title="hydpy.core.netcdftools.NetCDFVariableAgg.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a>.</p>
<p>The first axis corresponds to the number of timesteps and the second axis to
the number of devices.  We show this for the 1-dimensional input sequence
<a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableAgg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;lland&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 3)</span>
</pre></div>
</div>
<p>There is no difference for 2-dimensional sequences as aggregating their time
series also results in 1-dimensional data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;state_sp&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">elements</span><span class="o">.</span><span class="n">element4</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableAgg.array">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">array</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.25)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableAgg.array" title="Link to this definition">¶</a></dt>
<dd><p>The aggregated data of all logged <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> objects contained in a
single <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> object.</p>
<p>The documentation on <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.shape" title="hydpy.core.netcdftools.NetCDFVariableAgg.shape"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape</span></code></a> explains the structure of
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.array" title="hydpy.core.netcdftools.NetCDFVariableAgg.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a>.  This first example confirms that the first axis
corresponds to time while the second corresponds to the location:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableAgg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;lland&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">nkor</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">... </span>        <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor</span><span class="p">,</span> <span class="n">nkor</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">array</span>
<span class="go">array([[12. , 16.5, 25. ],</span>
<span class="go">       [13. , 18.5, 28. ],</span>
<span class="go">       [14. , 20.5, 31. ],</span>
<span class="go">       [15. , 22.5, 34. ]])</span>
</pre></div>
</div>
<p>There is no difference for 2-dimensional sequences as aggregating their time
series also results in 1-dimensional data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;state_sp&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">elements</span><span class="o">.</span><span class="n">element4</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">sp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">array</span>
<span class="go">array([[70.5],</span>
<span class="go">       [76.5],</span>
<span class="go">       [82.5],</span>
<span class="go">       [88.5]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableAgg.subdevicenames">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subdevicenames</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableAgg.subdevicenames" title="Link to this definition">¶</a></dt>
<dd><p>The names of all relevant devices.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableAgg.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableAgg.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableAgg.read" title="Link to this definition">¶</a></dt>
<dd><p>Raise a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> in any case.</p>
<p>This method always raises the following exception to tell users why
implementing a reading functionality is not possible:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableAgg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The process of aggregating values (of sequence `flux_nkor` and other sequences as well) is not invertible.</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableFlat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></span><span class="sig-name descname"><span class="pre">NetCDFVariableFlat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableFlat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a></p>
<p>Relates objects of a specific <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> subclass with a single NetCDF
variable for reading or writing their complete time-series data.</p>
<p>(1) We prepare some devices handling some sequences by applying the function
<a class="reference internal" href="examples.html#hydpy.examples.prepare_io_example_1" title="hydpy.examples.prepare_io_example_1"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_io_example_1()</span></code></a>.  We limit our attention to the returned elements, which
handle the more diverse sequences:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">,</span> <span class="n">element3</span><span class="p">,</span> <span class="n">element4</span><span class="p">)</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
</pre></div>
</div>
<p>(2) We define three <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a> instances with different
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat.array" title="hydpy.core.netcdftools.NetCDFVariableFlat.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a> structures and log the <a class="reference internal" href="lland.html#hydpy.models.lland.lland_inputs.Nied" title="hydpy.models.lland.lland_inputs.Nied"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nied</span></code></a> and
<a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a> sequences of the first two elements and <a class="reference internal" href="hland.html#hydpy.models.hland.hland_states.SP" title="hydpy.models.hland.hland_states.SP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SP</span></code></a> of
the fourth element:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableFlat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nied</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="s2">&quot;nied.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nkor</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="s2">&quot;nkor.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_sp</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;state_sp&quot;</span><span class="p">,</span> <span class="s2">&quot;sp.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">seqs</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span>
<span class="gp">... </span>    <span class="n">var_nied</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">seqs</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">,</span> <span class="n">seqs</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">var_nkor</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">seqs</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="n">seqs</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">element4</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">sp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_sp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>We write the data of all logged sequences to separate NetCDF files:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">var_nied</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">var_nkor</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">var_sp</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
<p>(4) We set all values of the selected sequences to -777 and check that they are
different from the original values available via <cite>testarray</cite> attribute:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seq1</span> <span class="o">=</span> <span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seq2</span> <span class="o">=</span> <span class="n">element2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seq3</span> <span class="o">=</span> <span class="n">element4</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">sp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">,</span> <span class="n">seq3</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">seq</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="o">-</span><span class="mf">777.0</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">seq</span><span class="o">.</span><span class="n">series</span> <span class="o">==</span> <span class="n">seq</span><span class="o">.</span><span class="n">testarray</span><span class="p">))</span>
<span class="go">False</span>
<span class="go">False</span>
<span class="go">False</span>
</pre></div>
</div>
<p>(5) Again, we prepare three <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a> instances and log the same
sequences as above, open the existing NetCDF file for reading, read its data, and
confirm that it has been correctly passed to the test sequences:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nied1</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="s2">&quot;nied.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nkor1</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="s2">&quot;nkor.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp4</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;state_sp&quot;</span><span class="p">,</span> <span class="s2">&quot;sp.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">sequences</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span>
<span class="gp">... </span>    <span class="n">nied1</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">nkor1</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp4</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">nied1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">nkor1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">sp4</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">,</span> <span class="n">seq3</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">seq</span><span class="o">.</span><span class="n">series</span> <span class="o">==</span> <span class="n">seq</span><span class="o">.</span><span class="n">testarray</span><span class="p">))</span>
<span class="go">True</span>
<span class="go">True</span>
<span class="go">True</span>
</pre></div>
</div>
<p>(6) Trying to read data not stored properly results in error messages like the
following:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nied1</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element3</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">nied1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">While trying to read data from NetCDF file `nied.nc`, the following error occurred: No data for sequence `input_nied` and (sub)device `element3` in NetCDF file `nied.nc` available.</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableFlat.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableFlat.shape" title="Link to this definition">¶</a></dt>
<dd><p>Required shape of <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat.array" title="hydpy.core.netcdftools.NetCDFVariableFlat.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a>.</p>
<p>For 0-dimensional sequences like <a class="reference internal" href="lland.html#hydpy.models.lland.lland_inputs.Nied" title="hydpy.models.lland.lland_inputs.Nied"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nied</span></code></a>, the first axis
corresponds to the number of timesteps and the second axis to the number of
devices:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableFlat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;lland&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 3)</span>
</pre></div>
</div>
<p>For 1-dimensional sequences as <a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a>, the second axis corresponds
to “subdevices”.  Here, these “subdevices” are hydrological response units of
different elements.  The model instances of the three elements define one, two,
and three response units, respectively, making up a sum of six subdevices:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;lland&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 6)</span>
</pre></div>
</div>
<p>The above assertions also hold for 2-dimensional sequences like
<a class="reference internal" href="hland.html#hydpy.models.hland.hland_states.SP" title="hydpy.models.hland.hland_states.SP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SP</span></code></a>.  In this specific case, each “subdevice” corresponds to a
single snow class (one element times three zones times two snow classes makes
six subdevices):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;state_sp&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">elements</span><span class="o">.</span><span class="n">element4</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 6)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableFlat.array">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">array</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.25)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableFlat.array" title="Link to this definition">¶</a></dt>
<dd><p>The series data of all logged <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> objects contained in one single
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> object.</p>
<p>The documentation on <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.shape" title="hydpy.core.netcdftools.NetCDFVariableAgg.shape"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape</span></code></a> explains the structure of
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.array" title="hydpy.core.netcdftools.NetCDFVariableAgg.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a>.  The first example confirms that the first axis
corresponds to time while the second corresponds to the location:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableFlat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;lland&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">nied1</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span>
<span class="gp">... </span>        <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nied1</span><span class="p">,</span> <span class="n">nied1</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">array</span>
<span class="go">array([[ 0.,  4.,  8.],</span>
<span class="go">       [ 1.,  5.,  9.],</span>
<span class="go">       [ 2.,  6., 10.],</span>
<span class="go">       [ 3.,  7., 11.]])</span>
</pre></div>
</div>
<p>The flattening of higher dimensional sequences spreads the time-series of
individual “subdevices” over the array’s columns.  For the 1-dimensional
sequence <a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a>, we find the time-series of both zones of the
second element in columns two and three:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;lland&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">nkor</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">... </span>        <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor</span><span class="p">,</span> <span class="n">nkor</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">array([[16., 17.],</span>
<span class="go">       [18., 19.],</span>
<span class="go">       [20., 21.],</span>
<span class="go">       [22., 23.]])</span>
</pre></div>
</div>
<p>The above assertions also hold for 2-dimensional sequences like
<a class="reference internal" href="hland.html#hydpy.models.hland.hland_states.SP" title="hydpy.models.hland.hland_states.SP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SP</span></code></a>.  In this specific case, each column contains the series of a
single snow class:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;state_sp&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">elements</span><span class="o">.</span><span class="n">element4</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">sp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">array</span>
<span class="go">array([[68., 69., 70., 71., 72., 73.],</span>
<span class="go">       [74., 75., 76., 77., 78., 79.],</span>
<span class="go">       [80., 81., 82., 83., 84., 85.],</span>
<span class="go">       [86., 87., 88., 89., 90., 91.]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableFlat.subdevicenames">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subdevicenames</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableFlat.subdevicenames" title="Link to this definition">¶</a></dt>
<dd><p>The names of the (sub)devices.</p>
<p>Property <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat.subdevicenames" title="hydpy.core.netcdftools.NetCDFVariableFlat.subdevicenames"><code class="xref py py-const docutils literal notranslate"><span class="pre">subdevicenames</span></code></a> clarifies which column of
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.array" title="hydpy.core.netcdftools.NetCDFVariableAgg.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a> contains the series of which (sub)device.  For
0-dimensional series like <a class="reference internal" href="lland.html#hydpy.models.lland.lland_inputs.Nied" title="hydpy.models.lland.lland_inputs.Nied"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nied</span></code></a>, we require no subdivision.
Hence, it returns the original device names:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableFlat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;lland&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">nied</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span>
<span class="gp">... </span>        <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nied</span><span class="p">,</span> <span class="n">nied</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">subdevicenames</span>
<span class="go">(&#39;element1&#39;, &#39;element2&#39;, &#39;element3&#39;)</span>
</pre></div>
</div>
<p>For 1-dimensional sequences like <a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a>, a suffix defines the
index of the respective subdevice.  For example, the third column of
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.array" title="hydpy.core.netcdftools.NetCDFVariableAgg.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a> contains the series of the first hydrological
response unit of the second element:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;lland&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">nkor</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">... </span>        <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor</span><span class="p">,</span> <span class="n">nkor</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">subdevicenames</span>
<span class="go">(&#39;element1_0&#39;, &#39;element2_0&#39;, &#39;element2_1&#39;, &#39;element3_0&#39;, &#39;element3_1&#39;, &#39;element3_2&#39;)</span>
</pre></div>
</div>
<p>2-dimensional sequences like <a class="reference internal" href="hland.html#hydpy.models.hland.hland_states.SP" title="hydpy.models.hland.hland_states.SP"><code class="xref py py-class docutils literal notranslate"><span class="pre">SP</span></code></a> require an additional suffix:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;state_sp&quot;</span><span class="p">,</span> <span class="s2">&quot;filename.nc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">elements</span><span class="o">.</span><span class="n">element4</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">sp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">subdevicenames</span>
<span class="go">(&#39;element4_0_0&#39;, &#39;element4_0_1&#39;, &#39;element4_0_2&#39;, &#39;element4_1_0&#39;, &#39;element4_1_1&#39;, &#39;element4_1_2&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.core.netcdftools.NetCDFVariableFlat.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableFlat.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableFlat.read" title="Link to this definition">¶</a></dt>
<dd><p>Read the data from the relevant NetCDF file.</p>
<p>See the general documentation on class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a> for some examples.</p>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="objecttools.html" title="objecttools"
             >next</a> |</li>
        <li class="right" >
          <a href="modeltools.html" title="modeltools"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HydPy 5.0.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="framework.html" >Framework Tools</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="core.html" >Core Tools</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">netcdftools</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2023, HydPy Developers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>
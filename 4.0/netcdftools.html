
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>netcdftools &#8212; HydPy 4.0.1 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="objecttools" href="objecttools.html" />
    <link rel="prev" title="modeltools" href="modeltools.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="objecttools.html" title="objecttools"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="modeltools.html" title="modeltools"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HydPy 4.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="framework.html" >Framework Tools</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="core.html" accesskey="U">Core Tools</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">netcdftools</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="netcdftools">
<span id="id1"></span><h1>netcdftools<a class="headerlink" href="#netcdftools" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-hydpy.core.netcdftools"></span><p>This module extends the features of module <a class="reference internal" href="filetools.html#module-hydpy.core.filetools" title="hydpy.core.filetools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">filetools</span></code></a> for loading data
from and storing data to netCDF4 files, consistent with the <a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html">NetCDF Climate
and Forecast (CF) Metadata Conventions</a>.</p>
<p>Usually, the features implemented in this module are applied only
indirectly in three steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Call either method <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.open_netcdfreader" title="hydpy.core.filetools.SequenceManager.open_netcdfreader"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_netcdfreader()</span></code></a> or method
<a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.open_netcdfwriter" title="hydpy.core.filetools.SequenceManager.open_netcdfwriter"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_netcdfwriter()</span></code></a> of the <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> object
available in module <code class="xref py py-mod docutils literal notranslate"><span class="pre">pub</span></code> to prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object
for reading or writing.</p></li>
<li><p>Call either the usual reading or writing methods of other HydPy
classes (e.g. method <a class="reference internal" href="hydpytools.html#hydpy.core.hydpytools.HydPy.load_fluxseries" title="hydpy.core.hydpytools.HydPy.load_fluxseries"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_fluxseries()</span></code></a> of class <a class="reference internal" href="hydpytools.html#hydpy.core.hydpytools.HydPy" title="hydpy.core.hydpytools.HydPy"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydPy</span></code></a>
or method <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Elements.save_stateseries" title="hydpy.core.devicetools.Elements.save_stateseries"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_stateseries()</span></code></a> of class <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Elements" title="hydpy.core.devicetools.Elements"><code class="xref py py-class docutils literal notranslate"><span class="pre">Elements</span></code></a>).
The prepared <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object collects all read or write
requests of those sequences that are supposed to be read from or
written to NetCDF files.</p></li>
<li><p>Finalize reading or writing by calling either method
<a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.close_netcdfreader" title="hydpy.core.filetools.SequenceManager.close_netcdfreader"><code class="xref py py-func docutils literal notranslate"><span class="pre">close_netcdfreader()</span></code></a> or method
<a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.close_netcdfwriter" title="hydpy.core.filetools.SequenceManager.close_netcdfwriter"><code class="xref py py-func docutils literal notranslate"><span class="pre">close_netcdfwriter()</span></code></a>.</p></li>
</ol>
</div></blockquote>
<p>Step 2 is a logging process only, telling the <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object
which data needs to be read or written.  The actual reading from or
writing to NetCDF files is triggered by step 3.</p>
<p>During step 2, the <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object, as well as its subobjects,
are accessible, allowing to inspect their current state or to modify
their behaviour.</p>
<p>The following real code examples show how to perform these three steps
both for reading and writing data, based on the example configuration
defined by function <a class="reference internal" href="examples.html#hydpy.examples.prepare_io_example_1" title="hydpy.examples.prepare_io_example_1"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_io_example_1()</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
</pre></div>
</div>
<p>(1) We prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object for writing data by
calling method <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.open_netcdfwriter" title="hydpy.core.filetools.SequenceManager.open_netcdfwriter"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_netcdfwriter()</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">pub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">open_netcdfwriter</span><span class="p">()</span>
</pre></div>
</div>
<p>(2) We tell the <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> to read and write all time series
data from and to NetCDF files placed within a folder called <cite>example</cite>
(In real cases you would not write the “with <a class="reference internal" href="testtools.html#hydpy.core.testtools.TestIO" title="hydpy.core.testtools.TestIO"><code class="xref py py-class docutils literal notranslate"><span class="pre">TestIO</span></code></a>:” line.  This
code block makes sure we are polluting the IO testing directory
instead of our current working directory):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">generalfiletype</span> <span class="o">=</span> <span class="s2">&quot;nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">generaldirpath</span> <span class="o">=</span> <span class="s2">&quot;example&quot;</span>
</pre></div>
</div>
<p>(3) We store all the time series handled by the <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Node" title="hydpy.core.devicetools.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> and <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Element" title="hydpy.core.devicetools.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a>
objects of the example dataset by calling <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Nodes.save_allseries" title="hydpy.core.devicetools.Nodes.save_allseries"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_allseries()</span></code></a> of
class <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Nodes" title="hydpy.core.devicetools.Nodes"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nodes</span></code></a> and <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Elements.save_allseries" title="hydpy.core.devicetools.Elements.save_allseries"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_allseries()</span></code></a> of class <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Elements" title="hydpy.core.devicetools.Elements"><code class="xref py py-class docutils literal notranslate"><span class="pre">Elements</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="o">.</span><span class="n">save_allseries</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span><span class="o">.</span><span class="n">save_allseries</span><span class="p">()</span>
</pre></div>
</div>
<p>(4) We again log all sequences, but this time after telling the
<a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> to average each time series spatially:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">generalaggregation</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="o">.</span><span class="n">save_allseries</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span><span class="o">.</span><span class="n">save_allseries</span><span class="p">()</span>
</pre></div>
</div>
<p>(5) We can now navigate into the details of the logged time series
data via the <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object and its subobjects.  For example,
we can find out which flux sequence objects of type <a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a>
belonging to application model <a class="reference internal" href="lland_v1.html#module-hydpy.models.lland_v1" title="hydpy.models.lland_v1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lland_v1</span></code></a> have been logged (those of
elements <cite>element1</cite> and <cite>element2</cite>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span> <span class="o">=</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">netcdfwriter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span><span class="o">.</span><span class="n">lland_v1</span><span class="o">.</span><span class="n">flux_nkor</span><span class="o">.</span><span class="n">subdevicenames</span>
<span class="go">(&#39;element1&#39;, &#39;element2&#39;)</span>
</pre></div>
</div>
<p>(6) In the example discussed here, all sequences are stored within
the same folder (<cite>example</cite>).  Storing sequences in separate folders
goes hand in hand with storing them in separate NetCDF files, of
course.  In such cases, you have to include the folder into the
attribute name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span><span class="o">.</span><span class="n">foldernames</span>
<span class="go">(&#39;example&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span><span class="o">.</span><span class="n">example_lland_v1</span><span class="o">.</span><span class="n">flux_nkor</span><span class="o">.</span><span class="n">subdevicenames</span>
<span class="go">(&#39;element1&#39;, &#39;element2&#39;)</span>
</pre></div>
</div>
<p>(7) We close the <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object, which is the moment
where the writing process happens.  After that, the interface object
is not available anymore:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">close_netcdfwriter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">netcdfwriter</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The sequence file manager does currently handle no NetCDF writer object.</span>
</pre></div>
</div>
<p>(8) We set the time series values of two test sequences to zero,
which serves the purpose to demonstrate that reading the data back in
actually works:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="o">.</span><span class="n">node2</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>(9) We move up a gear and and prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object for
reading data, log all <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.NodeSequence" title="hydpy.core.sequencetools.NodeSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeSequence</span></code></a> and <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.ModelSequence" title="hydpy.core.sequencetools.ModelSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelSequence</span></code></a> objects,
and read their time series data from the created NetCDF file (note
that we disable option <a class="reference internal" href="optiontools.html#hydpy.core.optiontools.Options.checkseries" title="hydpy.core.optiontools.Options.checkseries"><code class="xref py py-const docutils literal notranslate"><span class="pre">checkseries</span></code></a> temporarily, to prevent
from raising an exception when reading incomplete data from file):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">open_netcdfreader</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="o">.</span><span class="n">load_simseries</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span><span class="o">.</span><span class="n">load_allseries</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">checkseries</span><span class="p">(</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">close_netcdfreader</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple" start="10">
<li><p>We check if the data is available via the test sequences again:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="o">.</span><span class="n">node2</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span>
<span class="go">InfoArray([ 64.,  65.,  66.,  67.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="o">.</span><span class="n">series</span>
<span class="go">InfoArray([[ 16.,  17.],</span>
<span class="go">           [ 18.,  19.],</span>
<span class="go">           [ 20.,  21.],</span>
<span class="go">           [ 22.,  23.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">netcdfreader</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The sequence file manager does currently handle no NetCDF reader object.</span>
</pre></div>
</div>
<p>(11) The process of spatial aggregation  cannot be inverted.  Hence
reading averaged time series is left for postprocessing tools.
To show that writing the averaged series worked, we access
both relevant NetCDF files more directly using the underlying NetCDF4
library (note that averaging 1-dimensional time series as those of
node sequence <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sim" title="hydpy.core.sequencetools.Sim"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sim</span></code></a> is allowed for the sake of consistency):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;example/node.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;sim_q_mean&quot;</span><span class="p">][:])</span>
<span class="go">array([[ 60.,  61.,  62.,  63.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;example/lland_v1.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;flux_nkor_mean&quot;</span><span class="p">][:])[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">array([ 16.5,  18.5,  20.5,  22.5])</span>
</pre></div>
</div>
<p>The described workflow is, besides the testing related specialities,
more or less standard and can be modified in many ways, which are
described in the documentation of the different features implemented
in module <a class="reference internal" href="#module-hydpy.core.netcdftools" title="hydpy.core.netcdftools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">netcdftools</span></code></a>, but also in the documentation on class
<a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> of module <a class="reference internal" href="filetools.html#module-hydpy.core.filetools" title="hydpy.core.filetools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">filetools</span></code></a> and class <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> of
module <a class="reference internal" href="sequencetools.html#module-hydpy.core.sequencetools" title="hydpy.core.sequencetools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sequencetools</span></code></a>.</p>
<p>The examples above give little insight into the resulting/required
structure of NetCDF files. One should at least be aware of the
optional arguments <cite>flatten</cite>, <cite>isolate</cite>, and <cite>timeaxis</cite>. When
“flattening” data, multidimensional time series are handled as a
larger number of 1-dimensional time series. When “isolating” data,
all <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> objects of a specific subclass belong to one single
NetCDF file.  When selecting the first axis as the time axis (by
setting <cite>timeaxis</cite> to zero), we increase the speed of “spatial access”,
but decrease the speed of “time series access”, which is the focus
of the default configuration (where <cite>timeaxis</cite> is one). When reading
a NetCDF file, one has to choose the same options used for writing.</p>
<p>The following test shows that both <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.open_netcdfwriter" title="hydpy.core.filetools.SequenceManager.open_netcdfwriter"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_netcdfwriter()</span></code></a>
and <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager.open_netcdfreader" title="hydpy.core.filetools.SequenceManager.open_netcdfreader"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_netcdfreader()</span></code></a> pass the mentioned arguments
correctly to the constructor of <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">unittest.mock</span> <span class="kn">import</span> <span class="n">patch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">patch</span><span class="p">(</span><span class="s2">&quot;hydpy.core.netcdftools.NetCDFInterface&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">mock</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">open_netcdfwriter</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">flatten</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">mock</span><span class="o">.</span><span class="n">assert_called_with</span><span class="p">(</span><span class="n">flatten</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">open_netcdfreader</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">flatten</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">mock</span><span class="o">.</span><span class="n">assert_called_with</span><span class="p">(</span><span class="n">flatten</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Both methods take the current values of the options <a class="reference internal" href="optiontools.html#hydpy.core.optiontools.Options.flattennetcdf" title="hydpy.core.optiontools.Options.flattennetcdf"><code class="xref py py-const docutils literal notranslate"><span class="pre">flattennetcdf</span></code></a>,
<a class="reference internal" href="optiontools.html#hydpy.core.optiontools.Options.isolatenetcdf" title="hydpy.core.optiontools.Options.isolatenetcdf"><code class="xref py py-const docutils literal notranslate"><span class="pre">isolatenetcdf</span></code></a>, and <a class="reference internal" href="optiontools.html#hydpy.core.optiontools.Options.timeaxisnetcdf" title="hydpy.core.optiontools.Options.timeaxisnetcdf"><code class="xref py py-const docutils literal notranslate"><span class="pre">timeaxisnetcdf</span></code></a> as default arguments:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">patch</span><span class="p">(</span><span class="s2">&quot;hydpy.core.netcdftools.NetCDFInterface&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">mock</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">open_netcdfwriter</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">mock</span><span class="o">.</span><span class="n">assert_called_with</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">flatten</span><span class="o">=</span><span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">flattennetcdf</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">isolate</span><span class="o">=</span><span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">isolatenetcdf</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">timeaxis</span><span class="o">=</span><span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">timeaxisnetcdf</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">open_netcdfreader</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">mock</span><span class="o">.</span><span class="n">assert_called_with</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">flatten</span><span class="o">=</span><span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">flattennetcdf</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">isolate</span><span class="o">=</span><span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">isolatenetcdf</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">timeaxis</span><span class="o">=</span><span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">timeaxisnetcdf</span><span class="p">)</span>
</pre></div>
</div>
<p>Module <a class="reference internal" href="#module-hydpy.core.netcdftools" title="hydpy.core.netcdftools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">netcdftools</span></code></a> implements the following members:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">IntOrSlice</span></code> Type variable.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.str2chars" title="hydpy.core.netcdftools.str2chars"><code class="xref py py-func docutils literal notranslate"><span class="pre">str2chars()</span></code></a> Return <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> containing the byte characters (second axis) of all given strings (first axis).</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.chars2str" title="hydpy.core.netcdftools.chars2str"><code class="xref py py-func docutils literal notranslate"><span class="pre">chars2str()</span></code></a> Inversion function of function <a class="reference internal" href="#hydpy.core.netcdftools.str2chars" title="hydpy.core.netcdftools.str2chars"><code class="xref py py-func docutils literal notranslate"><span class="pre">str2chars()</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.create_dimension" title="hydpy.core.netcdftools.create_dimension"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_dimension()</span></code></a> Add a new dimension with the given name and length to the given NetCDF file.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.create_variable" title="hydpy.core.netcdftools.create_variable"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_variable()</span></code></a> Add a new variable with the given name, datatype, and dimensions to the given NetCDF file.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.query_variable" title="hydpy.core.netcdftools.query_variable"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_variable()</span></code></a> Return the variable with the given name from the given NetCDF file.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.query_timegrid" title="hydpy.core.netcdftools.query_timegrid"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_timegrid()</span></code></a> Return the <a class="reference internal" href="timetools.html#hydpy.core.timetools.Timegrid" title="hydpy.core.timetools.Timegrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timegrid</span></code></a> defined by the given NetCDF file.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.query_array" title="hydpy.core.netcdftools.query_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_array()</span></code></a> Return the data of the variable with the given name from the given NetCDF file.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.get_filepath" title="hydpy.core.netcdftools.get_filepath"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_filepath()</span></code></a> Return the filepath of the given NetCDF file.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> Interface between <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> and multiple NetCDF files.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> Handles a single NetCDF file.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.Subdevice2Index" title="hydpy.core.netcdftools.Subdevice2Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subdevice2Index</span></code></a> Return type of method <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index" title="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_subdevice2index()</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> Base class for <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="hydpy.core.netcdftools.NetCDFVariableDeep"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableDeep</span></code></a>, <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a>, and <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.DeepAndAggMixin" title="hydpy.core.netcdftools.DeepAndAggMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepAndAggMixin</span></code></a> Mixin class for <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="hydpy.core.netcdftools.NetCDFVariableDeep"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableDeep</span></code></a> and <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a></p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.AggAndFlatMixin" title="hydpy.core.netcdftools.AggAndFlatMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">AggAndFlatMixin</span></code></a> Mixin class for <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a> and <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="hydpy.core.netcdftools.NetCDFVariableDeep"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableDeep</span></code></a> Relates some objects of a specific <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> subclass with a single NetCDF variable without modifying dimensionality.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a> Relates some objects of a specific <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> subclass with a single NetCDF variable when aggregation of data is required.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a> Relates some objects of a specific <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> subclass with a single NetCDF variable when flattening of data is required.</p></li>
</ul>
</div></blockquote>
<hr class="docutils" />
<dl class="py data">
<dt id="hydpy.core.netcdftools.dimmapping">
<code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">dimmapping</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'nmb_characters':</span> <span class="pre">'char_leng_name',</span> <span class="pre">'nmb_subdevices':</span> <span class="pre">'stations',</span> <span class="pre">'nmb_timepoints':</span> <span class="pre">'time'}</span></em><a class="headerlink" href="#hydpy.core.netcdftools.dimmapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps dimension name terms from HydPy terms NetCDF.</p>
<p>You can change this mapping if it does not suit your requirements.  For
example, change the value of the keyword “nmb_subdevices”, if you prefer to
call this dimension “location” instead of “stations” within NetCDF files:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">dimmapping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dimmapping</span><span class="p">[</span><span class="s2">&quot;nmb_subdevices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;location&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py data">
<dt id="hydpy.core.netcdftools.varmapping">
<code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">varmapping</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'subdevices':</span> <span class="pre">'station_id',</span> <span class="pre">'timepoints':</span> <span class="pre">'time'}</span></em><a class="headerlink" href="#hydpy.core.netcdftools.varmapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps variable name terms from HydPy terms NetCDF.</p>
<p>You can change this mapping if it does not suit your requirements.  For 
example, change the value of the keyword “timepoints”, if you prefer to 
call this variable “period” instead of “time” within NetCDF files:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">varmapping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">varmapping</span><span class="p">[</span><span class="s2">&quot;timepoints&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;period&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py data">
<dt id="hydpy.core.netcdftools.fillvalue">
<code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">fillvalue</span></code><em class="property"> <span class="pre">=</span> <span class="pre">nan</span></em><a class="headerlink" href="#hydpy.core.netcdftools.fillvalue" title="Permalink to this definition">¶</a></dt>
<dd><p>Default fill value for writing NetCDF files.</p>
<p>You can set another <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> value before writing a NetCDF file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="kn">import</span> <span class="n">netcdftools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">netcdftools</span><span class="o">.</span><span class="n">fillvalue</span> <span class="o">=</span> <span class="o">-</span><span class="mf">777.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="hydpy.core.netcdftools.str2chars">
<code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">str2chars</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strings</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><span class="pre">numpy.ndarray</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#str2chars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.str2chars" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> containing the byte characters (second axis)
of all given strings (first axis).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">str2chars</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">str2chars</span><span class="p">([</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span> <span class="s2">&quot;ones&quot;</span><span class="p">])</span>
<span class="go">array([[b&#39;z&#39;, b&#39;e&#39;, b&#39;r&#39;, b&#39;o&#39;, b&#39;s&#39;],</span>
<span class="go">       [b&#39;o&#39;, b&#39;n&#39;, b&#39;e&#39;, b&#39;s&#39;, b&#39;&#39;]],</span>
<span class="go">      dtype=&#39;|S1&#39;)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">str2chars</span><span class="p">([])</span>
<span class="go">array([], shape=(0, 0),</span>
<span class="go">      dtype=&#39;|S1&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="hydpy.core.netcdftools.chars2str">
<code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">chars2str</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chars</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#chars2str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.chars2str" title="Permalink to this definition">¶</a></dt>
<dd><p>Inversion function of function <a class="reference internal" href="#hydpy.core.netcdftools.str2chars" title="hydpy.core.netcdftools.str2chars"><code class="xref py py-func docutils literal notranslate"><span class="pre">str2chars()</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">chars2str</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chars2str</span><span class="p">([[</span><span class="sa">b</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;s&quot;</span><span class="p">],</span>
<span class="gp">... </span>           <span class="p">[</span><span class="sa">b</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">]])</span>
<span class="go">[&#39;zeros&#39;, &#39;ones&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chars2str</span><span class="p">([])</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="hydpy.core.netcdftools.create_dimension">
<code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">create_dimension</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#create_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.create_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new dimension with the given name and length to the given
NetCDF file.</p>
<p>Essentially, <a class="reference internal" href="#hydpy.core.netcdftools.create_dimension" title="hydpy.core.netcdftools.create_dimension"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_dimension()</span></code></a> just calls the equally named method
of the NetCDF library, but adds information to possible error messages:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">create_dimension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;dim1&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dim</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="s2">&quot;dim1&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dim</span><span class="o">.</span><span class="n">size</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">dim</span>
<span class="go">5</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;dim1&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>    
<span class="go">While trying to add dimension `dim1` with length `5` to the NetCDF file `test.nc`, the following error occurred: ...</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="hydpy.core.netcdftools.create_variable">
<code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">create_variable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#create_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.create_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new variable with the given name, datatype, and dimensions
to the given NetCDF file.</p>
<p>Essentially, <a class="reference internal" href="#hydpy.core.netcdftools.create_variable" title="hydpy.core.netcdftools.create_variable"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_variable()</span></code></a> just calls the equally named method
of the NetCDF library, but adds information to possible error messages:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">create_variable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">create_variable</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var1&quot;</span><span class="p">,</span> <span class="s2">&quot;f8&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;dim1&quot;</span><span class="p">,))</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">))</span>    
<span class="go">While trying to add variable `var1` with datatype `f8` and dimensions `(&#39;dim1&#39;,)` to the NetCDF file `test.nc`, the following error occurred: ...</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">create_dimension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;dim1&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_variable</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var1&quot;</span><span class="p">,</span> <span class="s2">&quot;f8&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;dim1&quot;</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;var1&quot;</span><span class="p">][:])</span>
<span class="go">array([ nan,  nan,  nan,  nan,  nan])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="hydpy.core.netcdftools.query_variable">
<code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">query_variable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">netCDF4._netCDF4.Variable</span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#query_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.query_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the variable with the given name from the given NetCDF file.</p>
<p>Essentially, <a class="reference internal" href="#hydpy.core.netcdftools.query_variable" title="hydpy.core.netcdftools.query_variable"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_variable()</span></code></a> just performs a key assess via the
used NetCDF library, but adds information to possible error messages:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">query_variable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">file_</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;model.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query_variable</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span> <span class="s2">&quot;flux_prec&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">OSError</span>: <span class="n">NetCDF file `model.nc` does not contain variable `flux_prec`.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">create_variable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_variable</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span> <span class="s2">&quot;flux_prec&quot;</span><span class="p">,</span> <span class="s2">&quot;f8&quot;</span><span class="p">,</span> <span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">query_variable</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span> <span class="s2">&quot;flux_prec&quot;</span><span class="p">),</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Variable</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">file_</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="hydpy.core.netcdftools.query_timegrid">
<code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">query_timegrid</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="timetools.html#hydpy.core.timetools.Timegrid" title="hydpy.core.timetools.Timegrid"><span class="pre">hydpy.core.timetools.Timegrid</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#query_timegrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.query_timegrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <a class="reference internal" href="timetools.html#hydpy.core.timetools.Timegrid" title="hydpy.core.timetools.Timegrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timegrid</span></code></a> defined by the given NetCDF file.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_full_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prepare_full_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">query_timegrid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;LahnH/series/input/hland_v1_input_t.nc&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">query_timegrid</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="go">Timegrid(&quot;1996-01-01 00:00:00&quot;,</span>
<span class="go">         &quot;2007-01-01 00:00:00&quot;,</span>
<span class="go">         &quot;1d&quot;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="hydpy.core.netcdftools.query_array">
<code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">query_array</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><span class="pre">numpy.ndarray</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#query_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.query_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the data of the variable with the given name from the given
NetCDF file.</p>
<p>The following example shows that <a class="reference internal" href="#hydpy.core.netcdftools.query_array" title="hydpy.core.netcdftools.query_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_array()</span></code></a> returns <code class="xref py py-const docutils literal notranslate"><span class="pre">nan</span></code>
entries to represent missing values even when the respective NetCDF
variable defines a different fill value:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="kn">import</span> <span class="n">netcdftools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">netcdftools</span><span class="o">.</span><span class="n">fillvalue</span> <span class="o">=</span> <span class="o">-</span><span class="mf">999.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">netcdftools</span><span class="o">.</span><span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;dim1&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">netcdftools</span><span class="o">.</span><span class="n">create_variable</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var1&quot;</span><span class="p">,</span> <span class="s2">&quot;f8&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;dim1&quot;</span><span class="p">,))</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">netcdftools</span><span class="o">.</span><span class="n">query_variable</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var1&quot;</span><span class="p">)[:]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([-999., -999., -999., -999., -999.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">netcdftools</span><span class="o">.</span><span class="n">query_array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;var1&quot;</span><span class="p">)</span>
<span class="go">array([ nan,  nan,  nan,  nan,  nan])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">netcdftools</span><span class="o">.</span><span class="n">fillvalue</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="hydpy.core.netcdftools.get_filepath">
<code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">get_filepath</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#get_filepath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.get_filepath" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the filepath of the given NetCDF file.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">get_filepath</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;test.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ncfile</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">get_filepath</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="go">&#39;test.nc&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="hydpy.core.netcdftools.NetCDFInterface">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">NetCDFInterface</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flatten</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isolate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeaxis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFInterface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFInterface" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interface between <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> and multiple NetCDF files.</p>
<p>The core task of class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> is to distribute different
<a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> objects on different instances of class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a>.</p>
<p>(1) We prepare a <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> object and some devices handling
different sequences by applying function <a class="reference internal" href="examples.html#hydpy.examples.prepare_io_example_1" title="hydpy.examples.prepare_io_example_1"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_io_example_1()</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>We collect all sequences to be used in the following examples:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sequences</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">)</span>
</pre></div>
</div>
<p>(3) We prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> object and log and write all test
sequences.  Due to setting <cite>flatten</cite> to <code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code>, <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a>
initialises one <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> object for handling the <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.NodeSequence" title="hydpy.core.sequencetools.NodeSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeSequence</span></code></a>
objects, two <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> objects for handling the <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.InputSequence" title="hydpy.core.sequencetools.InputSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">InputSequence</span></code></a>
objects of application models <a class="reference internal" href="lland_v1.html#module-hydpy.models.lland_v1" title="hydpy.models.lland_v1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lland_v1</span></code></a> and <a class="reference internal" href="lland_v2.html#module-hydpy.models.lland_v2" title="hydpy.models.lland_v2"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lland_v2</span></code></a>, respectively,
and two <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> objects for handling the <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.FluxSequence" title="hydpy.core.sequencetools.FluxSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">FluxSequence</span></code></a> objects
of application models <a class="reference internal" href="lland_v1.html#module-hydpy.models.lland_v1" title="hydpy.models.lland_v1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lland_v1</span></code></a> and <a class="reference internal" href="lland_v2.html#module-hydpy.models.lland_v2" title="hydpy.models.lland_v2"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lland_v2</span></code></a>, respectively.
Sequences of a specific type of model and nodes are always handled
in separate NetCDF files, to avoid name conflicts. <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.InputSequence" title="hydpy.core.sequencetools.InputSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">InputSequence</span></code></a>
and <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.FluxSequence" title="hydpy.core.sequencetools.FluxSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">FluxSequence</span></code></a> objects can only be stored in the same NetCDF file
when one wants to store them in the same folder, of course, which is
not the case in the given example.  This should become clear when
looking at the following attempts to query the <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> objects
related to <a class="reference internal" href="lland_v2.html#module-hydpy.models.lland_v2" title="hydpy.models.lland_v2"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lland_v2</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFInterface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">NetCDFInterface</span><span class="p">(</span><span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">sequences</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">interface</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">sequence</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">interface</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">sequence</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">filenames</span>
<span class="go">(&#39;lland_v1&#39;, &#39;lland_v2&#39;, &#39;node&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">variablenames</span>
<span class="go">(&#39;sim_q&#39;, &#39;sim_q_mean&#39;, &#39;sim_t&#39;, &#39;sim_t_mean&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">node</span> <span class="o">==</span> <span class="n">interface</span><span class="o">.</span><span class="n">nodepath_node</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">lland_v2</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">The current NetCDFInterface object does handle multiple NetCDFFile objects named `lland_v2`.  Please be more specific.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">interface</span><span class="p">,</span> <span class="s2">&quot;outputpath_lland_v2&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;outputpath_lland_v2&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">lland_v3</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">The current NetCDFInterface object does neither handle a NetCDFFile object named `lland_v3` nor does it define a member named `lland_v3`.</span>
</pre></div>
</div>
<p>(4) We store all NetCDF files into the <cite>inputpath</cite>, <cite>outputpath</cite>,
and <cite>nodepath</cite> folders of the testing directory, define by
<a class="reference internal" href="examples.html#hydpy.examples.prepare_io_example_1" title="hydpy.examples.prepare_io_example_1"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_io_example_1()</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">interface</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
<p>(5) We define a shorter initialisation period and re-activate the
time series of the test sequences:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">pub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span> <span class="o">=</span> <span class="s2">&quot;02.01.2000&quot;</span><span class="p">,</span> <span class="s2">&quot;04.01.2000&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">sequences</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">sequence</span><span class="o">.</span><span class="n">activate_ram</span><span class="p">()</span>
</pre></div>
</div>
<p>(6) We again initialise class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a>, log all
test sequences, and read the test data of the defined subperiod:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFInterface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">NetCDFInterface</span><span class="p">(</span><span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">sequences</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">interface</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">interface</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="o">.</span><span class="n">node1</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span>
<span class="go">InfoArray([ 61.,  62.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="o">.</span><span class="n">series</span>
<span class="go">InfoArray([[ 18.,  19.],</span>
<span class="go">           [ 20.,  21.]])</span>
</pre></div>
</div>
<p>(7) We repeat the above steps, except that we set both
<cite>flatten</cite> and <cite>isolate</cite> to <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>.  The relevant difference is
that <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFInterface" title="hydpy.core.netcdftools.NetCDFInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFInterface</span></code></a> now initialises a new <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> object
for each sequence type, resulting in a larger number separate
NetCDF files containing only one NetCDF variable:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sequences</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">NetCDFInterface</span><span class="p">(</span><span class="n">flatten</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">sequences</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">interface</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">sequence</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">interface</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">sequence</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">interface</span><span class="o">.</span><span class="n">filenames</span><span class="p">)</span>
<span class="go">(&#39;lland_v1_flux_nkor&#39;,</span>
<span class="go"> &#39;lland_v1_flux_nkor_mean&#39;,</span>
<span class="go"> &#39;lland_v1_input_nied&#39;,</span>
<span class="go"> &#39;lland_v1_input_nied_mean&#39;,</span>
<span class="go"> &#39;lland_v2_flux_nkor&#39;,</span>
<span class="go"> &#39;lland_v2_flux_nkor_mean&#39;,</span>
<span class="go"> &#39;lland_v2_input_nied&#39;,</span>
<span class="go"> &#39;lland_v2_input_nied_mean&#39;,</span>
<span class="go"> &#39;node_sim_q&#39;,</span>
<span class="go"> &#39;node_sim_q_mean&#39;,</span>
<span class="go"> &#39;node_sim_t&#39;,</span>
<span class="go"> &#39;node_sim_t_mean&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">lland_v1_input_nied_mean</span><span class="o">.</span><span class="n">variablenames</span>
<span class="go">(&#39;input_nied_mean&#39;,)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">pub</span><span class="p">,</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">outputpath</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="gp">... </span>    <span class="n">interface</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">pub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span> <span class="o">=</span> <span class="s2">&quot;02.01.2000&quot;</span><span class="p">,</span> <span class="s2">&quot;04.01.2000&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">sequences</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">sequence</span><span class="o">.</span><span class="n">activate_ram</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">NetCDFInterface</span><span class="p">(</span><span class="n">flatten</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">sequences</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">interface</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">interface</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="o">.</span><span class="n">node1</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span>
<span class="go">InfoArray([ 61.,  62.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="o">.</span><span class="n">series</span>
<span class="go">InfoArray([[ 18.,  19.],</span>
<span class="go">           [ 20.,  21.]])</span>
</pre></div>
</div>
<p>(8) We technically confirm that the <cite>isolate</cite> and <cite>timeaxis</cite> arguments
are passed to the constructor of class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> correctly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">unittest.mock</span> <span class="kn">import</span> <span class="n">patch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">patch</span><span class="p">(</span><span class="s2">&quot;hydpy.core.netcdftools.NetCDFFile&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">mock</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">interface</span> <span class="o">=</span> <span class="n">NetCDFInterface</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">flatten</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">interface</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequences</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sequences</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">mock</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;node&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">flatten</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">dirpath</span><span class="o">=</span><span class="s2">&quot;nodepath&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFInterface.log">
<code class="sig-name descname"><span class="pre">log</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infoarray</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFInterface.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFInterface.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> object suitable for the given <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a>
object, when necessary, and pass the given arguments to its
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile.log" title="hydpy.core.netcdftools.NetCDFFile.log"><code class="xref py py-func docutils literal notranslate"><span class="pre">log()</span></code></a> method.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFInterface.read">
<code class="sig-name descname"><span class="pre">read</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFInterface.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFInterface.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Call method <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile.read" title="hydpy.core.netcdftools.NetCDFFile.read"><code class="xref py py-func docutils literal notranslate"><span class="pre">read()</span></code></a> of all handled <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> objects.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFInterface.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFInterface.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFInterface.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Call method <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile.write" title="hydpy.core.netcdftools.NetCDFFile.write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> of all handled <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> objects.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFInterface.foldernames">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">foldernames</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFInterface.foldernames" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> of names of all folders the sequences shall be
read from or written to.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFInterface.filenames">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">filenames</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFInterface.filenames" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> of names of all handled <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> objects.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.core.netcdftools.NetCDFFile">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">NetCDFFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">flatten</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isolate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeaxis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Handles a single NetCDF file.</p>
<p>The core task of class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> is to distribute different
<a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> objects on different instances of <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a>
subclasses.  The documentation on the method <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile.log" title="hydpy.core.netcdftools.NetCDFFile.log"><code class="xref py py-func docutils literal notranslate"><span class="pre">log()</span></code></a>
explains this in detail.  Here we focus on how a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> object
triggers the reading and writing functionalities of its subobjects.</p>
<p>(1) We prepare a <a class="reference internal" href="filetools.html#hydpy.core.filetools.SequenceManager" title="hydpy.core.filetools.SequenceManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">SequenceManager</span></code></a> object and some devices handling
different sequences by applying function <a class="reference internal" href="examples.html#hydpy.examples.prepare_io_example_1" title="hydpy.examples.prepare_io_example_1"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_io_example_1()</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">,</span> <span class="n">element3</span><span class="p">)</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
</pre></div>
</div>
<p>(2) We define two shortcuts for the sequences used in the following
examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nied</span> <span class="o">=</span> <span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nkor</span> <span class="o">=</span> <span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
</pre></div>
</div>
<p>(3) We prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> object and log the <a class="reference internal" href="lland.html#hydpy.models.lland.lland_inputs.Nied" title="hydpy.models.lland.lland_inputs.Nied"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nied</span></code></a>
sequence:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFFile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span> <span class="o">=</span> <span class="n">NetCDFFile</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dirpath</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nied</span><span class="p">,</span> <span class="n">nied</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>We store the NetCDF file directly into the testing directory:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">pub</span><span class="p">,</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">init</span> <span class="o">=</span> <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span>
<span class="gp">... </span>    <span class="n">ncfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">timeunit</span><span class="o">=</span><span class="n">init</span><span class="o">.</span><span class="n">firstdate</span><span class="o">.</span><span class="n">to_cfunits</span><span class="p">(</span><span class="s2">&quot;hours&quot;</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="n">timepoints</span><span class="o">=</span><span class="n">init</span><span class="o">.</span><span class="n">to_timepoints</span><span class="p">(</span><span class="s2">&quot;hours&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>(5) We set the time series values of the test sequence to zero,
log the sequence to a new <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> instance, read the data
from the NetCDF file, and check that test sequence <cite>nied</cite>
in fact contains the read data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nied</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span> <span class="o">=</span> <span class="n">NetCDFFile</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dirpath</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nied</span><span class="p">,</span> <span class="n">nied</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nied</span><span class="o">.</span><span class="n">series</span>
<span class="go">InfoArray([ 0.,  1.,  2.,  3.])</span>
</pre></div>
</div>
<p>(6) We show that IO errors and trying to access variables we have not
logged so far should result in clear error messages:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor</span><span class="p">,</span> <span class="n">nkor</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">OSError</span>: <span class="n">While trying to read data from NetCDF file `model.nc`, the following error occurred: NetCDF file `model.nc` does not contain variable `flux_nkor`.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;flux_nkor&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">flux_nkor</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;flux_nkor&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;state_bowa&#39;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">state_bowa</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">The NetCDFFile object `model` does neither handle a NetCDF variable named `state_bowa` nor does it define a member named `state_bowa`.</span>
</pre></div>
</div>
<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFFile.log">
<code class="sig-name descname"><span class="pre">log</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infoarray</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFFile.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFFile.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass the given <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> to a suitable instance of
a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> subclass.</p>
<p>When writing data, the second argument should be an <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.InfoArray" title="hydpy.core.sequencetools.InfoArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">InfoArray</span></code></a>.
When reading data, this argument is ignored. Simply pass <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>(1) We prepare some devices handling some sequences by applying
function <a class="reference internal" href="examples.html#hydpy.examples.prepare_io_example_1" title="hydpy.examples.prepare_io_example_1"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_io_example_1()</span></code></a>.  We limit our attention to the
returned elements, which handle the more diverse sequences:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">,</span> <span class="n">element3</span><span class="p">)</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
</pre></div>
</div>
<p>(2) We define some shortcuts for the sequences used in the
following examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nied1</span> <span class="o">=</span> <span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nied2</span> <span class="o">=</span> <span class="n">element2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nkor2</span> <span class="o">=</span> <span class="n">element2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nkor3</span> <span class="o">=</span> <span class="n">element3</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
</pre></div>
</div>
<p>(3) We define a function that logs these example sequences
to a given <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> object and prints some information
about the resulting object structure.  Note that sequence
<cite>nkor2</cite> is logged twice, the first time with its original
time series data, the second time with averaged values:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">classname</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">ncfile</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">ncfile</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nied1</span><span class="p">,</span> <span class="n">nied1</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">ncfile</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nied2</span><span class="p">,</span> <span class="n">nied2</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">ncfile</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor2</span><span class="p">,</span> <span class="n">nkor2</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">ncfile</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor2</span><span class="p">,</span> <span class="n">nkor2</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">... </span>    <span class="n">ncfile</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor3</span><span class="p">,</span> <span class="n">nkor3</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">classname</span><span class="p">(</span><span class="n">variable</span><span class="p">),</span> <span class="n">variable</span><span class="o">.</span><span class="n">subdevicenames</span><span class="p">)</span>
</pre></div>
</div>
<p>(4) We prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> object with both options
<cite>flatten</cite> and <cite>isolate</cite> being disabled:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFFile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span> <span class="o">=</span> <span class="n">NetCDFFile</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dirpath</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(5) We log all test sequences results in two <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="hydpy.core.netcdftools.NetCDFVariableDeep"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableDeep</span></code></a>
and one <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a> objects.  To keep both NetCDF variables
related to <a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a> distinguishable, the name
<cite>flux_nkor_mean</cite> includes information about the kind of aggregation
performed:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="go">input_nied NetCDFVariableDeep (&#39;element1&#39;, &#39;element2&#39;)</span>
<span class="go">flux_nkor NetCDFVariableDeep (&#39;element2&#39;,)</span>
<span class="go">flux_nkor_mean NetCDFVariableAgg (&#39;element2&#39;, &#39;element3&#39;)</span>
</pre></div>
</div>
<p>(6) We confirm that the <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> objects received
the required information:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">flux_nkor</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">descr_device</span>
<span class="go">&#39;element2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">flux_nkor</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">array</span>
<span class="go">InfoArray([[ 16.,  17.],</span>
<span class="go">           [ 18.,  19.],</span>
<span class="go">           [ 20.,  21.],</span>
<span class="go">           [ 22.,  23.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">flux_nkor_mean</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">descr_device</span>
<span class="go">&#39;element2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">flux_nkor_mean</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">array</span>
<span class="go">InfoArray([ 16.5,  18.5,  20.5,  22.5])</span>
</pre></div>
</div>
<p>(7) We again prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> object, but now with both
options <cite>flatten</cite> and <cite>isolate</cite> being enabled.  To log test
sequences with their original time series data does now trigger
the initialisation of class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a>.  When passing
aggregated data, nothing changes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span> <span class="o">=</span> <span class="n">NetCDFFile</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dirpath</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="go">input_nied NetCDFVariableFlat (&#39;element1&#39;, &#39;element2&#39;)</span>
<span class="go">flux_nkor NetCDFVariableFlat (&#39;element2_0&#39;, &#39;element2_1&#39;)</span>
<span class="go">flux_nkor_mean NetCDFVariableAgg (&#39;element2&#39;, &#39;element3&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">flux_nkor</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">descr_device</span>
<span class="go">&#39;element2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">flux_nkor</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">array</span>
<span class="go">InfoArray([[ 16.,  17.],</span>
<span class="go">           [ 18.,  19.],</span>
<span class="go">           [ 20.,  21.],</span>
<span class="go">           [ 22.,  23.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">flux_nkor_mean</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">descr_device</span>
<span class="go">&#39;element2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">flux_nkor_mean</span><span class="o">.</span><span class="n">element2</span><span class="o">.</span><span class="n">array</span>
<span class="go">InfoArray([ 16.5,  18.5,  20.5,  22.5])</span>
</pre></div>
</div>
<p>(8) We technically confirm that the <cite>isolate</cite> argument is passed
to the constructor of subclasses of <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> correctly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">unittest.mock</span> <span class="kn">import</span> <span class="n">patch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">patch</span><span class="p">(</span><span class="s2">&quot;hydpy.core.netcdftools.NetCDFVariableFlat&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">mock</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">NetCDFFile</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">dirpath</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">ncfile</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nied1</span><span class="p">,</span> <span class="n">nied1</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">mock</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFFile.filepath">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">filepath</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFFile.filepath" title="Permalink to this definition">¶</a></dt>
<dd><p>The NetCDF file path.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFFile.read">
<code class="sig-name descname"><span class="pre">read</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFFile.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFFile.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Open an existing NetCDF file temporarily and call method
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep.read" title="hydpy.core.netcdftools.NetCDFVariableDeep.read"><code class="xref py py-func docutils literal notranslate"><span class="pre">read()</span></code></a> of all handled <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a>
objects.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFFile.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeunit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timepoints</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFFile.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFFile.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a new NetCDF file temporarily and call method
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.write" title="hydpy.core.netcdftools.NetCDFVariableBase.write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> of all handled <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a>
objects.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFFile.variablenames">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">variablenames</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFFile.variablenames" title="Permalink to this definition">¶</a></dt>
<dd><p>The names of all handled <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> objects.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.core.netcdftools.Subdevice2Index">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">Subdevice2Index</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_ncfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#Subdevice2Index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.Subdevice2Index" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Return type of method <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index" title="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_subdevice2index()</span></code></a>.</p>
<dl class="py method">
<dt id="hydpy.core.netcdftools.Subdevice2Index.get_index">
<code class="sig-name descname"><span class="pre">get_index</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_subdevice</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#Subdevice2Index.get_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.Subdevice2Index.get_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Item access to the wrapped <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> object with a specialized
error message.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.core.netcdftools.NetCDFVariableBase">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">NetCDFVariableBase</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isolate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeaxis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<p>Base class for <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="hydpy.core.netcdftools.NetCDFVariableDeep"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableDeep</span></code></a>, <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a>, and
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a>.</p>
<p>The initialisation of <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> subclasses requires the
arguments <cite>name</cite>, <cite>isolate</cite>, and <cite>timeaxis</cite>. Only the last one is
checked to be valid:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableBase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">make_abc_testable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NCVar</span> <span class="o">=</span> <span class="n">make_abc_testable</span><span class="p">(</span><span class="n">NetCDFVariableBase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NCVar</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The argument `timeaxis` must be either `0` (the first axis handles time) or `1` (the second axis handles time), but for variable `flux_nkor` of class NetCDFVariableBase_ the value `2` is given.</span>
</pre></div>
</div>
<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableBase.log">
<code class="sig-name descname"><span class="pre">log</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infoarray</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Log the given <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> object either for reading or writing
data.</p>
<p>The optional <cite>array</cite> argument allows for passing alternative data
in an <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.InfoArray" title="hydpy.core.sequencetools.InfoArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">InfoArray</span></code></a> object replacing the series of the <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a>
object, which is useful for writing modified (e.g. spatially
averaged) time series.</p>
<p>Logged time series data is available via attribute access:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableBase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">make_abc_testable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NCVar</span> <span class="o">=</span> <span class="n">make_abc_testable</span><span class="p">(</span><span class="n">NetCDFVariableBase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NCVar</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nkor</span> <span class="o">=</span> <span class="n">elements</span><span class="o">.</span><span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor</span><span class="p">,</span> <span class="n">nkor</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;element1&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">ncvar</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">element1</span><span class="o">.</span><span class="n">sequence</span> <span class="ow">is</span> <span class="n">nkor</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;element2&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">ncvar</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">element2</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">The NetCDFVariable object `flux_nkor` does neither handle time series data under the (sub)device name `element2` nor does it define a member named `element2`.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableBase.subdevicenames">
<em class="property"><span class="pre">abstract</span> <span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">subdevicenames</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.subdevicenames" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> containing the (sub)device names.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableBase.dimensions">
<em class="property"><span class="pre">abstract</span> <span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">dimensions</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> containing the dimension names.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableBase.array">
<em class="property"><span class="pre">abstract</span> <span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">array</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.array" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> containing the values of all logged sequences.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableBase.prefix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">prefix</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>A prefix for names of dimensions and associated variables.</p>
<p>“Isolated” variables do not require a prefix:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableBase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">make_abc_testable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NetCDFVariableBase_</span> <span class="o">=</span> <span class="n">make_abc_testable</span><span class="p">(</span><span class="n">NetCDFVariableBase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NetCDFVariableBase_</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">prefix</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
<p>When storing different types of sequences in the same NetCDF
file, there is a risk of name conflicts.  We solve this by
using the variables name as a prefix:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">NetCDFVariableBase_</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">prefix</span>
<span class="go">&#39;name_&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableBase.insert_subdevices">
<code class="sig-name descname"><span class="pre">insert_subdevices</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase.insert_subdevices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.insert_subdevices" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a variable of the names of the (sub)devices of the logged
sequences into the given NetCDF file</p>
<p>(1) We prepare a <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> subclass with fixed
(sub)device names:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableBase</span><span class="p">,</span> <span class="n">chars2str</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">make_abc_testable</span><span class="p">,</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span> <span class="o">=</span> <span class="n">make_abc_testable</span><span class="p">(</span><span class="n">NetCDFVariableBase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span><span class="o">.</span><span class="n">subdevicenames</span> <span class="o">=</span> <span class="s2">&quot;element1&quot;</span><span class="p">,</span> <span class="s2">&quot;element_2&quot;</span>
</pre></div>
</div>
<p>(2) Without isolating variables,
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.insert_subdevices" title="hydpy.core.netcdftools.NetCDFVariableBase.insert_subdevices"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_subdevices()</span></code></a> prefixes the name of the
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableBase</span></code></a> object to the name of the inserted variable
and its dimensions.  The first dimension corresponds to the
number of (sub)devices, the second dimension to the number of
characters of the longest (sub)device name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var1</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="s2">&quot;var1&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">file1</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;model1.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var1</span><span class="o">.</span><span class="n">insert_subdevices</span><span class="p">(</span><span class="n">file1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file1</span><span class="p">[</span><span class="s2">&quot;var1_station_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dimensions</span>
<span class="go">(&#39;var1_stations&#39;, &#39;var1_char_leng_name&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file1</span><span class="p">[</span><span class="s2">&quot;var1_station_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chars2str</span><span class="p">(</span><span class="n">file1</span><span class="p">[</span><span class="s2">&quot;var1_station_id&quot;</span><span class="p">][:])</span>
<span class="go">[&#39;element1&#39;, &#39;element_2&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>When isolating variables, we omit the prefix:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var2</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="s2">&quot;var2&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">file2</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;model2.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var2</span><span class="o">.</span><span class="n">insert_subdevices</span><span class="p">(</span><span class="n">file2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file2</span><span class="p">[</span><span class="s2">&quot;station_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dimensions</span>
<span class="go">(&#39;stations&#39;, &#39;char_leng_name&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file2</span><span class="p">[</span><span class="s2">&quot;station_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chars2str</span><span class="p">(</span><span class="n">file2</span><span class="p">[</span><span class="s2">&quot;station_id&quot;</span><span class="p">][:])</span>
<span class="go">[&#39;element1&#39;, &#39;element_2&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevices">
<code class="sig-name descname"><span class="pre">query_subdevices</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase.query_subdevices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevices" title="Permalink to this definition">¶</a></dt>
<dd><p>Query the names of the (sub)devices of the logged sequences
from the given NetCDF file</p>
<p>(1) We apply function <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevices" title="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevices"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_subdevices()</span></code></a> on
an empty NetCDF file.  The error message shows that the method
tries to query the (sub)device names both under the assumptions
that variables have been isolated or not:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableBase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">make_abc_testable</span><span class="p">,</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;model.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span> <span class="o">=</span> <span class="n">make_abc_testable</span><span class="p">(</span><span class="n">NetCDFVariableBase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span><span class="o">.</span><span class="n">subdevicenames</span> <span class="o">=</span> <span class="s2">&quot;element1&quot;</span><span class="p">,</span> <span class="s2">&quot;element_2&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="s2">&quot;flux_prec&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">query_subdevices</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">OSError</span>: <span class="n">NetCDF file `model.nc` does neither contain a variable named `flux_prec_station_id` nor `station_id` for defining the coordinate locations of variable `flux_prec`.</span>
</pre></div>
</div>
<p>(2) After inserting the (sub)device name, they can be queried
and returned:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">insert_subdevices</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span><span class="p">(</span><span class="s2">&quot;flux_prec&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">query_subdevices</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="go">[&#39;element1&#39;, &#39;element_2&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span><span class="p">(</span><span class="s1">&#39;flux_prec&#39;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">query_subdevices</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="go">[&#39;element1&#39;, &#39;element_2&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index">
<code class="sig-name descname"><span class="pre">query_subdevice2index</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#hydpy.core.netcdftools.Subdevice2Index" title="hydpy.core.netcdftools.Subdevice2Index"><span class="pre">hydpy.core.netcdftools.Subdevice2Index</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase.query_subdevice2index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#hydpy.core.netcdftools.Subdevice2Index" title="hydpy.core.netcdftools.Subdevice2Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subdevice2Index</span></code></a> that maps the (sub)device names to
their position within the given NetCDF file.</p>
<p>Method <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index" title="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_subdevice2index()</span></code></a> is based on
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevices" title="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevices"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_subdevices()</span></code></a>.  The returned
<a class="reference internal" href="#hydpy.core.netcdftools.Subdevice2Index" title="hydpy.core.netcdftools.Subdevice2Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Subdevice2Index</span></code></a> object remembers the NetCDF file the
(sub)device names stem from, allowing for clear error messages:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableBase</span><span class="p">,</span> <span class="n">str2chars</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">make_abc_testable</span><span class="p">,</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;model.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span> <span class="o">=</span> <span class="n">make_abc_testable</span><span class="p">(</span><span class="n">NetCDFVariableBase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Var</span><span class="o">.</span><span class="n">subdevicenames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;element3&quot;</span><span class="p">,</span> <span class="s2">&quot;element1&quot;</span><span class="p">,</span> <span class="s2">&quot;element1_1&quot;</span><span class="p">,</span> <span class="s2">&quot;element2&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="s2">&quot;flux_prec&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">insert_subdevices</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subdevice2index</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">query_subdevice2index</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subdevice2index</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="s2">&quot;element1_1&quot;</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subdevice2index</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="s2">&quot;element3&quot;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subdevice2index</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="s2">&quot;element5&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">OSError</span>: <span class="n">No data for sequence `flux_prec` and (sub)device `element5` in NetCDF file `model.nc` available.</span>
</pre></div>
</div>
<p>Additionally, <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index" title="hydpy.core.netcdftools.NetCDFVariableBase.query_subdevice2index"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_subdevice2index()</span></code></a>
checks for duplicates:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;station_id&quot;</span><span class="p">][:]</span> <span class="o">=</span> <span class="n">str2chars</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s2">&quot;element3&quot;</span><span class="p">,</span> <span class="s2">&quot;element1&quot;</span><span class="p">,</span> <span class="s2">&quot;element1_1&quot;</span><span class="p">,</span> <span class="s2">&quot;element1&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="o">.</span><span class="n">query_subdevice2index</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">OSError</span>: <span class="n">The NetCDF file `model.nc` contains duplicate (sub)device names for variable `flux_prec` (the first found duplicate is `element1`).</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableBase.sort_timeplaceentries">
<code class="sig-name descname"><span class="pre">sort_timeplaceentries</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeentry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">placeentry</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase.sort_timeplaceentries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.sort_timeplaceentries" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> containing the given <cite>timeentry</cite> and <cite>placeentry</cite>
sorted in agreement with the currently selected <cite>timeaxis</cite>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableBase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">make_abc_testable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NCVar</span> <span class="o">=</span> <span class="n">make_abc_testable</span><span class="p">(</span><span class="n">NetCDFVariableBase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NCVar</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">sort_timeplaceentries</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;place&quot;</span><span class="p">)</span>
<span class="go">(&#39;place&#39;, &#39;time&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">sort_timeplaceentries</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;place&quot;</span><span class="p">)</span>
<span class="go">(&#39;time&#39;, &#39;place&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableBase.get_timeplaceslice">
<code class="sig-name descname"><span class="pre">get_timeplaceslice</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">placeindex</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.9)"><span class="pre">slice</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.9)"><span class="pre">slice</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase.get_timeplaceslice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.get_timeplaceslice" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> for indexing a complete time series of a certain
location available in <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase.array" title="hydpy.core.netcdftools.NetCDFVariableBase.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableBase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">make_abc_testable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NCVar</span> <span class="o">=</span> <span class="n">make_abc_testable</span><span class="p">(</span><span class="n">NetCDFVariableBase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NCVar</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">get_timeplaceslice</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(2, slice(None, None, None))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">get_timeplaceslice</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(slice(None, None, None), 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableBase.read">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">read</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timegrid_data</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the data from the given NetCDF file.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableBase.write">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableBase.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableBase.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the data to the given NetCDF file.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.core.netcdftools.DeepAndAggMixin">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">DeepAndAggMixin</span></code><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#DeepAndAggMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.DeepAndAggMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Mixin class for <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="hydpy.core.netcdftools.NetCDFVariableDeep"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableDeep</span></code></a> and <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a></p>
<dl class="py method">
<dt id="hydpy.core.netcdftools.DeepAndAggMixin.subdevicenames">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">subdevicenames</span></code><a class="headerlink" href="#hydpy.core.netcdftools.DeepAndAggMixin.subdevicenames" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> containing the device names.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.DeepAndAggMixin.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#DeepAndAggMixin.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.DeepAndAggMixin.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the data to the given NetCDF file.</p>
<p>See the general documentation on classes <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="hydpy.core.netcdftools.NetCDFVariableDeep"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableDeep</span></code></a>
and <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a> for some examples.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.core.netcdftools.AggAndFlatMixin">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">AggAndFlatMixin</span></code><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#AggAndFlatMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.AggAndFlatMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Mixin class for <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a> and <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a>.</p>
<dl class="py method">
<dt id="hydpy.core.netcdftools.AggAndFlatMixin.dimensions">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">dimensions</span></code><a class="headerlink" href="#hydpy.core.netcdftools.AggAndFlatMixin.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>The dimension names of the NetCDF variable.</p>
<p>Usually, the string defined by property <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence.descr_sequence" title="hydpy.core.sequencetools.IOSequence.descr_sequence"><code class="xref py py-const docutils literal notranslate"><span class="pre">descr_sequence</span></code></a>
prefixes the first dimension name related to the location, which
allows storing different sequences types in one NetCDF file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableAgg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">elements</span><span class="o">.</span><span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">dimensions</span>
<span class="go">(&#39;flux_nkor_stations&#39;, &#39;time&#39;)</span>
</pre></div>
</div>
<p>But when isolating variables into separate NetCDF files, the
variable specific suffix is omitted:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">elements</span><span class="o">.</span><span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">dimensions</span>
<span class="go">(&#39;stations&#39;, &#39;time&#39;)</span>
</pre></div>
</div>
<p>When using the first axis as the “timeaxis”, the order of the
dimension names turns:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">elements</span><span class="o">.</span><span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">dimensions</span>
<span class="go">(&#39;time&#39;, &#39;stations&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.core.netcdftools.NetCDFVariableDeep">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">NetCDFVariableDeep</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isolate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeaxis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableDeep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hydpy.core.netcdftools.DeepAndAggMixin" title="hydpy.core.netcdftools.DeepAndAggMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.netcdftools.DeepAndAggMixin</span></code></a>, <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.netcdftools.NetCDFVariableBase</span></code></a></p>
<p>Relates some objects of a specific <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> subclass with
a single NetCDF variable without modifying dimensionality.</p>
<p>Suitable both for reading and writing time series of sequences of
arbitrary dimensionality; performs no flattening.</p>
<p>(1) We prepare some devices handling some sequences by applying
function <a class="reference internal" href="examples.html#hydpy.examples.prepare_io_example_1" title="hydpy.examples.prepare_io_example_1"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_io_example_1()</span></code></a>.  We limit our attention to the
returned elements, which handle the more diverse sequences:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">,</span> <span class="n">element3</span><span class="p">)</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
</pre></div>
</div>
<p>(2) We define two <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="hydpy.core.netcdftools.NetCDFVariableDeep"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableDeep</span></code></a> instances with different
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep.array" title="hydpy.core.netcdftools.NetCDFVariableDeep.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a> structures and log the <a class="reference internal" href="lland.html#hydpy.models.lland.lland_inputs.Nied" title="hydpy.models.lland.lland_inputs.Nied"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nied</span></code></a>
and <a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a> sequences of the first two elements:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableDeep</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nied</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nkor</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">seqs</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span>
<span class="gp">... </span>    <span class="n">var_nied</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">seqs</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">,</span> <span class="n">seqs</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">var_nkor</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">seqs</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="n">seqs</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
</pre></div>
</div>
<p>(3) We prepare a (nearly) empty NetCDF file. “Nearly”, because
all sequences have to be related to the same period, which is why
usually a central instance of class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFFile" title="hydpy.core.netcdftools.NetCDFFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFFile</span></code></a> prepares and
passes time information:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;model.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">create_dimension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>We store the data of all logged sequences in the NetCDF file:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var_nied</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nkor</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>(5) We set all values of the series of both selected sequences
to -777 and check that they are in fact different from the original
values available via attribute <cite>testarray</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seq1</span> <span class="o">=</span> <span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seq2</span> <span class="o">=</span> <span class="n">element2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">seq</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="o">-</span><span class="mf">777.0</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">seq</span><span class="o">.</span><span class="n">series</span> <span class="o">==</span> <span class="n">seq</span><span class="o">.</span><span class="n">testarray</span><span class="p">))</span>
<span class="go">False</span>
<span class="go">False</span>
</pre></div>
</div>
<p>(6) We again prepare two <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="hydpy.core.netcdftools.NetCDFVariableDeep"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableDeep</span></code></a> instances and
log the same sequences as above, open the existing NetCDF file
for reading, read its data, and confirm that this data has been
passed to both test sequences properly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nied1</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nkor1</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">sequences</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span>
<span class="gp">... </span>    <span class="n">nied1</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">nkor1</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;model.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">pub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nied1</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nkor1</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">seq</span><span class="o">.</span><span class="n">series</span> <span class="o">==</span> <span class="n">seq</span><span class="o">.</span><span class="n">testarray</span><span class="p">))</span>
<span class="go">True</span>
<span class="go">True</span>
</pre></div>
</div>
<p>(6) We confirm that trying to read data that has not been stored
properly results in error messages like the following one:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nied1</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element3</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nied1</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">OSError</span>: <span class="n">No data for sequence `input_nied` and (sub)device `element3` in NetCDF file `model.nc` available.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>(7) We repeat the first few steps, but pass True to the constructor
of <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="hydpy.core.netcdftools.NetCDFVariableDeep"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableDeep</span></code></a> to indicate that we want to write each type
of sequence into a separate NetCDF file.  Nevertheless, we try to
store two different types of sequences into the same NetCDF file,
which works for the first sequence (<a class="reference internal" href="lland.html#hydpy.models.lland.lland_inputs.Nied" title="hydpy.models.lland.lland_inputs.Nied"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nied</span></code></a>) but not
for the second one (<a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var_nied</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nkor</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">seqs</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span>
<span class="gp">... </span>    <span class="n">var_nied</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">seqs</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">,</span> <span class="n">seqs</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">var_nkor</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">seqs</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="n">seqs</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;model.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nied</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">var_nkor</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">... </span><span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>   
<span class="go">While trying to add dimension `stations` with length `2` to the NetCDF file `model.nc`, the following error occurred: ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;model.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seq1</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nied</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seq1</span><span class="o">.</span><span class="n">series</span>
<span class="go">InfoArray([ 0.,  1.,  2.,  3.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableDeep.get_slices">
<code class="sig-name descname"><span class="pre">get_slices</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">IntOrSlice</span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">…</span></span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableDeep.get_slices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableDeep.get_slices" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> of one <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> and some <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">slice</span></code></a> objects to
accesses all values of a certain device within
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep.array" title="hydpy.core.netcdftools.NetCDFVariableDeep.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableDeep</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">get_slices</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="go">(2, slice(None, None, None), slice(0, 3, None))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">get_slices</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">(4, slice(None, None, None), slice(0, 1, None), slice(0, 2, None))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">get_slices</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">(slice(None, None, None), 4, slice(0, 1, None), slice(0, 2, None))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableDeep.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableDeep.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Required shape of <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep.array" title="hydpy.core.netcdftools.NetCDFVariableDeep.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a>.</p>
<p>For the default configuration, the first axis corresponds to the
number of devices, and the second one to the number of timesteps.
We show this for the 0-dimensional input sequence <a class="reference internal" href="lland.html#hydpy.models.lland.lland_inputs.Nied" title="hydpy.models.lland.lland_inputs.Nied"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nied</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableDeep</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 4)</span>
</pre></div>
</div>
<p>For higher dimensional sequences, each new entry corresponds
to the maximum number of fields the respective sequences require.
In the next example, we select the 1-dimensional sequence
<a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a>.  The maximum number 3 (last value of the
returned <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) is due to the third element defining three
hydrological response units:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 4, 3)</span>
</pre></div>
</div>
<p>When using the first axis for time (<cite>timeaxis=0</cite>) the order of the
first two <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> entries turns:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 3, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableDeep.array">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">array</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableDeep.array" title="Permalink to this definition">¶</a></dt>
<dd><p>The series data of all logged <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> objects contained
in one single <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>.</p>
<p>The documentation on <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep.shape" title="hydpy.core.netcdftools.NetCDFVariableDeep.shape"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape</span></code></a> explains how
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep.array" title="hydpy.core.netcdftools.NetCDFVariableDeep.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a> is structured.  The first example
confirms that, for the default configuration, the first axis
definces the location, while the second one defines time:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableDeep</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">nied1</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nied1</span><span class="p">,</span> <span class="n">nied1</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">array</span>
<span class="go">array([[  0.,   1.,   2.,   3.],</span>
<span class="go">       [  4.,   5.,   6.,   7.],</span>
<span class="go">       [  8.,   9.,  10.,  11.]])</span>
</pre></div>
</div>
<p>For higher dimensional sequences, <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep.array" title="hydpy.core.netcdftools.NetCDFVariableDeep.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a>
can contain missing values.  Such missing values show up for
some fiels of the second example element, which defines only
two hydrological response units instead of three:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">nkor1</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor1</span><span class="p">,</span> <span class="n">nkor1</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">array([[ 16.,  17.,  nan],</span>
<span class="go">       [ 18.,  19.,  nan],</span>
<span class="go">       [ 20.,  21.,  nan],</span>
<span class="go">       [ 22.,  23.,  nan]])</span>
</pre></div>
</div>
<p>When using the first axis for time (<cite>timeaxis=0</cite>) the same data
can be accessed with slightly different indexing:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">nkor1</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor1</span><span class="p">,</span> <span class="n">nkor1</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="go">array([[ 16.,  17.,  nan],</span>
<span class="go">       [ 18.,  19.,  nan],</span>
<span class="go">       [ 20.,  21.,  nan],</span>
<span class="go">       [ 22.,  23.,  nan]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableDeep.dimensions">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">dimensions</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableDeep.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>The dimension names of the NetCDF variable.</p>
<p>Usually, the string defined by property <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence.descr_sequence" title="hydpy.core.sequencetools.IOSequence.descr_sequence"><code class="xref py py-const docutils literal notranslate"><span class="pre">descr_sequence</span></code></a>
prefixes all dimension names except the second one related to time,
which allows storing different sequences in one NetCDF file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableDeep</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">elements</span><span class="o">.</span><span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">dimensions</span>
<span class="go">(&#39;flux_nkor_stations&#39;, &#39;time&#39;, &#39;flux_nkor_axis3&#39;)</span>
</pre></div>
</div>
<p>However, when isolating variables into separate NetCDF files, the
sequence-specific suffix is omitted:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">elements</span><span class="o">.</span><span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">dimensions</span>
<span class="go">(&#39;stations&#39;, &#39;time&#39;, &#39;axis3&#39;)</span>
</pre></div>
</div>
<p>When using the first axis as the “timeaxis”, the order of the
first two dimension names turns:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableDeep</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">elements</span><span class="o">.</span><span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">dimensions</span>
<span class="go">(&#39;time&#39;, &#39;stations&#39;, &#39;axis3&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableDeep.read">
<code class="sig-name descname"><span class="pre">read</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timegrid_data</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableDeep.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableDeep.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the data from the given NetCDF file.</p>
<p>The argument <cite>timegrid_data</cite> defines the data period of the
given NetCDF file.</p>
<p>See the general documentation on class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="hydpy.core.netcdftools.NetCDFVariableDeep"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableDeep</span></code></a>
for some examples.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.core.netcdftools.NetCDFVariableAgg">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">NetCDFVariableAgg</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isolate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeaxis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableAgg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hydpy.core.netcdftools.DeepAndAggMixin" title="hydpy.core.netcdftools.DeepAndAggMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.netcdftools.DeepAndAggMixin</span></code></a>, <a class="reference internal" href="#hydpy.core.netcdftools.AggAndFlatMixin" title="hydpy.core.netcdftools.AggAndFlatMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.netcdftools.AggAndFlatMixin</span></code></a>, <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.netcdftools.NetCDFVariableBase</span></code></a></p>
<p>Relates some objects of a specific <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> subclass with
a single NetCDF variable when aggregation of data is required.</p>
<p>Suitable for writing time series data only; performs no flattening.</p>
<p>Essentially, class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a> is very similar to class
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="hydpy.core.netcdftools.NetCDFVariableDeep"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableDeep</span></code></a> but a little bit simpler, as it handles
arrays with fixed dimensionality and provides no functionality
for reading data from NetCDF files.  Hence, the following examples
are a selection of the of the more thoroughly explained examples
of the documentation on class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="hydpy.core.netcdftools.NetCDFVariableDeep"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableDeep</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">,</span> <span class="n">element3</span><span class="p">)</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableAgg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nied</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;input_nied_mean&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nkor</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;flux_nkor_mean&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">nied1</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span>
<span class="gp">... </span>    <span class="n">var_nied</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nied1</span><span class="p">,</span> <span class="n">nied1</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">... </span>    <span class="n">nkor1</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">... </span>    <span class="n">var_nkor</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor1</span><span class="p">,</span> <span class="n">nkor1</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;model.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">create_dimension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nied</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nkor</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>As <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg" title="hydpy.core.netcdftools.NetCDFVariableAgg"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableAgg</span></code></a> provides no reading functionality, we
show that the aggregated values are readily available by using
the external NetCDF4 library directly.  Note the different shapes
due to using the second axis for time (<cite>timeaxis=1</cite>, default) and
using the first axis for time (<cite>timeaxis=0</cite>) for <a class="reference internal" href="lland.html#hydpy.models.lland.lland_inputs.Nied" title="hydpy.models.lland.lland_inputs.Nied"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nied</span></code></a>
and <a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a>, respectively:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;model.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;input_nied_mean&quot;</span><span class="p">][:])</span>
<span class="go">array([[ 0.,  1.,  2.,  3.],</span>
<span class="go">       [ 4.,  5.,  6.,  7.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ncfile</span><span class="p">[</span><span class="s2">&quot;flux_nkor_mean&quot;</span><span class="p">][:])</span>
<span class="go">array([[ 12. ,  16.5],</span>
<span class="go">       [ 13. ,  18.5],</span>
<span class="go">       [ 14. ,  20.5],</span>
<span class="go">       [ 15. ,  22.5]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableAgg.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableAgg.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Required shape of <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.array" title="hydpy.core.netcdftools.NetCDFVariableAgg.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a>.</p>
<p>For the default configuration, the first axis corresponds to the
number of devices, and the second one to the number of timesteps.
We show this for the 1-dimensional input sequence <a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableAgg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 4)</span>
</pre></div>
</div>
<p>When using the first axis as the “timeaxis”, the order of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>
entries turns:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableAgg.array">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">array</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableAgg.array" title="Permalink to this definition">¶</a></dt>
<dd><p>The aggregated data of all logged <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> objects contained
in one single <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> object.</p>
<p>The documentation on <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.shape" title="hydpy.core.netcdftools.NetCDFVariableAgg.shape"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape</span></code></a> explains how
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.array" title="hydpy.core.netcdftools.NetCDFVariableAgg.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a> is structured.  This first example
confirms that, under default configuration (<cite>timeaxis=1</cite>),
the first axis corresponds to the location, while the second
one corresponds to time:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableAgg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">nkor1</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor1</span><span class="p">,</span> <span class="n">nkor1</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">array</span>
<span class="go">array([[ 12. ,  13. ,  14. ,  15. ],</span>
<span class="go">       [ 16.5,  18.5,  20.5,  22.5],</span>
<span class="go">       [ 25. ,  28. ,  31. ,  34. ]])</span>
</pre></div>
</div>
<p>When using the first axis as the “timeaxis”, the resulting
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.array" title="hydpy.core.netcdftools.NetCDFVariableAgg.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a> is the transposed:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">nkor1</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor1</span><span class="p">,</span> <span class="n">nkor1</span><span class="o">.</span><span class="n">average_series</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">array</span>
<span class="go">array([[ 12. ,  16.5,  25. ],</span>
<span class="go">       [ 13. ,  18.5,  28. ],</span>
<span class="go">       [ 14. ,  20.5,  31. ],</span>
<span class="go">       [ 15. ,  22.5,  34. ]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableAgg.read">
<code class="sig-name descname"><span class="pre">read</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timegrid_data</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableAgg.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableAgg.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> in any case.</p>
<p>This method always raises the following exception, to tell
users why implementing a real reading functionality is not
possible:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableAgg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_</span> <span class="o">=</span> <span class="n">NetCDFVariableAgg</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The process of aggregating values (of sequence `flux_nkor` and other sequences as well) is not invertible.</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.core.netcdftools.NetCDFVariableFlat">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.netcdftools.</span></code><code class="sig-name descname"><span class="pre">NetCDFVariableFlat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isolate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeaxis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableFlat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hydpy.core.netcdftools.AggAndFlatMixin" title="hydpy.core.netcdftools.AggAndFlatMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.netcdftools.AggAndFlatMixin</span></code></a>, <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableBase" title="hydpy.core.netcdftools.NetCDFVariableBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.netcdftools.NetCDFVariableBase</span></code></a></p>
<p>Relates some objects of a specific <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> subclass with
a single NetCDF variable when flattening of data is required.</p>
<p>Suitable both for reading and writing time series of sequences of
arbitrary dimensionality.</p>
<p>The following examples on the usage of class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a>
are identical to the ones on the usage of class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableDeep" title="hydpy.core.netcdftools.NetCDFVariableDeep"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableDeep</span></code></a>.
We repeat the examples for testing purposes but refrain from repeating
the explanations. The relevant difference in the NetCDF file
structure should become clear when comparing the documentation on
the different members of both classes.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">,</span> <span class="n">element3</span><span class="p">)</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableFlat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nied</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nkor</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">seqs</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span>
<span class="gp">... </span>    <span class="n">var_nied</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">seqs</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">,</span> <span class="n">seqs</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">var_nkor</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">seqs</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="n">seqs</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">TestIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">netcdf4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;model.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">create_dimension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_dimension</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var_nied</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_nkor</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seq1</span> <span class="o">=</span> <span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seq2</span> <span class="o">=</span> <span class="n">element2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">seq</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="o">-</span><span class="mf">777.0</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">seq</span><span class="o">.</span><span class="n">series</span> <span class="o">==</span> <span class="n">seq</span><span class="o">.</span><span class="n">testarray</span><span class="p">))</span>
<span class="go">False</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nied1</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nkor1</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="n">element1</span><span class="p">,</span> <span class="n">element2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">sequences</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span>
<span class="gp">... </span>    <span class="n">nied1</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">nkor1</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TestIO</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ncfile</span> <span class="o">=</span> <span class="n">netcdf4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;model.nc&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">pub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nied1</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nkor1</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ncfile</span><span class="p">,</span> <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">seq</span><span class="o">.</span><span class="n">series</span> <span class="o">==</span> <span class="n">seq</span><span class="o">.</span><span class="n">testarray</span><span class="p">))</span>
<span class="go">True</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableFlat.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableFlat.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Required shape of <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat.array" title="hydpy.core.netcdftools.NetCDFVariableFlat.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a>.</p>
<p>For 0-dimensional sequences like <a class="reference internal" href="lland.html#hydpy.models.lland.lland_inputs.Nied" title="hydpy.models.lland.lland_inputs.Nied"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nied</span></code></a> and for the
default configuration (<cite>timeaxis=1</cite>), the first axis corresponds
to the number of devices, and the second one two the number of
timesteps:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableFlat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 4)</span>
</pre></div>
</div>
<p>For higher dimensional sequences, the first axis corresponds
to “subdevices”, e.g. hydrological response units within
different elements.  The 1-dimensional sequence <a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a>
is logged for three elements with one, two, and three response
units respectively, making up a sum of six subdevices:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(6, 4)</span>
</pre></div>
</div>
<p>When using the first axis as the “timeaxis”, the order of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>
entries turns:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 6)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableFlat.array">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">array</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableFlat.array" title="Permalink to this definition">¶</a></dt>
<dd><p>The series data of all logged <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.IOSequence" title="hydpy.core.sequencetools.IOSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOSequence</span></code></a> objects contained in
one single <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> object.</p>
<p>The documentation on <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.shape" title="hydpy.core.netcdftools.NetCDFVariableAgg.shape"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape</span></code></a> explains how
<a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.array" title="hydpy.core.netcdftools.NetCDFVariableAgg.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a> is structured.  The first example
confirms that, under default configuration (<cite>timeaxis=1</cite>), the
first axis corresponds to the location, while the second one
corresponds to time:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableFlat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">nied1</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nied1</span><span class="p">,</span> <span class="n">nied1</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">array</span>
<span class="go">array([[  0.,   1.,   2.,   3.],</span>
<span class="go">       [  4.,   5.,   6.,   7.],</span>
<span class="go">       [  8.,   9.,  10.,  11.]])</span>
</pre></div>
</div>
<p>Due to the flattening of higher dimensional sequences,
their individual time series (e.g. of different hydrological
response units) are spread over the rows of the array.
For the 1-dimensional sequence <a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a>, the
individual time series of the second element are stored
in row two and three:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">nkor1</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor1</span><span class="p">,</span> <span class="n">nkor1</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">array([[ 16.,  18.,  20.,  22.],</span>
<span class="go">       [ 17.,  19.,  21.,  23.]])</span>
</pre></div>
</div>
<p>When using the first axis as the “timeaxis”, the individual time
series of the second element are stored in column two and three:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">nkor1</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor1</span><span class="p">,</span> <span class="n">nkor1</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">array([[ 16.,  17.],</span>
<span class="go">       [ 18.,  19.],</span>
<span class="go">       [ 20.,  21.],</span>
<span class="go">       [ 22.,  23.]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableFlat.subdevicenames">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">subdevicenames</span></code><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableFlat.subdevicenames" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> containing the (sub)device names.</p>
<p>Property <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat.subdevicenames" title="hydpy.core.netcdftools.NetCDFVariableFlat.subdevicenames"><code class="xref py py-const docutils literal notranslate"><span class="pre">subdevicenames</span></code></a> clarifies which
row of <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.array" title="hydpy.core.netcdftools.NetCDFVariableAgg.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a> contains which time series.
For 0-dimensional series like <a class="reference internal" href="lland.html#hydpy.models.lland.lland_inputs.Nied" title="hydpy.models.lland.lland_inputs.Nied"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nied</span></code></a>, the plain
device names are returned</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_io_example_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">prepare_io_example_1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.netcdftools</span> <span class="kn">import</span> <span class="n">NetCDFVariableFlat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;input_nied&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">nied1</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">nied</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nied1</span><span class="p">,</span> <span class="n">nied1</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">subdevicenames</span>
<span class="go">(&#39;element1&#39;, &#39;element2&#39;, &#39;element3&#39;)</span>
</pre></div>
</div>
<p>For higher dimensional sequences like <a class="reference internal" href="lland.html#hydpy.models.lland.lland_fluxes.NKor" title="hydpy.models.lland.lland_fluxes.NKor"><code class="xref py py-class docutils literal notranslate"><span class="pre">NKor</span></code></a>, an
additional suffix defines the index of the respective subdevice.
For example contains the third row of <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableAgg.array" title="hydpy.core.netcdftools.NetCDFVariableAgg.array"><code class="xref py py-const docutils literal notranslate"><span class="pre">array</span></code></a>
the time series of the first hydrological response unit of the
second element:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span> <span class="o">=</span> <span class="n">NetCDFVariableFlat</span><span class="p">(</span><span class="s2">&quot;flux_nkor&quot;</span><span class="p">,</span> <span class="n">isolate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">nkor1</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">nkor</span>
<span class="gp">... </span>    <span class="n">ncvar</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nkor1</span><span class="p">,</span> <span class="n">nkor1</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncvar</span><span class="o">.</span><span class="n">subdevicenames</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">(&#39;element2_0&#39;, &#39;element2_1&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableFlat.read">
<code class="sig-name descname"><span class="pre">read</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timegrid_data</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableFlat.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableFlat.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the data from the given NetCDF file.</p>
<p>The argument <cite>timegrid_data</cite> defines the data period of the
given NetCDF file.</p>
<p>See the general documentation on class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a>
for some examples.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.netcdftools.NetCDFVariableFlat.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/netcdftools.html#NetCDFVariableFlat.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.netcdftools.NetCDFVariableFlat.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the data to the given NetCDF file.</p>
<p>See the general documentation on class <a class="reference internal" href="#hydpy.core.netcdftools.NetCDFVariableFlat" title="hydpy.core.netcdftools.NetCDFVariableFlat"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFVariableFlat</span></code></a>
for some examples.</p>
</dd></dl>

</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/HydPy_Logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to.html">How to…</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="framework.html">Framework Tools</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="core.html">Core Tools</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="aliastools.html">aliastools</a></li>
<li class="toctree-l3"><a class="reference internal" href="autodoctools.html">autodoctools</a></li>
<li class="toctree-l3"><a class="reference internal" href="auxfiletools.html">auxfiletools</a></li>
<li class="toctree-l3"><a class="reference internal" href="devicetools.html">devicetools</a></li>
<li class="toctree-l3"><a class="reference internal" href="exceptiontools.html">exceptiontools</a></li>
<li class="toctree-l3"><a class="reference internal" href="filetools.html">filetools</a></li>
<li class="toctree-l3"><a class="reference internal" href="hydpytools.html">hydpytools</a></li>
<li class="toctree-l3"><a class="reference internal" href="importtools.html">importtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="indextools.html">indextools</a></li>
<li class="toctree-l3"><a class="reference internal" href="itemtools.html">itemtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="masktools.html">masktools</a></li>
<li class="toctree-l3"><a class="reference internal" href="modeltools.html">modeltools</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">netcdftools</a></li>
<li class="toctree-l3"><a class="reference internal" href="objecttools.html">objecttools</a></li>
<li class="toctree-l3"><a class="reference internal" href="optiontools.html">optiontools</a></li>
<li class="toctree-l3"><a class="reference internal" href="parametertools.html">parametertools</a></li>
<li class="toctree-l3"><a class="reference internal" href="printtools.html">printtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="propertytools.html">propertytools</a></li>
<li class="toctree-l3"><a class="reference internal" href="pubtools.html">pubtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="selectiontools.html">selectiontools</a></li>
<li class="toctree-l3"><a class="reference internal" href="sequencetools.html">sequencetools</a></li>
<li class="toctree-l3"><a class="reference internal" href="seriestools.html">seriestools</a></li>
<li class="toctree-l3"><a class="reference internal" href="testtools.html">testtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="timetools.html">timetools</a></li>
<li class="toctree-l3"><a class="reference internal" href="typingtools.html">typingtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="variabletools.html">variabletools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="execution.html">Execution Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="cythons.html">Cython Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="auxiliaries.html">Auxiliary Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modelcollection.html">Model Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="zbibliography.html">Bibliography</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="modeltools.html"
                        title="previous chapter">modeltools</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="objecttools.html"
                        title="next chapter">objecttools</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/netcdftools.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="objecttools.html" title="objecttools"
             >next</a> |</li>
        <li class="right" >
          <a href="modeltools.html" title="modeltools"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HydPy 4.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="framework.html" >Framework Tools</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="core.html" >Core Tools</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">netcdftools</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, HydPy Developers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.2.
    </div>
  </body>
</html>
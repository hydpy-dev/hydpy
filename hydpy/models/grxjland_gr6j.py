# -*- coding: utf-8 -*-
# pylint: disable=line-too-long, unused-wildcard-import
"""
GR6J Version of the GrXJ-Land model.
The model can briefly be summarized as follows:

TODO

The following figure shows the general structure of HydPy GrXJ-Land Version GR6J:

.. image:: HydPy-GrXJ-Land_Version-Gr6J.png

.. _grxjland_gr6j_integration_tests:

Integration tests
=================

.. how_to_understand_integration_tests::

As integration test we use the example of the R-package airGR gauging station
Blue River at Nourlangie Rock with a catchment area 360 km².

The integration test is performed over a period of 50 days with
a simulation step of one day:

>>> from hydpy import pub
>>> pub.timegrids = '01.01.1990', '20.02.1990', '1d'

Prepare the model instance and build the connections to element `land`
and node `outlet`:

>>> from hydpy.models.grxjland_gr6j import *
>>> from hydpy import pub
>>> pub.options.reprdigits = 6
>>> ret = pub.options.printprogress(False)
>>> parameterstep('1d')
>>> from hydpy import Node, Element
>>> outlet = Node('outlet')
>>> land = Element('land', outlets=outlet)
>>> land.model = model

All tests are performed using a lumped basin with a size of
360 km²:

>>> area(360.0)

Initialize a test function object, which prepares and runs the tests
and prints their results for the given sequences:

>>> from hydpy import IntegrationTest
>>> IntegrationTest.plotting_options.height = 900
>>> IntegrationTest.plotting_options.activated=(
...     inputs.e, inputs.p, fluxes.qt)
>>> test = IntegrationTest(land)
>>> test.dateformat = '%d.%m.'

.. _grxjland_gr5j_ex1:

Example 1
_____________

We compared the results of grxjland_gr6j with the results of
the GR6J implementation of the airGR package:
The following code was used to run the airGR Gr6J model to compare our results:

.. code-block:: none

    library(airGR)
    ## loading catchment data
    data(L0123001)
    # preparation of the InputsModel object
    InputsModel <- CreateInputsModel(FUN_MOD = RunModel_GR6J, DatesR = BasinObs$DatesR,
        Precip = BasinObs$P, PotEvap = BasinObs$E)
    ## run period selection
    Ind_Run <- seq(which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1990-01-01"),
        which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1990-02-19"))
    ## preparation of the RunOptions object
    RunOptions <- CreateRunOptions(FUN_MOD = RunModel_GR6J,
        InputsModel = InputsModel,
        IndPeriod_WarmUp = 0L, IndPeriod_Run = Ind_Run)
    ## simulation
    Param <- c(X1 = 242.257, X2 = 0.637, X3 = 53.517, X4 = 2.218, X5 = 0.424, X6 = 4.759)
    OutputsModel <- RunModel_GR6J(InputsModel = InputsModel,
        RunOptions = RunOptions, Param = Param)

Set control parameters:

>>> x1(242.257)
>>> x2(0.637)
>>> x3(53.517)
>>> x4(2.218)
>>> x5(0.424)
>>> x6(4.759)

Set initial storage levels: production store 30% filled, routing store 50% filled. log.sequences empty


>>> test.inits = ((states.s, 0.3 * x1),
...               (states.r, 0.5 * x3),
...               (states.r2, 0),
...               (logs.quh1, [0.0, 0.0, 0.0]),
...               (logs.quh2, [0.0, 0.0, 0.0, 0.0, 0.0]))

Input sequences |P| and |E|:

>>> inputs.p.series = (
...     0.0,  9.3,  3.2,  7.3,  0.0,  0.0,  0.0,  0.0,  0.1,  0.2,  2.9,  0.2,  0.0,  0.0,  0.0,
...     3.3,  4.6,  0.8,  1.8,  1.1,  0.0,  5.0, 13.1, 14.6,  4.0,  0.8,  0.1,  3.3,  7.7, 10.3,
...     3.7, 15.3,  3.2,  2.7,  2.2,  8.0, 14.3,  6.3,  0.0,  5.9,  9.2,  6.1,  0.1,  0.0,  2.8,
...     10.6,  8.8,  7.2,  4.9,  1.8)
>>> inputs.e.series = (
...     0.3, 0.4, 0.4, 0.3, 0.1, 0.1, 0.1, 0.2, 0.2, 0.3, 0.3, 0.2, 0.2, 0.2, 0.2, 0.3, 0.3, 0.2, 0.2,
...     0.3, 0.2, 0.2, 0.3, 0.6, 0.4, 0.4, 0.4, 0.5, 0.4, 0.3, 0.3, 0.5, 0.5, 0.3, 0.3, 0.4, 0.4, 0.3,
...     0.2, 0.1, 0.1, 0.0, 0.1, 0.1, 0.0, 0.2, 0.9, 0.9, 0.5, 0.9)

.. integration-test::

    >>> derived.uh1.update()
    >>> derived.uh2.update()
    >>> test.reset_inits()
    >>> conditions = sequences.conditions

    >>> test('grxjland_gr6j_ex1')
    |   date |    p |   e |  en |   pn |        ps |       es |       ae |       pr |    pruh1 |    pruh2 |     perc |       q9 |       q1 |        f |       qr |      qr2 |       qd |       qt |          s |         r |         r2 |    outlet |
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 01.01. |  0.0 | 0.3 | 0.3 |  0.0 |       0.0 | 0.152867 | 0.152867 | 0.005681 | 0.005113 | 0.000568 | 0.005681 | 0.000698 | 0.000039 | 0.048412 | 0.406074 | 3.323095 | 0.048451 |  3.77762 |  72.518551 | 26.401257 |  -3.274404 | 15.740083 |
    | 02.01. |  9.3 | 0.4 | 0.0 |  8.9 |   8.01079 |      0.0 |      0.4 | 0.898798 | 0.808918 |  0.08988 | 0.009588 | 0.113658 | 0.006314 |  0.04416 | 0.384929 | 1.967881 | 0.050474 | 2.403284 |  80.519753 | 26.128682 |  -5.152662 | 10.013685 |
    | 03.01. |  3.2 | 0.4 | 0.0 |  2.8 |  2.481037 |      0.0 |      0.4 | 0.330116 | 0.297104 | 0.033012 | 0.011152 | 0.555871 |  0.03107 | 0.040915 |  0.38419 | 1.456093 | 0.071985 | 1.912268 |  82.989638 |  26.11893 |  -6.345491 |  7.967783 |
    | 04.01. |  7.3 | 0.3 | 0.0 |  7.0 |  6.116283 |      0.0 |      0.3 | 0.899618 | 0.809657 | 0.089962 | 0.015902 | 0.483706 | 0.056746 | 0.040799 | 0.380461 | 1.163228 | 0.097546 | 1.641234 |  89.090019 | 26.069493 |  -7.274437 |  6.838476 |
    | 05.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 |  0.06001 |  0.06001 | 0.015834 | 0.014251 | 0.001583 | 0.015834 |  0.58428 | 0.057791 | 0.040211 | 0.381182 | 0.983998 | 0.098002 | 1.463182 |  89.014175 | 26.079089 |  -7.984512 |  6.096592 |
    | 06.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.059971 | 0.059971 | 0.015767 |  0.01419 | 0.001577 | 0.015767 | 0.195519 | 0.046726 | 0.040325 | 0.365784 | 0.833841 | 0.087051 | 1.286676 |  88.938437 | 25.870942 |  -8.699821 |  5.361152 |
    | 07.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.059931 | 0.059931 |   0.0157 |  0.01413 |  0.00157 |   0.0157 | 0.014196 | 0.015996 | 0.037848 |  0.34462 | 0.715344 | 0.053844 | 1.113807 |  88.862806 | 25.572688 |  -9.371639 |  4.640864 |
    | 08.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.119752 | 0.119752 | 0.015581 | 0.014023 | 0.001558 | 0.015581 | 0.014129 | 0.002331 | 0.034298 | 0.325503 | 0.626646 | 0.036629 | 0.988777 |  88.727474 |  25.28996 |  -9.958335 |  4.119906 |
    | 09.01. |  0.1 | 0.2 | 0.1 |  0.0 |       0.0 | 0.059821 | 0.159821 | 0.015515 | 0.013963 | 0.001551 | 0.015515 | 0.014039 | 0.001566 | 0.030932 | 0.308148 | 0.557678 | 0.032498 | 0.898325 |  88.652138 | 25.021167 | -10.479466 |   3.74302 |
    | 10.01. |  0.2 | 0.3 | 0.1 |  0.0 |       0.0 | 0.059781 | 0.259781 | 0.015449 | 0.013904 | 0.001545 | 0.015449 | 0.013969 | 0.001557 | 0.027733 | 0.292324 | 0.502456 |  0.02929 |  0.82407 |  88.576908 | 24.764957 | -10.948602 |  3.433627 |
    | 11.01. |  2.9 | 0.3 | 0.0 |  2.6 |  2.243524 |      0.0 |      0.3 | 0.373966 |  0.33657 | 0.037397 | 0.017491 | 0.057958 | 0.003997 | 0.024683 | 0.279286 | 0.458816 |  0.02868 | 0.766782 |  90.802941 | 24.545129 | -11.359551 |  3.194925 |
    | 12.01. |  0.2 | 0.2 | 0.0 |  0.0 |       0.0 |      0.0 |      0.2 | 0.017474 | 0.015727 | 0.001747 | 0.017474 | 0.219241 | 0.012954 | 0.022067 |  0.27244 | 0.427782 |  0.03502 | 0.735243 |  90.785467 | 24.426301 |  -11.67757 |  3.063511 |
    | 13.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.121749 | 0.121749 | 0.017341 | 0.015607 | 0.001734 | 0.017341 | 0.088832 | 0.017588 | 0.020652 | 0.261894 | 0.396953 |  0.03824 | 0.697087 |  90.646377 | 24.238358 | -12.018337 |  2.904529 |
    | 14.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.121606 | 0.121606 | 0.017208 | 0.015487 | 0.001721 | 0.017208 | 0.015618 | 0.007446 | 0.018415 | 0.249868 | 0.368208 | 0.025861 | 0.643937 |  90.507563 | 24.016277 | -12.361883 |  2.683072 |
    | 15.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.121462 | 0.121462 | 0.017077 | 0.015369 | 0.001708 | 0.017077 | 0.015498 | 0.002036 | 0.015772 | 0.238729 |  0.34328 | 0.017808 | 0.599816 |  90.369024 | 23.802619 | -12.683192 |  2.499235 |
    | 16.01. |  3.3 | 0.3 | 0.0 |  3.0 |  2.570541 |      0.0 |      0.3 | 0.449087 | 0.404178 | 0.044909 | 0.019628 | 0.068464 | 0.004666 | 0.013229 | 0.229883 | 0.322829 | 0.017895 | 0.570607 |  92.919937 | 23.627043 | -12.965406 |  2.377529 |
    | 17.01. |  4.6 | 0.3 | 0.0 |  4.3 |  3.642215 |      0.0 |      0.3 | 0.681547 | 0.613392 | 0.068155 | 0.023761 | 0.344122 | 0.019974 | 0.011139 | 0.229304 | 0.311607 | 0.031113 | 0.572024 |  96.538391 | 23.615352 | -13.128225 |  2.383433 |
    | 18.01. |  0.8 | 0.2 | 0.0 |  0.6 |  0.504222 |      0.0 |      0.2 | 0.120136 | 0.108123 | 0.012014 | 0.024358 | 0.496748 | 0.042766 |    0.011 | 0.233089 | 0.305212 | 0.053766 | 0.592068 |  97.018254 | 23.691311 | -13.223739 |   2.46695 |
    | 19.01. |  1.8 | 0.2 | 0.0 |  1.6 |  1.339826 |      0.0 |      0.2 | 0.286227 | 0.257605 | 0.028623 | 0.026054 | 0.243678 | 0.043325 | 0.011904 | 0.229529 | 0.293279 | 0.055229 | 0.578036 |  98.332027 | 23.619893 | -13.407642 |  2.408485 |
    | 20.01. |  1.1 | 0.3 | 0.0 |  0.8 |    0.6673 |      0.0 |      0.3 | 0.159614 | 0.143653 | 0.015961 | 0.026914 | 0.207984 |  0.02683 | 0.011054 |  0.22514 | 0.281615 | 0.037884 | 0.544638 |  98.972413 | 23.530598 |  -13.59501 |  2.269325 |
    | 21.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.129972 | 0.129972 | 0.026701 | 0.024031 |  0.00267 | 0.026701 | 0.153296 | 0.020508 | 0.009991 | 0.219469 | 0.269779 | 0.030499 | 0.519747 |   98.81574 | 23.413097 |  -13.79348 |  2.165614 |
    | 22.01. |  5.0 | 0.2 | 0.0 |  4.8 |  3.968784 |      0.0 |      0.2 |  0.86368 | 0.777312 | 0.086368 | 0.032464 | 0.154107 | 0.018535 | 0.008592 | 0.214124 | 0.258997 | 0.027128 | 0.500249 |  102.75206 |  23.30003 | -13.982241 |   2.08437 |
    | 23.01. | 13.1 | 0.3 | 0.0 | 12.8 | 10.257869 |      0.0 |      0.3 | 2.594273 | 2.334846 | 0.259427 | 0.052142 | 0.818221 | 0.049142 | 0.007247 | 0.227121 | 0.263029 | 0.056388 | 0.546538 | 112.957787 | 23.571088 | -13.910735 |  2.277243 |
    | 24.01. | 14.6 | 0.6 | 0.0 | 14.0 |  10.65723 |      0.0 |      0.6 |  3.42438 | 3.081942 | 0.342438 |  0.08161 | 2.081847 | 0.144841 | 0.010473 |  0.27963 | 0.296091 | 0.155314 | 0.731036 | 123.533407 | 24.551039 | -13.363614 |  3.045983 |
    | 25.01. |  4.0 | 0.4 | 0.0 |  3.6 |   2.64368 |      0.0 |      0.4 | 1.046732 | 0.942059 | 0.104673 | 0.090413 | 2.619606 | 0.245346 | 0.022137 | 0.359602 | 0.346515 | 0.267483 | 0.973601 | 126.086674 | 25.785338 |  -12.64015 |  4.056669 |
    | 26.01. |  0.8 | 0.4 | 0.0 |  0.4 |  0.291395 |      0.0 |      0.4 | 0.199739 | 0.179765 | 0.019974 | 0.091134 | 1.325703 | 0.229388 | 0.036829 | 0.392315 | 0.362345 | 0.266217 | 1.020877 | 126.286936 | 26.225274 | -12.435385 |  4.253652 |
    | 27.01. |  0.1 | 0.4 | 0.3 |  0.0 |       0.0 | 0.231115 | 0.331115 |  0.08998 | 0.080982 | 0.008998 |  0.08998 | 0.340012 | 0.110611 | 0.042065 | 0.381958 | 0.349075 | 0.152676 | 0.883709 | 125.965841 | 26.089388 | -12.606389 |   3.68212 |
    | 28.01. |  3.3 | 0.5 | 0.0 |  2.8 |  2.030679 |      0.0 |      0.5 | 0.866432 | 0.779789 | 0.086643 | 0.097112 | 0.198874 | 0.037356 | 0.040448 | 0.366627 | 0.333231 | 0.077803 | 0.777661 | 127.899409 | 25.882533 | -12.819623 |  3.240256 |
    | 29.01. |  7.7 | 0.4 | 0.0 |  7.3 |  5.181272 |      0.0 |      0.4 | 2.236684 | 2.013015 | 0.223668 | 0.117955 | 0.788849 |   0.0509 | 0.037986 | 0.376554 | 0.334606 | 0.088886 | 0.800046 | 132.962726 | 26.017274 | -12.800704 |  3.333525 |
    | 30.01. | 10.3 | 0.3 | 0.0 | 10.0 |  6.829043 |      0.0 |      0.3 | 3.321736 | 2.989562 | 0.332174 | 0.150779 | 1.865245 | 0.133947 | 0.039589 | 0.433868 | 0.366623 | 0.173536 | 0.974026 |  139.64099 | 26.742143 | -12.381639 |  4.058443 |
    | 31.01. |  3.7 | 0.3 | 0.0 |  3.4 |  2.251963 |      0.0 |      0.3 | 1.310467 |  1.17942 | 0.131047 | 0.162429 | 2.519939 | 0.228058 | 0.048217 | 0.527892 | 0.421325 | 0.276276 | 1.225492 | 141.730523 | 27.774432 | -11.746771 |  5.106219 |
    | 01.02. | 15.3 | 0.5 | 0.0 | 14.8 |  9.387156 |      0.0 |      0.5 | 5.635217 | 5.071695 | 0.563522 | 0.222373 |  2.12321 | 0.264571 | 0.060504 | 0.604234 | 0.464711 | 0.325076 |  1.39402 | 150.895307 | 28.504628 | -11.301694 |  5.808418 |
    | 02.02. |  3.2 | 0.5 | 0.0 |  2.7 |  1.641019 |      0.0 |      0.5 | 1.291956 | 1.162761 | 0.129196 | 0.232976 | 3.651104 |  0.30135 | 0.069196 | 0.786878 | 0.574469 | 0.370546 | 1.731893 |  152.30335 | 29.977608 | -10.346525 |  7.216219 |
    | 03.02. |  2.7 | 0.3 | 0.0 |  2.4 |  1.442382 |      0.0 |      0.3 | 1.199948 | 1.079953 | 0.119995 |  0.24233 | 2.042321 | 0.324015 | 0.086728 | 0.852663 | 0.613069 | 0.410743 | 1.876475 | 153.503402 | 30.437067 | -10.055937 |  7.818645 |
    | 04.02. |  2.2 | 0.3 | 0.0 |  1.9 |  1.131508 |      0.0 |      0.3 | 1.017888 | 0.916099 | 0.101789 | 0.249396 | 1.076461 |  0.19394 | 0.092197 | 0.837973 | 0.602246 | 0.286137 | 1.726357 | 154.385514 | 30.337168 | -10.135402 |  7.193152 |
    | 05.02. |  8.0 | 0.4 | 0.0 |  7.6 |  4.423556 |      0.0 |      0.4 | 3.461238 | 3.115115 | 0.346124 | 0.284794 | 1.253583 | 0.134913 | 0.091008 | 0.838634 | 0.601082 | 0.225921 | 1.665637 | 158.524276 | 30.341692 | -10.144042 |  6.940152 |
    | 06.02. | 14.3 | 0.4 | 0.0 | 13.9 |  7.652417 |      0.0 |      0.4 | 6.604543 | 5.944088 | 0.660454 |  0.35696 | 3.000072 | 0.220714 | 0.091062 | 0.980952 | 0.688381 | 0.311776 | 1.981109 | 165.819733 | 31.251844 |  -9.541333 |  8.254621 |
    | 07.02. |  6.3 | 0.3 | 0.0 |  6.0 |  3.135145 |      0.0 |      0.3 | 3.252526 | 2.927273 | 0.325253 |  0.38767 | 4.887592 | 0.403547 | 0.101895 | 1.308894 | 0.897271 | 0.505442 | 2.711606 | 168.567207 | 32.977402 |  -8.381671 |  11.29836 |
    | 08.02. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.181449 | 0.181449 | 0.381214 | 0.343093 | 0.038121 | 0.381214 | 3.262107 | 0.456355 | 0.122434 | 1.450416 | 0.992647 | 0.578789 | 3.021852 | 168.004543 | 33.606684 |  -7.947041 | 12.591049 |
    | 09.02. |  5.9 | 0.1 | 0.0 |  5.8 |  2.960832 |      0.0 |      0.1 | 3.250345 | 2.925311 | 0.325035 | 0.411178 | 1.284482 | 0.287821 | 0.129924 | 1.348402 |  0.92888 | 0.417745 | 2.695027 | 170.554198 | 33.158896 |  -8.232204 | 11.229281 |
    | 10.02. |  9.2 | 0.1 | 0.0 |  9.1 |  4.469321 |      0.0 |      0.1 | 5.092757 | 4.583481 | 0.509276 | 0.462077 | 2.563133 | 0.212749 | 0.124594 |  1.40602 | 0.968817 | 0.337344 | 2.712181 | 174.561441 |  33.41535 |  -8.051174 | 11.300756 |
    | 11.02. |  6.1 | 0.0 | 0.0 |  6.1 |  2.879951 |      0.0 |      0.0 | 3.714754 | 3.343278 | 0.371475 | 0.494705 | 4.036303 | 0.340832 | 0.127647 | 1.630772 | 1.121029 | 0.468479 |  3.22028 | 176.946688 | 34.334006 |  -7.430034 | 13.417833 |
    | 12.02. |  0.1 | 0.1 | 0.0 |  0.0 |       0.0 |      0.0 |      0.1 | 0.487884 | 0.439096 | 0.048788 | 0.487884 | 3.229538 | 0.400529 | 0.138581 | 1.724893 | 1.187645 | 0.539111 | 3.451648 | 176.458803 | 34.685418 |  -7.187283 | 14.381867 |
    | 13.02. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.092613 | 0.092613 | 0.479977 | 0.431979 | 0.047998 | 0.479977 |      1.1 | 0.268509 | 0.142764 | 1.534191 | 1.060512 | 0.411273 | 3.005976 | 175.886214 | 33.953991 |  -7.665031 | 12.524902 |
    | 14.02. |  2.8 | 0.0 | 0.0 |  2.8 |  1.312983 |      0.0 |      0.0 | 1.978373 | 1.780536 | 0.197837 | 0.491356 | 0.617664 | 0.114306 | 0.134058 | 1.339632 | 0.932329 | 0.248364 | 2.520325 |  176.70784 | 33.119016 |  -8.216236 | 10.501355 |
    | 15.02. | 10.6 | 0.2 | 0.0 | 10.4 |  4.716023 |      0.0 |      0.2 | 6.236389 |  5.61275 | 0.623639 | 0.552412 | 1.996247 | 0.137799 |  0.12412 |  1.33644 | 0.930603 | 0.261919 | 2.528961 | 180.871451 | 33.104444 |   -8.22422 | 10.537339 |
    | 16.02. |  8.8 | 0.9 | 0.0 |  7.9 |  3.412051 |      0.0 |      0.9 | 5.084999 | 4.576499 |   0.5085 |  0.59705 | 4.597936 | 0.329098 | 0.123946 |  1.63541 | 1.131123 | 0.453044 | 3.219577 | 183.686452 | 34.351742 |  -7.392223 | 13.414904 |
    | 17.02. |  7.2 | 0.9 | 0.0 |  6.3 |  2.625687 |      0.0 |      0.9 | 4.304729 | 3.874256 | 0.430473 | 0.630416 | 4.716817 | 0.500776 | 0.138793 |    1.929 | 1.334853 | 0.639568 | 3.903421 | 185.681723 | 35.391625 |  -6.701556 | 16.264254 |
    | 18.02. |  4.9 | 0.5 | 0.0 |  4.4 |  1.790017 |      0.0 |      0.5 | 3.260126 | 2.934113 | 0.326013 | 0.650142 | 3.905982 | 0.487018 |  0.15117 | 2.064025 | 1.430302 | 0.638188 | 4.132514 | 186.821597 | 35.822359 |  -6.418295 |  17.21881 |
    | 19.02. |  1.8 | 0.9 | 0.0 |  0.9 |  0.363722 |      0.0 |      0.9 | 1.181503 | 1.063353 |  0.11815 | 0.645225 | 2.893038 | 0.390105 | 0.156297 | 2.022325 | 1.400259 | 0.546402 | 3.968987 | 186.540094 | 35.692154 |  -6.505042 | 16.537444 |

.. _grxjland_gr6j_ex2:

Example 2
_____________

In the second example we start from empty storages, again we reproduce the results from the airGR package running
the following code:

.. code-block:: none

    library(airGR)
    ## loading catchment data
    data(L0123001)
    # preparation of the InputsModel object
    InputsModel <- CreateInputsModel(FUN_MOD = RunModel_GR6J, DatesR = BasinObs$DatesR,
        Precip = BasinObs$P, PotEvap = BasinObs$E)
    ## run period selection
    Ind_Run <- seq(which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1990-01-01"),
        which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1990-02-19"))
    IniStates <- CreateIniStates(FUN_MOD = RunModel_GR6J, InputsModel = InputsModel,
        ProdStore = 0, RoutStore = 0, ExpStore = 0)
    ## preparation of the RunOptions object
    RunOptions <- CreateRunOptions(FUN_MOD = RunModel_GR6J,
        InputsModel = InputsModel,
        IndPeriod_WarmUp = 0L, IndPeriod_Run = Ind_Run, IniStates = IniStates)
    ## simulation
    Param <- c(X1 = 242.257, X2 = 0.637, X3 = 53.517, X4 = 2.218, X5 = 0.424, X6 = 4.759)
    OutputsModel <- RunModel_GR6J(InputsModel = InputsModel,
        RunOptions = RunOptions, Param = Param)

Set initial storage levels: empty production store and routing store. log.sequences empty


>>> test.inits = ((states.s, 0),
...               (states.r, 0),
...               (states.r2, 0),
...               (logs.quh1, [0.0, 0.0, 0.0]),
...               (logs.quh2, [0.0, 0.0, 0.0, 0.0, 0.0]))

Run Integration test

.. integration-test::

    >>> test('grxjland_gr6j_ex2')
    |   date |    p |   e |  en |   pn |        ps |       es |       ae |       pr |    pruh1 |    pruh2 |     perc |       q9 |       q1 |         f |       qr |      qr2 |       qd |       qt |          s |         r |         r2 |   outlet |
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 01.01. |  0.0 | 0.3 | 0.3 |  0.0 |       0.0 |      0.0 |      0.0 |      0.0 |      0.0 |      0.0 |      0.0 |      0.0 |      0.0 | -0.270088 |      0.0 | 3.165559 |      0.0 | 3.165559 |        0.0 |       0.0 |  -3.435647 | 13.18983 |
    | 02.01. |  9.3 | 0.4 | 0.0 |  8.9 |  8.895998 |      0.0 |      0.4 | 0.004002 | 0.003602 |   0.0004 |      0.0 | 0.000492 | 0.000027 | -0.270088 |      0.0 | 1.797819 |      0.0 | 1.797819 |   8.895998 |       0.0 |  -5.503357 | 7.490911 |
    | 03.01. |  3.2 | 0.4 | 0.0 |  2.8 |  2.794914 |      0.0 |      0.4 | 0.005087 | 0.004578 | 0.000509 | 0.000001 | 0.002914 | 0.000162 | -0.270088 |      0.0 | 1.238801 |      0.0 | 1.238801 |  11.690911 |       0.0 |   -7.01108 |  5.16167 |
    | 04.01. |  7.3 | 0.3 | 0.0 |  7.0 |  6.972036 |      0.0 |      0.3 | 0.027971 | 0.025174 | 0.002797 | 0.000006 | 0.007167 | 0.000531 | -0.270088 |      0.0 | 0.933327 |      0.0 | 0.933327 |   18.66294 |       0.0 |  -8.211628 | 3.888862 |
    | 05.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.014808 | 0.014808 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.017045 |  0.00118 | -0.270088 |      0.0 | 0.741079 |      0.0 | 0.741079 |  18.648126 |       0.0 |  -9.215977 | 3.087828 |
    | 06.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.014797 | 0.014797 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.005742 | 0.001331 | -0.270088 |      0.0 | 0.608144 |      0.0 | 0.608144 |  18.633322 |       0.0 | -10.091912 | 2.533933 |
    | 07.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.014786 | 0.014786 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.000006 | 0.000453 | -0.270088 |      0.0 | 0.510955 |      0.0 | 0.510955 |   18.61853 |       0.0 | -10.872953 |  2.12898 |
    | 08.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.029538 | 0.029538 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.000006 | 0.000025 | -0.270088 |      0.0 | 0.437054 |      0.0 | 0.437054 |  18.588986 |       0.0 | -11.580093 | 1.821058 |
    | 09.01. |  0.1 | 0.2 | 0.1 |  0.0 |       0.0 | 0.014752 | 0.114752 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.000006 | 0.000001 | -0.270088 |      0.0 | 0.379043 |      0.0 | 0.379043 |  18.574227 |       0.0 | -12.229221 | 1.579344 |
    | 10.01. |  0.2 | 0.3 | 0.1 |  0.0 |       0.0 | 0.014741 | 0.214741 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.000006 | 0.000001 | -0.270088 |      0.0 | 0.332358 |      0.0 | 0.332358 |   18.55948 |       0.0 | -12.831665 | 1.384827 |
    | 11.01. |  2.9 | 0.3 | 0.0 |  2.6 |  2.582518 |      0.0 |      0.3 | 0.017494 | 0.015745 | 0.001749 | 0.000012 | 0.002154 |  0.00012 | -0.270088 |      0.0 | 0.294085 |      0.0 | 0.294085 |  21.141986 |       0.0 | -13.394977 | 1.225355 |
    | 12.01. |  0.2 | 0.2 | 0.0 |  0.0 |       0.0 |      0.0 |      0.2 | 0.000012 | 0.000011 | 0.000001 | 0.000012 |  0.01001 | 0.000556 | -0.270088 |      0.0 | 0.262312 |      0.0 | 0.262312 |  21.141974 |       0.0 | -13.923372 | 1.092965 |
    | 13.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 |  0.03336 |  0.03336 | 0.000012 | 0.000011 | 0.000001 | 0.000012 | 0.003597 |  0.00078 | -0.270088 |      0.0 | 0.235292 |      0.0 | 0.235292 |  21.108602 |       0.0 | -14.427313 | 0.980383 |
    | 14.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 |  0.03331 |  0.03331 | 0.000012 | 0.000011 | 0.000001 | 0.000012 | 0.000011 | 0.000281 | -0.270088 |      0.0 | 0.212106 |      0.0 | 0.212106 |   21.07528 |       0.0 | -14.909504 | 0.883777 |
    | 15.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.033259 | 0.033259 | 0.000012 | 0.000011 | 0.000001 | 0.000012 | 0.000011 | 0.000016 | -0.270088 |      0.0 | 0.192075 |      0.0 | 0.192075 |  21.042009 |       0.0 | -15.371662 | 0.800312 |
    | 16.01. |  3.3 | 0.3 | 0.0 |  3.0 |  2.974016 |      0.0 |      0.3 | 0.026007 | 0.023406 | 0.002601 | 0.000023 | 0.003204 | 0.000179 | -0.270088 |      0.0 | 0.174667 |      0.0 | 0.174667 |  24.016003 |       0.0 | -15.815136 |  0.72778 |
    | 17.01. |  4.6 | 0.3 | 0.0 |  4.3 |  4.249817 |      0.0 |      0.3 | 0.050234 | 0.045211 | 0.005023 | 0.000051 |  0.02105 |  0.00117 | -0.270088 |      0.0 | 0.159618 |      0.0 | 0.159618 |  28.265768 |       0.0 | -16.236422 | 0.665077 |
    | 18.01. |  0.8 | 0.2 | 0.0 |  0.6 |   0.59166 |      0.0 |      0.2 | 0.008397 | 0.007557 |  0.00084 | 0.000057 | 0.035102 | 0.002812 | -0.270088 |      0.0 | 0.146472 |      0.0 | 0.146472 |  28.857372 |       0.0 | -16.638941 | 0.610299 |
    | 19.01. |  1.8 | 0.2 | 0.0 |  1.6 |  1.576034 |      0.0 |      0.2 |  0.02404 | 0.021636 | 0.002404 | 0.000074 |  0.01806 | 0.003084 | -0.270088 |      0.0 | 0.134569 |      0.0 | 0.134569 |  30.433332 |       0.0 | -17.036374 | 0.560703 |
    | 20.01. |  1.1 | 0.3 | 0.0 |  0.8 |  0.787045 |      0.0 |      0.3 | 0.013039 | 0.011735 | 0.001304 | 0.000084 | 0.017076 | 0.002053 | -0.270088 |      0.0 | 0.123916 |      0.0 | 0.123916 |  31.220293 |       0.0 | -17.423548 | 0.516317 |
    | 21.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.048193 | 0.048193 | 0.000083 | 0.000075 | 0.000008 | 0.000083 |   0.0124 | 0.001663 | -0.270088 |      0.0 | 0.114305 |      0.0 | 0.114305 |  31.172017 |       0.0 | -17.802981 | 0.476271 |
    | 22.01. |  5.0 | 0.2 | 0.0 |  4.8 |  4.707908 |      0.0 |      0.2 |  0.09226 | 0.083034 | 0.009226 | 0.000168 | 0.014055 | 0.001605 | -0.270088 |      0.0 | 0.105656 |      0.0 | 0.105656 |  35.879757 |       0.0 | -18.173103 | 0.440235 |
    | 23.01. | 13.1 | 0.3 | 0.0 | 12.8 | 12.410562 |      0.0 |      0.3 | 0.390182 | 0.351163 | 0.039018 | 0.000744 | 0.100724 | 0.005828 | -0.270088 |      0.0 | 0.098539 |      0.0 | 0.098539 |  48.289576 |       0.0 | -18.501441 |  0.41058 |
    | 24.01. | 14.6 | 0.6 | 0.0 | 14.0 | 13.276027 |      0.0 |      0.6 | 0.726478 |  0.65383 | 0.072648 | 0.002505 | 0.331366 | 0.021479 | -0.270088 |      0.0 | 0.093817 |      0.0 | 0.093817 |  61.563098 |       0.0 | -18.732799 | 0.390904 |
    | 25.01. |  4.0 | 0.4 | 0.0 |  3.6 |  3.354602 |      0.0 |      0.4 | 0.248663 | 0.223796 | 0.024866 | 0.003265 | 0.526156 | 0.043637 | -0.270088 |      0.0 | 0.090868 |      0.0 | 0.090868 |  64.914435 |  0.045606 | -18.883293 | 0.378618 |
    | 26.01. |  0.8 | 0.4 | 0.0 |  0.4 |  0.371115 |      0.0 |      0.4 | 0.032243 | 0.029019 | 0.003224 | 0.003358 | 0.295218 | 0.046798 | -0.269545 |      0.0 | 0.086398 |      0.0 | 0.086398 |  65.282192 |       0.0 | -19.121149 | 0.359992 |
    | 27.01. |  0.1 | 0.4 | 0.3 |  0.0 |       0.0 | 0.139773 | 0.239773 | 0.003322 |  0.00299 | 0.000332 | 0.003322 | 0.069857 | 0.024084 | -0.270088 |      0.0 | 0.080683 |      0.0 | 0.080683 |  65.139097 |       0.0 | -19.443977 |  0.33618 |
    | 28.01. |  3.3 | 0.5 | 0.0 |  2.8 |  2.589401 |      0.0 |      0.5 | 0.214635 | 0.193171 | 0.021463 | 0.004035 | 0.034879 | 0.007609 | -0.270088 |      0.0 | 0.075214 |      0.0 | 0.075214 |  67.724462 |       0.0 | -19.775327 |  0.31339 |
    | 29.01. |  7.7 | 0.4 | 0.0 |  7.3 |  6.671275 |      0.0 |      0.4 | 0.635178 |  0.57166 | 0.063518 | 0.006453 | 0.201487 | 0.012033 | -0.270088 |      0.0 | 0.071174 |      0.0 | 0.071174 |  74.389285 |       0.0 | -20.035995 |  0.29656 |
    | 30.01. | 10.3 | 0.3 | 0.0 | 10.0 |  8.938718 |      0.0 |      0.3 | 1.072656 | 0.965391 | 0.107266 | 0.011374 | 0.539141 | 0.037145 | -0.270088 |      0.0 | 0.069334 |      0.0 | 0.069334 |  83.316628 |  0.053396 | -20.159761 | 0.288891 |
    | 31.01. |  3.7 | 0.3 | 0.0 |  3.4 |  2.983253 |      0.0 |      0.3 | 0.430298 | 0.387268 |  0.04303 | 0.013551 | 0.796751 |  0.06875 | -0.269452 |      0.0 | 0.069044 |      0.0 | 0.069044 |   86.28633 |  0.261994 | -20.179557 | 0.287684 |
    | 01.02. | 15.3 | 0.5 | 0.0 | 14.8 | 12.631868 |      0.0 |      0.5 | 2.194936 | 1.975442 | 0.219494 | 0.026803 | 0.735792 | 0.086772 |  -0.26697 |      0.0 | 0.068446 |      0.0 | 0.068446 |  98.891394 |    0.4365 | -20.220655 | 0.285192 |
    | 02.02. |  3.2 | 0.5 | 0.0 |  2.7 |  2.239805 |      0.0 |      0.5 | 0.490132 | 0.441119 | 0.049013 | 0.029937 | 1.404073 | 0.109977 | -0.264892 |      0.0 | 0.071784 |      0.0 | 0.071784 | 101.101262 |  1.014052 | -19.995703 | 0.299101 |
    | 03.02. |  2.7 | 0.3 | 0.0 |  2.4 |  1.973779 |      0.0 |      0.3 | 0.459146 | 0.413231 | 0.045915 | 0.032925 | 0.786992 | 0.124261 | -0.258018 |      0.0 |  0.07156 |      0.0 |  0.07156 | 103.042116 |  1.228229 | -20.010484 | 0.298167 |
    | 04.02. |  2.2 | 0.3 | 0.0 |  1.9 |  1.551054 |      0.0 |      0.3 | 0.384367 |  0.34593 | 0.038437 |  0.03542 | 0.410401 | 0.074544 | -0.255469 |      0.0 |  0.06917 |      0.0 |  0.06917 | 104.557749 |     1.219 | -20.170962 | 0.288208 |
    | 05.02. |  8.0 | 0.4 | 0.0 |  7.6 |  6.099702 |      0.0 |      0.4 | 1.547238 | 1.392514 | 0.154724 |  0.04694 | 0.504115 | 0.052947 | -0.255579 |      0.0 | 0.067416 |      0.0 | 0.067416 | 110.610511 |  1.265891 | -20.292311 |   0.2809 |
    | 06.02. | 14.3 | 0.4 | 0.0 | 13.9 | 10.709966 |      0.0 |      0.4 | 3.264355 | 2.937919 | 0.326435 | 0.074321 | 1.364923 | 0.096335 |  -0.25502 | 0.000001 | 0.070634 |      0.0 | 0.070635 | 121.246157 |  1.829824 | -20.071996 | 0.294311 |
    | 07.02. |  6.3 | 0.3 | 0.0 |  6.0 |  4.441126 |      0.0 |      0.3 | 1.647547 | 1.482793 | 0.164755 | 0.088674 | 2.387107 | 0.190433 | -0.248308 | 0.000008 | 0.080647 |      0.0 | 0.080654 | 125.598609 |  3.013772 | -19.446108 |  0.33606 |
    | 08.02. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.153561 | 0.153561 | 0.087824 | 0.079041 | 0.008782 | 0.087824 | 1.622826 | 0.223422 | -0.234216 | 0.000023 | 0.086462 |      0.0 | 0.086485 | 125.357224 |  3.753229 | -19.117655 | 0.360353 |
    | 09.02. |  5.9 | 0.1 | 0.0 |  5.8 |  4.194228 |      0.0 |      0.1 | 1.708917 | 1.538026 | 0.170892 | 0.103146 | 0.598097 | 0.141399 | -0.225414 | 0.000027 | 0.085164 |      0.0 | 0.085191 | 129.448307 |  3.886646 | -19.188995 | 0.354963 |
    | 10.02. |  9.2 | 0.1 | 0.0 |  9.1 |  6.370876 |      0.0 |      0.1 | 2.859701 | 2.573731 |  0.28597 | 0.130577 | 1.346879 | 0.106905 | -0.223826 | 0.000054 | 0.089337 |      0.0 | 0.089392 | 135.688607 |  4.470893 | -18.963407 | 0.372465 |
    | 11.02. |  6.1 | 0.0 | 0.0 |  6.1 |  4.127264 |      0.0 |      0.0 | 2.123645 | 1.911281 | 0.212365 | 0.150909 | 2.247272 | 0.184293 | -0.216872 | 0.000168 | 0.101061 |      0.0 | 0.101229 | 139.664961 |  5.602216 | -18.382431 | 0.421789 |
    | 12.02. |  0.1 | 0.1 | 0.0 |  0.0 |       0.0 |      0.0 |      0.1 | 0.150098 | 0.135088 |  0.01501 | 0.150098 | 1.819826 | 0.223291 | -0.203406 | 0.000351 | 0.110358 | 0.019885 | 0.130594 | 139.514864 |  6.490354 | -17.968264 | 0.544141 |
    | 13.02. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.081999 | 0.081999 | 0.148857 | 0.133972 | 0.014886 | 0.148857 | 0.539738 | 0.147595 | -0.192835 | 0.000388 | 0.108374 |      0.0 | 0.108762 | 139.284007 |  6.620974 | -18.053579 | 0.453176 |
    | 14.02. |  2.8 | 0.0 | 0.0 |  2.8 |  1.861977 |      0.0 |      0.0 | 1.096231 | 0.986608 | 0.109623 | 0.158208 | 0.250601 | 0.055339 |  -0.19128 | 0.000376 | 0.103975 |      0.0 | 0.104351 | 140.987776 |  6.579679 | -18.248594 | 0.434797 |
    | 15.02. | 10.6 | 0.2 | 0.0 | 10.4 |  6.705901 |      0.0 |      0.2 | 3.892459 | 3.503213 | 0.389246 |  0.19836 | 1.135776 | 0.072253 | -0.191772 | 0.000538 | 0.107458 |      0.0 | 0.107997 | 147.495316 |  7.068835 | -18.093513 | 0.449985 |
    | 16.02. |  8.8 | 0.9 | 0.0 |  7.9 |  4.873118 |      0.0 |      0.9 | 3.258583 | 2.932724 | 0.325858 |   0.2317 | 2.851803 |  0.19727 | -0.185949 | 0.001428 |  0.12812 | 0.011321 | 0.140869 | 152.136734 |  8.592539 | -17.266862 | 0.586954 |
    | 17.02. |  7.2 | 0.9 | 0.0 |  6.3 |  3.753261 |      0.0 |      0.9 | 2.806388 | 2.525749 | 0.280639 | 0.259648 | 3.007194 | 0.313723 | -0.167813 |  0.00341 | 0.154586 |  0.14591 | 0.303906 | 155.630346 | 10.225632 | -16.386383 | 1.266275 |
    | 18.02. |  4.9 | 0.5 | 0.0 |  4.4 |  2.554033 |      0.0 |      0.5 | 2.125224 | 1.912701 | 0.212522 | 0.279256 | 2.534826 | 0.312047 | -0.148375 | 0.006387 | 0.179031 | 0.163672 | 0.349091 | 157.905122 | 11.591766 | -15.699858 | 1.454546 |
    | 19.02. |  1.8 | 0.9 | 0.0 |  0.9 |  0.516379 |      0.0 |      0.9 |  0.66497 | 0.598473 | 0.066497 | 0.281348 |  1.87304 | 0.252546 | -0.132114 | 0.009597 | 0.195943 | 0.120432 | 0.325972 | 158.140153 | 12.573879 | -15.278699 | 1.358217 |

.. _grxjland_gr6j_ex3:

Example 3
_____________

In the third we start from empty storages and use a negative groundwater exchange coefficient X2.
Agaim we reproduce the results from the airGR package running
the following code:

.. code-block:: none

    library(airGR)
    ## loading catchment data
    data(L0123001)
    # preparation of the InputsModel object
    InputsModel <- CreateInputsModel(FUN_MOD = RunModel_GR6J, DatesR = BasinObs$DatesR,
        Precip = BasinObs$P, PotEvap = BasinObs$E)
    ## run period selection
    Ind_Run <- seq(which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1990-01-01"),
        which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1990-02-19"))
    IniStates <- CreateIniStates(FUN_MOD = RunModel_GR6J, InputsModel = InputsModel,
        ProdStore = 0, RoutStore = 0, ExpStore = 0)
    ## preparation of the RunOptions object
    RunOptions <- CreateRunOptions(FUN_MOD = RunModel_GR6J,
        InputsModel = InputsModel,
        IndPeriod_WarmUp = 0L, IndPeriod_Run = Ind_Run, IniStates = IniStates)
    ## simulation
    Param <- c(X1 = 242.257, X2 = -0.637, X3 = 53.517, X4 = 2.218, X5 = 0.424, X6 = 4.759)
    OutputsModel <- RunModel_GR6J(InputsModel = InputsModel,
        RunOptions = RunOptions, Param = Param)


Set negative control parameters X2:

>>> x2(-0.637)

Run Integration test

.. integration-test::

    >>> test('grxjland_gr6j_ex3')
    |   date |    p |   e |  en |   pn |        ps |       es |       ae |       pr |    pruh1 |    pruh2 |     perc |       q9 |       q1 |         f |       qr |      qr2 |       qd |       qt |          s |         r |         r2 |    outlet |
    --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 01.01. |  0.0 | 0.3 | 0.3 |  0.0 |       0.0 |      0.0 |      0.0 |      0.0 |      0.0 |      0.0 |      0.0 |      0.0 |      0.0 |  0.270088 |      0.0 | 3.435647 | 0.270088 | 3.705735 |        0.0 |  0.270088 |  -3.165559 | 15.440563 |
    | 02.01. |  9.3 | 0.4 | 0.0 |  8.9 |  8.895998 |      0.0 |      0.4 | 0.004002 | 0.003602 |   0.0004 |      0.0 | 0.000492 | 0.000027 |  0.266873 |      0.0 | 2.066781 | 0.266901 | 2.333682 |   8.895998 |  0.537256 |  -4.965271 |  9.723674 |
    | 03.01. |  3.2 | 0.4 | 0.0 |  2.8 |  2.794914 |      0.0 |      0.4 | 0.005087 | 0.004578 | 0.000509 | 0.000001 | 0.002914 | 0.000162 |  0.263693 |      0.0 |  1.50664 | 0.263855 | 1.770495 |  11.690911 |  0.802698 |  -6.207052 |  7.377064 |
    | 04.01. |  7.3 | 0.3 | 0.0 |  7.0 |  6.972036 |      0.0 |      0.3 | 0.027971 | 0.025174 | 0.002797 | 0.000006 | 0.007167 | 0.000531 |  0.260534 |      0.0 | 1.200066 | 0.261064 | 1.461131 |   18.66294 |  1.067532 |  -7.143718 |  6.088045 |
    | 05.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.014808 | 0.014808 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.017045 |  0.00118 |  0.257381 |      0.0 | 1.006834 | 0.258561 | 1.265395 |  18.648126 |   1.33514 |  -7.886352 |  5.272478 |
    | 06.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.014797 | 0.014797 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.005742 | 0.001331 |  0.254196 |      0.0 |  0.87259 | 0.255527 | 1.128117 |  18.633322 |   1.59278 |   -8.50245 |  4.700489 |
    | 07.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.014786 | 0.014786 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.000006 | 0.000453 |   0.25113 | 0.000001 | 0.773975 | 0.251582 | 1.025558 |   18.61853 |  1.843913 |  -9.025293 |  4.273158 |
    | 08.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.029538 | 0.029538 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.000006 | 0.000025 |   0.24814 | 0.000001 |  0.69866 | 0.248165 | 0.946826 |  18.588986 |  2.092055 |   -9.47581 |  3.945109 |
    | 09.01. |  0.1 | 0.2 | 0.1 |  0.0 |       0.0 | 0.014752 | 0.114752 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.000006 | 0.000001 |  0.245187 | 0.000002 | 0.639232 | 0.245187 | 0.884421 |  18.574227 |  2.337243 |  -9.869853 |  3.685089 |
    | 10.01. |  0.2 | 0.3 | 0.1 |  0.0 |       0.0 | 0.014741 | 0.214741 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.000006 | 0.000001 |  0.242268 | 0.000003 |  0.59112 | 0.242269 | 0.833392 |   18.55948 |  2.579512 | -10.218702 |  3.472467 |
    | 11.01. |  2.9 | 0.3 | 0.0 |  2.6 |  2.582518 |      0.0 |      0.3 | 0.017494 | 0.015745 | 0.001749 | 0.000012 | 0.002154 |  0.00012 |  0.239385 | 0.000005 | 0.551445 | 0.239505 | 0.790955 |  21.141986 |  2.820183 | -10.529901 |  3.295645 |
    | 12.01. |  0.2 | 0.2 | 0.0 |  0.0 |       0.0 |      0.0 |      0.2 | 0.000012 | 0.000011 | 0.000001 | 0.000012 |  0.01001 | 0.000556 |   0.23652 | 0.000008 | 0.518399 | 0.237076 | 0.755484 |  21.141974 |  3.062701 | -10.807776 |  3.147849 |
    | 13.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 |  0.03336 |  0.03336 | 0.000012 | 0.000011 | 0.000001 | 0.000012 | 0.003597 |  0.00078 |  0.233633 | 0.000012 | 0.489926 | 0.234413 | 0.724351 |  21.108602 |  3.298481 |  -11.06263 |   3.01813 |
    | 14.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 |  0.03331 |  0.03331 | 0.000012 | 0.000011 | 0.000001 | 0.000012 | 0.000011 | 0.000281 |  0.230827 | 0.000017 | 0.465194 | 0.231108 | 0.696318 |   21.07528 |  3.529297 | -11.296992 |  2.901326 |
    | 15.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.033259 | 0.033259 | 0.000012 | 0.000011 | 0.000001 | 0.000012 | 0.000011 | 0.000016 |   0.22808 | 0.000023 | 0.443605 | 0.228096 | 0.671724 |  21.042009 |  3.757361 | -11.512513 |  2.798848 |
    | 16.01. |  3.3 | 0.3 | 0.0 |  3.0 |  2.974016 |      0.0 |      0.3 | 0.026007 | 0.023406 | 0.002601 | 0.000023 | 0.003204 | 0.000179 |  0.225365 | 0.000031 | 0.424691 | 0.225544 | 0.650266 |  24.016003 |  3.984617 | -11.710558 |   2.70944 |
    | 17.01. |  4.6 | 0.3 | 0.0 |  4.3 |  4.249817 |      0.0 |      0.3 | 0.050234 | 0.045211 | 0.005023 | 0.000051 |  0.02105 |  0.00117 |   0.22266 | 0.000041 | 0.408466 |  0.22383 | 0.632337 |  28.265768 |  4.219867 | -11.887944 |  2.634738 |
    | 18.01. |  0.8 | 0.2 | 0.0 |  0.6 |   0.59166 |      0.0 |      0.2 | 0.008397 | 0.007557 |  0.00084 | 0.000057 | 0.035102 | 0.002812 |   0.21986 | 0.000054 | 0.394347 | 0.222672 | 0.617073 |  28.857372 |  4.460734 | -12.048391 |  2.571138 |
    | 19.01. |  1.8 | 0.2 | 0.0 |  1.6 |  1.576034 |      0.0 |      0.2 |  0.02404 | 0.021636 | 0.002404 | 0.000074 |  0.01806 | 0.003084 |  0.216993 | 0.000069 | 0.381038 | 0.220077 | 0.601185 |  30.433332 |  4.688494 | -12.205212 |  2.504936 |
    | 20.01. |  1.1 | 0.3 | 0.0 |  0.8 |  0.787045 |      0.0 |      0.3 | 0.013039 | 0.011735 | 0.001304 | 0.000084 | 0.017076 | 0.002053 |  0.214282 | 0.000087 | 0.368922 | 0.216335 | 0.585344 |  31.220293 |  4.912934 | -12.353022 |  2.438935 |
    | 21.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.048193 | 0.048193 | 0.000083 | 0.000075 | 0.000008 | 0.000083 |   0.0124 | 0.001663 |  0.211611 | 0.000108 | 0.357724 | 0.213273 | 0.571106 |  31.172017 |  5.131876 | -12.494176 |   2.37961 |
    | 22.01. |  5.0 | 0.2 | 0.0 |  4.8 |  4.707908 |      0.0 |      0.2 |  0.09226 | 0.083034 | 0.009226 | 0.000168 | 0.014055 | 0.001605 |  0.209005 | 0.000133 | 0.347506 | 0.210609 | 0.558249 |  35.879757 |   5.34918 | -12.627055 |  2.326036 |
    | 23.01. | 13.1 | 0.3 | 0.0 | 12.8 | 12.410562 |      0.0 |      0.3 | 0.390182 | 0.351163 | 0.039018 | 0.000744 | 0.100724 | 0.005828 |  0.206418 |  0.00017 | 0.340477 | 0.212246 | 0.552893 |  48.289576 |  5.615862 | -12.720824 |  2.303722 |
    | 24.01. | 14.6 | 0.6 | 0.0 | 14.0 | 13.276027 |      0.0 |      0.6 | 0.726478 |  0.65383 | 0.072648 | 0.002505 | 0.331366 | 0.021479 |  0.203244 | 0.000241 | 0.340154 | 0.224723 | 0.565117 |  61.563098 |  6.017685 | -12.725188 |  2.354653 |
    | 25.01. |  4.0 | 0.4 | 0.0 |  3.6 |  3.354602 |      0.0 |      0.4 | 0.248663 | 0.223796 | 0.024866 | 0.003265 | 0.526156 | 0.043637 |  0.198461 | 0.000362 |  0.34493 | 0.242098 |  0.58739 |  64.914435 |  6.531478 | -12.661194 |  2.447457 |
    | 26.01. |  0.8 | 0.4 | 0.0 |  0.4 |  0.371115 |      0.0 |      0.4 | 0.032243 | 0.029019 | 0.003224 | 0.003358 | 0.295218 | 0.046798 |  0.192345 | 0.000477 | 0.342526 | 0.239144 | 0.582147 |  65.282192 |  6.900477 | -12.693287 |  2.425611 |
    | 27.01. |  0.1 | 0.4 | 0.3 |  0.0 |       0.0 | 0.139773 | 0.239773 | 0.003322 |  0.00299 | 0.000332 | 0.003322 | 0.069857 | 0.024084 |  0.187953 | 0.000562 |  0.33384 | 0.212037 | 0.546439 |  65.139097 |  7.129783 | -12.811231 |  2.276827 |
    | 28.01. |  3.3 | 0.5 | 0.0 |  2.8 |  2.589401 |      0.0 |      0.5 | 0.214635 | 0.193171 | 0.021463 | 0.004035 | 0.034879 | 0.007609 |  0.185224 | 0.000647 | 0.324836 | 0.192833 | 0.518317 |  67.724462 |  7.335287 | -12.936892 |  2.159652 |
    | 29.01. |  7.7 | 0.4 | 0.0 |  7.3 |  6.671275 |      0.0 |      0.4 | 0.635178 |  0.57166 | 0.063518 | 0.006453 | 0.201487 | 0.012033 |  0.182778 | 0.000793 | 0.320805 | 0.194811 | 0.516409 |  74.389285 |  7.638164 | -12.994324 |  2.151703 |
    | 30.01. | 10.3 | 0.3 | 0.0 | 10.0 |  8.938718 |      0.0 |      0.3 | 1.072656 | 0.965391 | 0.107266 | 0.011374 | 0.539141 | 0.037145 |  0.179173 | 0.001089 | 0.325666 | 0.216318 | 0.543074 |  83.316628 |  8.139732 | -12.925162 |  2.262806 |
    | 31.01. |  3.7 | 0.3 | 0.0 |  3.4 |  2.983253 |      0.0 |      0.3 | 0.430298 | 0.387268 |  0.04303 | 0.013551 | 0.796751 |  0.06875 |  0.173203 | 0.001599 | 0.336843 | 0.241953 | 0.580395 |   86.28633 |  8.789386 | -12.770101 |  2.418311 |
    | 01.02. | 15.3 | 0.5 | 0.0 | 14.8 | 12.631868 |      0.0 |      0.5 | 2.194936 | 1.975442 | 0.219494 | 0.026803 | 0.735792 | 0.086772 |   0.16547 | 0.002231 | 0.345346 | 0.252242 | 0.599819 |  98.891394 |    9.3941 |  -12.65566 |  2.499247 |
    | 02.02. |  3.2 | 0.5 | 0.0 |  2.7 |  2.239805 |      0.0 |      0.5 | 0.490132 | 0.441119 | 0.049013 | 0.029937 | 1.404073 | 0.109977 |  0.158272 | 0.003695 | 0.372545 | 0.268249 | 0.644489 | 101.101262 | 10.391121 | -12.308303 |  2.685372 |
    | 03.02. |  2.7 | 0.3 | 0.0 |  2.4 |  1.973779 |      0.0 |      0.3 | 0.459146 | 0.413231 | 0.045915 | 0.032925 | 0.786992 | 0.124261 |  0.146405 | 0.004925 | 0.379278 | 0.270665 | 0.654868 | 103.042116 | 11.004796 |  -12.22638 |  2.728618 |
    | 04.02. |  2.2 | 0.3 | 0.0 |  1.9 |  1.551054 |      0.0 |      0.3 | 0.384367 |  0.34593 | 0.038437 |  0.03542 | 0.410401 | 0.074544 |  0.139101 | 0.005835 | 0.373498 | 0.213645 | 0.592978 | 104.557749 | 11.384302 | -12.296617 |  2.470741 |
    | 05.02. |  8.0 | 0.4 | 0.0 |  7.6 |  6.099702 |      0.0 |      0.4 | 1.547238 | 1.392514 | 0.154724 |  0.04694 | 0.504115 | 0.052947 |  0.134583 | 0.007025 | 0.370695 |  0.18753 |  0.56525 | 110.610511 | 11.814329 | -12.331082 |  2.355208 |
    | 06.02. | 14.3 | 0.4 | 0.0 | 13.9 | 10.709966 |      0.0 |      0.4 | 3.264355 | 2.937919 | 0.326435 | 0.074321 | 1.364923 | 0.096335 |  0.129465 |   0.0103 |  0.39422 |   0.2258 | 0.630319 | 121.246157 | 12.752449 | -12.049868 |   2.62633 |
    | 07.02. |  6.3 | 0.3 | 0.0 |  6.0 |  4.441126 |      0.0 |      0.3 | 1.647547 | 1.482793 | 0.164755 | 0.088674 | 2.387107 | 0.190433 |  0.118299 | 0.018186 | 0.451882 | 0.308731 | 0.778799 | 125.598609 | 14.284826 | -11.428608 |  3.244996 |
    | 08.02. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.153561 | 0.153561 | 0.087824 | 0.079041 | 0.008782 | 0.087824 | 1.622826 | 0.223422 |  0.100059 | 0.025935 | 0.479592 | 0.323481 | 0.829008 | 125.357224 | 15.332645 |  -11.15901 |    3.4542 |
    | 09.02. |  5.9 | 0.1 | 0.0 |  5.8 |  4.194228 |      0.0 |      0.1 | 1.708917 | 1.538026 | 0.170892 | 0.103146 | 0.598097 | 0.141399 |  0.087587 | 0.029671 | 0.465158 | 0.228987 | 0.723816 | 129.448307 | 15.749419 | -11.297342 |  3.015898 |
    | 10.02. |  9.2 | 0.1 | 0.0 |  9.1 |  6.370876 |      0.0 |      0.1 | 2.859701 | 2.573731 |  0.28597 | 0.130577 | 1.346879 | 0.106905 |  0.082626 | 0.038658 | 0.479923 | 0.189532 | 0.708112 | 135.688607 | 16.601515 | -11.155887 |  2.950469 |
    | 11.02. |  6.1 | 0.0 | 0.0 |  6.1 |  4.127264 |      0.0 |      0.0 | 2.123645 | 1.911281 | 0.212365 | 0.150909 | 2.247272 | 0.184293 |  0.072484 | 0.057486 | 0.529331 | 0.256777 | 0.843594 | 139.664961 | 17.964877 | -10.713825 |  3.514975 |
    | 12.02. |  0.1 | 0.1 | 0.0 |  0.0 |       0.0 |      0.0 |      0.1 | 0.150098 | 0.135088 |  0.01501 | 0.150098 | 1.819826 | 0.223291 |  0.056256 | 0.076955 |  0.55681 | 0.279548 | 0.913313 | 139.514864 | 19.036074 | -10.486449 |  3.805471 |
    | 13.02. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.081999 | 0.081999 | 0.148857 | 0.133972 | 0.014886 | 0.148857 | 0.539738 | 0.147595 |  0.043506 |  0.08293 |  0.52487 | 0.191101 |   0.7989 | 139.284007 | 19.320493 | -10.751918 |   3.32875 |
    | 14.02. |  2.8 | 0.0 | 0.0 |  2.8 |  1.861977 |      0.0 |      0.0 | 1.096231 | 0.986608 | 0.109623 | 0.158208 | 0.250601 | 0.055339 |  0.040121 | 0.085233 | 0.486139 |  0.09546 | 0.666832 | 140.987776 | 19.425741 | -11.097696 |  2.778468 |
    | 15.02. | 10.6 | 0.2 | 0.0 | 10.4 |  6.705901 |      0.0 |      0.2 | 3.892459 | 3.503213 | 0.389246 |  0.19836 | 1.135776 | 0.072253 |  0.038868 |  0.09989 | 0.486823 | 0.111121 | 0.697834 | 147.495316 | 20.046185 |  -11.09134 |  2.907643 |
    | 16.02. |  8.8 | 0.9 | 0.0 |  7.9 |  4.873118 |      0.0 |      0.9 | 3.258583 | 2.932724 | 0.325858 |   0.2317 | 2.851803 |  0.19727 |  0.031483 | 0.147151 | 0.557971 | 0.228753 | 0.933876 | 152.136734 | 21.641599 | -10.477107 |  3.891149 |
    | 17.02. |  7.2 | 0.9 | 0.0 |  6.3 |  3.753261 |      0.0 |      0.9 | 2.806388 | 2.525749 | 0.280639 | 0.259648 | 3.007194 | 0.313723 |  0.012493 | 0.211643 | 0.635332 | 0.326216 | 1.173191 | 155.630346 | 23.246766 |  -9.897069 |  4.888297 |
    | 18.02. |  4.9 | 0.5 | 0.0 |  4.4 |  2.554033 |      0.0 |      0.5 | 2.125224 | 1.912701 | 0.212522 | 0.279256 | 2.534826 | 0.312047 | -0.006613 | 0.275818 | 0.683442 | 0.305434 | 1.264694 | 157.905122 | 24.485231 |  -9.573192 |  5.269557 |
    | 19.02. |  1.8 | 0.9 | 0.0 |  0.9 |  0.516379 |      0.0 |      0.9 |  0.66497 | 0.598473 | 0.066497 | 0.281348 |  1.87304 | 0.252546 | -0.021354 | 0.323787 | 0.689408 | 0.231192 | 1.244387 | 158.140153 | 25.263915 |  -9.534738 |  5.184944 |

**References**

Coron, L., G. Thirel, O. Delaigue, C. Perrin & V. Andréassian (2017): The suite of lumped GR hydrological models in an R package. Environmental Modelling & Software 94, 166-171

Coron, L., O. Delaigue, G. Thirel, C. Perrin & C. Michel (2019): airGR: Suite of GR Hydrological Models for Precipitation-Runoff Modelling. R package version 1.3.2.42. URL: https://CRAN.R-project.org/package=airGR.

Le Moine, N. (2008): Le bassin versant de surface vu par le souterrain : une voie d'amélioration des performances et du réalisme des modèles pluie-débit ? PhD thesis (french), UPMC, Paris, France.
    
Perrin, C., C. Michel & V. Andréassian (2003): Improvement of a parsimonious model for streamflow simulation. Journal of Hydrology 279(1), 275-289

Pushpalatha, R., C. Perrin, N. Le Moine, T. Mathevet, and V. Andréassian (2011): A downward structural sensitivity analysis of hydrological models to improve low-flow simulation. Journal of Hydrology, 411(1-2), 66-76. doi: 10.1016/j.jhydrol.2011.09.034.

"""

# import...
# ...from HydPy
from hydpy.exe.modelimports import *
from hydpy.core import modeltools

# ...from  grxjland
from hydpy.models.grxjland import grxjland_model


class Model(modeltools.AdHocModel):
    """GR6J version of GRxJ-Land (|grxjland_gr6j|)."""

    INLET_METHODS = ()
    RECEIVER_METHODS = ()
    RUN_METHODS = (
        grxjland_model.Calc_Pn_En_V1,
        grxjland_model.Calc_PS_V1,
        grxjland_model.Calc_Es_V1,
        grxjland_model.Update_S_V1,
        grxjland_model.Calc_Perc_V1,
        grxjland_model.Update_S_V2,
        grxjland_model.Calc_AE_V1,
        grxjland_model.Calc_Pr_V1,
        grxjland_model.Calc_PrUH1_PrUH2_V1,
        grxjland_model.Calc_Q9_V1,
        grxjland_model.Calc_Q1_V1,
        grxjland_model.Calc_F_V2,
        grxjland_model.Update_R_V2,
        grxjland_model.Calc_Qr_V1,
        grxjland_model.Update_R_V3,
        grxjland_model.Update_R2_V1,
        grxjland_model.Calc_Qr2_R2_V1,
        grxjland_model.Calc_Qd_V1,
        grxjland_model.Calc_Qt_V3,
    )
    ADD_METHODS = ()
    OUTLET_METHODS = (grxjland_model.Pass_Q_V1,)
    SENDER_METHODS = ()
    SUBMODELINTERFACES = ()
    SUBMODELS = ()


tester = Tester()
cythonizer = Cythonizer()

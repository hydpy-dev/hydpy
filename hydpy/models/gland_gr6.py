# -*- coding: utf-8 -*-
# pylint: disable=line-too-long, unused-wildcard-import
"""
The GR6J model (modèle du Génie Rural à 6 parametres Journalier) is a daily
lumped five-parameter rainfall-runoff model and belongs to the family of soil moisture
accounting models. It was published by :cite:t:`ref-Pushpalatha2011` and is a
modification of GR4 and GR5 (|gland_gr4|, |gland_gr5|). Here it is
implemented according to :cite:t:`ref-airGR2017`. The model contains two stores and
has five parameters.
Compared to GR5, the routing store is split into a linear and an exponential
routing store, which introduces a new parameter.

The following figure :cite:p:`ref-airGRManual` shows the general structure of HydPy
G-Land Version GR6:

.. image:: HydPy-G-Land_Version-Gr6.png

.. _gland_gr6_integration_tests:

Integration tests
=================

.. how_to_understand_integration_tests::

As integration test we use the example dataset L0123001 of the R-package airGR.

The integration test is performed over a period of 50 days with
a simulation step of one day:

>>> from hydpy import pub
>>> pub.timegrids = '01.01.1990', '20.02.1990', '1d'

Prepare the model instance and build the connections to element `land`
and node `outlet`:

>>> from hydpy.models.gland_gr6 import *
>>> from hydpy import pub
>>> pub.options.reprdigits = 6
>>> ret = pub.options.printprogress(False)
>>> parameterstep('1d')
>>> from hydpy import Node, Element
>>> outlet = Node('outlet')
>>> land = Element('land', outlets=outlet)
>>> land.model = model

All tests are performed using a lumped basin with a size of
360 km²:

>>> area(360.0)

We add the |evap_io| submodel, which can provide predefined time series
of potential evaporation:

>>> with model.add_petmodel_v1("evap_io"):
...     evapotranspirationfactor(1.0)

Initialize a test function object, which prepares and runs the tests
and prints their results for the given sequences:

>>> from hydpy import IntegrationTest
>>> IntegrationTest.plotting_options.height = 900
>>> IntegrationTest.plotting_options.activated=(
...     fluxes.e, inputs.p, fluxes.qh)
>>> test = IntegrationTest(land)
>>> test.dateformat = '%d.%m.'

.. _gland_gr6_ex1:

Example 1
_____________

We compared the results of gland_gr6 with the results of
the GR6 implementation of the airGR package:
The following code was used to run the airGR Gr6 model to compare our results:

Set control parameters:

>>> x1(242.257)
>>> x2(0.637)
>>> x3(53.517)
>>> x4(2.218)
>>> x5(0.424)
>>> x6(4.759)
>>> imax(0.0)

Set initial storage levels: production store 30% filled, routing store 50% filled. log.sequences empty


>>> test.inits = ((states.s, 0.3 * x1),
...               (states.r, 0.5 * x3),
...               (states.i, 0.0),
...               (states.r2, 0),
...               (logs.quh1, [0.0, 0.0, 0.0]),
...               (logs.quh2, [0.0, 0.0, 0.0, 0.0, 0.0]))

The input data shows high precipitation and low evapotranspiration:

>>> inputs.p.series = (
...     0.0,  9.3,  3.2,  7.3,  0.0,  0.0,  0.0,  0.0,  0.1,  0.2,  2.9,  0.2,  0.0,  0.0,  0.0,
...     3.3,  4.6,  0.8,  1.8,  1.1,  0.0,  5.0, 13.1, 14.6,  4.0,  0.8,  0.1,  3.3,  7.7, 10.3,
...     3.7, 15.3,  3.2,  2.7,  2.2,  8.0, 14.3,  6.3,  0.0,  5.9,  9.2,  6.1,  0.1,  0.0,  2.8,
...     10.6,  8.8,  7.2,  4.9,  1.8)
>>> model.petmodel.sequences.inputs.referenceevapotranspiration.series = (
...     0.3, 0.4, 0.4, 0.3, 0.1, 0.1, 0.1, 0.2, 0.2, 0.3, 0.3, 0.2, 0.2, 0.2, 0.2, 0.3, 0.3, 0.2, 0.2,
...     0.3, 0.2, 0.2, 0.3, 0.6, 0.4, 0.4, 0.4, 0.5, 0.4, 0.3, 0.3, 0.5, 0.5, 0.3, 0.3, 0.4, 0.4, 0.3,
...     0.2, 0.1, 0.1, 0.0, 0.1, 0.1, 0.0, 0.2, 0.9, 0.9, 0.5, 0.9)

.. integration-test::

    >>> conditions = test("gland_gr6_ex1", get_conditions="1990-01-01")
    |   date |    p |   e |  en |   pn |        ps |  ei |       es |       ae |       pr |      pr9 |      pr1 |     perc |       q9 |       q1 |       fd |       fr |      fr2 |       qr |      qr2 |       qd |       qh |        qv |   i |          s |         r |         r2 |    outlet |
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 01.01. |  0.0 | 0.3 | 0.3 |  0.0 |       0.0 | 0.0 | 0.152867 | 0.152867 | 0.005681 | 0.005113 | 0.000568 | 0.005681 | 0.000698 | 0.000039 | 0.048412 | 0.048412 | 0.048412 | 0.406074 | 3.323095 | 0.048451 |  3.77762 | 15.740083 | 0.0 |  72.518551 | 26.401257 |  -3.274404 | 15.740083 |
    | 02.01. |  9.3 | 0.4 | 0.0 |  8.9 |   8.01079 | 0.4 |      0.0 |      0.4 | 0.898798 | 0.808918 |  0.08988 | 0.009588 | 0.113658 | 0.006314 |  0.04416 |  0.04416 |  0.04416 | 0.384929 | 1.967881 | 0.050474 | 2.403284 | 10.013685 | 0.0 |  80.519753 | 26.128682 |  -5.152662 | 10.013685 |
    | 03.01. |  3.2 | 0.4 | 0.0 |  2.8 |  2.481037 | 0.4 |      0.0 |      0.4 | 0.330116 | 0.297104 | 0.033012 | 0.011152 | 0.555871 |  0.03107 | 0.040915 | 0.040915 | 0.040915 |  0.38419 | 1.456093 | 0.071985 | 1.912268 |  7.967783 | 0.0 |  82.989638 |  26.11893 |  -6.345491 |  7.967783 |
    | 04.01. |  7.3 | 0.3 | 0.0 |  7.0 |  6.116283 | 0.3 |      0.0 |      0.3 | 0.899618 | 0.809657 | 0.089962 | 0.015902 | 0.483706 | 0.056746 | 0.040799 | 0.040799 | 0.040799 | 0.380461 | 1.163228 | 0.097546 | 1.641234 |  6.838476 | 0.0 |  89.090019 | 26.069493 |  -7.274437 |  6.838476 |
    | 05.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.0 |  0.06001 |  0.06001 | 0.015834 | 0.014251 | 0.001583 | 0.015834 |  0.58428 | 0.057791 | 0.040211 | 0.040211 | 0.040211 | 0.381182 | 0.983998 | 0.098002 | 1.463182 |  6.096592 | 0.0 |  89.014175 | 26.079089 |  -7.984512 |  6.096592 |
    | 06.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.0 | 0.059971 | 0.059971 | 0.015767 |  0.01419 | 0.001577 | 0.015767 | 0.195519 | 0.046726 | 0.040325 | 0.040325 | 0.040325 | 0.365784 | 0.833841 | 0.087051 | 1.286676 |  5.361152 | 0.0 |  88.938437 | 25.870942 |  -8.699821 |  5.361152 |
    | 07.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.0 | 0.059931 | 0.059931 |   0.0157 |  0.01413 |  0.00157 |   0.0157 | 0.014196 | 0.015996 | 0.037848 | 0.037848 | 0.037848 |  0.34462 | 0.715344 | 0.053844 | 1.113807 |  4.640864 | 0.0 |  88.862806 | 25.572688 |  -9.371639 |  4.640864 |
    | 08.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.0 | 0.119752 | 0.119752 | 0.015581 | 0.014023 | 0.001558 | 0.015581 | 0.014129 | 0.002331 | 0.034298 | 0.034298 | 0.034298 | 0.325503 | 0.626646 | 0.036629 | 0.988777 |  4.119906 | 0.0 |  88.727474 |  25.28996 |  -9.958335 |  4.119906 |
    | 09.01. |  0.1 | 0.2 | 0.1 |  0.0 |       0.0 | 0.1 | 0.059821 | 0.159821 | 0.015515 | 0.013963 | 0.001551 | 0.015515 | 0.014039 | 0.001566 | 0.030932 | 0.030932 | 0.030932 | 0.308148 | 0.557678 | 0.032498 | 0.898325 |   3.74302 | 0.0 |  88.652138 | 25.021167 | -10.479466 |   3.74302 |
    | 10.01. |  0.2 | 0.3 | 0.1 |  0.0 |       0.0 | 0.2 | 0.059781 | 0.259781 | 0.015449 | 0.013904 | 0.001545 | 0.015449 | 0.013969 | 0.001557 | 0.027733 | 0.027733 | 0.027733 | 0.292324 | 0.502456 |  0.02929 |  0.82407 |  3.433627 | 0.0 |  88.576908 | 24.764957 | -10.948602 |  3.433627 |
    | 11.01. |  2.9 | 0.3 | 0.0 |  2.6 |  2.243524 | 0.3 |      0.0 |      0.3 | 0.373966 |  0.33657 | 0.037397 | 0.017491 | 0.057958 | 0.003997 | 0.024683 | 0.024683 | 0.024683 | 0.279286 | 0.458816 |  0.02868 | 0.766782 |  3.194925 | 0.0 |  90.802941 | 24.545129 | -11.359551 |  3.194925 |
    | 12.01. |  0.2 | 0.2 | 0.0 |  0.0 |       0.0 | 0.2 |      0.0 |      0.2 | 0.017474 | 0.015727 | 0.001747 | 0.017474 | 0.219241 | 0.012954 | 0.022067 | 0.022067 | 0.022067 |  0.27244 | 0.427782 |  0.03502 | 0.735243 |  3.063511 | 0.0 |  90.785467 | 24.426301 |  -11.67757 |  3.063511 |
    | 13.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.0 | 0.121749 | 0.121749 | 0.017341 | 0.015607 | 0.001734 | 0.017341 | 0.088832 | 0.017588 | 0.020652 | 0.020652 | 0.020652 | 0.261894 | 0.396953 |  0.03824 | 0.697087 |  2.904529 | 0.0 |  90.646377 | 24.238358 | -12.018337 |  2.904529 |
    | 14.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.0 | 0.121606 | 0.121606 | 0.017208 | 0.015487 | 0.001721 | 0.017208 | 0.015618 | 0.007446 | 0.018415 | 0.018415 | 0.018415 | 0.249868 | 0.368208 | 0.025861 | 0.643937 |  2.683072 | 0.0 |  90.507563 | 24.016277 | -12.361883 |  2.683072 |
    | 15.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.0 | 0.121462 | 0.121462 | 0.017077 | 0.015369 | 0.001708 | 0.017077 | 0.015498 | 0.002036 | 0.015772 | 0.015772 | 0.015772 | 0.238729 |  0.34328 | 0.017808 | 0.599816 |  2.499235 | 0.0 |  90.369024 | 23.802619 | -12.683192 |  2.499235 |
    | 16.01. |  3.3 | 0.3 | 0.0 |  3.0 |  2.570541 | 0.3 |      0.0 |      0.3 | 0.449087 | 0.404178 | 0.044909 | 0.019628 | 0.068464 | 0.004666 | 0.013229 | 0.013229 | 0.013229 | 0.229883 | 0.322829 | 0.017895 | 0.570607 |  2.377529 | 0.0 |  92.919937 | 23.627043 | -12.965406 |  2.377529 |
    | 17.01. |  4.6 | 0.3 | 0.0 |  4.3 |  3.642215 | 0.3 |      0.0 |      0.3 | 0.681547 | 0.613392 | 0.068155 | 0.023761 | 0.344122 | 0.019974 | 0.011139 | 0.011139 | 0.011139 | 0.229304 | 0.311607 | 0.031113 | 0.572024 |  2.383433 | 0.0 |  96.538391 | 23.615352 | -13.128225 |  2.383433 |
    | 18.01. |  0.8 | 0.2 | 0.0 |  0.6 |  0.504222 | 0.2 |      0.0 |      0.2 | 0.120136 | 0.108123 | 0.012014 | 0.024358 | 0.496748 | 0.042766 |    0.011 |    0.011 |    0.011 | 0.233089 | 0.305212 | 0.053766 | 0.592068 |   2.46695 | 0.0 |  97.018254 | 23.691311 | -13.223739 |   2.46695 |
    | 19.01. |  1.8 | 0.2 | 0.0 |  1.6 |  1.339826 | 0.2 |      0.0 |      0.2 | 0.286227 | 0.257605 | 0.028623 | 0.026054 | 0.243678 | 0.043325 | 0.011904 | 0.011904 | 0.011904 | 0.229529 | 0.293279 | 0.055229 | 0.578036 |  2.408485 | 0.0 |  98.332027 | 23.619893 | -13.407642 |  2.408485 |
    | 20.01. |  1.1 | 0.3 | 0.0 |  0.8 |    0.6673 | 0.3 |      0.0 |      0.3 | 0.159614 | 0.143653 | 0.015961 | 0.026914 | 0.207984 |  0.02683 | 0.011054 | 0.011054 | 0.011054 |  0.22514 | 0.281615 | 0.037884 | 0.544638 |  2.269325 | 0.0 |  98.972413 | 23.530598 |  -13.59501 |  2.269325 |
    | 21.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.0 | 0.129972 | 0.129972 | 0.026701 | 0.024031 |  0.00267 | 0.026701 | 0.153296 | 0.020508 | 0.009991 | 0.009991 | 0.009991 | 0.219469 | 0.269779 | 0.030499 | 0.519747 |  2.165614 | 0.0 |   98.81574 | 23.413097 |  -13.79348 |  2.165614 |
    | 22.01. |  5.0 | 0.2 | 0.0 |  4.8 |  3.968784 | 0.2 |      0.0 |      0.2 |  0.86368 | 0.777312 | 0.086368 | 0.032464 | 0.154107 | 0.018535 | 0.008592 | 0.008592 | 0.008592 | 0.214124 | 0.258997 | 0.027128 | 0.500249 |   2.08437 | 0.0 |  102.75206 |  23.30003 | -13.982241 |   2.08437 |
    | 23.01. | 13.1 | 0.3 | 0.0 | 12.8 | 10.257869 | 0.3 |      0.0 |      0.3 | 2.594273 | 2.334846 | 0.259427 | 0.052142 | 0.818221 | 0.049142 | 0.007247 | 0.007247 | 0.007247 | 0.227121 | 0.263029 | 0.056388 | 0.546538 |  2.277243 | 0.0 | 112.957787 | 23.571088 | -13.910735 |  2.277243 |
    | 24.01. | 14.6 | 0.6 | 0.0 | 14.0 |  10.65723 | 0.6 |      0.0 |      0.6 |  3.42438 | 3.081942 | 0.342438 |  0.08161 | 2.081847 | 0.144841 | 0.010473 | 0.010473 | 0.010473 |  0.27963 | 0.296091 | 0.155314 | 0.731036 |  3.045983 | 0.0 | 123.533407 | 24.551039 | -13.363614 |  3.045983 |
    | 25.01. |  4.0 | 0.4 | 0.0 |  3.6 |   2.64368 | 0.4 |      0.0 |      0.4 | 1.046732 | 0.942059 | 0.104673 | 0.090413 | 2.619606 | 0.245346 | 0.022137 | 0.022137 | 0.022137 | 0.359602 | 0.346515 | 0.267483 | 0.973601 |  4.056669 | 0.0 | 126.086674 | 25.785338 |  -12.64015 |  4.056669 |
    | 26.01. |  0.8 | 0.4 | 0.0 |  0.4 |  0.291395 | 0.4 |      0.0 |      0.4 | 0.199739 | 0.179765 | 0.019974 | 0.091134 | 1.325703 | 0.229388 | 0.036829 | 0.036829 | 0.036829 | 0.392315 | 0.362345 | 0.266217 | 1.020877 |  4.253652 | 0.0 | 126.286936 | 26.225274 | -12.435385 |  4.253652 |
    | 27.01. |  0.1 | 0.4 | 0.3 |  0.0 |       0.0 | 0.1 | 0.231115 | 0.331115 |  0.08998 | 0.080982 | 0.008998 |  0.08998 | 0.340012 | 0.110611 | 0.042065 | 0.042065 | 0.042065 | 0.381958 | 0.349075 | 0.152676 | 0.883709 |   3.68212 | 0.0 | 125.965841 | 26.089388 | -12.606389 |   3.68212 |
    | 28.01. |  3.3 | 0.5 | 0.0 |  2.8 |  2.030679 | 0.5 |      0.0 |      0.5 | 0.866432 | 0.779789 | 0.086643 | 0.097112 | 0.198874 | 0.037356 | 0.040448 | 0.040448 | 0.040448 | 0.366627 | 0.333231 | 0.077803 | 0.777661 |  3.240256 | 0.0 | 127.899409 | 25.882533 | -12.819623 |  3.240256 |
    | 29.01. |  7.7 | 0.4 | 0.0 |  7.3 |  5.181272 | 0.4 |      0.0 |      0.4 | 2.236684 | 2.013015 | 0.223668 | 0.117955 | 0.788849 |   0.0509 | 0.037986 | 0.037986 | 0.037986 | 0.376554 | 0.334606 | 0.088886 | 0.800046 |  3.333525 | 0.0 | 132.962726 | 26.017274 | -12.800704 |  3.333525 |
    | 30.01. | 10.3 | 0.3 | 0.0 | 10.0 |  6.829043 | 0.3 |      0.0 |      0.3 | 3.321736 | 2.989562 | 0.332174 | 0.150779 | 1.865245 | 0.133947 | 0.039589 | 0.039589 | 0.039589 | 0.433868 | 0.366623 | 0.173536 | 0.974026 |  4.058443 | 0.0 |  139.64099 | 26.742143 | -12.381639 |  4.058443 |
    | 31.01. |  3.7 | 0.3 | 0.0 |  3.4 |  2.251963 | 0.3 |      0.0 |      0.3 | 1.310467 |  1.17942 | 0.131047 | 0.162429 | 2.519939 | 0.228058 | 0.048217 | 0.048217 | 0.048217 | 0.527892 | 0.421325 | 0.276276 | 1.225492 |  5.106219 | 0.0 | 141.730523 | 27.774432 | -11.746771 |  5.106219 |
    | 01.02. | 15.3 | 0.5 | 0.0 | 14.8 |  9.387156 | 0.5 |      0.0 |      0.5 | 5.635217 | 5.071695 | 0.563522 | 0.222373 |  2.12321 | 0.264571 | 0.060504 | 0.060504 | 0.060504 | 0.604234 | 0.464711 | 0.325076 |  1.39402 |  5.808418 | 0.0 | 150.895307 | 28.504628 | -11.301694 |  5.808418 |
    | 02.02. |  3.2 | 0.5 | 0.0 |  2.7 |  1.641019 | 0.5 |      0.0 |      0.5 | 1.291956 | 1.162761 | 0.129196 | 0.232976 | 3.651104 |  0.30135 | 0.069196 | 0.069196 | 0.069196 | 0.786878 | 0.574469 | 0.370546 | 1.731893 |  7.216219 | 0.0 |  152.30335 | 29.977608 | -10.346525 |  7.216219 |
    | 03.02. |  2.7 | 0.3 | 0.0 |  2.4 |  1.442382 | 0.3 |      0.0 |      0.3 | 1.199948 | 1.079953 | 0.119995 |  0.24233 | 2.042321 | 0.324015 | 0.086728 | 0.086728 | 0.086728 | 0.852663 | 0.613069 | 0.410743 | 1.876475 |  7.818645 | 0.0 | 153.503402 | 30.437067 | -10.055937 |  7.818645 |
    | 04.02. |  2.2 | 0.3 | 0.0 |  1.9 |  1.131508 | 0.3 |      0.0 |      0.3 | 1.017888 | 0.916099 | 0.101789 | 0.249396 | 1.076461 |  0.19394 | 0.092197 | 0.092197 | 0.092197 | 0.837973 | 0.602246 | 0.286137 | 1.726357 |  7.193152 | 0.0 | 154.385514 | 30.337168 | -10.135402 |  7.193152 |
    | 05.02. |  8.0 | 0.4 | 0.0 |  7.6 |  4.423556 | 0.4 |      0.0 |      0.4 | 3.461238 | 3.115115 | 0.346124 | 0.284794 | 1.253583 | 0.134913 | 0.091008 | 0.091008 | 0.091008 | 0.838634 | 0.601082 | 0.225921 | 1.665637 |  6.940152 | 0.0 | 158.524276 | 30.341692 | -10.144042 |  6.940152 |
    | 06.02. | 14.3 | 0.4 | 0.0 | 13.9 |  7.652417 | 0.4 |      0.0 |      0.4 | 6.604543 | 5.944088 | 0.660454 |  0.35696 | 3.000072 | 0.220714 | 0.091062 | 0.091062 | 0.091062 | 0.980952 | 0.688381 | 0.311776 | 1.981109 |  8.254621 | 0.0 | 165.819733 | 31.251844 |  -9.541333 |  8.254621 |
    | 07.02. |  6.3 | 0.3 | 0.0 |  6.0 |  3.135145 | 0.3 |      0.0 |      0.3 | 3.252526 | 2.927273 | 0.325253 |  0.38767 | 4.887592 | 0.403547 | 0.101895 | 0.101895 | 0.101895 | 1.308894 | 0.897271 | 0.505442 | 2.711606 |  11.29836 | 0.0 | 168.567207 | 32.977402 |  -8.381671 |  11.29836 |
    | 08.02. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.0 | 0.181449 | 0.181449 | 0.381214 | 0.343093 | 0.038121 | 0.381214 | 3.262107 | 0.456355 | 0.122434 | 0.122434 | 0.122434 | 1.450416 | 0.992647 | 0.578789 | 3.021852 | 12.591049 | 0.0 | 168.004543 | 33.606684 |  -7.947041 | 12.591049 |
    | 09.02. |  5.9 | 0.1 | 0.0 |  5.8 |  2.960832 | 0.1 |      0.0 |      0.1 | 3.250345 | 2.925311 | 0.325035 | 0.411178 | 1.284482 | 0.287821 | 0.129924 | 0.129924 | 0.129924 | 1.348402 |  0.92888 | 0.417745 | 2.695027 | 11.229281 | 0.0 | 170.554198 | 33.158896 |  -8.232204 | 11.229281 |
    | 10.02. |  9.2 | 0.1 | 0.0 |  9.1 |  4.469321 | 0.1 |      0.0 |      0.1 | 5.092757 | 4.583481 | 0.509276 | 0.462077 | 2.563133 | 0.212749 | 0.124594 | 0.124594 | 0.124594 |  1.40602 | 0.968817 | 0.337344 | 2.712181 | 11.300756 | 0.0 | 174.561441 |  33.41535 |  -8.051174 | 11.300756 |
    | 11.02. |  6.1 | 0.0 | 0.0 |  6.1 |  2.879951 | 0.0 |      0.0 |      0.0 | 3.714754 | 3.343278 | 0.371475 | 0.494705 | 4.036303 | 0.340832 | 0.127647 | 0.127647 | 0.127647 | 1.630772 | 1.121029 | 0.468479 |  3.22028 | 13.417833 | 0.0 | 176.946688 | 34.334006 |  -7.430034 | 13.417833 |
    | 12.02. |  0.1 | 0.1 | 0.0 |  0.0 |       0.0 | 0.1 |      0.0 |      0.1 | 0.487884 | 0.439096 | 0.048788 | 0.487884 | 3.229538 | 0.400529 | 0.138581 | 0.138581 | 0.138581 | 1.724893 | 1.187645 | 0.539111 | 3.451648 | 14.381867 | 0.0 | 176.458803 | 34.685418 |  -7.187283 | 14.381867 |
    | 13.02. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.0 | 0.092613 | 0.092613 | 0.479977 | 0.431979 | 0.047998 | 0.479977 |      1.1 | 0.268509 | 0.142764 | 0.142764 | 0.142764 | 1.534191 | 1.060512 | 0.411273 | 3.005976 | 12.524902 | 0.0 | 175.886214 | 33.953991 |  -7.665031 | 12.524902 |
    | 14.02. |  2.8 | 0.0 | 0.0 |  2.8 |  1.312983 | 0.0 |      0.0 |      0.0 | 1.978373 | 1.780536 | 0.197837 | 0.491356 | 0.617664 | 0.114306 | 0.134058 | 0.134058 | 0.134058 | 1.339632 | 0.932329 | 0.248364 | 2.520325 | 10.501355 | 0.0 |  176.70784 | 33.119016 |  -8.216236 | 10.501355 |
    | 15.02. | 10.6 | 0.2 | 0.0 | 10.4 |  4.716023 | 0.2 |      0.0 |      0.2 | 6.236389 |  5.61275 | 0.623639 | 0.552412 | 1.996247 | 0.137799 |  0.12412 |  0.12412 |  0.12412 |  1.33644 | 0.930603 | 0.261919 | 2.528961 | 10.537339 | 0.0 | 180.871451 | 33.104444 |   -8.22422 | 10.537339 |
    | 16.02. |  8.8 | 0.9 | 0.0 |  7.9 |  3.412051 | 0.9 |      0.0 |      0.9 | 5.084999 | 4.576499 |   0.5085 |  0.59705 | 4.597936 | 0.329098 | 0.123946 | 0.123946 | 0.123946 |  1.63541 | 1.131123 | 0.453044 | 3.219577 | 13.414904 | 0.0 | 183.686452 | 34.351742 |  -7.392223 | 13.414904 |
    | 17.02. |  7.2 | 0.9 | 0.0 |  6.3 |  2.625687 | 0.9 |      0.0 |      0.9 | 4.304729 | 3.874256 | 0.430473 | 0.630416 | 4.716817 | 0.500776 | 0.138793 | 0.138793 | 0.138793 |    1.929 | 1.334853 | 0.639568 | 3.903421 | 16.264254 | 0.0 | 185.681723 | 35.391625 |  -6.701556 | 16.264254 |
    | 18.02. |  4.9 | 0.5 | 0.0 |  4.4 |  1.790017 | 0.5 |      0.0 |      0.5 | 3.260126 | 2.934113 | 0.326013 | 0.650142 | 3.905982 | 0.487018 |  0.15117 |  0.15117 |  0.15117 | 2.064025 | 1.430302 | 0.638188 | 4.132514 |  17.21881 | 0.0 | 186.821597 | 35.822359 |  -6.418295 |  17.21881 |
    | 19.02. |  1.8 | 0.9 | 0.0 |  0.9 |  0.363722 | 0.9 |      0.0 |      0.9 | 1.181503 | 1.063353 |  0.11815 | 0.645225 | 2.893038 | 0.390105 | 0.156297 | 0.156297 | 0.156297 | 2.022325 | 1.400259 | 0.546402 | 3.968987 | 16.537444 | 0.0 | 186.540094 | 35.692154 |  -6.505042 | 16.537444 |

There is no indication of an error in the water balance:

>>> from hydpy import round_
>>> round_(model.check_waterbalance(conditions))
0.0

.. _gland_gr6_ex2:

Example 2
_____________

In the third we start from empty storages and use a negative groundwater exchange coefficient X2.
Again we reproduce the results from the airGR package running
the following code:

Set negative control parameters X2:

>>> x2(-0.637)

>>> test.inits = ((states.s, 0.0),
...               (states.r, 0.0),
...               (states.i, 0.0),
...               (states.r2, 0),
...               (logs.quh1, [0.0, 0.0, 0.0]),
...               (logs.quh2, [0.0, 0.0, 0.0, 0.0, 0.0]))

Run Integration test

.. integration-test::

    >>> conditions = test("gland_gr6_ex2", get_conditions="1990-01-01")
    |   date |    p |   e |  en |   pn |        ps |  ei |       es |       ae |       pr |      pr9 |      pr1 |     perc |       q9 |       q1 |        fd |        fr |       fr2 |       qr |      qr2 |       qd |       qh |        qv |   i |          s |         r |         r2 |    outlet |
    --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 01.01. |  0.0 | 0.3 | 0.3 |  0.0 |       0.0 | 0.0 |      0.0 |      0.0 |      0.0 |      0.0 |      0.0 |      0.0 |      0.0 |      0.0 |  0.270088 |  0.270088 |  0.270088 |      0.0 | 3.435647 | 0.270088 | 3.705735 | 15.440563 | 0.0 |        0.0 |  0.270088 |  -3.165559 | 15.440563 |
    | 02.01. |  9.3 | 0.4 | 0.0 |  8.9 |  8.895998 | 0.4 |      0.0 |      0.4 | 0.004002 | 0.003602 |   0.0004 |      0.0 | 0.000492 | 0.000027 |  0.266873 |  0.266873 |  0.266873 |      0.0 | 2.066781 | 0.266901 | 2.333682 |  9.723674 | 0.0 |   8.895998 |  0.537256 |  -4.965271 |  9.723674 |
    | 03.01. |  3.2 | 0.4 | 0.0 |  2.8 |  2.794914 | 0.4 |      0.0 |      0.4 | 0.005087 | 0.004578 | 0.000509 | 0.000001 | 0.002914 | 0.000162 |  0.263693 |  0.263693 |  0.263693 |      0.0 |  1.50664 | 0.263855 | 1.770495 |  7.377064 | 0.0 |  11.690911 |  0.802698 |  -6.207052 |  7.377064 |
    | 04.01. |  7.3 | 0.3 | 0.0 |  7.0 |  6.972036 | 0.3 |      0.0 |      0.3 | 0.027971 | 0.025174 | 0.002797 | 0.000006 | 0.007167 | 0.000531 |  0.260534 |  0.260534 |  0.260534 |      0.0 | 1.200066 | 0.261064 | 1.461131 |  6.088045 | 0.0 |   18.66294 |  1.067532 |  -7.143718 |  6.088045 |
    | 05.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.0 | 0.014808 | 0.014808 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.017045 |  0.00118 |  0.257381 |  0.257381 |  0.257381 |      0.0 | 1.006834 | 0.258561 | 1.265395 |  5.272478 | 0.0 |  18.648126 |   1.33514 |  -7.886352 |  5.272478 |
    | 06.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.0 | 0.014797 | 0.014797 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.005742 | 0.001331 |  0.254196 |  0.254196 |  0.254196 |      0.0 |  0.87259 | 0.255527 | 1.128117 |  4.700489 | 0.0 |  18.633322 |   1.59278 |   -8.50245 |  4.700489 |
    | 07.01. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.0 | 0.014786 | 0.014786 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.000006 | 0.000453 |   0.25113 |   0.25113 |   0.25113 | 0.000001 | 0.773975 | 0.251582 | 1.025558 |  4.273158 | 0.0 |   18.61853 |  1.843913 |  -9.025293 |  4.273158 |
    | 08.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.0 | 0.029538 | 0.029538 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.000006 | 0.000025 |   0.24814 |   0.24814 |   0.24814 | 0.000001 |  0.69866 | 0.248165 | 0.946826 |  3.945109 | 0.0 |  18.588986 |  2.092055 |   -9.47581 |  3.945109 |
    | 09.01. |  0.1 | 0.2 | 0.1 |  0.0 |       0.0 | 0.1 | 0.014752 | 0.114752 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.000006 | 0.000001 |  0.245187 |  0.245187 |  0.245187 | 0.000002 | 0.639232 | 0.245187 | 0.884421 |  3.685089 | 0.0 |  18.574227 |  2.337243 |  -9.869853 |  3.685089 |
    | 10.01. |  0.2 | 0.3 | 0.1 |  0.0 |       0.0 | 0.2 | 0.014741 | 0.214741 | 0.000006 | 0.000006 | 0.000001 | 0.000006 | 0.000006 | 0.000001 |  0.242268 |  0.242268 |  0.242268 | 0.000003 |  0.59112 | 0.242269 | 0.833392 |  3.472467 | 0.0 |   18.55948 |  2.579512 | -10.218702 |  3.472467 |
    | 11.01. |  2.9 | 0.3 | 0.0 |  2.6 |  2.582518 | 0.3 |      0.0 |      0.3 | 0.017494 | 0.015745 | 0.001749 | 0.000012 | 0.002154 |  0.00012 |  0.239385 |  0.239385 |  0.239385 | 0.000005 | 0.551445 | 0.239505 | 0.790955 |  3.295645 | 0.0 |  21.141986 |  2.820183 | -10.529901 |  3.295645 |
    | 12.01. |  0.2 | 0.2 | 0.0 |  0.0 |       0.0 | 0.2 |      0.0 |      0.2 | 0.000012 | 0.000011 | 0.000001 | 0.000012 |  0.01001 | 0.000556 |   0.23652 |   0.23652 |   0.23652 | 0.000008 | 0.518399 | 0.237076 | 0.755484 |  3.147849 | 0.0 |  21.141974 |  3.062701 | -10.807776 |  3.147849 |
    | 13.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.0 |  0.03336 |  0.03336 | 0.000012 | 0.000011 | 0.000001 | 0.000012 | 0.003597 |  0.00078 |  0.233633 |  0.233633 |  0.233633 | 0.000012 | 0.489926 | 0.234413 | 0.724351 |   3.01813 | 0.0 |  21.108602 |  3.298481 |  -11.06263 |   3.01813 |
    | 14.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.0 |  0.03331 |  0.03331 | 0.000012 | 0.000011 | 0.000001 | 0.000012 | 0.000011 | 0.000281 |  0.230827 |  0.230827 |  0.230827 | 0.000017 | 0.465194 | 0.231108 | 0.696318 |  2.901326 | 0.0 |   21.07528 |  3.529297 | -11.296992 |  2.901326 |
    | 15.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.0 | 0.033259 | 0.033259 | 0.000012 | 0.000011 | 0.000001 | 0.000012 | 0.000011 | 0.000016 |   0.22808 |   0.22808 |   0.22808 | 0.000023 | 0.443605 | 0.228096 | 0.671724 |  2.798848 | 0.0 |  21.042009 |  3.757361 | -11.512513 |  2.798848 |
    | 16.01. |  3.3 | 0.3 | 0.0 |  3.0 |  2.974016 | 0.3 |      0.0 |      0.3 | 0.026007 | 0.023406 | 0.002601 | 0.000023 | 0.003204 | 0.000179 |  0.225365 |  0.225365 |  0.225365 | 0.000031 | 0.424691 | 0.225544 | 0.650266 |   2.70944 | 0.0 |  24.016003 |  3.984617 | -11.710558 |   2.70944 |
    | 17.01. |  4.6 | 0.3 | 0.0 |  4.3 |  4.249817 | 0.3 |      0.0 |      0.3 | 0.050234 | 0.045211 | 0.005023 | 0.000051 |  0.02105 |  0.00117 |   0.22266 |   0.22266 |   0.22266 | 0.000041 | 0.408466 |  0.22383 | 0.632337 |  2.634738 | 0.0 |  28.265768 |  4.219867 | -11.887944 |  2.634738 |
    | 18.01. |  0.8 | 0.2 | 0.0 |  0.6 |   0.59166 | 0.2 |      0.0 |      0.2 | 0.008397 | 0.007557 |  0.00084 | 0.000057 | 0.035102 | 0.002812 |   0.21986 |   0.21986 |   0.21986 | 0.000054 | 0.394347 | 0.222672 | 0.617073 |  2.571138 | 0.0 |  28.857372 |  4.460734 | -12.048391 |  2.571138 |
    | 19.01. |  1.8 | 0.2 | 0.0 |  1.6 |  1.576034 | 0.2 |      0.0 |      0.2 |  0.02404 | 0.021636 | 0.002404 | 0.000074 |  0.01806 | 0.003084 |  0.216993 |  0.216993 |  0.216993 | 0.000069 | 0.381038 | 0.220077 | 0.601185 |  2.504936 | 0.0 |  30.433332 |  4.688494 | -12.205212 |  2.504936 |
    | 20.01. |  1.1 | 0.3 | 0.0 |  0.8 |  0.787045 | 0.3 |      0.0 |      0.3 | 0.013039 | 0.011735 | 0.001304 | 0.000084 | 0.017076 | 0.002053 |  0.214282 |  0.214282 |  0.214282 | 0.000087 | 0.368922 | 0.216335 | 0.585344 |  2.438935 | 0.0 |  31.220293 |  4.912934 | -12.353022 |  2.438935 |
    | 21.01. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.0 | 0.048193 | 0.048193 | 0.000083 | 0.000075 | 0.000008 | 0.000083 |   0.0124 | 0.001663 |  0.211611 |  0.211611 |  0.211611 | 0.000108 | 0.357724 | 0.213273 | 0.571106 |   2.37961 | 0.0 |  31.172017 |  5.131876 | -12.494176 |   2.37961 |
    | 22.01. |  5.0 | 0.2 | 0.0 |  4.8 |  4.707908 | 0.2 |      0.0 |      0.2 |  0.09226 | 0.083034 | 0.009226 | 0.000168 | 0.014055 | 0.001605 |  0.209005 |  0.209005 |  0.209005 | 0.000133 | 0.347506 | 0.210609 | 0.558249 |  2.326036 | 0.0 |  35.879757 |   5.34918 | -12.627055 |  2.326036 |
    | 23.01. | 13.1 | 0.3 | 0.0 | 12.8 | 12.410562 | 0.3 |      0.0 |      0.3 | 0.390182 | 0.351163 | 0.039018 | 0.000744 | 0.100724 | 0.005828 |  0.206418 |  0.206418 |  0.206418 |  0.00017 | 0.340477 | 0.212246 | 0.552893 |  2.303722 | 0.0 |  48.289576 |  5.615862 | -12.720824 |  2.303722 |
    | 24.01. | 14.6 | 0.6 | 0.0 | 14.0 | 13.276027 | 0.6 |      0.0 |      0.6 | 0.726478 |  0.65383 | 0.072648 | 0.002505 | 0.331366 | 0.021479 |  0.203244 |  0.203244 |  0.203244 | 0.000241 | 0.340154 | 0.224723 | 0.565117 |  2.354653 | 0.0 |  61.563098 |  6.017685 | -12.725188 |  2.354653 |
    | 25.01. |  4.0 | 0.4 | 0.0 |  3.6 |  3.354602 | 0.4 |      0.0 |      0.4 | 0.248663 | 0.223796 | 0.024866 | 0.003265 | 0.526156 | 0.043637 |  0.198461 |  0.198461 |  0.198461 | 0.000362 |  0.34493 | 0.242098 |  0.58739 |  2.447457 | 0.0 |  64.914435 |  6.531478 | -12.661194 |  2.447457 |
    | 26.01. |  0.8 | 0.4 | 0.0 |  0.4 |  0.371115 | 0.4 |      0.0 |      0.4 | 0.032243 | 0.029019 | 0.003224 | 0.003358 | 0.295218 | 0.046798 |  0.192345 |  0.192345 |  0.192345 | 0.000477 | 0.342526 | 0.239144 | 0.582147 |  2.425611 | 0.0 |  65.282192 |  6.900477 | -12.693287 |  2.425611 |
    | 27.01. |  0.1 | 0.4 | 0.3 |  0.0 |       0.0 | 0.1 | 0.139773 | 0.239773 | 0.003322 |  0.00299 | 0.000332 | 0.003322 | 0.069857 | 0.024084 |  0.187953 |  0.187953 |  0.187953 | 0.000562 |  0.33384 | 0.212037 | 0.546439 |  2.276827 | 0.0 |  65.139097 |  7.129783 | -12.811231 |  2.276827 |
    | 28.01. |  3.3 | 0.5 | 0.0 |  2.8 |  2.589401 | 0.5 |      0.0 |      0.5 | 0.214635 | 0.193171 | 0.021463 | 0.004035 | 0.034879 | 0.007609 |  0.185224 |  0.185224 |  0.185224 | 0.000647 | 0.324836 | 0.192833 | 0.518317 |  2.159652 | 0.0 |  67.724462 |  7.335287 | -12.936892 |  2.159652 |
    | 29.01. |  7.7 | 0.4 | 0.0 |  7.3 |  6.671275 | 0.4 |      0.0 |      0.4 | 0.635178 |  0.57166 | 0.063518 | 0.006453 | 0.201487 | 0.012033 |  0.182778 |  0.182778 |  0.182778 | 0.000793 | 0.320805 | 0.194811 | 0.516409 |  2.151703 | 0.0 |  74.389285 |  7.638164 | -12.994324 |  2.151703 |
    | 30.01. | 10.3 | 0.3 | 0.0 | 10.0 |  8.938718 | 0.3 |      0.0 |      0.3 | 1.072656 | 0.965391 | 0.107266 | 0.011374 | 0.539141 | 0.037145 |  0.179173 |  0.179173 |  0.179173 | 0.001089 | 0.325666 | 0.216318 | 0.543074 |  2.262806 | 0.0 |  83.316628 |  8.139732 | -12.925162 |  2.262806 |
    | 31.01. |  3.7 | 0.3 | 0.0 |  3.4 |  2.983253 | 0.3 |      0.0 |      0.3 | 0.430298 | 0.387268 |  0.04303 | 0.013551 | 0.796751 |  0.06875 |  0.173203 |  0.173203 |  0.173203 | 0.001599 | 0.336843 | 0.241953 | 0.580395 |  2.418311 | 0.0 |   86.28633 |  8.789386 | -12.770101 |  2.418311 |
    | 01.02. | 15.3 | 0.5 | 0.0 | 14.8 | 12.631868 | 0.5 |      0.0 |      0.5 | 2.194936 | 1.975442 | 0.219494 | 0.026803 | 0.735792 | 0.086772 |   0.16547 |   0.16547 |   0.16547 | 0.002231 | 0.345346 | 0.252242 | 0.599819 |  2.499247 | 0.0 |  98.891394 |    9.3941 |  -12.65566 |  2.499247 |
    | 02.02. |  3.2 | 0.5 | 0.0 |  2.7 |  2.239805 | 0.5 |      0.0 |      0.5 | 0.490132 | 0.441119 | 0.049013 | 0.029937 | 1.404073 | 0.109977 |  0.158272 |  0.158272 |  0.158272 | 0.003695 | 0.372545 | 0.268249 | 0.644489 |  2.685372 | 0.0 | 101.101262 | 10.391121 | -12.308303 |  2.685372 |
    | 03.02. |  2.7 | 0.3 | 0.0 |  2.4 |  1.973779 | 0.3 |      0.0 |      0.3 | 0.459146 | 0.413231 | 0.045915 | 0.032925 | 0.786992 | 0.124261 |  0.146405 |  0.146405 |  0.146405 | 0.004925 | 0.379278 | 0.270665 | 0.654868 |  2.728618 | 0.0 | 103.042116 | 11.004796 |  -12.22638 |  2.728618 |
    | 04.02. |  2.2 | 0.3 | 0.0 |  1.9 |  1.551054 | 0.3 |      0.0 |      0.3 | 0.384367 |  0.34593 | 0.038437 |  0.03542 | 0.410401 | 0.074544 |  0.139101 |  0.139101 |  0.139101 | 0.005835 | 0.373498 | 0.213645 | 0.592978 |  2.470741 | 0.0 | 104.557749 | 11.384302 | -12.296617 |  2.470741 |
    | 05.02. |  8.0 | 0.4 | 0.0 |  7.6 |  6.099702 | 0.4 |      0.0 |      0.4 | 1.547238 | 1.392514 | 0.154724 |  0.04694 | 0.504115 | 0.052947 |  0.134583 |  0.134583 |  0.134583 | 0.007025 | 0.370695 |  0.18753 |  0.56525 |  2.355208 | 0.0 | 110.610511 | 11.814329 | -12.331082 |  2.355208 |
    | 06.02. | 14.3 | 0.4 | 0.0 | 13.9 | 10.709966 | 0.4 |      0.0 |      0.4 | 3.264355 | 2.937919 | 0.326435 | 0.074321 | 1.364923 | 0.096335 |  0.129465 |  0.129465 |  0.129465 |   0.0103 |  0.39422 |   0.2258 | 0.630319 |   2.62633 | 0.0 | 121.246157 | 12.752449 | -12.049868 |   2.62633 |
    | 07.02. |  6.3 | 0.3 | 0.0 |  6.0 |  4.441126 | 0.3 |      0.0 |      0.3 | 1.647547 | 1.482793 | 0.164755 | 0.088674 | 2.387107 | 0.190433 |  0.118299 |  0.118299 |  0.118299 | 0.018186 | 0.451882 | 0.308731 | 0.778799 |  3.244996 | 0.0 | 125.598609 | 14.284826 | -11.428608 |  3.244996 |
    | 08.02. |  0.0 | 0.2 | 0.2 |  0.0 |       0.0 | 0.0 | 0.153561 | 0.153561 | 0.087824 | 0.079041 | 0.008782 | 0.087824 | 1.622826 | 0.223422 |  0.100059 |  0.100059 |  0.100059 | 0.025935 | 0.479592 | 0.323481 | 0.829008 |    3.4542 | 0.0 | 125.357224 | 15.332645 |  -11.15901 |    3.4542 |
    | 09.02. |  5.9 | 0.1 | 0.0 |  5.8 |  4.194228 | 0.1 |      0.0 |      0.1 | 1.708917 | 1.538026 | 0.170892 | 0.103146 | 0.598097 | 0.141399 |  0.087587 |  0.087587 |  0.087587 | 0.029671 | 0.465158 | 0.228987 | 0.723816 |  3.015898 | 0.0 | 129.448307 | 15.749419 | -11.297342 |  3.015898 |
    | 10.02. |  9.2 | 0.1 | 0.0 |  9.1 |  6.370876 | 0.1 |      0.0 |      0.1 | 2.859701 | 2.573731 |  0.28597 | 0.130577 | 1.346879 | 0.106905 |  0.082626 |  0.082626 |  0.082626 | 0.038658 | 0.479923 | 0.189532 | 0.708112 |  2.950469 | 0.0 | 135.688607 | 16.601515 | -11.155887 |  2.950469 |
    | 11.02. |  6.1 | 0.0 | 0.0 |  6.1 |  4.127264 | 0.0 |      0.0 |      0.0 | 2.123645 | 1.911281 | 0.212365 | 0.150909 | 2.247272 | 0.184293 |  0.072484 |  0.072484 |  0.072484 | 0.057486 | 0.529331 | 0.256777 | 0.843594 |  3.514975 | 0.0 | 139.664961 | 17.964877 | -10.713825 |  3.514975 |
    | 12.02. |  0.1 | 0.1 | 0.0 |  0.0 |       0.0 | 0.1 |      0.0 |      0.1 | 0.150098 | 0.135088 |  0.01501 | 0.150098 | 1.819826 | 0.223291 |  0.056256 |  0.056256 |  0.056256 | 0.076955 |  0.55681 | 0.279548 | 0.913313 |  3.805471 | 0.0 | 139.514864 | 19.036074 | -10.486449 |  3.805471 |
    | 13.02. |  0.0 | 0.1 | 0.1 |  0.0 |       0.0 | 0.0 | 0.081999 | 0.081999 | 0.148857 | 0.133972 | 0.014886 | 0.148857 | 0.539738 | 0.147595 |  0.043506 |  0.043506 |  0.043506 |  0.08293 |  0.52487 | 0.191101 |   0.7989 |   3.32875 | 0.0 | 139.284007 | 19.320493 | -10.751918 |   3.32875 |
    | 14.02. |  2.8 | 0.0 | 0.0 |  2.8 |  1.861977 | 0.0 |      0.0 |      0.0 | 1.096231 | 0.986608 | 0.109623 | 0.158208 | 0.250601 | 0.055339 |  0.040121 |  0.040121 |  0.040121 | 0.085233 | 0.486139 |  0.09546 | 0.666832 |  2.778468 | 0.0 | 140.987776 | 19.425741 | -11.097696 |  2.778468 |
    | 15.02. | 10.6 | 0.2 | 0.0 | 10.4 |  6.705901 | 0.2 |      0.0 |      0.2 | 3.892459 | 3.503213 | 0.389246 |  0.19836 | 1.135776 | 0.072253 |  0.038868 |  0.038868 |  0.038868 |  0.09989 | 0.486823 | 0.111121 | 0.697834 |  2.907643 | 0.0 | 147.495316 | 20.046185 |  -11.09134 |  2.907643 |
    | 16.02. |  8.8 | 0.9 | 0.0 |  7.9 |  4.873118 | 0.9 |      0.0 |      0.9 | 3.258583 | 2.932724 | 0.325858 |   0.2317 | 2.851803 |  0.19727 |  0.031483 |  0.031483 |  0.031483 | 0.147151 | 0.557971 | 0.228753 | 0.933876 |  3.891149 | 0.0 | 152.136734 | 21.641599 | -10.477107 |  3.891149 |
    | 17.02. |  7.2 | 0.9 | 0.0 |  6.3 |  3.753261 | 0.9 |      0.0 |      0.9 | 2.806388 | 2.525749 | 0.280639 | 0.259648 | 3.007194 | 0.313723 |  0.012493 |  0.012493 |  0.012493 | 0.211643 | 0.635332 | 0.326216 | 1.173191 |  4.888297 | 0.0 | 155.630346 | 23.246766 |  -9.897069 |  4.888297 |
    | 18.02. |  4.9 | 0.5 | 0.0 |  4.4 |  2.554033 | 0.5 |      0.0 |      0.5 | 2.125224 | 1.912701 | 0.212522 | 0.279256 | 2.534826 | 0.312047 | -0.006613 | -0.006613 | -0.006613 | 0.275818 | 0.683442 | 0.305434 | 1.264694 |  5.269557 | 0.0 | 157.905122 | 24.485231 |  -9.573192 |  5.269557 |
    | 19.02. |  1.8 | 0.9 | 0.0 |  0.9 |  0.516379 | 0.9 |      0.0 |      0.9 |  0.66497 | 0.598473 | 0.066497 | 0.281348 |  1.87304 | 0.252546 | -0.021354 | -0.021354 | -0.021354 | 0.323787 | 0.689408 | 0.231192 | 1.244387 |  5.184944 | 0.0 | 158.140153 | 25.263915 |  -9.534738 |  5.184944 |

There is no indication of an error in the water balance:

>>> round_(model.check_waterbalance(conditions))
0.0

.. _gland_gr6_ex3:

Example 3
_____________

In the last example we repeat example 1 but activate the interception storage:

>>> x2(1.012)
>>> imax(10.0)

Set initial storage levels: production store 30% filled, routing store 50% filled.
log.sequences empty

>>> test.inits = ((states.s, 0.3 * x1),
...               (states.r, 0.5 * x3),
...               (states.i, 0.0),
...               (states.r2, 0),
...               (logs.quh1, [0.0, 0.0, 0.0]),
...               (logs.quh2, [0.0, 0.0, 0.0, 0.0, 0.0]))

The input data shows high precipitation and low evapotranspiration:

>>> inputs.p.series = (
...     0.0,  9.3,  3.2,  7.3,  0.0,  0.0,  0.0,  0.0,  0.1,  0.2,  2.9,  0.2,  0.0,  0.0,  0.0,
...     3.3,  4.6,  0.8,  1.8,  1.1,  0.0,  5.0, 13.1, 14.6,  4.0,  0.8,  0.1,  3.3,  7.7, 10.3,
...     3.7, 15.3,  3.2,  2.7,  2.2,  8.0, 14.3,  6.3,  0.0,  5.9,  9.2,  6.1,  0.1,  0.0,  2.8,
...     10.6,  8.8,  7.2,  4.9,  1.8)
>>> model.petmodel.sequences.inputs.referenceevapotranspiration.series = (
...     0.3, 0.4, 0.4, 0.3, 0.1, 0.1, 0.1, 0.2, 0.2, 0.3, 0.3, 0.2, 0.2, 0.2, 0.2, 0.3, 0.3, 0.2, 0.2,
...     0.3, 0.2, 0.2, 0.3, 0.6, 0.4, 0.4, 0.4, 0.5, 0.4, 0.3, 0.3, 0.5, 0.5, 0.3, 0.3, 0.4, 0.4, 0.3,
...     0.2, 0.1, 0.1, 0.0, 0.1, 0.1, 0.0, 0.2, 0.9, 0.9, 0.5, 0.9)

Run Integration test

.. integration-test::

    >>> conditions = test("gland_gr6_ex3", get_conditions="1990-01-01")
    |   date |    p |   e |  en |   pn |        ps |  ei |       es |       ae |       pr |      pr9 |      pr1 |     perc |       q9 |       q1 |       fd |       fr |      fr2 |       qr |      qr2 |       qd |       qh |        qv |    i |          s |         r |         r2 |    outlet |
    ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 01.01. |  0.0 | 0.3 | 0.3 |  0.0 |       0.0 | 0.0 | 0.152867 | 0.152867 | 0.005681 | 0.005113 | 0.000568 | 0.005681 | 0.000698 | 0.000039 | 0.076912 | 0.076912 | 0.076912 | 0.408172 |  3.33744 | 0.076951 | 3.822563 | 15.927344 |  0.0 |  72.518551 | 26.427658 |  -3.260248 | 15.927344 |
    | 02.01. |  9.3 | 0.4 | 0.0 |  0.0 |       0.0 | 0.4 |      0.0 |      0.4 | 0.005679 | 0.005111 | 0.000568 | 0.005679 | 0.003947 | 0.000219 | 0.070656 | 0.070656 | 0.070656 | 0.384018 | 1.966786 | 0.070875 |  2.42168 | 10.090333 |  8.9 |  72.512873 | 26.116664 |    -5.1548 | 10.090333 |
    | 03.01. |  3.2 | 0.4 | 0.0 |  1.7 |  1.544421 | 0.4 |      0.0 |      0.4 | 0.161886 | 0.145697 | 0.016189 | 0.006307 |   0.0243 | 0.001538 | 0.064775 | 0.064775 | 0.064775 | 0.363032 |  1.40651 | 0.066313 | 1.835856 |  7.649398 | 10.0 |  74.050986 | 25.832987 |  -6.486815 |  7.649398 |
    | 04.01. |  7.3 | 0.3 | 0.0 |  7.0 |  6.288662 | 0.3 |      0.0 |      0.3 | 0.720814 | 0.648733 | 0.072081 | 0.009476 | 0.182316 | 0.010408 | 0.059411 | 0.059411 | 0.059411 | 0.350122 | 1.111521 | 0.069818 | 1.531462 |  6.381093 | 10.0 |  80.330173 | 25.651665 |     -7.466 |  6.381093 |
    | 05.01. |  0.0 | 0.1 | 0.0 |  0.0 |       0.0 | 0.1 |      0.0 |      0.1 |  0.00947 | 0.008523 | 0.000947 |  0.00947 | 0.446707 | 0.030277 | 0.055982 | 0.055982 | 0.055982 | 0.348414 | 0.941725 | 0.086259 | 1.376398 |  5.734992 |  9.9 |  80.320702 | 25.627257 |   -8.17306 |  5.734992 |
    | 06.01. |  0.0 | 0.1 | 0.0 |  0.0 |       0.0 | 0.1 |      0.0 |      0.1 | 0.009465 | 0.008518 | 0.000946 | 0.009465 | 0.154429 | 0.035061 |  0.05552 |  0.05552 |  0.05552 | 0.335529 | 0.803844 | 0.090581 | 1.229954 |  5.124809 |  9.8 |  80.311237 | 25.439906 |  -8.859612 |  5.124809 |
    | 07.01. |  0.0 | 0.1 | 0.0 |  0.0 |       0.0 | 0.1 |      0.0 |      0.1 | 0.009459 | 0.008513 | 0.000946 | 0.009459 | 0.008519 | 0.012464 | 0.051978 | 0.051978 | 0.051978 | 0.318228 | 0.694972 | 0.064441 | 1.077642 |  4.490174 |  9.7 |  80.301778 | 25.178766 |  -9.499199 |  4.490174 |
    | 08.01. |  0.0 | 0.2 | 0.0 |  0.0 |       0.0 | 0.2 |      0.0 |      0.2 | 0.009454 | 0.008508 | 0.000945 | 0.009454 | 0.008514 | 0.001556 | 0.047039 | 0.047039 | 0.047039 | 0.302349 | 0.612358 | 0.048595 | 0.963302 |   4.01376 |  9.5 |  80.292324 | 24.928565 | -10.061112 |   4.01376 |
    | 09.01. |  0.1 | 0.2 | 0.0 |  0.0 |       0.0 | 0.2 |      0.0 |      0.2 | 0.009448 | 0.008503 | 0.000945 | 0.009448 | 0.008509 | 0.000946 | 0.042308 | 0.042308 | 0.042308 | 0.287719 | 0.547417 | 0.043254 |  0.87839 |  3.659957 |  9.4 |  80.282876 | 24.688259 | -10.562817 |  3.659957 |
    | 10.01. |  0.2 | 0.3 | 0.0 |  0.0 |       0.0 | 0.3 |      0.0 |      0.3 | 0.009443 | 0.008498 | 0.000944 | 0.009443 | 0.008504 | 0.000945 | 0.037764 | 0.037764 | 0.037764 | 0.274191 | 0.494945 | 0.038709 | 0.807845 |  3.366022 |  9.3 |  80.273434 | 24.456934 | -11.016596 |  3.366022 |
    | 11.01. |  2.9 | 0.3 | 0.0 |  1.9 |  1.686967 | 0.3 |      0.0 |      0.3 | 0.223504 | 0.201154 |  0.02235 | 0.010471 | 0.034795 | 0.002406 |  0.03339 |  0.03339 |  0.03339 | 0.262468 | 0.452556 | 0.035795 | 0.750819 |  3.128412 | 10.0 |  81.949929 | 24.248733 | -11.421845 |  3.128412 |
    | 12.01. |  0.2 | 0.2 | 0.0 |  0.0 |       0.0 | 0.2 |      0.0 |      0.2 | 0.010464 | 0.009418 | 0.001046 | 0.010464 | 0.131077 | 0.007754 | 0.029453 | 0.029453 | 0.029453 | 0.254474 | 0.420097 | 0.037207 | 0.711778 |  2.965742 | 10.0 |  81.939465 | 24.102357 | -11.760058 |  2.965742 |
    | 13.01. |  0.0 | 0.2 | 0.0 |  0.0 |       0.0 | 0.2 |      0.0 |      0.2 | 0.010458 | 0.009412 | 0.001046 | 0.010458 | 0.053114 | 0.010516 | 0.026685 | 0.026685 | 0.026685 | 0.244604 | 0.389754 | 0.037201 | 0.671559 |  2.798162 |  9.8 |  81.929007 | 23.916307 | -12.101882 |  2.798162 |
    | 14.01. |  0.0 | 0.2 | 0.0 |  0.0 |       0.0 | 0.2 |      0.0 |      0.2 | 0.010451 | 0.009406 | 0.001045 | 0.010451 | 0.009412 | 0.004455 | 0.023166 | 0.023166 | 0.023166 | 0.234081 | 0.362205 | 0.027622 | 0.623907 |  2.599614 |  9.6 |  81.918557 |  23.71104 | -12.437155 |  2.599614 |
    | 15.01. |  0.0 | 0.2 | 0.0 |  0.0 |       0.0 | 0.2 |      0.0 |      0.2 | 0.010444 |   0.0094 | 0.001044 | 0.010444 | 0.009406 | 0.001228 | 0.019285 | 0.019285 | 0.019285 | 0.224222 | 0.338154 | 0.020513 | 0.582889 |  2.428703 |  9.4 |  81.908112 | 23.511746 | -12.752261 |  2.428703 |
    | 16.01. |  3.3 | 0.3 | 0.0 |  2.4 |   2.11848 | 0.3 |      0.0 |      0.3 | 0.293379 | 0.264041 | 0.029338 | 0.011859 | 0.044157 | 0.002976 | 0.015516 | 0.015516 | 0.015516 |   0.2159 | 0.317849 | 0.018492 | 0.552241 |  2.301003 | 10.0 |  84.014734 | 23.337857 | -13.036931 |  2.301003 |
    | 17.01. |  4.6 | 0.3 | 0.0 |  4.3 |  3.759302 | 0.3 |      0.0 |      0.3 | 0.555446 | 0.499902 | 0.055545 | 0.014749 | 0.238199 | 0.013756 | 0.012228 | 0.012228 | 0.012228 |  0.21318 | 0.304536 | 0.025984 |   0.5437 |  2.265416 | 10.0 |  87.759287 | 23.279825 | -13.233959 |  2.265416 |
    | 18.01. |  0.8 | 0.2 | 0.0 |  0.6 |  0.520794 | 0.2 |      0.0 |      0.2 | 0.094385 | 0.084946 | 0.009438 | 0.015179 | 0.389511 | 0.031537 | 0.011131 | 0.011131 | 0.011131 | 0.214594 | 0.296121 | 0.042668 | 0.553383 |  2.305764 | 10.0 |  88.264902 | 23.310068 | -13.363146 |  2.305764 |
    | 19.01. |  1.8 | 0.2 | 0.0 |  1.6 |  1.384254 | 0.2 |      0.0 |      0.2 | 0.232138 | 0.208924 | 0.023214 | 0.016392 | 0.196438 | 0.034024 | 0.011703 | 0.011703 | 0.011703 | 0.210812 | 0.283953 | 0.045726 | 0.540491 |  2.252047 | 10.0 |  89.632765 | 23.228821 | -13.556821 |  2.252047 |
    | 20.01. |  1.1 | 0.3 | 0.0 |  0.8 |  0.689641 | 0.3 |      0.0 |      0.3 | 0.127376 | 0.114639 | 0.012738 | 0.017017 |   0.1678 | 0.021592 | 0.010166 | 0.010166 | 0.010166 | 0.206433 | 0.272224 | 0.031758 | 0.510415 |  2.126731 | 10.0 |  90.305388 | 23.133235 | -13.751758 |  2.126731 |
    | 21.01. |  0.0 | 0.2 | 0.0 |  0.0 |       0.0 | 0.2 |      0.0 |      0.2 | 0.017001 | 0.015301 |   0.0017 | 0.017001 | 0.122568 | 0.016488 | 0.008359 | 0.008359 | 0.008359 | 0.201077 | 0.260531 | 0.024847 | 0.486455 |  2.026897 |  9.8 |  90.288388 | 23.014057 | -13.954904 |  2.026897 |
    | 22.01. |  5.0 | 0.2 | 0.0 |  4.6 |  3.932743 | 0.2 |      0.0 |      0.2 | 0.688276 | 0.619448 | 0.068828 | 0.021019 | 0.120399 | 0.014706 | 0.006105 | 0.006105 | 0.006105 | 0.195906 | 0.249765 | 0.020811 | 0.466483 |  1.943678 | 10.0 |  94.200112 | 22.896495 | -14.150404 |  1.943678 |
    | 23.01. | 13.1 | 0.3 | 0.0 | 12.8 | 10.636229 | 0.3 |      0.0 |      0.3 | 2.199605 | 1.979645 | 0.219961 | 0.035834 | 0.667411 |  0.03988 | 0.003882 | 0.003882 | 0.003882 | 0.204751 | 0.250845 | 0.043761 | 0.499357 |  2.080656 | 10.0 | 104.800507 | 23.096073 | -14.130403 |  2.080656 |
    | 24.01. | 14.6 | 0.6 | 0.0 | 14.0 | 11.090393 | 0.6 |      0.0 |      0.6 | 2.968736 | 2.671862 | 0.296874 | 0.059129 |  1.76413 | 0.121195 | 0.007656 | 0.007656 | 0.007656 | 0.244668 | 0.275717 | 0.128851 | 0.649237 |  2.705153 | 10.0 | 115.831771 | 23.917539 | -13.692812 |  2.705153 |
    | 25.01. |  4.0 | 0.4 | 0.0 |  3.6 |  2.757196 | 0.4 |      0.0 |      0.4 | 0.909135 | 0.818221 | 0.090913 | 0.066331 | 2.261102 | 0.209535 |  0.02319 |  0.02319 |  0.02319 | 0.306258 | 0.314884 | 0.232725 | 0.853866 |  3.557777 | 10.0 | 118.522636 | 24.991132 | -13.080065 |  3.557777 |
    | 26.01. |  0.8 | 0.4 | 0.0 |  0.4 |  0.304011 | 0.4 |      0.0 |      0.4 | 0.162987 | 0.146689 | 0.016299 | 0.066998 | 1.149018 | 0.198006 | 0.043491 | 0.043491 | 0.043491 | 0.332282 |  0.32716 | 0.241497 | 0.900939 |  3.753911 | 10.0 | 118.759649 | 25.391752 | -12.904126 |  3.753911 |
    | 27.01. |  0.1 | 0.4 | 0.0 |  0.0 |       0.0 | 0.4 |      0.0 |      0.4 | 0.066809 | 0.060129 | 0.006681 | 0.066809 | 0.287919 | 0.095526 | 0.051067 | 0.051067 | 0.051067 | 0.325509 | 0.316636 | 0.146593 | 0.788738 |  3.286407 |  9.7 | 118.692839 | 25.290062 | -13.054527 |  3.286407 |
    | 28.01. |  3.3 | 0.5 | 0.0 |  2.5 |  1.890258 | 0.5 |      0.0 |      0.5 | 0.681834 | 0.613651 | 0.068183 | 0.072092 | 0.155405 |  0.03113 | 0.049144 | 0.049144 | 0.049144 | 0.314318 | 0.303682 | 0.080274 | 0.698275 |  2.909477 | 10.0 | 120.511005 | 25.118131 | -13.246903 |  2.909477 |
    | 29.01. |  7.7 | 0.4 | 0.0 |  7.3 |  5.410815 | 0.4 |      0.0 |      0.4 | 1.978688 | 1.780819 | 0.197869 | 0.089503 | 0.646806 | 0.041535 | 0.045893 | 0.045893 | 0.045893 | 0.321596 |  0.30374 | 0.087428 | 0.712764 |  2.969851 | 10.0 | 125.832317 |  25.23051 | -13.246028 |  2.969851 |
    | 30.01. | 10.3 | 0.3 | 0.0 | 10.0 |  7.144816 | 0.3 |      0.0 |      0.3 | 2.972682 | 2.675414 | 0.297268 | 0.117498 | 1.636918 | 0.114742 | 0.048018 | 0.048018 | 0.048018 |  0.36741 | 0.329408 |  0.16276 | 0.859578 |  3.581575 | 10.0 | 132.859635 | 25.893269 |  -12.87265 |  3.581575 |
    | 31.01. |  3.7 | 0.3 | 0.0 |  3.4 |  2.359072 | 0.3 |      0.0 |      0.3 | 1.168649 | 1.051784 | 0.116865 | 0.127721 | 2.249925 | 0.201534 | 0.060551 | 0.060551 | 0.060551 | 0.443833 | 0.374328 | 0.262084 | 1.080245 |  4.501022 | 10.0 | 135.090986 | 26.859942 | -12.286457 |  4.501022 |
    | 01.02. | 15.3 | 0.5 | 0.0 | 14.8 |  9.850026 | 0.5 |      0.0 |      0.5 |  5.13057 | 4.617513 | 0.513057 | 0.180596 | 1.908497 | 0.236788 |  0.07883 |  0.07883 |  0.07883 | 0.508542 | 0.411375 | 0.315619 | 1.235536 |  5.148065 | 10.0 | 144.760417 | 27.575329 | -11.855604 |  5.148065 |
    | 02.02. |  3.2 | 0.5 | 0.0 |  2.7 |   1.72437 | 0.5 |      0.0 |      0.5 | 1.166025 | 1.049422 | 0.116602 | 0.190395 | 3.317864 | 0.272329 | 0.092358 | 0.092358 | 0.092358 | 0.660858 | 0.503464 | 0.364688 | 1.529009 |  6.370871 | 10.0 | 146.294392 | 28.997548 | -10.939564 |  6.370871 |
    | 03.02. |  2.7 | 0.3 | 0.0 |  2.4 |   1.51567 | 0.3 |      0.0 |      0.3 | 1.083471 | 0.975124 | 0.108347 | 0.199141 | 1.852465 | 0.294176 | 0.119252 | 0.119252 | 0.119252 | 0.723719 | 0.540512 | 0.413428 | 1.677659 |  6.990246 | 10.0 | 147.610921 |  29.50456 | -10.619838 |  6.990246 |
    | 04.02. |  2.2 | 0.3 | 0.0 |  1.9 |   1.18889 | 0.3 |      0.0 |      0.3 | 0.916989 |  0.82529 | 0.091699 | 0.205879 | 0.971606 | 0.175742 |  0.12884 |  0.12884 |  0.12884 |  0.72236 | 0.538045 | 0.304582 | 1.564987 |  6.520779 | 10.0 | 148.593931 | 29.494003 |   -10.6404 |  6.520779 |
    | 05.02. |  8.0 | 0.4 | 0.0 |  7.6 |  4.649681 | 0.4 |      0.0 |      0.4 | 3.188729 | 2.869856 | 0.318873 | 0.238411 | 1.138498 | 0.122212 |  0.12864 |  0.12864 |  0.12864 | 0.732599 | 0.542983 | 0.250852 | 1.526434 |  6.360141 | 10.0 | 153.005202 | 29.573143 | -10.599344 |  6.360141 |
    | 06.02. | 14.3 | 0.4 | 0.0 | 13.9 |  8.054622 | 0.4 |      0.0 |      0.4 | 6.150855 |  5.53577 | 0.615086 | 0.305477 | 2.767758 | 0.202492 | 0.130137 | 0.130137 | 0.130137 | 0.862277 | 0.622904 | 0.332629 |  1.81781 |  7.574207 | 10.0 | 160.754347 | 30.501657 |  -9.985008 |  7.574207 |
    | 07.02. |  6.3 | 0.3 | 0.0 |  6.0 |  3.303093 | 0.3 |      0.0 |      0.3 | 3.031768 | 2.728592 | 0.303177 | 0.334861 | 4.545049 | 0.373772 | 0.147695 | 0.147695 | 0.147695 | 1.155031 | 0.809531 | 0.521467 | 2.486029 | 10.358454 | 10.0 | 163.722579 | 32.221349 |  -8.828825 | 10.358454 |
    | 08.02. |  0.0 | 0.2 | 0.0 |  0.0 |       0.0 | 0.2 |      0.0 |      0.2 | 0.331471 | 0.298324 | 0.033147 | 0.331471 | 3.036656 | 0.424348 | 0.180214 | 0.180214 | 0.180214 | 1.297832 | 0.905978 | 0.604561 | 2.808372 |  11.70155 |  9.8 | 163.391107 | 32.925724 |  -8.339927 |  11.70155 |
    | 09.02. |  5.9 | 0.1 | 0.0 |  5.6 |   3.00524 | 0.1 |      0.0 |      0.1 | 2.954075 | 2.658667 | 0.295407 | 0.359315 | 1.174352 | 0.266892 | 0.193533 | 0.193533 | 0.193533 |  1.22895 | 0.864783 | 0.460426 | 2.554159 | 10.642328 | 10.0 | 166.037033 | 32.594919 |  -8.541436 | 10.642328 |
    | 10.02. |  9.2 | 0.1 | 0.0 |  9.1 |  4.702102 | 0.1 |      0.0 |      0.1 | 4.806376 | 4.325738 | 0.480638 | 0.408477 | 2.348271 | 0.195242 | 0.187278 | 0.187278 | 0.187278 | 1.292147 | 0.909295 |  0.38252 | 2.583961 | 10.766506 | 10.0 | 170.330657 | 32.899013 |  -8.324144 | 10.766506 |
    | 11.02. |  6.1 | 0.0 | 0.0 |  6.1 |  3.030189 | 0.0 |      0.0 |      0.0 | 3.510462 | 3.159416 | 0.351046 | 0.440651 | 3.786616 | 0.316158 | 0.193028 | 0.193028 | 0.193028 | 1.509714 | 1.058127 | 0.509186 | 3.077027 | 12.820948 | 10.0 | 172.920195 | 33.854296 |  -7.674597 | 12.820948 |
    | 12.02. |  0.1 | 0.1 | 0.0 |  0.0 |       0.0 | 0.1 |      0.0 |      0.1 | 0.435107 | 0.391596 | 0.043511 | 0.435107 |  3.04745 | 0.376138 | 0.211093 | 0.211093 | 0.211093 | 1.616134 | 1.134634 | 0.587231 | 3.337999 | 13.908331 | 10.0 | 172.485088 | 34.277725 |  -7.379158 | 13.908331 |
    | 13.02. |  0.0 | 0.1 | 0.0 |  0.0 |       0.0 | 0.1 |      0.0 |      0.1 | 0.429687 | 0.386719 | 0.042969 | 0.429687 | 1.021728 | 0.252553 |   0.2191 |   0.2191 |   0.2191 | 1.460489 | 1.031538 | 0.471653 | 2.963679 | 12.348664 |  9.9 | 172.055401 | 33.649373 |  -7.782905 | 12.348664 |
    | 14.02. |  2.8 | 0.0 | 0.0 |  2.7 |  1.327529 | 0.0 |      0.0 |      0.0 | 1.813401 | 1.632061 |  0.18134 |  0.44093 | 0.557805 | 0.105716 | 0.207218 | 0.207218 | 0.207218 | 1.292167 | 0.920186 | 0.312934 | 2.525287 | 10.522029 | 10.0 |    172.942 | 32.899106 |  -8.272752 | 10.522029 |
    | 15.02. | 10.6 | 0.2 | 0.0 | 10.4 |  4.945335 | 0.2 |      0.0 |      0.2 | 5.955582 | 5.360024 | 0.595558 | 0.500917 | 1.857066 |  0.12738 |  0.19303 |  0.19303 |  0.19303 | 1.294815 | 0.922945 | 0.320411 | 2.538171 | 10.575711 | 10.0 | 177.386418 | 32.911561 |   -8.25984 | 10.575711 |
    | 16.02. |  8.8 | 0.9 | 0.0 |  7.9 |  3.577702 | 0.9 |      0.0 |      0.9 | 4.867788 | 4.381009 | 0.486779 |  0.54549 | 4.376781 | 0.310495 | 0.193266 | 0.193266 | 0.193266 | 1.582852 | 1.119591 |  0.50376 | 3.206203 | 13.359178 | 10.0 |  180.41863 | 34.148044 |  -7.435452 | 13.359178 |
    | 17.02. |  7.2 | 0.9 | 0.0 |  6.3 |   2.75186 | 0.9 |      0.0 |      0.9 | 4.127488 | 3.714739 | 0.412749 | 0.579349 | 4.513193 | 0.477474 | 0.216647 | 0.216647 | 0.216647 | 1.871798 | 1.323442 | 0.694122 | 3.889363 | 16.205677 | 10.0 | 182.591142 | 35.200808 |  -6.736971 | 16.205677 |
    | 18.02. |  4.9 | 0.5 | 0.0 |  4.4 |  1.874596 | 0.5 |      0.0 |      0.5 | 3.125393 | 2.812853 | 0.312539 | 0.599989 | 3.743488 | 0.466157 | 0.236555 | 0.236555 | 0.236555 | 2.014863 | 1.426405 | 0.702712 |  4.14398 | 17.266584 | 10.0 | 183.865749 | 35.668593 |  -6.429426 | 17.266584 |
    | 19.02. |  1.8 | 0.9 | 0.0 |  0.9 |  0.380494 | 0.9 |      0.0 |      0.9 | 1.115957 | 1.004361 | 0.111596 | 0.596451 | 2.771559 | 0.373766 | 0.245401 | 0.245401 | 0.245401 | 1.989384 | 1.407766 | 0.619167 | 4.016316 | 16.734649 | 10.0 | 183.649792 | 35.587546 |  -6.483167 | 16.734649 |

There is no indication of an error in the water balance:

>>> round_(model.check_waterbalance(conditions))
0.0
"""

# import...
# ...from HydPy
from hydpy.exe.modelimports import *
from hydpy.core import modeltools
from hydpy.core.typingtools import *
from hydpy.interfaces import petinterfaces

# ...from  gland
from hydpy.models.gland import gland_model


class Model(gland_model.Main_PETModel_V1):
    """GR6 version of G-Land (|gland_gr6|)."""

    INLET_METHODS = (gland_model.Calc_E_V1,)
    RECEIVER_METHODS = ()
    RUN_METHODS = (
        gland_model.Calc_EI_V1,
        gland_model.Calc_PN_V1,
        gland_model.Calc_EN_V1,
        gland_model.Update_I_V1,
        gland_model.Calc_PS_V1,
        gland_model.Calc_ES_V1,
        gland_model.Update_S_V1,
        gland_model.Calc_Perc_V1,
        gland_model.Update_S_V2,
        gland_model.Calc_AE_V1,
        gland_model.Calc_Pr_V1,
        gland_model.Calc_PR1_PR9_V1,
        gland_model.Calc_Q9_V1,
        gland_model.Calc_Q1_V1,
        gland_model.Calc_FR_V2,
        gland_model.Update_R_V2,
        gland_model.Calc_QR_V1,
        gland_model.Update_R_V3,
        gland_model.Calc_FR2_V1,
        gland_model.Update_R2_V1,
        gland_model.Calc_QR2_R2_V1,
        gland_model.Calc_FD_V1,
        gland_model.Calc_Qd_V1,
        gland_model.Calc_QH_V2,
        gland_model.Calc_QV_V1,
    )
    INTERFACE_METHODS = ()
    ADD_METHODS = (gland_model.Calc_E_PETModel_V1,)
    OUTLET_METHODS = (gland_model.Pass_Q_V1,)
    SENDER_METHODS = ()
    SUBMODELINTERFACES = (petinterfaces.PETModel_V1,)
    SUBMODELS = ()

    petmodel = modeltools.SubmodelProperty(petinterfaces.PETModel_V1)

    def check_waterbalance(self, initial_conditions: ConditionsModel) -> float:
        r"""Determine the water balance error of the previous simulation run in mm.

        Method |Model.check_waterbalance| calculates the balance error as follows:

          .. math::
            \sum_{t=t0}^{t1} \left(
            P_t
            + FR_t
            + FR2_t
            + FD_t
            - Qt_t
            - AE_t
            \right)
            -
            \left(
            \left( I_{t1} - I_{t0} \right)
            + \left( R_{t1} - R_{t0} \right)
            + \left( S_{t1} - S_{t0} \right)
            \right)
        """
        fluxes = self.sequences.fluxes
        inputs = self.sequences.inputs
        last = self.sequences.states
        first = initial_conditions["model"]["states"]
        logs = initial_conditions["model"]["logs"]
        return (
            numpy.sum(inputs.p.evalseries)
            - numpy.sum(fluxes.ae.evalseries)
            - numpy.sum(fluxes.qh.evalseries)
            + numpy.sum(fluxes.fr.evalseries)
            + numpy.sum(fluxes.fr2.evalseries)
            + numpy.sum(fluxes.fd.evalseries)
            - (last.s - first["s"])
            - (last.r - first["r"])
            - (last.r2 - first["r2"])
            - (last.i - first["i"])
            - numpy.sum(self.sequences.logs.quh1 - logs["quh1"])
            - numpy.sum(self.sequences.logs.quh2 - logs["quh2"])
        )


tester = Tester()
cythonizer = Cythonizer()

<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hydpy.exe.commandtools &#8212; HydPy 5.0.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/classic.css?v=127cebf3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
    
    <script src="../../../_static/documentation_options.js?v=f98c4cc8"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">HydPy 5.0.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">hydpy.exe.commandtools</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/HydPy_Logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="../../../index.html">Table of Contents</a></h3>
    <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../how_to.html">How toâ€¦</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../framework.html">Framework Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modelcollection.html">Model Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Example Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../zbibliography.html">Bibliography</a></li>
</ul>

  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for hydpy.exe.commandtools</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;This module implements some main features for using *HydPy* from your command line</span>
<span class="sd">tools via script |hyd|.&quot;&quot;&quot;</span>
<span class="c1"># import...</span>
<span class="c1"># ...from standard library</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">import</span> <span class="nn">contextlib</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">runpy</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TextIO</span>

<span class="c1"># ...from hydpy</span>
<span class="kn">import</span> <span class="nn">hydpy</span>
<span class="kn">import</span> <span class="nn">hydpy.tests.run_doctests</span>
<span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">config</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="kn">import</span> <span class="n">objecttools</span>


<span class="nd">@overload</span>
<span class="k">def</span> <span class="nf">run_subprocess</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">blocking</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;non-blocking&quot;&quot;&quot;</span>


<span class="nd">@overload</span>
<span class="k">def</span> <span class="nf">run_subprocess</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">blocking</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;blocking&quot;&quot;&quot;</span>


<div class="viewcode-block" id="run_subprocess">
<a class="viewcode-back" href="../../../commandtools.html#hydpy.exe.commandtools.run_subprocess">[docs]</a>
<span class="k">def</span> <span class="nf">run_subprocess</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">blocking</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute the given command in a new process.</span>

<span class="sd">    Only when both `verbose` and `blocking` are |True|, |run_subprocess| prints all</span>
<span class="sd">    responses to the current value of |sys.stdout|:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy import run_subprocess</span>
<span class="sd">    &gt;&gt;&gt; import platform</span>
<span class="sd">    &gt;&gt;&gt; esc = &quot;&quot; if &quot;windows&quot; in platform.platform().lower() else &quot;\\\\&quot;</span>
<span class="sd">    &gt;&gt;&gt; result = run_subprocess(f&quot;python -c print{esc}(1+1{esc})&quot;)</span>
<span class="sd">    2</span>

<span class="sd">    With verbose being |False|, |run_subprocess| never prints anything:</span>

<span class="sd">    &gt;&gt;&gt; result = run_subprocess(f&quot;python -c print{esc}(1+1{esc})&quot;, verbose=False)</span>

<span class="sd">    &gt;&gt;&gt; process = run_subprocess(&quot;python&quot;, blocking=False, verbose=False)</span>
<span class="sd">    &gt;&gt;&gt; process.kill()</span>
<span class="sd">    &gt;&gt;&gt; _ = process.communicate()</span>

<span class="sd">    When `verbose` is |True| and `blocking` is |False|, |run_subprocess| prints all</span>
<span class="sd">    responses to the console (&quot;invisible&quot; for doctests):</span>

<span class="sd">    &gt;&gt;&gt; process = run_subprocess(&quot;python&quot;, blocking=False)</span>
<span class="sd">    &gt;&gt;&gt; process.kill()</span>
<span class="sd">    &gt;&gt;&gt; _ = process.communicate()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;python&quot;</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="si">}{</span><span class="n">command</span><span class="p">[</span><span class="mi">6</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">blocking</span><span class="p">:</span>
        <span class="n">result1</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="n">command</span><span class="p">,</span>
            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
            <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">env</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>  <span class="c1"># due to doctest replacing sys.stdout</span>
            <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="p">(</span><span class="n">result1</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">result1</span><span class="o">.</span><span class="n">stderr</span><span class="p">):</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result1</span>
    <span class="n">stdouterr</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">verbose</span> <span class="k">else</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span>
    <span class="n">result2</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>  <span class="c1"># pylint: disable=consider-using-with</span>
        <span class="n">command</span><span class="p">,</span>
        <span class="n">stdout</span><span class="o">=</span><span class="n">stdouterr</span><span class="p">,</span>
        <span class="n">stderr</span><span class="o">=</span><span class="n">stdouterr</span><span class="p">,</span>
        <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
        <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">env</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">result2</span></div>



<div class="viewcode-block" id="exec_commands">
<a class="viewcode-back" href="../../../commandtools.html#hydpy.exe.commandtools.exec_commands">[docs]</a>
<span class="k">def</span> <span class="nf">exec_commands</span><span class="p">(</span><span class="n">commands</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">parameters</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute the given Python commands.</span>

<span class="sd">    Function |exec_commands| is thought for testing purposes only (see the main</span>
<span class="sd">    documentation on module |hyd|).  Separate individual commands by semicolons and</span>
<span class="sd">    replaced whitespaces with underscores:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy.exe.commandtools import exec_commands</span>
<span class="sd">    &gt;&gt;&gt; import sys</span>
<span class="sd">    &gt;&gt;&gt; exec_commands(&quot;x_=_1+1;print(x)&quot;)</span>
<span class="sd">    Start to execute the commands [&#39;x_=_1+1&#39;, &#39;print(x)&#39;] for testing purposes.</span>
<span class="sd">    2</span>

<span class="sd">    |exec_commands| interprets double underscores as a single underscores:</span>

<span class="sd">    &gt;&gt;&gt; exec_commands(&quot;x_=_1;print(x.____class____)&quot;)</span>
<span class="sd">    Start to execute the commands [&#39;x_=_1&#39;, &#39;print(x.____class____)&#39;] \</span>
<span class="sd">for testing purposes.</span>
<span class="sd">    &lt;class &#39;int&#39;&gt;</span>

<span class="sd">    |exec_commands| evaluates additional keyword arguments before it executes the given</span>
<span class="sd">    commands:</span>

<span class="sd">    &gt;&gt;&gt; exec_commands(&quot;e=x==y;print(e)&quot;, x=1, y=2)</span>
<span class="sd">    Start to execute the commands [&#39;e=x==y&#39;, &#39;print(e)&#39;] for testing purposes.</span>
<span class="sd">    False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cmdlist</span> <span class="o">=</span> <span class="n">commands</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Start to execute the commands </span><span class="si">{</span><span class="n">cmdlist</span><span class="si">}</span><span class="s2"> for testing purposes.&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">par</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">exec</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">par</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">cmdlist</span><span class="p">:</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">,</span> <span class="s2">&quot;temptemptemp&quot;</span><span class="p">)</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;temptemptemp&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
        <span class="n">exec</span><span class="p">(</span><span class="n">command</span><span class="p">)</span></div>



<div class="viewcode-block" id="run_doctests">
<a class="viewcode-back" href="../../../commandtools.html#hydpy.exe.commandtools.run_doctests">[docs]</a>
<span class="k">def</span> <span class="nf">run_doctests</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># pylint: disable=inconsistent-return-statements</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute the main function of script `run_doctests.py` from remote.</span>

<span class="sd">    Whenever in doubt about the functioning of your *HydPy* installation, call the</span>
<span class="sd">    script function |run_doctests|.  It executes all tests employed before your actual</span>
<span class="sd">    *HydPy* version was released, which allows you to check for possible</span>
<span class="sd">    incompatibilities with the site-packages or the configuration of your specific</span>
<span class="sd">    system.</span>

<span class="sd">    |run_doctests| calls the mentioned function with default arguments and returns its</span>
<span class="sd">    exit code:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy import run_doctests</span>
<span class="sd">    &gt;&gt;&gt; from unittest import mock</span>
<span class="sd">    &gt;&gt;&gt; with mock.patch(&quot;hydpy.tests.run_doctests.main.callback&quot;,</span>
<span class="sd">    ...                 side_effect=SystemExit(1)) as main:</span>
<span class="sd">    ...     run_doctests()</span>
<span class="sd">    1</span>
<span class="sd">    &gt;&gt;&gt; assert &quot;hydpy_path=None&quot; in str(main.mock_calls)</span>
<span class="sd">    &gt;&gt;&gt; assert &quot;file_doctests=[]&quot; in str(main.mock_calls)</span>
<span class="sd">    &gt;&gt;&gt; assert &quot;python_mode=True&quot; in str(main.mock_calls)</span>
<span class="sd">    &gt;&gt;&gt; assert &quot;cython_mode=True&quot; in str(main.mock_calls)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">hydpy</span><span class="o">.</span><span class="n">tests</span><span class="o">.</span><span class="n">run_doctests</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
            <span class="n">hydpy_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_doctests</span><span class="o">=</span><span class="p">[],</span> <span class="n">python_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cython_mode</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">SystemExit</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">exc</span><span class="o">.</span><span class="n">code</span></div>



<div class="viewcode-block" id="exec_script">
<a class="viewcode-back" href="../../../commandtools.html#hydpy.exe.commandtools.exec_script">[docs]</a>
<span class="k">def</span> <span class="nf">exec_script</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute an arbitrary Python script.</span>

<span class="sd">    Function |run_simulation| allows you to execute a predefined *HydPy* workflow.  You</span>
<span class="sd">    can configure many details of this workflow but not change its general structure.</span>
<span class="sd">    Use function |exec_script| execute *HydPy* remotely but strive for more flexibility.</span>
<span class="sd">    As its name suggests, function |exec_script| executes any valid Python code relying</span>
<span class="sd">    on the standard library and the available site-packages.</span>

<span class="sd">    Function |exec_script| requires the name of the script to be executed as a single</span>
<span class="sd">    argument:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy import print_latest_logfile, Node, TestIO, run_subprocess</span>
<span class="sd">    &gt;&gt;&gt; TestIO.clear()</span>
<span class="sd">    &gt;&gt;&gt; with TestIO():</span>
<span class="sd">    ...     result = run_subprocess(&#39;hyd.py logfile=&quot;default&quot; exec_script temp.py&#39;)</span>
<span class="sd">    ...     print_latest_logfile()    # doctest: +ELLIPSIS</span>
<span class="sd">    Invoking hyd.py with arguments `logfile=default, exec_script, temp.py` \</span>
<span class="sd">resulted in the following error:</span>
<span class="sd">    File `...temp.py` does not exist.</span>
<span class="sd">    ...</span>

<span class="sd">    Function |exec_script| can use all *HydPy* features.  As a simple example, we write</span>
<span class="sd">    a Python script that initialises a |Node| object and prints its string</span>
<span class="sd">    representation (into the log file):</span>

<span class="sd">    &gt;&gt;&gt; with TestIO():</span>
<span class="sd">    ...     with open(&quot;temp.py&quot;, &quot;w&quot;) as file_:</span>
<span class="sd">    ...         _ = file_.write(&quot;from hydpy import Node\\n&quot;)</span>
<span class="sd">    ...         _ = file_.write(&#39;print(repr(Node(&quot;valid_name&quot;)))\\n&#39;)</span>
<span class="sd">    ...     result = run_subprocess(&#39;hyd.py logfile=&quot;default&quot; exec_script temp.py&#39;)</span>
<span class="sd">    ...     print_latest_logfile()</span>
<span class="sd">    Node(&quot;valid_name&quot;, variable=&quot;Q&quot;)</span>
<span class="sd">    &lt;BLANKLINE&gt;</span>

<span class="sd">    Errors are reported as usual:</span>

<span class="sd">    &gt;&gt;&gt; with TestIO():</span>
<span class="sd">    ...     with open(&quot;temp.py&quot;, &quot;w&quot;) as file_:</span>
<span class="sd">    ...         _ = file_.write(&quot;from hydpy import Node\\n&quot;)</span>
<span class="sd">    ...         _ = file_.write(&#39;print(repr(Node(&quot;invalid name&quot;)))\\n&#39;)</span>
<span class="sd">    ...     result = run_subprocess(&#39;hyd.py logfile=&quot;default&quot; exec_script temp.py&#39;)</span>
<span class="sd">    ...     print_latest_logfile()    # doctest: +ELLIPSIS</span>
<span class="sd">    Invoking hyd.py with arguments `logfile=default, exec_script, temp.py` resulted \</span>
<span class="sd">in the following error:</span>
<span class="sd">    While trying to initialize a `Node` object with value `invalid name` of type \</span>
<span class="sd">`str`, the following error occurred: The given name string `invalid name` does not \</span>
<span class="sd">define a valid variable identifier.  Valid identifiers do not contain characters like \</span>
<span class="sd">`-` or empty spaces, do not start with numbers, cannot be mistaken with Python \</span>
<span class="sd">built-ins like `for`...)</span>
<span class="sd">    ...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File `</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span><span class="si">}</span><span class="s2">` does not exist.&quot;</span><span class="p">)</span>
    <span class="n">runpy</span><span class="o">.</span><span class="n">run_path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span></div>



<div class="viewcode-block" id="start_shell">
<a class="viewcode-back" href="../../../commandtools.html#hydpy.exe.commandtools.start_shell">[docs]</a>
<span class="k">def</span> <span class="nf">start_shell</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Open an interactive Python shell.</span>

<span class="sd">    Writing &quot;hyd.py start_shell&quot; into your command line tool opens an interactive</span>
<span class="sd">    Python console with the most relevant *HydPy* features being imported already.  In</span>
<span class="sd">    our first example, we directly prepare an |Element| object (without needing to</span>
<span class="sd">    import class |Element| first) and print its string representation:</span>

<span class="sd">    &gt;&gt;&gt; import subprocess</span>
<span class="sd">    &gt;&gt;&gt; from hydpy import TestIO</span>
<span class="sd">    &gt;&gt;&gt; TestIO.clear()</span>
<span class="sd">    &gt;&gt;&gt; with TestIO():</span>
<span class="sd">    ...     with subprocess.Popen(</span>
<span class="sd">    ...             &quot;hyd.py start_shell&quot;,</span>
<span class="sd">    ...             stdin=subprocess.PIPE,</span>
<span class="sd">    ...             stdout=subprocess.PIPE,</span>
<span class="sd">    ...             stderr=subprocess.PIPE,</span>
<span class="sd">    ...             encoding=&quot;utf-8&quot;,</span>
<span class="sd">    ...             shell=True) as process:</span>
<span class="sd">    ...         response = process.communicate(</span>
<span class="sd">    ...             &#39;print(repr(Element(&quot;e1&quot;, outlets=&quot;n1&quot;)))&#39;)</span>
<span class="sd">    ...         print(response[0])</span>
<span class="sd">    Element(&quot;e1&quot;,</span>
<span class="sd">            outlets=&quot;n1&quot;)</span>
<span class="sd">    &lt;BLANKLINE&gt;</span>

<span class="sd">    You can pass the name of a Python file as an additional argument, which enables</span>
<span class="sd">    interaction with the file results.  We create the example file `test.py` for</span>
<span class="sd">    demonstration purposes, simply defining a |Nodes| object handling two individual</span>
<span class="sd">    nodes:</span>

<span class="sd">    &gt;&gt;&gt; with TestIO():</span>
<span class="sd">    ...     with open(&quot;test.py&quot;, &quot;w&quot;) as file_:</span>
<span class="sd">    ...         _ = file_.write(&quot;from hydpy import Nodes\\n&quot;)</span>
<span class="sd">    ...         _ = file_.write(&#39;nodes = Nodes(&quot;n1&quot;, &quot;n2&quot;)\\n&#39;)</span>

<span class="sd">    Now we can, execute this file and, for example, query the names of</span>
<span class="sd">    the defined nodes interactively:</span>

<span class="sd">    &gt;&gt;&gt; with TestIO():</span>
<span class="sd">    ...     with subprocess.Popen(</span>
<span class="sd">    ...             &quot;hyd.py start_shell test.py&quot;,</span>
<span class="sd">    ...             stdin=subprocess.PIPE,</span>
<span class="sd">    ...             stdout=subprocess.PIPE,</span>
<span class="sd">    ...             stderr=subprocess.PIPE,</span>
<span class="sd">    ...             encoding=&quot;utf-8&quot;,</span>
<span class="sd">    ...             shell=True) as process:</span>
<span class="sd">    ...         response = process.communicate(</span>
<span class="sd">    ...             &quot;print(nodes.names)&quot;)</span>
<span class="sd">    ...         print(response[0])</span>
<span class="sd">    (&#39;n1&#39;, &#39;n2&#39;)</span>
<span class="sd">    &lt;BLANKLINE&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filepath</span><span class="p">:</span>
        <span class="n">filepath_</span> <span class="o">=</span> <span class="n">filepath</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">filepath_</span> <span class="o">=</span> <span class="s2">&quot;__hydpy_temp__&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;__hydpy_temp__&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">ENCODING</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_</span><span class="p">:</span>
            <span class="n">file_</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;from hydpy import *&quot;</span><span class="p">)</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span> <span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="n">filepath_</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">filepath</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filepath_</span><span class="p">)</span></div>


    <span class="c1"># First steps to use IPython instead:</span>
    <span class="c1"># import IPython</span>
    <span class="c1"># IPython.start_ipython()</span>
    <span class="c1"># console = IPython.get_ipython()</span>
    <span class="c1"># console.run_code(compile(&quot;print(1+1&quot;, &quot;_&quot;, &quot;exec&quot;))</span>
    <span class="c1"># console.run_code(compile(&quot;from hydpy import *&quot;, &quot;_&quot;, &quot;exec&quot;))</span>


<div class="viewcode-block" id="print_latest_logfile">
<a class="viewcode-back" href="../../../commandtools.html#hydpy.exe.commandtools.print_latest_logfile">[docs]</a>
<span class="k">def</span> <span class="nf">print_latest_logfile</span><span class="p">(</span><span class="n">dirpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">wait</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print the latest log file in the current or the given working directory.</span>

<span class="sd">    When executing processes in parallel, |print_latest_logfile| may be called before</span>
<span class="sd">    any log file exists.  Then pass an appropriate number of seconds to the argument</span>
<span class="sd">    `wait`.  |print_latest_logfile| prints the contents of the latest log file as soon</span>
<span class="sd">    as it finds one. Function |print_latest_logfile| works only for &quot;default&quot; logfile</span>
<span class="sd">    names, as described in the documentation on function |prepare_logfile|.</span>

<span class="sd">    &gt;&gt;&gt; from hydpy import TestIO, print_latest_logfile, run_subprocess</span>
<span class="sd">    &gt;&gt;&gt; TestIO.clear()</span>
<span class="sd">    &gt;&gt;&gt; with TestIO():</span>
<span class="sd">    ...     result = run_subprocess(&quot;hyd.py&quot;)</span>
<span class="sd">    ...     print_latest_logfile(wait=0.5)    # doctest: +ELLIPSIS</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    FileNotFoundError: Cannot find a default HydPy log file in directory ...iotesting.</span>

<span class="sd">    &gt;&gt;&gt; with TestIO():</span>
<span class="sd">    ...     result1 = run_subprocess(&#39;hyd.py logfile=&quot;default&quot; test=1&#39;)</span>
<span class="sd">    ...     result2 = run_subprocess(&#39;hyd.py logfile=&quot;default&quot; test=2&#39;)</span>
<span class="sd">    ...     print_latest_logfile(wait=0.5)    # doctest: +ELLIPSIS</span>
<span class="sd">    Invoking hyd.py with arguments `logfile=default, test=2` resulted in the \</span>
<span class="sd">following error:</span>
<span class="sd">    ...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">wait</span> <span class="o">+=</span> <span class="n">now</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">now</span> <span class="o">&lt;=</span> <span class="n">wait</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">dirpath</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;hydpy_&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.log&quot;</span><span class="p">):</span>
                <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Cannot find a default HydPy log file in directory &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">dirpath</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">filenames</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">encoding</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">ENCODING</span><span class="p">)</span> <span class="k">as</span> <span class="n">logfile</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">logfile</span><span class="o">.</span><span class="n">read</span><span class="p">())</span></div>



<div class="viewcode-block" id="prepare_logfile">
<a class="viewcode-back" href="../../../commandtools.html#hydpy.exe.commandtools.prepare_logfile">[docs]</a>
<span class="k">def</span> <span class="nf">prepare_logfile</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare an empty log file eventually and return its absolute path.</span>

<span class="sd">    When passing the &quot;filename&quot; `stdout`, |prepare_logfile| does not prepare any file</span>
<span class="sd">    and just returns `stdout`:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy.exe.commandtools import prepare_logfile</span>
<span class="sd">    &gt;&gt;&gt; prepare_logfile(&quot;stdout&quot;)</span>
<span class="sd">    &#39;stdout&#39;</span>

<span class="sd">    When passing the &quot;filename&quot; `default`, |prepare_logfile| generates a filename</span>
<span class="sd">    containing the actual date and time, prepares an empty file on disk, and returns</span>
<span class="sd">    its path:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy import repr_, TestIO</span>
<span class="sd">    &gt;&gt;&gt; from hydpy.core.testtools import mock_datetime_now</span>
<span class="sd">    &gt;&gt;&gt; from datetime import datetime</span>
<span class="sd">    &gt;&gt;&gt; with TestIO():</span>
<span class="sd">    ...     with mock_datetime_now(datetime(2000, 1, 1, 12, 30, 0)):</span>
<span class="sd">    ...         filepath = prepare_logfile(&quot;default&quot;)</span>
<span class="sd">    &gt;&gt;&gt; import os</span>
<span class="sd">    &gt;&gt;&gt; os.path.exists(filepath)</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; repr_(filepath)    # doctest: +ELLIPSIS</span>
<span class="sd">    &#39;...hydpy/tests/iotesting/hydpy_2000-01-01_12-30-00.log&#39;</span>

<span class="sd">    For all other strings, |prepare_logfile| does not add any date or time information</span>
<span class="sd">    to the filename:</span>

<span class="sd">    &gt;&gt;&gt; with TestIO():</span>
<span class="sd">    ...     with mock_datetime_now(datetime(2000, 1, 1, 12, 30, 0)):</span>
<span class="sd">    ...         filepath = prepare_logfile(&quot;my_log_file.txt&quot;)</span>
<span class="sd">    &gt;&gt;&gt; os.path.exists(filepath)</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; repr_(filepath)    # doctest: +ELLIPSIS</span>
<span class="sd">    &#39;...hydpy/tests/iotesting/my_log_file.txt&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;stdout&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">filename</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;hydpy_%Y-%m-</span><span class="si">%d</span><span class="s2">_%H-%M-%S.log&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">ENCODING</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></div>



<span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
<span class="k">def</span> <span class="nf">_activate_logfile</span><span class="p">(</span>
    <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">logstyle</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">level_stdout</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">,</span> <span class="s2">&quot;exception&quot;</span><span class="p">],</span>
    <span class="n">level_stderr</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span> <span class="s2">&quot;exception&quot;</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">filepath</span> <span class="o">==</span> <span class="s2">&quot;stdout&quot;</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">TextIO</span><span class="p">,</span> <span class="n">LogFileInterface</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">logstyle</span><span class="p">,</span> <span class="n">level_stdout</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">TextIO</span><span class="p">,</span> <span class="n">LogFileInterface</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="n">logstyle</span><span class="p">,</span> <span class="n">level_stderr</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">yield</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">ENCODING</span><span class="p">)</span> <span class="k">as</span> <span class="n">logfile</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                    <span class="n">TextIO</span><span class="p">,</span> <span class="n">LogFileInterface</span><span class="p">(</span><span class="n">logfile</span><span class="p">,</span> <span class="n">logstyle</span><span class="p">,</span> <span class="n">level_stdout</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                    <span class="n">TextIO</span><span class="p">,</span> <span class="n">LogFileInterface</span><span class="p">(</span><span class="n">logfile</span><span class="p">,</span> <span class="n">logstyle</span><span class="p">,</span> <span class="n">level_stderr</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">yield</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">__stdout__</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">__stderr__</span>


<div class="viewcode-block" id="execute_scriptfunction">
<a class="viewcode-back" href="../../../commandtools.html#hydpy.exe.commandtools.execute_scriptfunction">[docs]</a>
<span class="k">def</span> <span class="nf">execute_scriptfunction</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute a HydPy script function.</span>

<span class="sd">    Function |execute_scriptfunction| is indirectly applied and explained in the</span>
<span class="sd">    documentation on module |hyd|.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logstyle</span> <span class="o">=</span> <span class="s2">&quot;plain&quot;</span>
    <span class="n">logfilepath</span> <span class="o">=</span> <span class="n">prepare_logfile</span><span class="p">(</span><span class="s2">&quot;stdout&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">args_given</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">kwargs_given</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">args_given</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">parse_argument</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">args_given</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">kwargs_given</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">logfilepath</span> <span class="o">=</span> <span class="n">prepare_logfile</span><span class="p">(</span><span class="n">kwargs_given</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;logfile&quot;</span><span class="p">,</span> <span class="s2">&quot;stdout&quot;</span><span class="p">))</span>
        <span class="n">logstyle</span> <span class="o">=</span> <span class="n">kwargs_given</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;logstyle&quot;</span><span class="p">,</span> <span class="s2">&quot;plain&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">funcname</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">args_given</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The first positional argument defining the function to be called is &quot;</span>
                <span class="s2">&quot;missing.&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">hydpy</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">scriptfunctions</span><span class="p">[</span><span class="n">funcname</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">available_funcs</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">enumeration</span><span class="p">(</span>
                <span class="nb">sorted</span><span class="p">(</span><span class="n">hydpy</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">scriptfunctions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;There is no `</span><span class="si">{</span><span class="n">funcname</span><span class="si">}</span><span class="s2">` function callable by `hyd.py`.  Choose one &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;of the following instead: </span><span class="si">{</span><span class="n">available_funcs</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>
        <span class="n">argspec</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getfullargspec</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="n">args_possible</span> <span class="o">=</span> <span class="n">argspec</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argspec</span><span class="o">.</span><span class="n">defaults</span><span class="p">:</span>
            <span class="n">args_required</span> <span class="o">=</span> <span class="n">args_possible</span><span class="p">[:</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">argspec</span><span class="o">.</span><span class="n">defaults</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">args_required</span> <span class="o">=</span> <span class="n">args_possible</span>
        <span class="n">nmb_args_possible</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args_possible</span><span class="p">)</span>
        <span class="n">nmb_args_required</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args_required</span><span class="p">)</span>
        <span class="n">nmb_args_given</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args_given</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nmb_args_given</span> <span class="o">&lt;</span> <span class="n">nmb_args_required</span> <span class="ow">or</span> <span class="n">nmb_args_given</span> <span class="o">&gt;</span> <span class="n">nmb_args_possible</span><span class="p">:</span>
            <span class="n">enum_args_given</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">nmb_args_given</span><span class="p">:</span>
                <span class="n">enum_args_given</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="n">objecttools</span><span class="o">.</span><span class="n">enumeration</span><span class="p">(</span><span class="n">args_given</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="k">if</span> <span class="n">nmb_args_given</span> <span class="o">&lt;</span> <span class="n">nmb_args_required</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="n">args_required</span>
                <span class="n">nmb_args</span> <span class="o">=</span> <span class="n">nmb_args_required</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="s2">&quot;requires&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="n">args_possible</span>
                <span class="n">nmb_args</span> <span class="o">=</span> <span class="n">nmb_args_possible</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="s2">&quot;allows&quot;</span>
            <span class="n">enum_args</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">nmb_args</span><span class="p">:</span>
                <span class="n">enum_args</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="n">objecttools</span><span class="o">.</span><span class="n">enumeration</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Function `</span><span class="si">{</span><span class="n">funcname</span><span class="si">}</span><span class="s2">` </span><span class="si">{</span><span class="n">condition</span><span class="si">}</span><span class="s2"> `</span><span class="si">{</span><span class="n">nmb_args</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">` &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;positional arguments</span><span class="si">{</span><span class="n">enum_args</span><span class="si">}</span><span class="s2">, but &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">nmb_args_given</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">` are given</span><span class="si">{</span><span class="n">enum_args_given</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">with</span> <span class="n">_activate_logfile</span><span class="p">(</span><span class="n">logfilepath</span><span class="p">,</span> <span class="n">logstyle</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args_given</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_given</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">logstyle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">LogFileInterface</span><span class="o">.</span><span class="n">style2infotype2string</span><span class="p">:</span>
            <span class="n">logstyle</span> <span class="o">=</span> <span class="s2">&quot;plain&quot;</span>
        <span class="k">with</span> <span class="n">_activate_logfile</span><span class="p">(</span><span class="n">logfilepath</span><span class="p">,</span> <span class="n">logstyle</span><span class="p">,</span> <span class="s2">&quot;exception&quot;</span><span class="p">,</span> <span class="s2">&quot;exception&quot;</span><span class="p">):</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">nmb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nmb</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">argphrase</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;with arguments `</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="si">}</span><span class="s2">`&quot;</span>
            <span class="k">elif</span> <span class="n">nmb</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">argphrase</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;with argument `</span><span class="si">{</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">`&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">argphrase</span> <span class="o">=</span> <span class="s2">&quot;without arguments&quot;</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invoking hyd.py </span><span class="si">{</span><span class="n">argphrase</span><span class="si">}</span><span class="s2"> resulted in the following error:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">See the following stack traceback for debugging:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">traceback</span><span class="o">.</span><span class="n">print_tb</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">return</span> <span class="mi">1</span></div>



<div class="viewcode-block" id="LogFileInterface">
<a class="viewcode-back" href="../../../commandtools.html#hydpy.exe.commandtools.LogFileInterface">[docs]</a>
<span class="k">class</span> <span class="nc">LogFileInterface</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wraps a usual file object, exposing all its methods while modifying only the</span>
<span class="sd">    `write` method.</span>

<span class="sd">    At the moment, class |LogFileInterface| supports only two log styles, as explained</span>
<span class="sd">    in the documentation on module |hyd|.  The following example shows its basic</span>
<span class="sd">    usage:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy import TestIO</span>
<span class="sd">    &gt;&gt;&gt; from hydpy.exe.commandtools import LogFileInterface</span>
<span class="sd">    &gt;&gt;&gt; with TestIO():</span>
<span class="sd">    ...     logfile = open(&quot;test.log&quot;, &quot;w&quot;)</span>
<span class="sd">    &gt;&gt;&gt; lfi = LogFileInterface(</span>
<span class="sd">    ...     logfile, logstyle=&quot;prefixed&quot;, infotype=&quot;exception&quot;)</span>
<span class="sd">    &gt;&gt;&gt; lfi.write(&quot;a message\\n&quot;)</span>
<span class="sd">    &gt;&gt;&gt; lfi.write(&quot;another message\\n&quot;)</span>
<span class="sd">    &gt;&gt;&gt; lfi.close()</span>
<span class="sd">    &gt;&gt;&gt; with TestIO():</span>
<span class="sd">    ...     with open(&quot;test.log&quot;, &quot;r&quot;) as logfile:</span>
<span class="sd">    ...         print(logfile.read())</span>
<span class="sd">    error: a message</span>
<span class="sd">    error: another message</span>
<span class="sd">    &lt;BLANKLINE&gt;</span>

<span class="sd">    The class member `style2infotype2string` defines the currently available log styles.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">style2infotype2string</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;plain&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;exception&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">},</span>
        <span class="s2">&quot;prefixed&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="s2">&quot;info: &quot;</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">:</span> <span class="s2">&quot;warning: &quot;</span><span class="p">,</span> <span class="s2">&quot;exception&quot;</span><span class="p">:</span> <span class="s2">&quot;error: &quot;</span><span class="p">},</span>
    <span class="p">}</span>

    <span class="n">logfile</span><span class="p">:</span> <span class="n">TextIO</span>
    <span class="n">infotype</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">,</span> <span class="s2">&quot;exception&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">logfile</span><span class="p">:</span> <span class="n">TextIO</span><span class="p">,</span>
        <span class="n">logstyle</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">infotype</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">,</span> <span class="s2">&quot;exception&quot;</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logfile</span> <span class="o">=</span> <span class="n">logfile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_infotype</span> <span class="o">=</span> <span class="n">infotype</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">stdtype2string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style2infotype2string</span><span class="p">[</span><span class="n">logstyle</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">styles</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">enumeration</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style2infotype2string</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The given log file style </span><span class="si">{</span><span class="n">logstyle</span><span class="si">}</span><span class="s2"> is not available.  &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Please choose one of the following: </span><span class="si">{</span><span class="n">styles</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_string</span> <span class="o">=</span> <span class="n">stdtype2string</span><span class="p">[</span><span class="n">infotype</span><span class="p">]</span>

<div class="viewcode-block" id="LogFileInterface.write">
<a class="viewcode-back" href="../../../commandtools.html#hydpy.exe.commandtools.LogFileInterface.write">[docs]</a>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write the given string as explained in the main documentation on class</span>
<span class="sd">        |LogFileInterface|.&quot;&quot;&quot;</span>
        <span class="n">substrings</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_string</span><span class="si">}{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">s</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">substrings</span><span class="p">))</span></div>


    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></div>



<div class="viewcode-block" id="parse_argument">
<a class="viewcode-back" href="../../../commandtools.html#hydpy.exe.commandtools.parse_argument">[docs]</a>
<span class="k">def</span> <span class="nf">parse_argument</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a single value for a string understood as a positional argument or a</span>
<span class="sd">    |tuple| containing a keyword and its value for a string understood as a keyword</span>
<span class="sd">    argument.</span>

<span class="sd">    |parse_argument| is intended to be used as a helper function for function</span>
<span class="sd">    |execute_scriptfunction| only.  See the following examples to see which types of</span>
<span class="sd">    keyword arguments |execute_scriptfunction| covers:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy.exe.commandtools import parse_argument</span>
<span class="sd">    &gt;&gt;&gt; parse_argument(&quot;x=3&quot;)</span>
<span class="sd">    (&#39;x&#39;, &#39;3&#39;)</span>
<span class="sd">    &gt;&gt;&gt; parse_argument(&#39;&quot;x=3&quot;&#39;)</span>
<span class="sd">    &#39;&quot;x=3&quot;&#39;</span>
<span class="sd">    &gt;&gt;&gt; parse_argument(&quot;&#39;x=3&#39;&quot;)</span>
<span class="sd">    &quot;&#39;x=3&#39;&quot;</span>
<span class="sd">    &gt;&gt;&gt; parse_argument(&#39;x=&quot;3==3&quot;&#39;)</span>
<span class="sd">    (&#39;x&#39;, &#39;&quot;3==3&quot;&#39;)</span>
<span class="sd">    &gt;&gt;&gt; parse_argument(&quot;x=&#39;3==3&#39;&quot;)</span>
<span class="sd">    (&#39;x&#39;, &quot;&#39;3==3&#39;&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">idx_equal</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">idx_equal</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string</span>
    <span class="n">idx_quote</span> <span class="o">=</span> <span class="n">idx_equal</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">quote</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">quote</span><span class="p">)</span>
        <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="n">idx_quote</span><span class="p">:</span>
            <span class="n">idx_quote</span> <span class="o">=</span> <span class="n">idx</span>
    <span class="k">if</span> <span class="n">idx_equal</span> <span class="o">&lt;</span> <span class="n">idx_quote</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string</span><span class="p">[:</span><span class="n">idx_equal</span><span class="p">],</span> <span class="n">string</span><span class="p">[</span><span class="n">idx_equal</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
    <span class="k">return</span> <span class="n">string</span></div>



<div class="viewcode-block" id="print_textandtime">
<a class="viewcode-back" href="../../../commandtools.html#hydpy.exe.commandtools.print_textandtime">[docs]</a>
<span class="k">def</span> <span class="nf">print_textandtime</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print the given string and the current date and time with high precision for</span>
<span class="sd">    logging purposes.</span>

<span class="sd">    &gt;&gt;&gt; from hydpy.exe.commandtools import print_textandtime</span>
<span class="sd">    &gt;&gt;&gt; from hydpy.core.testtools import mock_datetime_now</span>
<span class="sd">    &gt;&gt;&gt; from datetime import datetime</span>
<span class="sd">    &gt;&gt;&gt; with mock_datetime_now(datetime(2000, 1, 1, 12, 30, 0, 123456)):</span>
<span class="sd">    ...     print_textandtime(&quot;something happens&quot;)</span>
<span class="sd">    something happens (2000-01-01 12:30:00.123456).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">timestring</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S.</span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">timestring</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span></div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">HydPy 5.0.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">hydpy.exe.commandtools</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2023, HydPy Developers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>
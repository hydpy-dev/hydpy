# -*- coding: utf-8 -*-
# pylint: disable=line-too-long, unused-wildcard-import
"""
|snow_cnhyst| differs from |snow_cn| only in the approach to building up and breaking
down the snowpack. Whereas in |snow_cn| the build-up and decay is uniform, in
|snow_cnhyst| a hysteresis effect comes into play that is intended to take into
account the age of the snow cover.

.. _snow_cnhyst_integration_tests:

Integration tests
=================

.. how_to_understand_integration_tests::

The setup of this example is the same as the |snow_cnhyst| example. The difference is
the additional declaration of the parameters |CN3| and |CN4| and additional state
|GLocalMax|.

>>> from hydpy import pub
>>> pub.timegrids = '01.04.1990', '01.06.1990', '1d'

>>> from hydpy.models.snow_cnhyst import *
>>> parameterstep('1d')

>>> from hydpy import Node, Element
>>> land = Element('land')
>>> land.model = model

>>> from hydpy import IntegrationTest
>>> test = IntegrationTest(land)
>>> test.dateformat = '%d.%m.'


.. _snow_cnhyst.py_ex1:

Example 1
_____________

Set control parameters:

>>> cn1(0.962)
>>> cn2(2.249)
>>> cn3(100)
>>> cn4(0.4)
>>> zinputs(577)
>>> nsnowlayers(5)
>>> layerarea(0.2)
>>> zlayers(hypsodata=[
...     286, 309, 320, 327, 333, 338, 342, 347, 351, 356, 360, 365, 369, 373, 378, 382, 387, 393, 399,
...     405, 411, 417, 423, 428, 434, 439, 443, 448, 453, 458, 463, 469, 474, 480, 485, 491, 496, 501, 507,
...     513, 519, 524, 530, 536, 542, 548, 554, 560, 566, 571, 577, 583, 590, 596, 603, 609, 615, 622, 629,
...     636, 642, 649, 656, 663, 669, 677, 684, 691, 698, 706, 714, 722, 730, 738, 746, 754, 762, 770, 777,
...     786, 797, 808, 819, 829, 841, 852, 863, 875, 887, 901, 916, 934, 952, 972, 994, 1012, 1029, 1054, 1080,
...     1125, 1278])
>>> gradp(0.00041)
>>> meanansolidprecip(83., 83., 83., 83., 83.)
>>> parameters.update()
>>> zlayers
zlayers(360.0, 463.0, 577.0, 714.0, 916.0)
>>> derived.gthresh
gthresh(33.2)

Define temperature gradient for each day in year for France according to
:cite:t:`ref-Valery`.

>>> gradtmean(0.434, 0.434, 0.435, 0.436, 0.437, 0.439, 0.44, 0.441, 0.442, 0.444, 0.445, 0.446, 0.448,
...     0.45, 0.451, 0.453, 0.455, 0.456, 0.458, 0.46, 0.462, 0.464, 0.466, 0.468, 0.47, 0.472,
...     0.474, 0.476, 0.478, 0.48, 0.483, 0.485, 0.487, 0.489, 0.492, 0.494, 0.496, 0.498, 0.501,
...     0.503, 0.505, 0.508, 0.51, 0.512, 0.515, 0.517, 0.519, 0.522, 0.524, 0.526, 0.528, 0.53, 0.533,
...     0.535, 0.537, 0.539, 0.541, 0.543, 0.545, 0.546, 0.547, 0.549, 0.551, 0.553, 0.555, 0.557, 0.559,
...     0.56, 0.562, 0.564, 0.566, 0.567, 0.569, 0.57, 0.572, 0.573, 0.575, 0.576, 0.577, 0.579, 0.58, 0.581,
...     0.582, 0.583, 0.584, 0.585, 0.586, 0.587, 0.588, 0.589, 0.59, 0.591, 0.591, 0.592, 0.593, 0.593,
...     0.594, 0.595, 0.595, 0.596, 0.596, 0.597, 0.597, 0.597, 0.598, 0.598, 0.598, 0.599, 0.599, 0.599,
...     0.599, 0.6, 0.6, 0.6, 0.6, 0.6, 0.601, 0.601, 0.601, 0.601, 0.601, 0.601, 0.601, 0.601, 0.601, 0.601,
...     0.601, 0.601, 0.601, 0.601, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602,
...     0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602,
...     0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.602,
...     0.602, 0.602, 0.602, 0.602, 0.602, 0.602, 0.601, 0.601, 0.601, 0.601, 0.601, 0.601, 0.6, 0.6, 0.6, 0.6,
...     0.599, 0.599, 0.599, 0.598, 0.598, 0.598, 0.597, 0.597, 0.597, 0.596, 0.596, 0.595, 0.595, 0.594, 0.594,
...     0.593, 0.593, 0.592, 0.592, 0.591, 0.59, 0.59, 0.589, 0.588, 0.588, 0.587, 0.586, 0.586, 0.585, 0.584,
...     0.583, 0.583, 0.582, 0.581, 0.58, 0.579, 0.578, 0.578, 0.577, 0.576, 0.575, 0.574, 0.573, 0.572, 0.571,
...     0.57, 0.569, 0.569, 0.568, 0.567, 0.566, 0.565, 0.564, 0.563, 0.562, 0.561, 0.56, 0.558, 0.557, 0.556,
...     0.555, 0.554, 0.553, 0.552, 0.551, 0.55, 0.549, 0.548, 0.546, 0.545, 0.544, 0.543, 0.542, 0.541, 0.54,
...     0.538, 0.537, 0.536, 0.535, 0.533, 0.532, 0.531, 0.53, 0.528, 0.527, 0.526, 0.525, 0.523, 0.522, 0.521,
...     0.519, 0.518, 0.517, 0.515, 0.514, 0.512, 0.511, 0.51, 0.508, 0.507, 0.505, 0.504, 0.502, 0.501, 0.499,
...     0.498, 0.496, 0.495, 0.493, 0.492, 0.49, 0.489, 0.487, 0.485, 0.484, 0.482, 0.481, 0.479, 0.478, 0.476,
...     0.475, 0.473, 0.471, 0.47, 0.468, 0.467, 0.465, 0.464, 0.462, 0.461, 0.459, 0.458, 0.456, 0.455, 0.454,
...     0.452, 0.451, 0.45, 0.448, 0.447, 0.446, 0.445, 0.443, 0.442, 0.441, 0.44, 0.439, 0.438, 0.437, 0.436,
...     0.435, 0.434, 0.434, 0.433, 0.432, 0.431, 0.431, 0.43, 0.43, 0.429, 0.429, 0.429, 0.428, 0.428, 0.428,
...     0.428, 0.428, 0.428, 0.428, 0.428, 0.429, 0.429, 0.429, 0.43, 0.43, 0.431, 0.431, 0.432, 0.433)

For simplicity, we set the initial conditions to 0:

>>> test.inits = ((states.g, [0.0, 0.0, 0.0, 0.0, 0.0]),
...               (states.etg, [0.0, 0.0, 0.0, 0.0, 0.0]),
...               (states.gratio, [0.0, 0.0, 0.0, 0.0, 0.0]),
...               (logs.glocalmax, derived.gthresh))

Time series for precipitation and temperature were taken from the sample data set:

>>> inputs.p.series = (
...     0.4,  0. ,  1. ,  1.6,  3.1,  0. ,  0. ,  0. ,  0. ,  2.4,  2.1,
...     0.8,  8.4, 16.1,  2.9,  0. ,  0.4, 12.2,  8.8,  6.3,  2.5,  0. ,
...     0. ,  1.7,  2.5,  9.9,  7.5,  0.3,  6.3,  4.6,  1.1,  0. ,  0. ,
...     0. ,  0.4,  9.1,  0. , 13.4,  4. ,  0. ,  0. ,  8.6,  5.3,  2.5,
...     1.8,  0. ,  2.4, 13.3,  5.8,  4.3, 20. ,  9.8,  2.1,  1.6,  3.7,
...     0.2,  0. ,  0. ,  0.1,  0.7,  2.2)
>>> inputs.t.series = (
...     7.2,  7.1,  6.4,  7.4,  7.5,  4.3,  3.5,  3.5,  4.5,  5. ,  1.9,
...     1.8,  3. ,  1.3,  0.2,  1.8,  1.5,  3.7,  7.4,  7.6,  5.8,  6. ,
...     8.1,  8.1,  8.6,  8.7,  6.6,  8.8,  9.6,  9.2,  7.8,  8. , 10.6,
...    13.8, 12.1,  7.7,  7. , 10. ,  9.1, 11.3,  6.6,  7.4,  5.9,  7.6,
...     9.2, 11.8, 13.8, 12.1, 10.8, 11.7, 11.1,  7.3,  8. , 10.3,  8. ,
...    10.4, 14. , 14.2, 14.9, 15.6, 16.3)

.. integration-test::

    >>> test.reset_inits()
    >>> conditions = sequences.conditions

    >>> test("snow_cnhyst_ex1", axis1=(fluxes.player, fluxes.pnetlayer), axis2=states.g)
    |   date |    p |    t |                                                player |                                          psnowlayer |                                             prainlayer |                                       tlayer |                                      solidfraction |                                            potmelt |                                              melt |                                             pnetlayer |      pnet |                                                  g |                                 etg |                                           gratio |
    ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 01.04. |  0.4 |  7.2 |  0.360463   0.376011   0.394003   0.416768   0.452754 |      0.0       0.0       0.0        0.0         0.0 |  0.360463   0.376011   0.394003   0.416768    0.452754 |  8.48247   7.87374   7.2   6.39033   5.19651 |      0.0       0.0    0.0       0.0            0.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0       0.0        0.0 |  0.360463   0.376011   0.394003   0.416768   0.452754 |       0.4 |      0.0       0.0       0.0        0.0        0.0 | 0.0  0.0  0.0        0.0        0.0 |      0.0       0.0       0.0       0.0       0.0 |
    | 02.04. |  0.0 |  7.1 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 |  8.38247   7.77374   7.1   6.29033   5.09651 |      0.0       0.0    0.0       0.0            0.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0       0.0        0.0 |       0.0        0.0        0.0        0.0        0.0 |       0.0 |      0.0       0.0       0.0        0.0        0.0 | 0.0  0.0  0.0        0.0        0.0 |      0.0       0.0       0.0       0.0       0.0 |
    | 03.04. |  1.0 |  6.4 |  0.901158   0.940029   0.985008    1.04192   1.131886 |      0.0       0.0       0.0        0.0         0.0 |  0.901158   0.940029   0.985008    1.04192    1.131886 |  7.68464   7.07488   6.4   5.58896   4.39312 |      0.0       0.0    0.0       0.0            0.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0       0.0        0.0 |  0.901158   0.940029   0.985008    1.04192   1.131886 |       1.0 |      0.0       0.0       0.0        0.0        0.0 | 0.0  0.0  0.0        0.0        0.0 |      0.0       0.0       0.0       0.0       0.0 |
    | 04.04. |  1.6 |  7.4 |  1.441852   1.504046   1.576014   1.667072   1.811017 |      0.0       0.0       0.0        0.0         0.0 |  1.441852   1.504046   1.576014   1.667072    1.811017 |  8.68681   8.07602   7.4   6.58759   5.38973 |      0.0       0.0    0.0       0.0            0.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0       0.0        0.0 |  1.441852   1.504046   1.576014   1.667072   1.811017 |       1.6 |      0.0       0.0       0.0        0.0        0.0 | 0.0  0.0  0.0        0.0        0.0 |      0.0       0.0       0.0       0.0       0.0 |
    | 05.04. |  3.1 |  7.5 |  2.793589   2.914088   3.053526   3.229951   3.508845 |      0.0       0.0       0.0        0.0         0.0 |  2.793589   2.914088   3.053526   3.229951    3.508845 |  8.78681   8.17602   7.5   6.68759   5.48973 |      0.0       0.0    0.0       0.0            0.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0       0.0        0.0 |  2.793589   2.914088   3.053526   3.229951   3.508845 |       3.1 |      0.0       0.0       0.0        0.0        0.0 | 0.0  0.0  0.0        0.0        0.0 |      0.0       0.0       0.0       0.0       0.0 |
    | 06.04. |  0.0 |  4.3 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 |  5.58898   4.97716   4.3   3.48622   2.28634 |      0.0       0.0    0.0       0.0       0.178415 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0       0.0        0.0 |       0.0        0.0        0.0        0.0        0.0 |       0.0 |      0.0       0.0       0.0        0.0        0.0 | 0.0  0.0  0.0        0.0        0.0 |      0.0       0.0       0.0       0.0       0.0 |
    | 07.04. |  0.0 |  3.5 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 |  4.79115    4.1783   3.5   2.68485   1.48295 |      0.0       0.0    0.0  0.078788       0.379262 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0       0.0        0.0 |       0.0        0.0        0.0        0.0        0.0 |       0.0 |      0.0       0.0       0.0        0.0        0.0 | 0.0  0.0  0.0        0.0        0.0 |      0.0       0.0       0.0       0.0       0.0 |
    | 08.04. |  0.0 |  3.5 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 |  4.79115    4.1783   3.5   2.68485   1.48295 |      0.0       0.0    0.0  0.078788       0.379262 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0       0.0        0.0 |       0.0        0.0        0.0        0.0        0.0 |       0.0 |      0.0       0.0       0.0        0.0        0.0 | 0.0  0.0  0.0        0.0        0.0 |      0.0       0.0       0.0       0.0       0.0 |
    | 09.04. |  0.0 |  4.5 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 |  5.79332   5.17944   4.5   3.68348   2.47956 |      0.0       0.0    0.0       0.0        0.13011 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0       0.0        0.0 |       0.0        0.0        0.0        0.0        0.0 |       0.0 |      0.0       0.0       0.0        0.0        0.0 | 0.0  0.0  0.0        0.0        0.0 |      0.0       0.0       0.0       0.0       0.0 |
    | 10.04. |  2.4 |  5.0 |  2.162778   2.256068    2.36402   2.500607   2.716525 |      0.0       0.0       0.0        0.0    0.013881 |  2.162778   2.256068    2.36402   2.500607    2.702644 |  6.29332   5.67944   5.0   4.18348   2.97956 |      0.0       0.0    0.0       0.0        0.00511 |      0.0       0.0       0.0        0.0   0.013881 |      0.0       0.0       0.0       0.0   0.001393 |  2.162778   2.256068    2.36402   2.500607   2.704037 |  2.397502 |      0.0       0.0       0.0        0.0   0.012488 | 0.0  0.0  0.0        0.0        0.0 |      0.0       0.0       0.0       0.0  0.000543 |
    | 11.04. |  2.1 |  1.9 |  1.892431    1.97406   2.068518   2.188031    2.37696 |      0.0   0.20699  0.568842   1.049101    1.856305 |  1.892431    1.76707   1.499675   1.138931    0.520655 |  3.19549   2.58058   1.9   1.08211  -0.12383 |      0.0  0.104855  0.275  0.479473       0.780957 |      0.0   0.20699  0.568842   1.049101        0.0 |      0.0   0.02186  0.065656  0.134746        0.0 |  1.892431    1.78893   1.565331   1.273677   0.520655 |  1.408205 |      0.0   0.18513  0.503186   0.914355   1.868793 | 0.0  0.0  0.0        0.0  -0.004706 |      0.0  0.008086  0.022166  0.040743  0.019106 |
    | 12.04. |  0.8 |  1.8 |  0.720926   0.752023   0.788007   0.833536   0.905508 |      0.0  0.097654  0.236402   0.420496    0.729801 |  0.720926   0.654369   0.551605    0.41304    0.175707 |  3.09549   2.48058   1.8   0.98211  -0.22383 |      0.0  0.129855    0.3  0.504472       0.805957 |      0.0  0.282784  0.739588   1.334851        0.0 |      0.0  0.030446  0.088787  0.181788        0.0 |  0.720926   0.684815   0.640392   0.594828   0.175707 |  0.563333 |      0.0  0.252337  0.650801   1.153063   2.598594 | 0.0  0.0  0.0        0.0  -0.013032 |      0.0   0.00919  0.023753  0.042593  0.026404 |
    | 13.04. |  8.4 |  3.0 |  7.569724    7.89624   8.274071   8.752126   9.507839 |      0.0       0.0       0.0   1.789569    4.810563 |  7.569724    7.89624   8.274071   6.962557    4.697277 |  4.29549   3.68058   3.0   2.18211   0.97617 |      0.0       0.0    0.0  0.204473       0.505957 |      0.0  0.252337  0.650801   2.942632   2.195406 |      0.0   0.02696  0.076562  0.528997   0.660489 |  7.569724   7.923199   8.350633   7.491554   5.357766 |  7.338575 |      0.0  0.225378   0.57424   2.413635   6.748667 | 0.0  0.0  0.0        0.0        0.0 |      0.0  0.006788  0.017296  0.101239  0.264668 |
    | 14.04. | 16.1 |  1.3 | 14.508638  15.134459  15.858636  16.774908  18.223359 | 1.459351  3.852779   6.73992  10.565089   16.980617 | 13.049287   11.28168   9.118716   6.209819    1.242742 |  2.59766   1.98172   1.3   0.48074  -0.72722 | 0.100585   0.25457  0.425  0.629815       0.931805 | 1.459351  4.078157    2.9237   1.081184        0.0 | 0.203668  0.858666  0.872068  0.488515        0.0 | 13.252955  12.140346   9.990784   6.698334   1.242742 |  8.665032 | 1.255683  3.219491  6.442092  12.490209  23.729284 | 0.0  0.0  0.0        0.0  -0.027634 | 0.056513  0.152777  0.278985  0.491691  0.434474 |
    | 15.04. |  2.9 |  0.2 |  2.613357   2.726083   2.856524   3.021567   3.282468 | 0.981538  1.443652  1.999567   2.733959    3.282468 |  1.631819   1.282431   0.856957   0.287608         0.0 |  1.49766   0.88172   0.2  -0.61926  -1.82722 | 0.375585   0.52957    0.7  0.904815            1.0 | 2.237221  1.982988    0.4498        0.0        0.0 | 0.359404  0.448969  0.147912       0.0        0.0 |  1.991224     1.7314    1.00487   0.287608        0.0 |   1.00302 | 1.877817  4.214173  8.293747  15.224168  27.011752 | 0.0  0.0  0.0  -0.023532  -0.096019 | 0.073608  0.150403  0.272783  0.519031  0.467299 |
    | 16.04. |  0.0 |  1.8 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 |  3.09766   2.48172   1.8   0.98074  -0.22722 |      0.0   0.12957    0.3  0.504815       0.806805 | 1.877817  4.214173    4.0482   2.205684        0.0 | 0.283371  0.902843  1.314979  1.130862        0.0 |  0.283371   0.902843   1.314979   1.130862        0.0 |  0.726411 | 1.594446   3.31133  6.978768  14.093307  27.011752 | 0.0  0.0  0.0        0.0  -0.101004 | 0.048025  0.099739  0.210204  0.424497  0.467299 |
    | 17.04. |  0.4 |  1.5 |  0.360463   0.376011   0.394003   0.416768   0.452754 | 0.018038  0.076813  0.147751   0.241791    0.399625 |  0.342425   0.299198   0.246252   0.174977     0.05313 |  2.79983   2.18286   1.5   0.67937  -0.53061 | 0.050042  0.204285  0.375  0.580157       0.882652 | 1.612484  3.388144    3.3735   1.527903        0.0 | 0.231733  0.650006  0.989072  0.746537        0.0 |  0.574158   0.949204   1.235324   0.921513    0.05313 |  0.746666 | 1.380751  2.738138  6.137447  13.588561  27.411377 | 0.0  0.0  0.0        0.0  -0.117329 | 0.041589  0.082474  0.184863  0.409294  0.471295 |
    | 18.04. | 12.2 |  3.7 | 10.994123  11.468348  12.017103  12.711421  13.809005 |      0.0       0.0       0.0   0.383345      4.5936 | 10.994123  11.468348  12.017103  12.328076    9.215405 |  4.99983   4.38286   3.7   2.87937   1.66939 |      0.0       0.0    0.0  0.030157       0.332652 | 1.380751  2.738138  6.137447   6.475703        0.0 | 0.189757  0.477056  1.634872  3.100285        0.0 |  11.18388  11.945404  13.651975  15.428361   9.215405 | 12.285005 | 1.190994  2.261081  4.502575  10.871621  32.004977 | 0.0  0.0  0.0        0.0  -0.049434 | 0.035873  0.068105   0.13562  0.327458  0.517231 |
    | 19.04. |  8.8 |  7.4 |  7.930187   8.272251   8.668074   9.168894   9.960593 |      0.0       0.0       0.0        0.0         0.0 |  7.930187   8.272251   8.668074   9.168894    9.960593 |  8.69983   8.08286   7.4   6.57937   5.36939 |      0.0       0.0    0.0       0.0            0.0 | 1.190994  2.261081  4.502575  10.871621  12.075758 | 0.157552    0.3647  0.999832  4.291166  11.684561 |  8.087739   8.636951   9.667906   13.46006  21.645155 | 12.299562 | 1.033442  1.896382  3.502743   6.580455  20.320415 | 0.0  0.0  0.0        0.0        0.0 | 0.031128   0.05712  0.105504  0.198206  0.612061 |
    | 20.04. |  6.3 |  7.6 |  5.677293    5.92218   6.205553   6.564094   7.130879 |      0.0       0.0       0.0        0.0         0.0 |  5.677293    5.92218   6.205553   6.564094    7.130879 |  8.89983   8.28286   7.6   6.77937   5.56939 |      0.0       0.0    0.0       0.0            0.0 | 1.033442  1.896382  3.502743   6.580455  12.525558 | 0.132296  0.287127  0.682873  1.831905   8.152318 |  5.809589   6.209307   6.888427      8.396  15.283197 |  8.517304 | 0.901146  1.609254   2.81987    4.74855  12.168098 | 0.0  0.0  0.0        0.0        0.0 | 0.027143  0.048472  0.084936  0.143029  0.366509 |
    | 21.04. |  2.5 |  5.8 |  2.252894   2.350071   2.462521   2.604799   2.829714 |      0.0       0.0       0.0        0.0         0.0 |  2.252894   2.350071   2.462521   2.604799    2.829714 |    7.102     6.484   5.8     4.978     3.766 |      0.0       0.0    0.0       0.0            0.0 | 0.901146  1.609254   2.81987    4.74855   8.469734 | 0.112128  0.231128  0.497544  1.086116   3.640784 |  2.365023   2.581199   2.960065   3.690915   6.470498 |   3.61354 | 0.789018  1.378126  2.322326   3.662434   8.527314 | 0.0  0.0  0.0        0.0        0.0 | 0.023766   0.04151   0.06995  0.110314  0.256847 |
    | 22.04. |  0.0 |  6.0 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 |    7.302     6.684   6.0     5.178     3.966 |      0.0       0.0    0.0       0.0            0.0 | 0.789018  1.378126  2.322326   3.662434   8.527314 | 0.095778  0.189298  0.378434   0.72986   2.823924 |  0.095778   0.189298   0.378434    0.72986   2.823924 |  0.843459 |  0.69324  1.188828  1.943892   2.932574   5.703391 | 0.0  0.0  0.0        0.0        0.0 | 0.020881  0.035808  0.058551  0.088331  0.171789 |
    | 23.04. |  0.0 |  8.1 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 |    9.402     8.784   8.1     7.278     6.066 |      0.0       0.0    0.0       0.0            0.0 |  0.69324  1.188828  1.943892   2.932574   5.703391 | 0.082352  0.157196  0.296824   0.52639    1.45214 |  0.082352   0.157196   0.296824    0.52639    1.45214 |   0.50298 | 0.610888  1.031633  1.647068   2.406184    4.25125 | 0.0  0.0  0.0        0.0        0.0 |   0.0184  0.031073   0.04961  0.072475   0.12805 |
    | 24.04. |  1.7 |  8.1 |  1.531968   1.598048   1.674514   1.771264   1.924206 |      0.0       0.0       0.0        0.0         0.0 |  1.531968   1.598048   1.674514   1.771264    1.924206 |    9.402     8.784   8.1     7.278     6.066 |      0.0       0.0    0.0       0.0            0.0 | 0.610888  1.031633  1.647068   2.406184    4.25125 | 0.071205  0.132014  0.238247  0.397569   0.915059 |  1.603173   1.730062   1.912762   2.168832   2.839265 |  2.050819 | 0.539683  0.899619   1.40882   2.008615   3.336191 | 0.0  0.0  0.0        0.0        0.0 | 0.016256  0.027097  0.042434    0.0605  0.100488 |
    | 25.04. |  2.5 |  8.6 |  2.252894   2.350071   2.462521   2.604799   2.829714 |      0.0       0.0       0.0        0.0         0.0 |  2.252894   2.350071   2.462521   2.604799    2.829714 |    9.902     9.284   8.6     7.778     6.566 |      0.0       0.0    0.0       0.0            0.0 | 0.539683  0.899619   1.40882   2.008615   3.336191 | 0.061864  0.111901  0.194686  0.310231   0.635341 |  2.314758   2.461972   2.657207   2.915031   3.465055 |  2.762805 | 0.477819  0.787718  1.214134   1.698384   2.700851 | 0.0  0.0  0.0        0.0        0.0 | 0.014392  0.023726   0.03657  0.051156  0.081351 |
    | 26.04. |  9.9 |  8.7 |  8.921461   9.306282   9.751584  10.315006  11.205668 |      0.0       0.0       0.0        0.0         0.0 |  8.921461   9.306282   9.751584  10.315006   11.205668 | 10.00417   9.38514   8.7   7.87663   6.66261 |      0.0       0.0    0.0       0.0            0.0 | 0.477819  0.787718  1.214134   1.698384   2.700851 | 0.053971  0.095593  0.161375  0.248033    0.46783 |  8.975432   9.401875   9.912958  10.563039  11.673498 |  10.10536 | 0.423848  0.692125   1.05276   1.450351    2.23302 | 0.0  0.0  0.0        0.0        0.0 | 0.012767  0.020847   0.03171  0.043685   0.06726 |
    | 27.04. |  7.5 |  6.6 |  6.758682   7.050214   7.387563   7.814398   8.489142 |      0.0       0.0       0.0        0.0         0.0 |  6.758682   7.050214   7.387563   7.814398    8.489142 |  7.90417   7.28514   6.6   5.77663   4.56261 |      0.0       0.0    0.0       0.0            0.0 | 0.423848  0.692125   1.05276   1.450351    2.23302 | 0.047255  0.082198   0.13532  0.202058   0.358475 |  6.805937   7.132412   7.522884   8.016456   8.847617 |  7.665061 | 0.376593  0.609927  0.917439   1.248293   1.874545 | 0.0  0.0  0.0        0.0        0.0 | 0.011343  0.018371  0.027634  0.037599  0.056462 |
    | 28.04. |  0.3 |  8.8 |  0.270347   0.282009   0.295503   0.312576   0.339566 |      0.0       0.0       0.0        0.0         0.0 |  0.270347   0.282009   0.295503   0.312576    0.339566 | 10.10417   9.48514   8.8   7.97663   6.76261 |      0.0       0.0    0.0       0.0            0.0 | 0.376593  0.609927  0.917439   1.248293   1.874545 | 0.041504  0.071077  0.114561  0.167071   0.282711 |  0.311851   0.353086   0.410063   0.479647   0.622277 |  0.435385 | 0.335089  0.538849  0.802878   1.081222   1.591834 | 0.0  0.0  0.0        0.0        0.0 | 0.010093   0.01623  0.024183  0.032567  0.047947 |
    | 29.04. |  6.3 |  9.6 |  5.677293    5.92218   6.205553   6.564094   7.130879 |      0.0       0.0       0.0        0.0         0.0 |  5.677293    5.92218   6.205553   6.564094    7.130879 | 10.90417  10.28514   9.6   8.77663   7.56261 |      0.0       0.0    0.0       0.0            0.0 | 0.335089  0.538849  0.802878   1.081222   1.591834 | 0.036553  0.061756  0.097762  0.139813   0.227874 |  5.713846   5.983936   6.303316   6.703908   7.358754 |  6.412752 | 0.298536  0.477093  0.705116   0.941409    1.36396 | 0.0  0.0  0.0        0.0        0.0 | 0.008992   0.01437  0.021238  0.028356  0.041083 |
    | 30.04. |  4.6 |  9.2 |  4.145325   4.324131   4.531039   4.792831   5.206674 |      0.0       0.0       0.0        0.0         0.0 |  4.145325   4.324131   4.531039   4.792831    5.206674 | 10.50417   9.88514   9.2   8.37663   7.16261 |      0.0       0.0    0.0       0.0            0.0 | 0.298536  0.477093  0.705116   0.941409    1.36396 |  0.03227   0.05388   0.08399  0.118166   0.186828 |  4.177595   4.378011   4.615028   4.910997   5.393502 |  4.695027 | 0.266267  0.423214  0.621126   0.823243   1.177131 | 0.0  0.0  0.0        0.0        0.0 |  0.00802  0.012747  0.018709  0.024796  0.035456 |
    | 01.05. |  1.1 |  7.8 |  0.991273   1.034031   1.083509   1.146112   1.245074 |      0.0       0.0       0.0        0.0         0.0 |  0.991273   1.034031   1.083509   1.146112    1.245074 |  9.10417   8.48514   7.8   6.97663   5.76261 |      0.0       0.0    0.0       0.0            0.0 | 0.266267  0.423214  0.621126   0.823243   1.177131 | 0.028549  0.047177  0.072571  0.100697   0.155276 |  1.019822   1.081208    1.15608   1.246808    1.40035 |  1.180854 | 0.237718  0.376037  0.548555   0.722547   1.021856 | 0.0  0.0  0.0        0.0        0.0 |  0.00716  0.011326  0.016523  0.021763  0.030779 |
    | 02.05. |  0.0 |  8.0 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 |  9.30417   8.68514   8.0   7.17663   5.96261 |      0.0       0.0    0.0       0.0            0.0 | 0.237718  0.376037  0.548555   0.722547   1.021856 | 0.025304  0.041437  0.063013  0.086407   0.130492 |  0.025304   0.041437   0.063013   0.086407   0.130492 |  0.069331 | 0.212414    0.3346  0.485543    0.63614   0.891364 | 0.0  0.0  0.0        0.0        0.0 | 0.006398  0.010078  0.014625  0.019161  0.026848 |
    | 03.05. |  0.0 | 10.6 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 | 11.90417  11.28514  10.6   9.77663   8.56261 |      0.0       0.0    0.0       0.0            0.0 | 0.212414    0.3346  0.485543    0.63614   0.891364 | 0.022465  0.036495  0.054945  0.074584   0.110675 |  0.022465   0.036495   0.054945   0.074584   0.110675 |  0.059833 |  0.18995  0.298105  0.430597   0.561556   0.780689 | 0.0  0.0  0.0        0.0        0.0 | 0.005721  0.008979   0.01297  0.016914  0.023515 |
    | 04.05. |  0.0 | 13.8 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 | 15.10417  14.48514  13.8  12.97663  11.76261 |      0.0       0.0    0.0       0.0            0.0 |  0.18995  0.298105  0.430597   0.561556   0.780689 | 0.019973   0.03222  0.048086  0.064704   0.094591 |  0.019973    0.03222   0.048086   0.064704   0.094591 |  0.051915 | 0.169977  0.265885  0.382511   0.496851   0.686098 | 0.0  0.0  0.0        0.0        0.0 |  0.00512  0.008009  0.011521  0.014965  0.020666 |
    | 05.05. |  0.4 | 12.1 |  0.360463   0.376011   0.394003   0.416768   0.452754 |      0.0       0.0       0.0        0.0         0.0 |  0.360463   0.376011   0.394003   0.416768    0.452754 | 13.40417  12.78514  12.1  11.27663  10.06261 |      0.0       0.0    0.0       0.0            0.0 | 0.169977  0.265885  0.382511   0.496851   0.686098 | 0.017781  0.028505  0.042218  0.056377   0.081371 |  0.378244   0.404516   0.436221   0.473145   0.534125 |   0.44525 | 0.152196   0.23738  0.340294   0.440474   0.604728 | 0.0  0.0  0.0        0.0        0.0 | 0.004584   0.00715   0.01025  0.013267  0.018215 |
    | 06.05. |  9.1 |  7.7 |  8.200535    8.55426   8.963577    9.48147  10.300159 |      0.0       0.0       0.0        0.0         0.0 |  8.200535    8.55426   8.963577    9.48147   10.300159 |  9.00417   8.38514   7.7   6.87663   5.66261 |      0.0       0.0    0.0       0.0            0.0 | 0.152196   0.23738  0.340294   0.440474   0.604728 | 0.015848  0.025266  0.037169  0.049307   0.070386 |  8.216382   8.579525   9.000745   9.530777  10.370545 |  9.139595 | 0.136348  0.212115  0.303125   0.391167   0.534341 | 0.0  0.0  0.0        0.0        0.0 | 0.004107  0.006389   0.00913  0.011782  0.016095 |
    | 07.05. |  0.0 |  7.0 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 |  8.30417   7.68514   7.0   6.17663   4.96261 |      0.0       0.0    0.0       0.0            0.0 | 0.136348  0.212115  0.303125   0.391167   0.534341 | 0.014139  0.022431  0.032803  0.043265   0.061174 |  0.014139   0.022431   0.032803   0.043265   0.061174 |  0.034762 |  0.12221  0.189684  0.270322   0.347903   0.473167 | 0.0  0.0  0.0        0.0        0.0 | 0.003681  0.005713  0.008142  0.010479  0.014252 |
    | 08.05. | 13.4 | 10.0 | 12.075513  12.596382  13.199113  13.961725  15.167267 |      0.0       0.0       0.0        0.0         0.0 | 12.075513  12.596382  13.199113  13.961725   15.167267 | 11.30417  10.68514  10.0   9.17663   7.96261 |      0.0       0.0    0.0       0.0            0.0 |  0.12221  0.189684  0.270322   0.347903   0.473167 | 0.012626  0.019944  0.029013  0.038071   0.053386 | 12.088138  12.616326  13.228126  13.999796  15.220653 | 13.430608 | 0.109584   0.16974  0.241309   0.309831   0.419781 | 0.0  0.0  0.0        0.0        0.0 | 0.003301  0.005113  0.007268  0.009332  0.012644 |
    | 09.05. |  4.0 |  9.1 |  3.604631   3.760114   3.940034   4.167679   4.527542 |      0.0       0.0       0.0        0.0         0.0 |  3.604631   3.760114   3.940034   4.167679    4.527542 | 10.40417   9.78514   9.1   8.27663   7.06261 |      0.0       0.0    0.0       0.0            0.0 | 0.109584   0.16974  0.241309   0.309831   0.419781 | 0.011284  0.017755  0.025709  0.033585   0.046755 |  3.615915   3.777869   3.965743   4.201264   4.574298 |  4.027018 |   0.0983  0.151985  0.215599   0.276246   0.373026 | 0.0  0.0  0.0        0.0        0.0 | 0.002961  0.004578  0.006494  0.008321  0.011236 |
    | 10.05. |  0.0 | 11.3 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 | 12.60634  11.98628  11.3  10.47526   9.25922 |      0.0       0.0    0.0       0.0            0.0 |   0.0983  0.151985  0.215599   0.276246   0.373026 | 0.010092  0.015825   0.02282  0.029693   0.041075 |  0.010092   0.015825    0.02282   0.029693   0.041075 |  0.023901 | 0.088208   0.13616  0.192779   0.246553   0.331952 | 0.0  0.0  0.0        0.0        0.0 | 0.002657  0.004101  0.005807  0.007426  0.009999 |
    | 11.05. |  0.0 |  6.6 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 |  7.90634   7.28628   6.6   5.77526   4.55922 |      0.0       0.0    0.0       0.0            0.0 | 0.088208   0.13616  0.192779   0.246553   0.331952 | 0.009032  0.014119  0.020285  0.026303   0.036182 |  0.009032   0.014119   0.020285   0.026303   0.036182 |  0.021184 | 0.079176  0.122042  0.172494   0.220249   0.295769 | 0.0  0.0  0.0        0.0        0.0 | 0.002385  0.003676  0.005196  0.006634  0.008909 |
    | 12.05. |  8.6 |  7.4 |  7.749956   8.084245   8.471073    8.96051   9.734216 |      0.0       0.0       0.0        0.0         0.0 |  7.749956   8.084245   8.471073    8.96051    9.734216 |  8.70634   8.08628   7.4   6.57526   5.35922 |      0.0       0.0    0.0       0.0            0.0 | 0.079176  0.122042  0.172494   0.220249   0.295769 | 0.008088  0.012608  0.018056   0.02334   0.031948 |  7.758043   8.096853   8.489129    8.98385   9.766165 |  8.618808 | 0.071089  0.109434  0.154438    0.19691   0.263821 | 0.0  0.0  0.0        0.0        0.0 | 0.002141  0.003296  0.004652  0.005931  0.007946 |
    | 13.05. |  5.3 |  5.9 |  4.776136   4.982151   5.220545   5.522175   5.998994 |      0.0       0.0       0.0        0.0         0.0 |  4.776136   4.982151   5.220545   5.522175    5.998994 |  7.20634   6.58628   5.9   5.07526   3.85922 |      0.0       0.0    0.0       0.0            0.0 | 0.071089  0.109434  0.154438    0.19691   0.263821 | 0.007246  0.011268   0.01609  0.020742   0.028269 |  4.783381   4.993419   5.236635   5.542917   6.027263 |  5.316723 | 0.063843  0.098166  0.138348   0.176167   0.235552 | 0.0  0.0  0.0        0.0        0.0 | 0.001923  0.002957  0.004167  0.005306  0.007095 |
    | 14.05. |  2.5 |  7.6 |  2.252894   2.350071   2.462521   2.604799   2.829714 |      0.0       0.0       0.0        0.0         0.0 |  2.252894   2.350071   2.462521   2.604799    2.829714 |  8.90634   8.28628   7.6   6.77526   5.55922 |      0.0       0.0    0.0       0.0            0.0 | 0.063843  0.098166  0.138348   0.176167   0.235552 | 0.006495  0.010078  0.014354  0.018458   0.025059 |  2.259389   2.360149   2.476875   2.623257   2.854773 |  2.514889 | 0.057348  0.088088  0.123994   0.157709   0.210493 | 0.0  0.0  0.0        0.0        0.0 | 0.001727  0.002653  0.003735   0.00475   0.00634 |
    | 15.05. |  1.8 |  9.2 |  1.622084   1.692051   1.773015   1.875456   2.037394 |      0.0       0.0       0.0        0.0         0.0 |  1.622084   1.692051   1.773015   1.875456    2.037394 | 10.50634   9.88628   9.2   8.37526   7.15922 |      0.0       0.0    0.0       0.0            0.0 | 0.057348  0.088088  0.123994   0.157709   0.210493 | 0.005824  0.009019  0.012816  0.016445    0.02225 |  1.627908    1.70107   1.785831   1.891901   2.059644 |  1.813271 | 0.051524  0.079069  0.111178   0.141264   0.188242 | 0.0  0.0  0.0        0.0        0.0 | 0.001552  0.002382  0.003349  0.004255   0.00567 |
    | 16.05. |  0.0 | 11.8 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 | 13.10634  12.48628  11.8  10.97526   9.75922 |      0.0       0.0    0.0       0.0            0.0 | 0.051524  0.079069  0.111178   0.141264   0.188242 | 0.005224  0.008076  0.011453  0.014667   0.019785 |  0.005224   0.008076   0.011453   0.014667   0.019785 |  0.011841 |   0.0463  0.070992  0.099725   0.126597   0.168458 | 0.0  0.0  0.0        0.0        0.0 | 0.001395  0.002138  0.003004  0.003813  0.005074 |
    | 17.05. |  2.4 | 13.8 |  2.162778   2.256068    2.36402   2.500607   2.716525 |      0.0       0.0       0.0        0.0         0.0 |  2.162778   2.256068    2.36402   2.500607    2.716525 | 15.10634  14.48628  13.8  12.97526  11.75922 |      0.0       0.0    0.0       0.0            0.0 |   0.0463  0.070992  0.099725   0.126597   0.168458 | 0.004688  0.007236  0.010242  0.013094   0.017615 |  2.167466   2.263304   2.374262   2.513702   2.734141 |  2.410575 | 0.041612  0.063757  0.089483   0.113503   0.150842 | 0.0  0.0  0.0        0.0        0.0 | 0.001253   0.00192  0.002695  0.003419  0.004543 |
    | 18.05. | 13.3 | 12.1 | 11.985397  12.502379  13.100612  13.857533  15.054079 |      0.0       0.0       0.0        0.0         0.0 | 11.985397  12.502379  13.100612  13.857533   15.054079 | 13.40634  12.78628  12.1  11.27526  10.05922 |      0.0       0.0    0.0       0.0            0.0 | 0.041612  0.063757  0.089483   0.113503   0.150842 | 0.004208  0.006486  0.009165    0.0117   0.015701 | 11.989605  12.508865  13.109778  13.869232   15.06978 | 13.309452 | 0.037404  0.057271  0.080318   0.101803   0.135141 | 0.0  0.0  0.0        0.0        0.0 | 0.001127  0.001725  0.002419  0.003066  0.004071 |
    | 19.05. |  5.8 | 10.8 |  5.226714   5.452165   5.713049   6.043135   6.564937 |      0.0       0.0       0.0        0.0         0.0 |  5.226714   5.452165   5.713049   6.043135    6.564937 | 12.10634  11.48628  10.8   9.97526   8.75922 |      0.0       0.0    0.0       0.0            0.0 | 0.037404  0.057271  0.080318   0.101803   0.135141 | 0.003778  0.005816  0.008207  0.010461   0.014009 |  5.230493   5.457981   5.721256   6.053596   6.578946 |  5.808454 | 0.033625  0.051455  0.072111   0.091342   0.121132 | 0.0  0.0  0.0        0.0        0.0 | 0.001013   0.00155  0.002172  0.002751  0.003649 |
    | 20.05. |  4.3 | 11.7 |  3.874978   4.042123   4.235536   4.480255   4.867108 |      0.0       0.0       0.0        0.0         0.0 |  3.874978   4.042123   4.235536   4.480255    4.867108 | 13.00634  12.38628  11.7  10.87526   9.65922 |      0.0       0.0    0.0       0.0            0.0 | 0.033625  0.051455  0.072111   0.091342   0.121132 | 0.003393  0.005217  0.007352   0.00936   0.012511 |  3.878371    4.04734   4.242888   4.489615   4.879619 |  4.307567 | 0.030232  0.046237  0.064759   0.081982   0.108621 | 0.0  0.0  0.0        0.0        0.0 | 0.000911  0.001393  0.001951  0.002469  0.003272 |
    | 21.05. | 20.0 | 11.1 | 18.023153   18.80057  19.700169  20.838395  22.637712 |      0.0       0.0       0.0        0.0         0.0 | 18.023153   18.80057  19.700169  20.838395   22.637712 | 12.40634  11.78628  11.1  10.27526   9.05922 |      0.0       0.0    0.0       0.0            0.0 | 0.030232  0.046237  0.064759   0.081982   0.108621 | 0.003048  0.004682   0.00659   0.00838   0.011182 | 18.026201  18.805252  19.706758  20.846776  22.648894 | 20.006776 | 0.027184  0.041556  0.058169   0.073601   0.097439 | 0.0  0.0  0.0        0.0        0.0 | 0.000819  0.001252  0.001752  0.002217  0.002935 |
    | 22.05. |  9.8 |  7.3 |  8.831345   9.212279   9.653083  10.210814  11.092479 |      0.0       0.0       0.0        0.0         0.0 |  8.831345   9.212279   9.653083  10.210814   11.092479 |  8.60634   7.98628   7.3   6.47526   5.25922 |      0.0       0.0    0.0       0.0            0.0 | 0.027184  0.041556  0.058169   0.073601   0.097439 | 0.002738  0.004202  0.005909  0.007507   0.010001 |  8.834083   9.216482   9.658991  10.218321   11.10248 |  9.806072 | 0.024446  0.037353  0.052261   0.066094   0.087438 | 0.0  0.0  0.0        0.0        0.0 | 0.000736  0.001125  0.001574  0.001991  0.002634 |
    | 23.05. |  2.1 |  8.0 |  1.892431    1.97406   2.068518   2.188031    2.37696 |      0.0       0.0       0.0        0.0         0.0 |  1.892431    1.97406   2.068518   2.188031     2.37696 |  9.30634   8.68628   8.0   7.17526   5.95922 |      0.0       0.0    0.0       0.0            0.0 | 0.024446  0.037353  0.052261   0.066094   0.087438 | 0.002461  0.003773    0.0053  0.006728   0.008951 |  1.894892   1.977833   2.073818   2.194759   2.385911 |  2.105443 | 0.021985   0.03358  0.046961   0.059366   0.078487 | 0.0  0.0  0.0        0.0        0.0 | 0.000662  0.001011  0.001414  0.001788  0.002364 |
    | 24.05. |  1.6 | 10.3 |  1.441852   1.504046   1.576014   1.667072   1.811017 |      0.0       0.0       0.0        0.0         0.0 |  1.441852   1.504046   1.576014   1.667072    1.811017 | 11.60634  10.98628  10.3   9.47526   8.25922 |      0.0       0.0    0.0       0.0            0.0 | 0.021985   0.03358  0.046961   0.059366   0.078487 | 0.002212  0.003389  0.004756  0.006032   0.008016 |  1.444064   1.507434   1.580769   1.673104   1.819033 |  1.604881 | 0.019773  0.030192  0.042205   0.053334   0.070471 | 0.0  0.0  0.0        0.0        0.0 | 0.000596  0.000909  0.001271  0.001606  0.002123 |
    | 25.05. |  3.7 |  8.0 |  3.334283   3.478106   3.644531   3.855103   4.187977 |      0.0       0.0       0.0        0.0         0.0 |  3.334283   3.478106   3.644531   3.855103    4.187977 |  9.30634   8.68628   8.0   7.17526   5.95922 |      0.0       0.0    0.0       0.0            0.0 | 0.019773  0.030192  0.042205   0.053334   0.070471 | 0.001988  0.003044  0.004269  0.005411   0.007182 |  3.336271   3.481149     3.6488   3.860514   4.195159 |  3.704379 | 0.017785  0.027148  0.037936   0.047924   0.063289 | 0.0  0.0  0.0        0.0        0.0 | 0.000536  0.000818  0.001143  0.001443  0.001906 |
    | 26.05. |  0.2 | 10.4 |  0.180232   0.188006   0.197002   0.208384   0.226377 |      0.0       0.0       0.0        0.0         0.0 |  0.180232   0.188006   0.197002   0.208384    0.226377 | 11.70634  11.08628  10.4   9.57526   8.35922 |      0.0       0.0    0.0       0.0            0.0 | 0.017785  0.027148  0.037936   0.047924   0.063289 | 0.001787  0.002735  0.003833  0.004855   0.006438 |  0.182019    0.19074   0.200834   0.213239   0.232815 |  0.203929 | 0.015998  0.024413  0.034103   0.043069   0.056852 | 0.0  0.0  0.0        0.0        0.0 | 0.000482  0.000735  0.001027  0.001297  0.001712 |
    | 27.05. |  0.0 | 14.0 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 | 15.30634  14.68628  14.0  13.17526  11.95922 |      0.0       0.0    0.0       0.0            0.0 | 0.015998  0.024413  0.034103   0.043069   0.056852 | 0.001607  0.002457  0.003442  0.004357   0.005773 |  0.001607   0.002457   0.003442   0.004357   0.005773 |  0.003527 | 0.014391  0.021956  0.030661   0.038712   0.051079 | 0.0  0.0  0.0        0.0        0.0 | 0.000433  0.000661  0.000924  0.001166  0.001539 |
    | 28.05. |  0.0 | 14.2 |       0.0        0.0        0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |       0.0        0.0        0.0        0.0         0.0 | 15.50634  14.88628  14.2  13.37526  12.15922 |      0.0       0.0    0.0       0.0            0.0 | 0.014391  0.021956  0.030661   0.038712   0.051079 | 0.001445  0.002209  0.003092  0.003912   0.005179 |  0.001445   0.002209   0.003092   0.003912   0.005179 |  0.003167 | 0.012947  0.019747   0.02757     0.0348     0.0459 | 0.0  0.0  0.0        0.0        0.0 |  0.00039  0.000595   0.00083  0.001048  0.001383 |
    | 29.05. |  0.1 | 14.9 |  0.090116   0.094003   0.098501   0.104192   0.113189 |      0.0       0.0       0.0        0.0         0.0 |  0.090116   0.094003   0.098501   0.104192    0.113189 | 16.20634  15.58628  14.9  14.07526  12.85922 |      0.0       0.0    0.0       0.0            0.0 | 0.012947  0.019747   0.02757     0.0348     0.0459 | 0.001299  0.001985  0.002778  0.003513   0.004647 |  0.091415   0.095988   0.101278   0.107705   0.117836 |  0.102844 | 0.011648  0.017762  0.024792   0.031287   0.041253 | 0.0  0.0  0.0        0.0        0.0 | 0.000351  0.000535  0.000747  0.000942  0.001243 |
    | 30.05. |  0.7 | 15.6 |   0.63081    0.65802   0.689506   0.729344    0.79232 |      0.0       0.0       0.0        0.0         0.0 |   0.63081    0.65802   0.689506   0.729344     0.79232 | 16.90634  16.28628  15.6  14.77526  13.55922 |      0.0       0.0    0.0       0.0            0.0 | 0.011648  0.017762  0.024792   0.031287   0.041253 | 0.001168  0.001785  0.002496  0.003155   0.004171 |  0.631979   0.659805   0.692002   0.732499   0.796491 |  0.702555 | 0.010479  0.015977  0.022296   0.028132   0.037082 | 0.0  0.0  0.0        0.0        0.0 | 0.000316  0.000481  0.000672  0.000847  0.001117 |
    | 31.05. |  2.2 | 16.3 |  1.982547   2.068063   2.167019   2.292223   2.490148 |      0.0       0.0       0.0        0.0         0.0 |  1.982547   2.068063   2.167019   2.292223    2.490148 | 17.60634  16.98628  16.3  15.47526  14.25922 |      0.0       0.0    0.0       0.0            0.0 | 0.010479  0.015977  0.022296   0.028132   0.037082 | 0.001051  0.001605  0.002243  0.002835   0.003745 |  1.983598   2.069667   2.169262   2.295058   2.493894 |  2.202296 | 0.009428  0.014372  0.020053   0.025297   0.033336 | 0.0  0.0  0.0        0.0        0.0 | 0.000284  0.000433  0.000604  0.000762  0.001004 |

.. _snow_cnhyst_ex2:

Example 2
_____________

In the second example we want to take a closer look at the hysteresis effect. Since
this is relevant when fresh snow falls on an old snow cover, we initialize a model
with snow and add some more snow after some time steps.

    >>> test.inits = ((states.g, [10.0, 15.0, 20.0, 30.0, 40.0]),
    ...               (states.etg, [0.0, 0.0, 0.0, 0.0, 0.0]),
    ...               (states.gratio, [0.8, 0.8, 0.8, 0.8, 0.8]),
    ...               (logs.glocalmax, derived.gthresh))

    >>> pub.timegrids = '01.01.1990', '16.01.1990', '1d'
    >>> cn3(20)

    >>> inputs.t.series = (5., 5., 5., 5., 5., 5., -1., -1., 5., 5., 5., 5., 5., 5.,5.)
    >>> inputs.p.series = (0., 0., 0., 0., 0., 0., 10., 10., 0., 0., 0., 0., 0., 0., 0.)

.. integration-test::

    >>> test.reset_inits()
    >>> conditions = sequences.conditions

    >>> test("snow_cnhyst_ex2",
    ...      axis1=(fluxes.player, fluxes.pnetlayer), axis2=states.g)
    |   date |    p |    t |                                             player |                                          psnowlayer |                               prainlayer |                                       tlayer |                               solidfraction |                                            potmelt |                                             melt |                                         pnetlayer |     pnet |                                                     g |                                                   etg |                                           gratio |
    ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 01.01. |  0.0 |  5.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |      0.0       0.0  0.0  0.0         0.0 |  5.94178   5.49476   5.0   4.40542   3.52874 |      0.0       0.0  0.0  0.0            0.0 |      10.0  12.357715    11.245   9.90779  7.936136 | 3.710843  6.260746  7.221187  9.048319  7.936136 | 3.710843  6.260746  7.221187  9.048319   7.936136 | 6.835446 |  6.289157   8.739254  12.778813  20.951681  32.063864 |       0.0        0.0        0.0        0.0        0.0 | 0.189432  0.263231  0.384904  0.631075  0.965779 |
    | 02.01. |  0.0 |  5.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |      0.0       0.0  0.0  0.0         0.0 |  5.94178   5.49476   5.0   4.40542   3.52874 |      0.0       0.0  0.0  0.0            0.0 |  6.289157   8.739254    11.245   9.90779  7.936136 | 1.701149   2.94432  5.019921  6.618079  7.691712 | 1.701149   2.94432  5.019921  6.618079   7.691712 | 4.795036 |  4.588008   5.794934   7.758892  14.333602  24.372152 |       0.0        0.0        0.0        0.0        0.0 | 0.138193  0.174546  0.233702  0.431735  0.734101 |
    | 03.01. |  0.0 |  5.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |      0.0       0.0  0.0  0.0         0.0 |  5.94395    5.4959   5.0   4.40405   3.52535 |      0.0       0.0  0.0  0.0            0.0 |  4.588008   5.794934  7.758892  9.904708  7.928512 | 1.029428  1.489829  2.407828  4.839059  6.031147 | 1.029428  1.489829  2.407828  4.839059   6.031147 | 3.159458 |  3.558579   4.305105   5.351064   9.494543  18.341005 |       0.0        0.0        0.0        0.0        0.0 | 0.107186  0.129672  0.161177   0.28598   0.55244 |
    | 04.01. |  0.0 |  5.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |      0.0       0.0  0.0  0.0         0.0 |  5.94612   5.49704   5.0   4.40268   3.52196 |      0.0       0.0  0.0  0.0            0.0 |  3.558579   4.305105  5.351064  9.494543  7.920888 | 0.699145  0.932936  1.311326  3.393181  4.730322 | 0.699145  0.932936  1.311326  3.393181   4.730322 | 2.213382 |  2.859434   3.372169   4.039738   6.101362  13.610683 |       0.0        0.0        0.0        0.0        0.0 | 0.086128  0.101571  0.121679  0.183776   0.40996 |
    | 05.01. |  0.0 |  5.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |      0.0       0.0  0.0  0.0         0.0 |  5.94829   5.49818   5.0   4.40131   3.51857 |      0.0       0.0  0.0  0.0            0.0 |  2.859434   3.372169  4.039738  6.101362  7.913264 | 0.507592  0.645481  0.846369  1.619292  3.711038 | 0.507592  0.645481  0.846369  1.619292   3.711038 | 1.465954 |  2.351842   2.726688   3.193369   4.482071   9.899645 |       0.0        0.0        0.0        0.0        0.0 | 0.070839  0.082129  0.096186  0.135002  0.298182 |
    | 06.01. |  0.0 |  5.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |      0.0       0.0  0.0  0.0         0.0 |  5.95263   5.50046   5.0   4.39857   3.51179 |      0.0       0.0  0.0  0.0            0.0 |  2.351842   2.726688  3.193369  4.482071  7.898016 | 0.385125  0.474215  0.595778  0.992787  2.909344 | 0.385125  0.474215  0.595778  0.992787   2.909344 |  1.07145 |  1.966717   2.252472   2.597591   3.489283   6.990301 |       0.0        0.0        0.0        0.0        0.0 | 0.059238  0.067846  0.078241  0.105099  0.210551 |
    | 07.01. | 10.0 | -1.0 | 9.011577  9.400285  9.850084  10.419198  11.318856 | 6.860513  8.221489  9.850084  10.419198   11.318856 | 2.151063  1.178796  0.0  0.0         0.0 |  -0.0452   -0.4984  -1.0   -1.6028   -2.4916 |   0.7613    0.8746  1.0  1.0            1.0 |       0.0        0.0       0.0       0.0       0.0 |      0.0       0.0       0.0       0.0       0.0 | 2.151063  1.178796       0.0       0.0        0.0 | 0.665972 |   8.82723  10.473962  12.447675  13.908481  18.309157 | -0.001718  -0.018939     -0.038  -0.060906  -0.094681 | 0.402264   0.47892  0.570745  0.626059  0.776494 |
    | 08.01. | 10.0 | -1.0 | 9.011577  9.400285  9.850084  10.419198  11.318856 | 6.855624   8.21881  9.850084  10.419198   11.318856 | 2.155952  1.181475  0.0  0.0         0.0 | -0.04303  -0.49726  -1.0  -1.60417  -2.49499 | 0.760757  0.874315  1.0  1.0            1.0 |       0.0        0.0       0.0       0.0       0.0 |      0.0       0.0       0.0       0.0       0.0 | 2.155952  1.181475       0.0       0.0        0.0 | 0.667485 | 15.682855  18.692772   22.29776  24.327679  29.628014 | -0.003287  -0.037115  -0.074556   -0.11955  -0.185893 | 0.745045  0.889861       1.0       1.0       1.0 |
    | 09.01. |  0.0 |  5.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |      0.0       0.0  0.0  0.0         0.0 |  5.95914   5.50388   5.0   4.39446   3.50162 |      0.0       0.0  0.0  0.0            0.0 | 13.402106  12.378226    11.245  9.883141       0.0 |  7.03795  7.510263    11.245  9.883141       0.0 |  7.03795  7.510263    11.245  9.883141        0.0 | 7.135271 |  8.644905  11.182509   11.05276  14.444538  29.628014 |       0.0        0.0        0.0        0.0  -0.045767 | 0.260389  0.336823  0.495689  0.593749       1.0 |
    | 10.01. |  0.0 |  5.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |      0.0       0.0  0.0  0.0         0.0 |  5.96348   5.50616   5.0   4.39172   3.49484 |      0.0       0.0  0.0  0.0            0.0 |  8.644905  11.182509  11.05276  9.876978  7.859895 | 2.890422   4.50812  6.036137    6.2657  7.859895 | 2.890422   4.50812  6.036137    6.2657   7.859895 | 5.512055 |  5.754482   6.674389   5.016623   8.178838  21.768118 |       0.0        0.0        0.0        0.0        0.0 | 0.173328  0.201036  0.224983  0.336195  0.734714 |
    | 11.01. |  0.0 |  5.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |      0.0       0.0  0.0  0.0         0.0 |  5.96565    5.5073   5.0   4.39035   3.49145 |      0.0       0.0  0.0  0.0            0.0 |  5.754482   6.674389  5.016623  8.178838  7.852271 | 1.473119  1.875051  1.517453  3.292598  5.977484 | 1.473119  1.875051  1.517453  3.292598   5.977484 | 2.827141 |  4.281364   4.799338    3.49917    4.88624  15.790635 |       0.0        0.0        0.0        0.0        0.0 | 0.128957  0.144558  0.156929  0.200851  0.532963 |
    | 12.01. |  0.0 |  5.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |      0.0       0.0  0.0  0.0         0.0 |  5.96782   5.50844   5.0   4.38898   3.48806 |      0.0       0.0  0.0  0.0            0.0 |  4.281364   4.799338   3.49917   4.88624  7.844647 | 0.925036   1.10434  0.844127   1.37189  4.547281 | 0.925036   1.10434  0.844127   1.37189   4.547281 | 1.758535 |  3.356328   3.694998   2.655043    3.51435  11.243354 |       0.0        0.0        0.0        0.0        0.0 | 0.101094  0.111295  0.119072  0.144459  0.379484 |
    | 13.01. |  0.0 |  5.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |      0.0       0.0  0.0  0.0         0.0 |  5.97216   5.51072   5.0   4.38624   3.48128 |      0.0       0.0  0.0  0.0            0.0 |  3.356328   3.694998  2.655043   3.51435  7.829399 | 0.641008  0.739612  0.550032  0.808346  3.456958 | 0.641008  0.739612  0.550032  0.808346   3.456958 | 1.239191 |   2.71532   2.955387   2.105011   2.706004   7.786397 |       0.0        0.0        0.0        0.0        0.0 | 0.081787  0.089018  0.094405  0.111231  0.262805 |
    | 14.01. |  0.0 |  5.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |      0.0       0.0  0.0  0.0         0.0 |   5.9765     5.513   5.0    4.3835    3.4745 |      0.0       0.0  0.0  0.0            0.0 |   2.71532   2.955387  2.105011  2.706004  7.786397 | 0.471401  0.532312  0.389352  0.541494  2.620315 | 0.471401  0.532312  0.389352  0.541494   2.620315 | 0.910975 |  2.243919   2.423074    1.71566    2.16451   5.166082 |       0.0        0.0        0.0        0.0        0.0 | 0.067588  0.072984  0.076943  0.088973  0.174365 |
    | 15.01. |  0.0 |  5.0 |      0.0       0.0       0.0        0.0        0.0 |      0.0       0.0       0.0        0.0         0.0 |      0.0       0.0  0.0  0.0         0.0 |  5.97867   5.51414   5.0   4.38213   3.47111 |      0.0       0.0  0.0  0.0            0.0 |  2.243919   2.423074   1.71566   2.16451  5.166082 | 0.360887  0.401469  0.290373  0.389776  1.327313 | 0.360887  0.401469  0.290373  0.389776   1.327313 | 0.553964 |  1.883031   2.021606   1.425286   1.774734   3.838769 |       0.0        0.0        0.0        0.0        0.0 | 0.056718  0.060892  0.063921  0.072951  0.129566 |
"""

# import...
# ...from HydPy
from hydpy.exe.modelimports import *
from hydpy.core import modeltools

# ...from  snow
from hydpy.models.snow import snow_model


class Model(modeltools.AdHocModel):
    """The Cema-Neige version with hysteresis of the HydPy-Snow."""

    INLET_METHODS = ()
    RECEIVER_METHODS = ()
    ADD_METHODS = (snow_model.Return_T_V1,)
    RUN_METHODS = (
        snow_model.Calc_PLayer_V1,
        snow_model.Calc_TLayer_V1,
        snow_model.Calc_SolidFraction_V1,
        snow_model.Calc_PSnowLayer_V1,
        snow_model.Calc_PRainLayer_V1,
        snow_model.Calc_G_V1,
        snow_model.Calc_ETG_V1,
        snow_model.Calc_PotMelt_V1,
        snow_model.Calc_GRatio_GLocalMax_V1,
        snow_model.Calc_Melt_V1,
        snow_model.Update_G_V1,
        snow_model.Update_GRatio_GLocalMax_V1,
        snow_model.Calc_PNetLayer_V1,
        snow_model.Calc_PNet_V1,
    )
    OUTLET_METHODS = ()
    SENDER_METHODS = ()
    SUBMODELINTERFACES = ()
    SUBMODELS = ()


tester = Tester()
cythonizer = Cythonizer()


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hydpy.models.wland.wland_model &#8212; HydPy 4.0.1 documentation</title>
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    
    <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">HydPy 4.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">hydpy.models.wland.wland_model</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for hydpy.models.wland.wland_model</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. _`Pegasus method`: https://link.springer.com/article/10.1007/BF01932959</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># import...</span>
<span class="c1"># ...from HydPy</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="kn">import</span> <span class="n">modeltools</span>
<span class="kn">from</span> <span class="nn">hydpy.auxs</span> <span class="kn">import</span> <span class="n">quadtools</span>
<span class="kn">from</span> <span class="nn">hydpy.auxs</span> <span class="kn">import</span> <span class="n">roottools</span>
<span class="kn">from</span> <span class="nn">hydpy.cythons</span> <span class="kn">import</span> <span class="n">modelutils</span>
<span class="kn">from</span> <span class="nn">hydpy.cythons.autogen</span> <span class="kn">import</span> <span class="n">smoothutils</span>
<span class="kn">from</span> <span class="nn">hydpy.models.wland</span> <span class="kn">import</span> <span class="n">wland_control</span>
<span class="kn">from</span> <span class="nn">hydpy.models.wland</span> <span class="kn">import</span> <span class="n">wland_derived</span>
<span class="kn">from</span> <span class="nn">hydpy.models.wland</span> <span class="kn">import</span> <span class="n">wland_fixed</span>
<span class="kn">from</span> <span class="nn">hydpy.models.wland</span> <span class="kn">import</span> <span class="n">wland_solver</span>
<span class="kn">from</span> <span class="nn">hydpy.models.wland</span> <span class="kn">import</span> <span class="n">wland_inputs</span>
<span class="kn">from</span> <span class="nn">hydpy.models.wland</span> <span class="kn">import</span> <span class="n">wland_fluxes</span>
<span class="kn">from</span> <span class="nn">hydpy.models.wland</span> <span class="kn">import</span> <span class="n">wland_states</span>
<span class="kn">from</span> <span class="nn">hydpy.models.wland</span> <span class="kn">import</span> <span class="n">wland_aides</span>
<span class="kn">from</span> <span class="nn">hydpy.models.wland</span> <span class="kn">import</span> <span class="n">wland_outlets</span>
<span class="kn">from</span> <span class="nn">hydpy.models.wland.wland_constants</span> <span class="kn">import</span> <span class="n">SEALED</span>


<div class="viewcode-block" id="Calc_FXS_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_FXS_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_FXS_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Query the current surface water supply/extraction.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        FXS_{fluxes} = \begin{cases}</span>
<span class="sd">        0 &amp;|\ FXS_{inputs} = 0</span>
<span class="sd">        \\</span>
<span class="sd">        \frac{FXS_{inputs}}{ASR} &amp;|\ FXS_{inputs} \neq 0 \land ASR &gt; 0</span>
<span class="sd">        \\</span>
<span class="sd">        inf &amp;|\ FXS_{inputs} \neq 0 \land ASR = 0</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.asr(0.5)</span>
<span class="sd">        &gt;&gt;&gt; inputs.fxs = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_fxs_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fxs</span>
<span class="sd">        fxs(4.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.asr(0.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_fxs_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fxs</span>
<span class="sd">        fxs(inf)</span>
<span class="sd">        &gt;&gt;&gt; inputs.fxs = 0.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_fxs_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fxs</span>
<span class="sd">        fxs(0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">ASR</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_inputs</span><span class="o">.</span><span class="n">FXS</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">FXS</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">inp</span><span class="o">.</span><span class="n">fxs</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">fxs</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">elif</span> <span class="n">der</span><span class="o">.</span><span class="n">asr</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">fxs</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">fxs</span> <span class="o">/</span> <span class="n">der</span><span class="o">.</span><span class="n">asr</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">fxs</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">inf</span></div>


<div class="viewcode-block" id="Calc_FXG_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_FXG_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_FXG_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Query the current seepage/extraction.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        FXG_{fluxes} = \begin{cases}</span>
<span class="sd">        0 &amp;|\ FXG_{inputs} = 0</span>
<span class="sd">        \\</span>
<span class="sd">        \frac{FXG_{inputs}}{AGR} &amp;|\ FXG_{inputs} \neq 0 \land AGR &gt; 0</span>
<span class="sd">        \\</span>
<span class="sd">        inf &amp;|\ FXG_{inputs} \neq 0 \land AGR = 0</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.alr(0.5)</span>
<span class="sd">        &gt;&gt;&gt; derived.agr(0.8)</span>
<span class="sd">        &gt;&gt;&gt; inputs.fxg = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_fxg_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fxg</span>
<span class="sd">        fxg(5.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.agr(0.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_fxg_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fxg</span>
<span class="sd">        fxg(inf)</span>
<span class="sd">        &gt;&gt;&gt; inputs.fxg = 0.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_fxg_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fxg</span>
<span class="sd">        fxg(0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">ALR</span><span class="p">,</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">AGR</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_inputs</span><span class="o">.</span><span class="n">FXG</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">FXG</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">inp</span><span class="o">.</span><span class="n">fxg</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">fxg</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d_ra</span> <span class="o">=</span> <span class="n">der</span><span class="o">.</span><span class="n">alr</span> <span class="o">*</span> <span class="n">der</span><span class="o">.</span><span class="n">agr</span>
            <span class="k">if</span> <span class="n">d_ra</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">fxg</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">fxg</span> <span class="o">/</span> <span class="n">d_ra</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">fxg</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">inf</span></div>


<div class="viewcode-block" id="Calc_PC_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_PC_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_PC_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the corrected precipitation.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`PC = CP \cdot P`</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; cp(1.2)</span>
<span class="sd">        &gt;&gt;&gt; inputs.p = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_pc_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.pc</span>
<span class="sd">        pc(2.4)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_control</span><span class="o">.</span><span class="n">CP</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_inputs</span><span class="o">.</span><span class="n">P</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PC</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cp</span> <span class="o">*</span> <span class="n">inp</span><span class="o">.</span><span class="n">p</span></div>


<div class="viewcode-block" id="Calc_PETL_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_PETL_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_PETL_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Adjust the potential evapotranspiration of the land areas.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`PETL = CETP \cdot CPETL \cdot PET`</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub, UnitTest</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &#39;2000-03-30&#39;, &#39;2000-04-03&#39;, &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nu(2)</span>
<span class="sd">        &gt;&gt;&gt; lt(FIELD, DECIDIOUS)</span>
<span class="sd">        &gt;&gt;&gt; cpet(0.8)</span>
<span class="sd">        &gt;&gt;&gt; cpetl.field_mar = 1.25</span>
<span class="sd">        &gt;&gt;&gt; cpetl.field_apr = 1.5</span>
<span class="sd">        &gt;&gt;&gt; cpetl.decidious_mar = 1.75</span>
<span class="sd">        &gt;&gt;&gt; cpetl.decidious_apr = 2.0</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; inputs.pet = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&#39;2000-03-31&#39;]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_petl_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.petl</span>
<span class="sd">        petl(2.0, 2.8)</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&#39;2000-04-01&#39;]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_petl_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.petl</span>
<span class="sd">        petl(2.4, 3.2)</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">NU</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">LT</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">CPET</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">CPETL</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_inputs</span><span class="o">.</span><span class="n">PET</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PETL</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nu</span><span class="p">):</span>
            <span class="n">d_cpetl</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cpetl</span><span class="p">[</span><span class="n">con</span><span class="o">.</span><span class="n">lt</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">SEALED</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]]</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">petl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cpet</span> <span class="o">*</span> <span class="n">d_cpetl</span> <span class="o">*</span> <span class="n">inp</span><span class="o">.</span><span class="n">pet</span></div>


<div class="viewcode-block" id="Calc_PES_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_PES_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_PES_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Adapt the potential evaporation for the surface water area.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`PES = CETP \cdot CPES \cdot PET`</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub, UnitTest</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &#39;2000-03-30&#39;, &#39;2000-04-03&#39;, &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; cpet(0.8)</span>
<span class="sd">        &gt;&gt;&gt; cpes.mar = 1.25</span>
<span class="sd">        &gt;&gt;&gt; cpes.apr = 1.5</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; inputs.pet = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&#39;2000-03-31&#39;]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_pes_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.pes</span>
<span class="sd">        pes(2.0)</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&#39;2000-04-01&#39;]</span>
<span class="sd">        &gt;&gt;&gt; model.calc_pes_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.pes</span>
<span class="sd">        pes(2.4)</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">CPET</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">CPES</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_inputs</span><span class="o">.</span><span class="n">PET</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PES</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">d_cpes</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cpes</span><span class="p">[</span><span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]]</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">pes</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cpet</span> <span class="o">*</span> <span class="n">d_cpes</span> <span class="o">*</span> <span class="n">inp</span><span class="o">.</span><span class="n">pet</span></div>


<div class="viewcode-block" id="Calc_TF_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_TF_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_TF_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the total amount of throughfall.</span>

<span class="sd">    Basic equation (discontinuous):</span>
<span class="sd">      .. math::</span>
<span class="sd">        TF = \begin{cases}</span>
<span class="sd">        P &amp;|\ IC &gt; IT</span>
<span class="sd">        \\</span>
<span class="sd">        0 &amp;|\ IC &lt; IT</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import pub, UnitTest</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &#39;2000-03-30&#39;, &#39;2000-04-03&#39;, &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nu(1)</span>
<span class="sd">        &gt;&gt;&gt; lt(FIELD)</span>
<span class="sd">        &gt;&gt;&gt; ih(0.2)</span>
<span class="sd">        &gt;&gt;&gt; lai.field_mar = 5.0</span>
<span class="sd">        &gt;&gt;&gt; lai.field_apr = 10.0</span>
<span class="sd">        &gt;&gt;&gt; derived.moy.update()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.pc = 5.0</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_tf_v1,</span>
<span class="sd">        ...     last_example=6,</span>
<span class="sd">        ...     parseqs=(states.ic, fluxes.tf),</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.ic = -4.0, 0.0, 1.0, 2.0, 3.0, 7.0</span>

<span class="sd">        Without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&#39;2000-03-31&#39;]</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |   ic |  tf |</span>
<span class="sd">        --------------------</span>
<span class="sd">        |   1 | -4.0 | 0.0 |</span>
<span class="sd">        |   2 |  0.0 | 0.0 |</span>
<span class="sd">        |   3 |  1.0 | 2.5 |</span>
<span class="sd">        |   4 |  2.0 | 5.0 |</span>
<span class="sd">        |   5 |  3.0 | 5.0 |</span>
<span class="sd">        |   6 |  7.0 | 5.0 |</span>

<span class="sd">        With smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(1.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; model.idx_sim = pub.timegrids.init[&#39;2000-04-01&#39;]</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |   ic |      tf |</span>
<span class="sd">        ------------------------</span>
<span class="sd">        |   1 | -4.0 |     0.0 |</span>
<span class="sd">        |   2 |  0.0 | 0.00051 |</span>
<span class="sd">        |   3 |  1.0 |    0.05 |</span>
<span class="sd">        |   4 |  2.0 |     2.5 |</span>
<span class="sd">        |   5 |  3.0 |    4.95 |</span>
<span class="sd">        |   6 |  7.0 |     5.0 |</span>

<span class="sd">        .. testsetup::</span>

<span class="sd">            &gt;&gt;&gt; del pub.timegrids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">NU</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">LT</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">LAI</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">IH</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">MOY</span><span class="p">,</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">RH1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PC</span><span class="p">,</span>
        <span class="n">wland_states</span><span class="o">.</span><span class="n">IC</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">TF</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nu</span><span class="p">):</span>
            <span class="n">d_lai</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">lai</span><span class="p">[</span><span class="n">con</span><span class="o">.</span><span class="n">lt</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">SEALED</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">moy</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span><span class="p">]]</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">tf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">pc</span> <span class="o">*</span> <span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_logistic1</span><span class="p">(</span>
                <span class="n">sta</span><span class="o">.</span><span class="n">ic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">ih</span> <span class="o">*</span> <span class="n">d_lai</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">rh1</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Calc_EI_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_EI_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_EI_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the interception evaporation.</span>

<span class="sd">    Basic equation (discontinuous):</span>
<span class="sd">      .. math::</span>
<span class="sd">        EI = \begin{cases}</span>
<span class="sd">        PETL &amp;|\ IC &gt; 0</span>
<span class="sd">        \\</span>
<span class="sd">        0 &amp;|\ IC &lt; 0</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nu(1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.petl = 5.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_ei_v1,</span>
<span class="sd">        ...     last_example=9,</span>
<span class="sd">        ...     parseqs=(states.ic, fluxes.ei)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.ic= -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0</span>

<span class="sd">        Without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |   ic |  ei |</span>
<span class="sd">        --------------------</span>
<span class="sd">        |   1 | -4.0 | 0.0 |</span>
<span class="sd">        |   2 | -3.0 | 0.0 |</span>
<span class="sd">        |   3 | -2.0 | 0.0 |</span>
<span class="sd">        |   4 | -1.0 | 0.0 |</span>
<span class="sd">        |   5 |  0.0 | 2.5 |</span>
<span class="sd">        |   6 |  1.0 | 5.0 |</span>
<span class="sd">        |   7 |  2.0 | 5.0 |</span>
<span class="sd">        |   8 |  3.0 | 5.0 |</span>
<span class="sd">        |   9 |  4.0 | 5.0 |</span>

<span class="sd">        With smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(1.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |   ic |       ei |</span>
<span class="sd">        -------------------------</span>
<span class="sd">        |   1 | -4.0 |      0.0 |</span>
<span class="sd">        |   2 | -3.0 | 0.000005 |</span>
<span class="sd">        |   3 | -2.0 |  0.00051 |</span>
<span class="sd">        |   4 | -1.0 |     0.05 |</span>
<span class="sd">        |   5 |  0.0 |      2.5 |</span>
<span class="sd">        |   6 |  1.0 |     4.95 |</span>
<span class="sd">        |   7 |  2.0 |  4.99949 |</span>
<span class="sd">        |   8 |  3.0 | 4.999995 |</span>
<span class="sd">        |   9 |  4.0 |      5.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_control</span><span class="o">.</span><span class="n">NU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PETL</span><span class="p">,</span>
        <span class="n">wland_states</span><span class="o">.</span><span class="n">IC</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">EI</span><span class="p">,</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">RH1</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nu</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">ei</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">petl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_logistic1</span><span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">ic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">der</span><span class="o">.</span><span class="n">rh1</span><span class="p">))</span></div>


<div class="viewcode-block" id="Calc_FR_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_FR_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_FR_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Determine the fraction between rainfall and total precipitation.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`FR = \frac{T- \left( TT - TI / 2 \right)}{TI}`</span>

<span class="sd">    Restriction:</span>
<span class="sd">      :math:`0 \leq FR \leq 1`</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; tt(1.0)</span>
<span class="sd">        &gt;&gt;&gt; ti(4.0)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_fr_v1,</span>
<span class="sd">        ...     last_example=9,</span>
<span class="sd">        ...     parseqs=(inputs.t, aides.fr)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.t = -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |    t |   fr |</span>
<span class="sd">        ---------------------</span>
<span class="sd">        |   1 | -3.0 |  0.0 |</span>
<span class="sd">        |   2 | -2.0 |  0.0 |</span>
<span class="sd">        |   3 | -1.0 |  0.0 |</span>
<span class="sd">        |   4 |  0.0 | 0.25 |</span>
<span class="sd">        |   5 |  1.0 |  0.5 |</span>
<span class="sd">        |   6 |  2.0 | 0.75 |</span>
<span class="sd">        |   7 |  3.0 |  1.0 |</span>
<span class="sd">        |   8 |  4.0 |  1.0 |</span>
<span class="sd">        |   9 |  5.0 |  1.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">TT</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">TI</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_inputs</span><span class="o">.</span><span class="n">T</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_aides</span><span class="o">.</span><span class="n">FR</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">inp</span><span class="o">.</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">tt</span> <span class="o">+</span> <span class="n">con</span><span class="o">.</span><span class="n">ti</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">):</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">fr</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">elif</span> <span class="n">inp</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">tt</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">ti</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">):</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">fr</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">fr</span> <span class="o">=</span> <span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">t</span> <span class="o">-</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">tt</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">ti</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">))</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">ti</span></div>


<div class="viewcode-block" id="Calc_RF_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_RF_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_RF_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the liquid amount of throughfall (rainfall).</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`RF = FR \cdot TF`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nu(1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.tf = 2.0</span>
<span class="sd">        &gt;&gt;&gt; aides.fr = 0.8</span>
<span class="sd">        &gt;&gt;&gt; model.calc_rf_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.rf</span>
<span class="sd">        rf(1.6)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_control</span><span class="o">.</span><span class="n">NU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">TF</span><span class="p">,</span>
        <span class="n">wland_aides</span><span class="o">.</span><span class="n">FR</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">RF</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nu</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">rf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">aid</span><span class="o">.</span><span class="n">fr</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">tf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>


<div class="viewcode-block" id="Calc_SF_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_SF_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_SF_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the frozen amount of throughfall (snowfall).</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`SF = (1-FR) \cdot TF`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nu(1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.tf = 2.0</span>
<span class="sd">        &gt;&gt;&gt; aides.fr = 0.8</span>
<span class="sd">        &gt;&gt;&gt; model.calc_sf_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.sf</span>
<span class="sd">        sf(0.4)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_control</span><span class="o">.</span><span class="n">NU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">TF</span><span class="p">,</span>
        <span class="n">wland_aides</span><span class="o">.</span><span class="n">FR</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">SF</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nu</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">sf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">aid</span><span class="o">.</span><span class="n">fr</span><span class="p">)</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">tf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>


<div class="viewcode-block" id="Calc_PM_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_PM_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_PM_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the potential snowmelt.</span>

<span class="sd">    Basic equation (discontinous):</span>
<span class="sd">      :math:`PM = max \left( DDF \cdot (T - DDT), 0 \right)`</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&#39;12h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nu(1)</span>
<span class="sd">        &gt;&gt;&gt; ddf(4.0)</span>
<span class="sd">        &gt;&gt;&gt; ddt(1.0)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_pm_v1,</span>
<span class="sd">        ...     last_example=11,</span>
<span class="sd">        ...     parseqs=(inputs.t, fluxes.pm)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.t = -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0</span>

<span class="sd">        Without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; st(0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rt2.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |    t |   pm |</span>
<span class="sd">        ---------------------</span>
<span class="sd">        |   1 | -4.0 |  0.0 |</span>
<span class="sd">        |   2 | -3.0 |  0.0 |</span>
<span class="sd">        |   3 | -2.0 |  0.0 |</span>
<span class="sd">        |   4 | -1.0 |  0.0 |</span>
<span class="sd">        |   5 |  0.0 |  0.0 |</span>
<span class="sd">        |   6 |  1.0 |  0.0 |</span>
<span class="sd">        |   7 |  2.0 |  2.0 |</span>
<span class="sd">        |   8 |  3.0 |  4.0 |</span>
<span class="sd">        |   9 |  4.0 |  6.0 |</span>
<span class="sd">        |  10 |  5.0 |  8.0 |</span>
<span class="sd">        |  11 |  6.0 | 10.0 |</span>

<span class="sd">        With smoothing:</span>

<span class="sd">        &gt;&gt;&gt; st(1.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rt2.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |    t |       pm |</span>
<span class="sd">        -------------------------</span>
<span class="sd">        |   1 | -4.0 |      0.0 |</span>
<span class="sd">        |   2 | -3.0 | 0.000001 |</span>
<span class="sd">        |   3 | -2.0 | 0.000024 |</span>
<span class="sd">        |   4 | -1.0 | 0.000697 |</span>
<span class="sd">        |   5 |  0.0 |     0.02 |</span>
<span class="sd">        |   6 |  1.0 | 0.411048 |</span>
<span class="sd">        |   7 |  2.0 |     2.02 |</span>
<span class="sd">        |   8 |  3.0 | 4.000697 |</span>
<span class="sd">        |   9 |  4.0 | 6.000024 |</span>
<span class="sd">        |  10 |  5.0 | 8.000001 |</span>
<span class="sd">        |  11 |  6.0 |     10.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">NU</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">DDF</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">DDT</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">RT2</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_inputs</span><span class="o">.</span><span class="n">T</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PM</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nu</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">pm</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">ddf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_logistic2</span><span class="p">(</span>
                <span class="n">inp</span><span class="o">.</span><span class="n">t</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">ddt</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">rt2</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Calc_AM_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_AM_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_AM_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the actual snowmelt.</span>

<span class="sd">    Basic equation (discontinous):</span>
<span class="sd">      .. math::</span>
<span class="sd">        AM = \begin{cases}</span>
<span class="sd">        PM &amp;|\ SP &gt; 0</span>
<span class="sd">        \\</span>
<span class="sd">        0 &amp;|\ SP &lt; 0</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nu(1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.pm = 2.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_am_v1,</span>
<span class="sd">        ...     last_example=9,</span>
<span class="sd">        ...     parseqs=(states.sp, fluxes.am)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.sp = -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0</span>

<span class="sd">        Without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |   sp |  am |</span>
<span class="sd">        --------------------</span>
<span class="sd">        |   1 | -4.0 | 0.0 |</span>
<span class="sd">        |   2 | -3.0 | 0.0 |</span>
<span class="sd">        |   3 | -2.0 | 0.0 |</span>
<span class="sd">        |   4 | -1.0 | 0.0 |</span>
<span class="sd">        |   5 |  0.0 | 1.0 |</span>
<span class="sd">        |   6 |  1.0 | 2.0 |</span>
<span class="sd">        |   7 |  2.0 | 2.0 |</span>
<span class="sd">        |   8 |  3.0 | 2.0 |</span>
<span class="sd">        |   9 |  4.0 | 2.0 |</span>

<span class="sd">        With smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(1.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |   sp |       am |</span>
<span class="sd">        -------------------------</span>
<span class="sd">        |   1 | -4.0 |      0.0 |</span>
<span class="sd">        |   2 | -3.0 | 0.000002 |</span>
<span class="sd">        |   3 | -2.0 | 0.000204 |</span>
<span class="sd">        |   4 | -1.0 |     0.02 |</span>
<span class="sd">        |   5 |  0.0 |      1.0 |</span>
<span class="sd">        |   6 |  1.0 |     1.98 |</span>
<span class="sd">        |   7 |  2.0 | 1.999796 |</span>
<span class="sd">        |   8 |  3.0 | 1.999998 |</span>
<span class="sd">        |   9 |  4.0 |      2.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_control</span><span class="o">.</span><span class="n">NU</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">RH1</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PM</span><span class="p">,</span>
        <span class="n">wland_states</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">AM</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nu</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">am</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">pm</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_logistic1</span><span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">sp</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">der</span><span class="o">.</span><span class="n">rh1</span><span class="p">)</span></div>


<div class="viewcode-block" id="Calc_PS_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_PS_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_PS_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the precipitation entering the surface water reservoir.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`PS = PC`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.pc = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_ps_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.ps</span>
<span class="sd">        ps(3.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PC</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PS</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">ps</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">pc</span></div>


<div class="viewcode-block" id="Calc_W_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_W_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_W_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the wetness index.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`W = cos \left(</span>
<span class="sd">      \frac{max(min(DV, CW), 0) \cdot Pi}{CW} \right) \cdot \frac{1}{2} + \frac{1}{2}`</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; cw(200.0)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_w_v1,</span>
<span class="sd">        ...     last_example=11,</span>
<span class="sd">        ...     parseqs=(states.dv, aides.w)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.dv = (</span>
<span class="sd">        ...     -50.0, -5.0, 0.0, 5.0, 50.0, 100.0, 150.0, 195.0, 200.0, 205.0, 250.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |    dv |        w |</span>
<span class="sd">        --------------------------</span>
<span class="sd">        |   1 | -50.0 |      1.0 |</span>
<span class="sd">        |   2 |  -5.0 |      1.0 |</span>
<span class="sd">        |   3 |   0.0 |      1.0 |</span>
<span class="sd">        |   4 |   5.0 | 0.998459 |</span>
<span class="sd">        |   5 |  50.0 | 0.853553 |</span>
<span class="sd">        |   6 | 100.0 |      0.5 |</span>
<span class="sd">        |   7 | 150.0 | 0.146447 |</span>
<span class="sd">        |   8 | 195.0 | 0.001541 |</span>
<span class="sd">        |   9 | 200.0 |      0.0 |</span>
<span class="sd">        |  10 | 205.0 |      0.0 |</span>
<span class="sd">        |  11 | 250.0 |      0.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_control</span><span class="o">.</span><span class="n">CW</span><span class="p">,)</span>
    <span class="n">FIXEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fixed</span><span class="o">.</span><span class="n">Pi</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">DV</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_aides</span><span class="o">.</span><span class="n">W</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fix</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">fixed</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span>
            <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">dv</span><span class="p">,</span> <span class="n">con</span><span class="o">.</span><span class="n">cw</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">fix</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">cw</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Calc_PV_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_PV_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_PV_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the rainfall (and snowmelt) entering the vadose zone.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        PV = \Sigma \left ( \frac{AUR}{AGR} \cdot (RF + AM) \cdot \begin{cases}</span>
<span class="sd">        0 &amp;|\ LT = SEALED</span>
<span class="sd">        \\</span>
<span class="sd">        1-W &amp;|\ LT \neq SEALED</span>
<span class="sd">        \end{cases}  \right )</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nu(3)</span>
<span class="sd">        &gt;&gt;&gt; lt(FIELD, SOIL, SEALED)</span>
<span class="sd">        &gt;&gt;&gt; aur(0.7, 0.2, 0.1)</span>
<span class="sd">        &gt;&gt;&gt; derived.agr.update()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.rf = 3.0, 2.0, 1.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.am = 1.0, 2.0, 3.0</span>
<span class="sd">        &gt;&gt;&gt; aides.w = 0.75</span>
<span class="sd">        &gt;&gt;&gt; model.calc_pv_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.pv</span>
<span class="sd">        pv(1.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">NU</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">LT</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">AUR</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">AGR</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">RF</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">AM</span><span class="p">,</span>
        <span class="n">wland_aides</span><span class="o">.</span><span class="n">W</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PV</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">pv</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nu</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lt</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="n">SEALED</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">pv</span> <span class="o">+=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">aid</span><span class="o">.</span><span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">aur</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">der</span><span class="o">.</span><span class="n">agr</span> <span class="o">*</span> <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">rf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">flu</span><span class="o">.</span><span class="n">am</span><span class="p">[</span><span class="n">k</span><span class="p">])</span></div>


<div class="viewcode-block" id="Calc_PQ_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_PQ_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_PQ_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the rainfall (and snowmelt) entering the quickflow reservoir.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        PQ = \Sigma \left( AUR \cdot (RF + AM) \cdot \begin{cases}</span>
<span class="sd">        1 &amp;|\ LT = SEALED</span>
<span class="sd">        \\</span>
<span class="sd">        W &amp;|\ LT \neq SEALED</span>
<span class="sd">        \end{cases} \right)</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nu(3)</span>
<span class="sd">        &gt;&gt;&gt; lt(FIELD, SOIL, SEALED)</span>
<span class="sd">        &gt;&gt;&gt; aur(0.6, 0.3, 0.1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.rf = 3.0, 2.0, 1.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.am = 1.0, 2.0, 2.0</span>
<span class="sd">        &gt;&gt;&gt; aides.w = 0.75</span>
<span class="sd">        &gt;&gt;&gt; model.calc_pq_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.pq</span>
<span class="sd">        pq(3.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">NU</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">LT</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">AUR</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">RF</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">AM</span><span class="p">,</span>
        <span class="n">wland_aides</span><span class="o">.</span><span class="n">W</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PQ</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">pq</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nu</span><span class="p">):</span>
            <span class="n">d_pq</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">aur</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">rf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">flu</span><span class="o">.</span><span class="n">am</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lt</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="n">SEALED</span><span class="p">:</span>
                <span class="n">d_pq</span> <span class="o">*=</span> <span class="n">aid</span><span class="o">.</span><span class="n">w</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">pq</span> <span class="o">+=</span> <span class="n">d_pq</span></div>


<div class="viewcode-block" id="Calc_Beta_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_Beta_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_Beta_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the evapotranspiration reduction factor.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      :math:`Beta = \frac{1 - x}{1 + x} \cdot \frac{1}{2} + \frac{1}{2}`</span>

<span class="sd">      :math:`x = exp \left( Zeta1 \cdot (DV - Zeta2) \right)`</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; zeta1(0.02)</span>
<span class="sd">        &gt;&gt;&gt; zeta2(400.0)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_beta_v1,</span>
<span class="sd">        ...     last_example=12,</span>
<span class="sd">        ...     parseqs=(states.dv, aides.beta)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.dv = (</span>
<span class="sd">        ...     -100.0, 0.0, 100.0, 200.0, 300.0, 400.0,</span>
<span class="sd">        ...     500.0, 600.0, 700.0, 800.0, 900.0, 100000.0</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |       dv |     beta |</span>
<span class="sd">        -----------------------------</span>
<span class="sd">        |   1 |   -100.0 | 0.999955 |</span>
<span class="sd">        |   2 |      0.0 | 0.999665 |</span>
<span class="sd">        |   3 |    100.0 | 0.997527 |</span>
<span class="sd">        |   4 |    200.0 | 0.982014 |</span>
<span class="sd">        |   5 |    300.0 | 0.880797 |</span>
<span class="sd">        |   6 |    400.0 |      0.5 |</span>
<span class="sd">        |   7 |    500.0 | 0.119203 |</span>
<span class="sd">        |   8 |    600.0 | 0.017986 |</span>
<span class="sd">        |   9 |    700.0 | 0.002473 |</span>
<span class="sd">        |  10 |    800.0 | 0.000335 |</span>
<span class="sd">        |  11 |    900.0 | 0.000045 |</span>
<span class="sd">        |  12 | 100000.0 |      0.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">Zeta1</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">Zeta2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">DV</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_aides</span><span class="o">.</span><span class="n">Beta</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">d_temp</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">zeta1</span> <span class="o">*</span> <span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">dv</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">zeta2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">d_temp</span> <span class="o">&gt;</span> <span class="mf">700.0</span><span class="p">:</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d_temp</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">d_temp</span><span class="p">)</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">d_temp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">d_temp</span><span class="p">)</span></div>


<div class="viewcode-block" id="Calc_ETV_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_ETV_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_ETV_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the actual evapotranspiration from the vadose zone.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        ETV = \Sigma \left( \frac{AUR}{AGR} \cdot (PETL -  EI) \cdot \begin{cases}</span>
<span class="sd">        0 &amp;|\ LT = SEALED</span>
<span class="sd">        \\</span>
<span class="sd">        Beta  &amp;|\ LT \neq SEALED</span>
<span class="sd">        \end{cases}  \right)</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nu(3)</span>
<span class="sd">        &gt;&gt;&gt; lt(FIELD, SOIL, SEALED)</span>
<span class="sd">        &gt;&gt;&gt; aur(0.4, 0.4, 0.2)</span>
<span class="sd">        &gt;&gt;&gt; derived.agr.update()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.petl = 5.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.ei = 1.0, 3.0, 2.0</span>
<span class="sd">        &gt;&gt;&gt; aides.beta = 0.75</span>
<span class="sd">        &gt;&gt;&gt; model.calc_etv_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.etv</span>
<span class="sd">        etv(2.25)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">NU</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">LT</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">AUR</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">AGR</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PETL</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">EI</span><span class="p">,</span>
        <span class="n">wland_aides</span><span class="o">.</span><span class="n">Beta</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">ETV</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">etv</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nu</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lt</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="n">SEALED</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">etv</span> <span class="o">+=</span> <span class="n">aid</span><span class="o">.</span><span class="n">beta</span> <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">aur</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">der</span><span class="o">.</span><span class="n">agr</span> <span class="o">*</span> <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">petl</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">ei</span><span class="p">[</span><span class="n">k</span><span class="p">])</span></div>


<div class="viewcode-block" id="Calc_ES_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_ES_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_ES_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the actual evaporation from the surface water reservoir.</span>

<span class="sd">    Basic equation (discontinous):</span>
<span class="sd">      .. math::</span>
<span class="sd">        ES = \begin{cases}</span>
<span class="sd">        PES &amp;|\ HS &gt; 0</span>
<span class="sd">        \\</span>
<span class="sd">        0 &amp;|\ HS \leq 0</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.pes = 5.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_es_v1,</span>
<span class="sd">        ...     last_example=9,</span>
<span class="sd">        ...     parseqs=(states.hs, fluxes.es)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.hs = -4.0, -3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0</span>

<span class="sd">        Without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |   hs |  es |</span>
<span class="sd">        --------------------</span>
<span class="sd">        |   1 | -4.0 | 0.0 |</span>
<span class="sd">        |   2 | -3.0 | 0.0 |</span>
<span class="sd">        |   3 | -2.0 | 0.0 |</span>
<span class="sd">        |   4 | -1.0 | 0.0 |</span>
<span class="sd">        |   5 |  0.0 | 2.5 |</span>
<span class="sd">        |   6 |  1.0 | 5.0 |</span>
<span class="sd">        |   7 |  2.0 | 5.0 |</span>
<span class="sd">        |   8 |  3.0 | 5.0 |</span>
<span class="sd">        |   9 |  4.0 | 5.0 |</span>

<span class="sd">        With smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(1.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |   hs |       es |</span>
<span class="sd">        -------------------------</span>
<span class="sd">        |   1 | -4.0 |      0.0 |</span>
<span class="sd">        |   2 | -3.0 | 0.000005 |</span>
<span class="sd">        |   3 | -2.0 |  0.00051 |</span>
<span class="sd">        |   4 | -1.0 |     0.05 |</span>
<span class="sd">        |   5 |  0.0 |      2.5 |</span>
<span class="sd">        |   6 |  1.0 |     4.95 |</span>
<span class="sd">        |   7 |  2.0 |  4.99949 |</span>
<span class="sd">        |   8 |  3.0 | 4.999995 |</span>
<span class="sd">        |   9 |  4.0 |      5.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">RH1</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PES</span><span class="p">,</span>
        <span class="n">wland_states</span><span class="o">.</span><span class="n">HS</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">ES</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">es</span> <span class="o">=</span> <span class="n">flu</span><span class="o">.</span><span class="n">pes</span> <span class="o">*</span> <span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_logistic1</span><span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">hs</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">rh1</span><span class="p">)</span></div>


<div class="viewcode-block" id="Calc_ET_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_ET_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_ET_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the total actual evapotranspiration.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`ET = ALR \cdot \bigl( \Sigma (AUR \cdot EI) + AGR \cdot ETV \bigl ) +</span>
<span class="sd">      ASR \cdot ES`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nu(2)</span>
<span class="sd">        &gt;&gt;&gt; aur(0.8, 0.2)</span>
<span class="sd">        &gt;&gt;&gt; derived.alr(0.8)</span>
<span class="sd">        &gt;&gt;&gt; derived.asr(0.2)</span>
<span class="sd">        &gt;&gt;&gt; derived.agr(0.5)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.ei = 0.5, 3.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.etv = 2.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.es = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_et_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.et</span>
<span class="sd">        et(2.2)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">NU</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">AUR</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">ALR</span><span class="p">,</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">ASR</span><span class="p">,</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">AGR</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">EI</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">ETV</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">ES</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">ET</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">d_ei</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nu</span><span class="p">):</span>
            <span class="n">d_ei</span> <span class="o">+=</span> <span class="n">con</span><span class="o">.</span><span class="n">aur</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">ei</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">et</span> <span class="o">=</span> <span class="n">der</span><span class="o">.</span><span class="n">alr</span> <span class="o">*</span> <span class="p">(</span><span class="n">d_ei</span> <span class="o">+</span> <span class="n">der</span><span class="o">.</span><span class="n">agr</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">etv</span><span class="p">)</span> <span class="o">+</span> <span class="n">der</span><span class="o">.</span><span class="n">asr</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">es</span></div>


<div class="viewcode-block" id="Calc_DVEq_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_DVEq_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_DVEq_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the equilibrium storage deficit of the vadose zone.</span>

<span class="sd">    Basic equation (discontinuous):</span>
<span class="sd">      .. math::</span>
<span class="sd">        DVEq = \begin{cases}</span>
<span class="sd">          0 &amp;|\ DG \leq PsiAE</span>
<span class="sd">          \\</span>
<span class="sd">          ThetaS \cdot \left( DG - \frac{DG^{1-1/b}}{(1-1/b) \cdot PsiAE^{-1/B}} -</span>
<span class="sd">          \frac{PsiAE}{1-B} \right) &amp;|\ PsiAE &lt; DG</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; thetas(0.4)</span>
<span class="sd">        &gt;&gt;&gt; psiae(300.0)</span>
<span class="sd">        &gt;&gt;&gt; b(5.0)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_dveq_v1,</span>
<span class="sd">        ...     last_example=6,</span>
<span class="sd">        ...     parseqs=(states.dg, aides.dveq)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.dg = 200.0, 300.0, 400.0, 800.0, 1600.0, 3200.0</span>

<span class="sd">        Without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |     dg |       dveq |</span>
<span class="sd">        -----------------------------</span>
<span class="sd">        |   1 |  200.0 |        0.0 |</span>
<span class="sd">        |   2 |  300.0 |        0.0 |</span>
<span class="sd">        |   3 |  400.0 |   1.182498 |</span>
<span class="sd">        |   4 |  800.0 |  21.249634 |</span>
<span class="sd">        |   5 | 1600.0 |  97.612368 |</span>
<span class="sd">        |   6 | 3200.0 | 313.415248 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaS</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">PsiAE</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">NUG</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">DG</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_aides</span><span class="o">.</span><span class="n">DVEq</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">nug</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span> <span class="o">&lt;</span> <span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">:</span>
                <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">thetas</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="n">sta</span><span class="o">.</span><span class="n">dg</span>
                    <span class="o">-</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
                    <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
                    <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">psiae</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
                    <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">psiae</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">nan</span></div>


<div class="viewcode-block" id="Return_DVH_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Return_DVH_V1">[docs]</a><span class="k">class</span> <span class="nc">Return_DVH_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Return the storage deficit of the vadose zone at a specific height above</span>
<span class="sd">    the groundwater table.</span>

<span class="sd">    Basic equation (discontinous):</span>
<span class="sd">      .. math::</span>
<span class="sd">        DVH = \begin{cases}</span>
<span class="sd">          0 &amp;|\ DG \leq PsiAE</span>
<span class="sd">          \\</span>
<span class="sd">          ThetaS \cdot \left(1 - \left( \frac{h}{PsiAE} \right)^{-1/b} \right)</span>
<span class="sd">          &amp;|\ PsiAE &lt; DG</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    This power law is the differential of the equation underlying method</span>
<span class="sd">    |Calc_DVEq_V1| with respect to height.  :cite:`ref-Brauer2014` also cites it</span>
<span class="sd">    (equation 6) but does not use it directly.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; thetas(0.4)</span>
<span class="sd">        &gt;&gt;&gt; psiae(300.0)</span>
<span class="sd">        &gt;&gt;&gt; b(5.0)</span>

<span class="sd">        With smoothing:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import repr_</span>
<span class="sd">        &gt;&gt;&gt; sh(0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; for h in [200.0, 299.0, 300.0, 301.0, 400.0, 500.0, 600.0]:</span>
<span class="sd">        ...     print(repr_(h), repr_(model.return_dvh_v1(h)))</span>
<span class="sd">        200.0 0.0</span>
<span class="sd">        299.0 0.0</span>
<span class="sd">        300.0 0.0</span>
<span class="sd">        301.0 0.000266</span>
<span class="sd">        400.0 0.022365</span>
<span class="sd">        500.0 0.038848</span>
<span class="sd">        600.0 0.05178</span>

<span class="sd">        Without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(1.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; for h in [200.0, 299.0, 300.0, 301.0, 400.0, 500.0, 600.0]:</span>
<span class="sd">        ...     print(repr_(h), repr_(model.return_dvh_v1(h)))</span>
<span class="sd">        200.0 0.0</span>
<span class="sd">        299.0 0.000001</span>
<span class="sd">        300.0 0.00004</span>
<span class="sd">        301.0 0.000267</span>
<span class="sd">        400.0 0.022365</span>
<span class="sd">        500.0 0.038848</span>
<span class="sd">        600.0 0.05178</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaS</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">PsiAE</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">RH1</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">d_h</span> <span class="o">=</span> <span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_max1</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">rh1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">con</span><span class="o">.</span><span class="n">thetas</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="p">(</span><span class="n">d_h</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">b</span><span class="p">))</span></div>


<div class="viewcode-block" id="Calc_DVEq_V2"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_DVEq_V2">[docs]</a><span class="k">class</span> <span class="nc">Calc_DVEq_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the equilibrium storage deficit of the vadose zone.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`DHEq = \int_{0}^{DG} Return\_DVH\_V1(h) \ \ dh`</span>

<span class="sd">    Method |Calc_DVEq_V2| integrates |Return_DVH_V1| numerically, based on the</span>
<span class="sd">    Lobatto-Gau quadrature.  Hence, it should give nearly identical results as</span>
<span class="sd">    method |Calc_DVEq_V1|, which provides the analytical solution to the underlying</span>
<span class="sd">    power law. The benefit of method |Calc_DVEq_V2| is that it supports the</span>
<span class="sd">    regularisation of |Return_DVH_V1|, which |Calc_DVEq_V1| does not.  In our</span>
<span class="sd">    experience, this benefit does not justify the additional numerical cost.</span>
<span class="sd">    However, we keep it for educational purposes; mainly as a starting point to</span>
<span class="sd">    implement alternative relationships between the soil water deficit and the</span>
<span class="sd">    groundwater table that we cannot solve analytically.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.nug(0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dveq_v2()</span>
<span class="sd">        &gt;&gt;&gt; aides.dveq</span>
<span class="sd">        dveq(nan)</span>

<span class="sd">        &gt;&gt;&gt; derived.nug(1)</span>
<span class="sd">        &gt;&gt;&gt; thetas(0.4)</span>
<span class="sd">        &gt;&gt;&gt; psiae(300.0)</span>
<span class="sd">        &gt;&gt;&gt; b(5.0)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_dveq_v2,</span>
<span class="sd">        ...     last_example=8,</span>
<span class="sd">        ...     parseqs=(states.dg, aides.dveq)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.dg = 200.0, 299.0, 300.0, 301.0, 400.0, 800.0, 1600.0, 3200.0</span>

<span class="sd">        Without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |     dg |       dveq |</span>
<span class="sd">        -----------------------------</span>
<span class="sd">        |   1 |  200.0 |        0.0 |</span>
<span class="sd">        |   2 |  299.0 |        0.0 |</span>
<span class="sd">        |   3 |  300.0 |        0.0 |</span>
<span class="sd">        |   4 |  301.0 |   0.000133 |</span>
<span class="sd">        |   5 |  400.0 |   1.182498 |</span>
<span class="sd">        |   6 |  800.0 |  21.249634 |</span>
<span class="sd">        |   7 | 1600.0 |  97.612368 |</span>
<span class="sd">        |   8 | 3200.0 | 313.415248 |</span>

<span class="sd">        With smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(1.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |     dg |       dveq |</span>
<span class="sd">        -----------------------------</span>
<span class="sd">        |   1 |  200.0 |        0.0 |</span>
<span class="sd">        |   2 |  299.0 |        0.0 |</span>
<span class="sd">        |   3 |  300.0 |   0.000033 |</span>
<span class="sd">        |   4 |  301.0 |   0.000176 |</span>
<span class="sd">        |   5 |  400.0 |   1.182542 |</span>
<span class="sd">        |   6 |  800.0 |   21.24972 |</span>
<span class="sd">        |   7 | 1600.0 |  97.612538 |</span>
<span class="sd">        |   8 | 3200.0 | 313.415588 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaS</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">PsiAE</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">SH</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">RH1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">DG</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_aides</span><span class="o">.</span><span class="n">DVEq</span><span class="p">,)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_DVH_V1</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">nug</span><span class="p">:</span>
            <span class="n">d_x0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.0</span> <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">sh</span>
            <span class="k">if</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span> <span class="o">&gt;</span> <span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">:</span>
                <span class="n">d_below</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">quaddveq_v1</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">d_x0</span><span class="p">,</span> <span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">)</span>
                <span class="n">d_above</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">quaddveq_v1</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">,</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">)</span>
                <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span> <span class="o">=</span> <span class="n">d_below</span> <span class="o">+</span> <span class="n">d_above</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">quaddveq_v1</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">d_x0</span><span class="p">,</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">nan</span></div>


<div class="viewcode-block" id="Calc_DVEq_V3"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_DVEq_V3">[docs]</a><span class="k">class</span> <span class="nc">Calc_DVEq_V3</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the equilibrium storage deficit of the vadose zone.</span>

<span class="sd">    Basic equation (discontinuous):</span>
<span class="sd">      .. math::</span>
<span class="sd">        DHEq = ThetaR \cdot DG + \begin{cases}</span>
<span class="sd">          0 &amp;|\ DG \leq PsiAE</span>
<span class="sd">          \\</span>
<span class="sd">          ThetaS \cdot \left( DG - \frac{DG^{1-1/b}}{(1-1/b) \cdot PsiAE^{-1/B}} -</span>
<span class="sd">          \frac{PsiAE}{1-B} \right) &amp;|\ PsiAE &lt; DG</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    Method |Calc_DVEq_V3| extends the original `WALRUS`_ relationship between the</span>
<span class="sd">    groundwater depth and the equilibrium water deficit of the vadose zone defined</span>
<span class="sd">    by equation 5 of :cite:`ref-Brauer2014` and implemented into application model</span>
<span class="sd">    |wland| by method |Calc_DVEq_V1|.  Parameter |ThetaR| introduces a (small)</span>
<span class="sd">    amount of water to fill the tension-saturated area directly above the groundwater</span>
<span class="sd">    table.  This &quot;residual saturation&quot; allows the direct injection of water into</span>
<span class="sd">    groundwater without risking infinitely fast groundwater depth changes.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; thetas(0.4)</span>
<span class="sd">        &gt;&gt;&gt; thetar(0.01)</span>
<span class="sd">        &gt;&gt;&gt; psiae(300.0)</span>
<span class="sd">        &gt;&gt;&gt; b(5.0)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_dveq_v3,</span>
<span class="sd">        ...     last_example=8,</span>
<span class="sd">        ...     parseqs=(states.dg, aides.dveq)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.dg = 200.0, 299.0, 300.0, 301.0, 400.0, 800.0, 1600.0, 3200.0</span>

<span class="sd">        Without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |     dg |       dveq |</span>
<span class="sd">        -----------------------------</span>
<span class="sd">        |   1 |  200.0 |        2.0 |</span>
<span class="sd">        |   2 |  299.0 |       2.99 |</span>
<span class="sd">        |   3 |  300.0 |        3.0 |</span>
<span class="sd">        |   4 |  301.0 |    3.01013 |</span>
<span class="sd">        |   5 |  400.0 |   5.152935 |</span>
<span class="sd">        |   6 |  800.0 |  28.718393 |</span>
<span class="sd">        |   7 | 1600.0 | 111.172058 |</span>
<span class="sd">        |   8 | 3200.0 | 337.579867 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaS</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaR</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">PsiAE</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">NUG</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">DG</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_aides</span><span class="o">.</span><span class="n">DVEq</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">nug</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span> <span class="o">&lt;</span> <span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">:</span>
                <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">thetar</span> <span class="o">*</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span> <span class="o">=</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">thetas</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">thetar</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="n">sta</span><span class="o">.</span><span class="n">dg</span>
                    <span class="o">-</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
                    <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
                    <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">psiae</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
                    <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">psiae</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
                <span class="p">)</span> <span class="o">+</span> <span class="n">con</span><span class="o">.</span><span class="n">thetar</span> <span class="o">*</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">nan</span></div>


<div class="viewcode-block" id="Return_DVH_V2"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Return_DVH_V2">[docs]</a><span class="k">class</span> <span class="nc">Return_DVH_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Return the storage deficit of the vadose zone at a specific height above</span>
<span class="sd">    the groundwater table.</span>

<span class="sd">    Basic equation (discontinous):</span>
<span class="sd">      .. math::</span>
<span class="sd">        DVH = ThetaR + \begin{cases}</span>
<span class="sd">          0 &amp;|\ DG \leq PsiAE</span>
<span class="sd">          \\</span>
<span class="sd">          (ThetaS-ThetaR) \cdot \left(1 - \left( \frac{h}{PsiAE} \right)^{-1/b} \right)</span>
<span class="sd">          &amp;|\ PsiAE &lt; DG</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    The given equation is the differential of the equation underlying method</span>
<span class="sd">    |Calc_DVEq_V3| with respect to height.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; thetas(0.4)</span>
<span class="sd">        &gt;&gt;&gt; thetar(0.01)</span>
<span class="sd">        &gt;&gt;&gt; psiae(300.0)</span>
<span class="sd">        &gt;&gt;&gt; b(5.0)</span>

<span class="sd">        With smoothing:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import repr_</span>
<span class="sd">        &gt;&gt;&gt; sh(0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; for h in [200.0, 299.0, 300.0, 301.0, 400.0, 500.0, 600.0]:</span>
<span class="sd">        ...     print(repr_(h), repr_(model.return_dvh_v2(h)))</span>
<span class="sd">        200.0 0.01</span>
<span class="sd">        299.0 0.01</span>
<span class="sd">        300.0 0.01</span>
<span class="sd">        301.0 0.010259</span>
<span class="sd">        400.0 0.031806</span>
<span class="sd">        500.0 0.047877</span>
<span class="sd">        600.0 0.060485</span>

<span class="sd">        Without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(1.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; for h in [200.0, 299.0, 300.0, 301.0, 400.0, 500.0, 600.0]:</span>
<span class="sd">        ...     print(repr_(h), repr_(model.return_dvh_v2(h)))</span>
<span class="sd">        200.0 0.01</span>
<span class="sd">        299.0 0.010001</span>
<span class="sd">        300.0 0.010039</span>
<span class="sd">        301.0 0.01026</span>
<span class="sd">        400.0 0.031806</span>
<span class="sd">        500.0 0.047877</span>
<span class="sd">        600.0 0.060485</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaS</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaR</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">PsiAE</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">RH1</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">d_h</span> <span class="o">=</span> <span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_max1</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">rh1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">con</span><span class="o">.</span><span class="n">thetar</span> <span class="o">+</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">thetas</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">thetar</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="p">(</span><span class="n">d_h</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">b</span><span class="p">))</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Calc_DVEq_V4"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_DVEq_V4">[docs]</a><span class="k">class</span> <span class="nc">Calc_DVEq_V4</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the equilibrium storage deficit of the vadose zone.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`DHEq = \int_{0}^{DG} Return\_DVH\_V2(h) \ \ dh`</span>

<span class="sd">    Method |Calc_DVEq_V4| integrates |Return_DVH_V2| numerically, based on the</span>
<span class="sd">    Lobatto-Gau quadrature.  The short discussion in the documentation on</span>
<span class="sd">    |Calc_DVEq_V2| (which integrates |Return_DVH_V1|) also applies on |Calc_DVEq_V4|.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.nug(0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dveq_v4()</span>
<span class="sd">        &gt;&gt;&gt; aides.dveq</span>
<span class="sd">        dveq(nan)</span>

<span class="sd">        &gt;&gt;&gt; derived.nug(1)</span>
<span class="sd">        &gt;&gt;&gt; thetas(0.4)</span>
<span class="sd">        &gt;&gt;&gt; thetar(0.01)</span>
<span class="sd">        &gt;&gt;&gt; psiae(300.0)</span>
<span class="sd">        &gt;&gt;&gt; b(5.0)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_dveq_v4,</span>
<span class="sd">        ...     last_example=8,</span>
<span class="sd">        ...     parseqs=(states.dg, aides.dveq)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.dg = 200.0, 299.0, 300.0, 301.0, 400.0, 800.0, 1600.0, 3200.0</span>

<span class="sd">        Without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |     dg |       dveq |</span>
<span class="sd">        -----------------------------</span>
<span class="sd">        |   1 |  200.0 |        2.0 |</span>
<span class="sd">        |   2 |  299.0 |       2.99 |</span>
<span class="sd">        |   3 |  300.0 |        3.0 |</span>
<span class="sd">        |   4 |  301.0 |    3.01013 |</span>
<span class="sd">        |   5 |  400.0 |   5.152935 |</span>
<span class="sd">        |   6 |  800.0 |  28.718393 |</span>
<span class="sd">        |   7 | 1600.0 | 111.172058 |</span>
<span class="sd">        |   8 | 3200.0 | 337.579867 |</span>

<span class="sd">        With smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(1.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |     dg |       dveq |</span>
<span class="sd">        -----------------------------</span>
<span class="sd">        |   1 |  200.0 |        2.1 |</span>
<span class="sd">        |   2 |  299.0 |       3.09 |</span>
<span class="sd">        |   3 |  300.0 |   3.100032 |</span>
<span class="sd">        |   4 |  301.0 |   3.110172 |</span>
<span class="sd">        |   5 |  400.0 |   5.252979 |</span>
<span class="sd">        |   6 |  800.0 |  28.818477 |</span>
<span class="sd">        |   7 | 1600.0 | 111.272224 |</span>
<span class="sd">        |   8 | 3200.0 | 337.680198 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaS</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaR</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">PsiAE</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">SH</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">RH1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">DG</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_aides</span><span class="o">.</span><span class="n">DVEq</span><span class="p">,)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_DVH_V2</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">nug</span><span class="p">:</span>
            <span class="n">d_x0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.0</span> <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">sh</span>
            <span class="k">if</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span> <span class="o">&gt;</span> <span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">:</span>
                <span class="n">d_below</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">quaddveq_v2</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">d_x0</span><span class="p">,</span> <span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">)</span>
                <span class="n">d_above</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">quaddveq_v2</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">,</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">)</span>
                <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span> <span class="o">=</span> <span class="n">d_below</span> <span class="o">+</span> <span class="n">d_above</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">quaddveq_v2</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">d_x0</span><span class="p">,</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">nan</span></div>


<div class="viewcode-block" id="Return_ErrorDV_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Return_ErrorDV_V1">[docs]</a><span class="k">class</span> <span class="nc">Return_ErrorDV_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the difference between the equilibrium and the actual storage</span>
<span class="sd">    deficit of the vadose zone.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`DVEq_{Calc\_DVEq\_V3} - DV`</span>

<span class="sd">    Method |Return_ErrorDV_V1| uses |Calc_DVEq_V3| to calculate the equilibrium</span>
<span class="sd">    deficit corresponding to the current groundwater depth.  The following example</span>
<span class="sd">    shows that it resets the values |DG| and |DVEq|,  which it needs to change</span>
<span class="sd">    temporarily, to their original states.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; thetas(0.4)</span>
<span class="sd">        &gt;&gt;&gt; thetar(0.01)</span>
<span class="sd">        &gt;&gt;&gt; psiae(300.0)</span>
<span class="sd">        &gt;&gt;&gt; b(5.0)</span>
<span class="sd">        &gt;&gt;&gt; states.dg = -9.0</span>
<span class="sd">        &gt;&gt;&gt; aides.dveq = -99.0</span>
<span class="sd">        &gt;&gt;&gt; states.dv = 3.152935</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(model.return_errordv_v1(400.0))</span>
<span class="sd">        2.0</span>
<span class="sd">        &gt;&gt;&gt; states.dg</span>
<span class="sd">        dg(-9.0)</span>
<span class="sd">        &gt;&gt;&gt; aides.dveq</span>
<span class="sd">        dveq(-99.0)</span>

<span class="sd">    Technical checks:</span>

<span class="sd">        As mentioned above, method |Return_ErrorDV_V1| changes the values of the</span>
<span class="sd">        sequences |DG| and |DVEq|, but only temporarily.  Hence, we do not include</span>
<span class="sd">        them into the method specifications, even if the following check considers</span>
<span class="sd">        this to be erroneous:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.core.testtools import check_selectedvariables</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland.wland_model import Return_ErrorDV_V1</span>
<span class="sd">        &gt;&gt;&gt; print(check_selectedvariables(Return_ErrorDV_V1))</span>
<span class="sd">        Definitely missing: dg and dveq</span>
<span class="sd">        Possibly missing (REQUIREDSEQUENCES):</span>
<span class="sd">            Calc_DVEq_V3: DG</span>
<span class="sd">        Possibly missing (RESULTSEQUENCES):</span>
<span class="sd">            Calc_DVEq_V3: DVEq</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaS</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaR</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">PsiAE</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">NUG</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">DV</span><span class="p">,)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Calc_DVEq_V3</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">dg</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">d_dveq</span><span class="p">,</span> <span class="n">d_dg</span> <span class="o">=</span> <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span><span class="p">,</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span>
        <span class="n">sta</span><span class="o">.</span><span class="n">dg</span> <span class="o">=</span> <span class="n">dg</span>
        <span class="n">model</span><span class="o">.</span><span class="n">calc_dveq_v3</span><span class="p">()</span>
        <span class="n">d_delta</span> <span class="o">=</span> <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span> <span class="o">-</span> <span class="n">sta</span><span class="o">.</span><span class="n">dv</span>
        <span class="n">aid</span><span class="o">.</span><span class="n">dveq</span><span class="p">,</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span> <span class="o">=</span> <span class="n">d_dveq</span><span class="p">,</span> <span class="n">d_dg</span>
        <span class="k">return</span> <span class="n">d_delta</span></div>


<div class="viewcode-block" id="Calc_DGEq_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_DGEq_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_DGEq_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the equilibrium groundwater depth.</span>

<span class="sd">    Method |Calc_DGEq_V1| calculates the equilibrium groundwater depth for the</span>
<span class="sd">    current water deficit of the vadose zone, following methods |Return_DVH_V2|</span>
<span class="sd">    and |Calc_DVEq_V3|.  As we are not aware of an analytical solution, we solve</span>
<span class="sd">    it numerically via class |PegasusDGEq|, which performs an iterative root-search</span>
<span class="sd">    based on the `Pegasus method`_.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; thetas(0.4)</span>
<span class="sd">        &gt;&gt;&gt; thetar(0.01)</span>
<span class="sd">        &gt;&gt;&gt; psiae(300.0)</span>
<span class="sd">        &gt;&gt;&gt; b(5.0)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_dgeq_v1,</span>
<span class="sd">        ...     last_example=13,</span>
<span class="sd">        ...     parseqs=(states.dv, aides.dgeq)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.dv = (</span>
<span class="sd">        ...     -1.0, -0.01, 0.0, 0.01, 1.0, 2.0, 2.99, 3.0,</span>
<span class="sd">        ...     3.01012983, 5.1529353, 28.71839324, 111.1720584, 337.5798671)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |         dv |   dgeq |</span>
<span class="sd">        -----------------------------</span>
<span class="sd">        |   1 |       -1.0 |    0.0 |</span>
<span class="sd">        |   2 |      -0.01 |    0.0 |</span>
<span class="sd">        |   3 |        0.0 |    0.0 |</span>
<span class="sd">        |   4 |       0.01 |    1.0 |</span>
<span class="sd">        |   5 |        1.0 |  100.0 |</span>
<span class="sd">        |   6 |        2.0 |  200.0 |</span>
<span class="sd">        |   7 |       2.99 |  299.0 |</span>
<span class="sd">        |   8 |        3.0 |  300.0 |</span>
<span class="sd">        |   9 |    3.01013 |  301.0 |</span>
<span class="sd">        |  10 |   5.152935 |  400.0 |</span>
<span class="sd">        |  11 |  28.718393 |  800.0 |</span>
<span class="sd">        |  12 | 111.172058 | 1600.0 |</span>
<span class="sd">        |  13 | 337.579867 | 3200.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaS</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaR</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">PsiAE</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">NUG</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">DV</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_aides</span><span class="o">.</span><span class="n">DGEq</span><span class="p">,)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_ErrorDV_V1</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">psiae</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">sta</span><span class="o">.</span><span class="n">dv</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">d_error</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">return_errordv_v1</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">d_error</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">aid</span><span class="o">.</span><span class="n">dgeq</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">pegasusdgeq</span><span class="o">.</span><span class="n">find_x</span><span class="p">(</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">,</span>
                    <span class="mf">10000.0</span><span class="p">,</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">,</span>
                    <span class="mf">1000000.0</span><span class="p">,</span>
                    <span class="mf">0.0</span><span class="p">,</span>
                    <span class="mf">1e-8</span><span class="p">,</span>
                    <span class="mi">20</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">aid</span><span class="o">.</span><span class="n">dgeq</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">pegasusdgeq</span><span class="o">.</span><span class="n">find_x</span><span class="p">(</span>
                    <span class="mf">0.0</span><span class="p">,</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">,</span>
                    <span class="mf">0.0</span><span class="p">,</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">psiae</span><span class="p">,</span>
                    <span class="mf">0.0</span><span class="p">,</span>
                    <span class="mf">1e-8</span><span class="p">,</span>
                    <span class="mi">20</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">dgeq</span> <span class="o">=</span> <span class="mf">0.0</span></div>


<div class="viewcode-block" id="Calc_GF_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_GF_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_GF_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the gain factor for changes in groundwater depth.</span>

<span class="sd">    Basic equation (discontinuous):</span>
<span class="sd">     .. math::</span>
<span class="sd">        GF = \begin{cases}</span>
<span class="sd">          0 &amp;|\ DG \leq 0</span>
<span class="sd">          \\</span>
<span class="sd">          Return\_DVH\_V2(DGEq - DG)^{-1} &amp;|\ 0 &lt; DG</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    The original `WALRUS`_ model attributes a passive role to groundwater dynamics.</span>
<span class="sd">    All water entering or leaving the underground is added to or subtracted from the</span>
<span class="sd">    vadose zone, and the groundwater table only reacts on such changes until it is in</span>
<span class="sd">    equilibrium with the updated water deficit in the vadose zone.  Hence, the movement</span>
<span class="sd">    of the groundwater table is generally slow.  However, in catchments with</span>
<span class="sd">    near-surface water tables, we often observe fast responses of groundwater to input</span>
<span class="sd">    forcings, maybe due to rapid infiltration along macropores or the re-infiltration</span>
<span class="sd">    of channel water.  In such situations, where the input water somehow bypasses the</span>
<span class="sd">    vadose zone, the speed of the rise of the groundwater table depends not only on</span>
<span class="sd">    the effective pore size of the soil material but also on the soil&#39;s degree of</span>
<span class="sd">    saturation directly above the groundwater table.  The smaller the remaining pore</span>
<span class="sd">    size, the larger the fraction between the water table&#39;s rise and the actual</span>
<span class="sd">    groundwater recharge.  We call this fraction the &quot;gain factor&quot; (|GF|).</span>

<span class="sd">    The `WALRUS`_ model does not explicitly account for the soil moisture in different</span>
<span class="sd">    depths above the groundwater table.  To keep the vertically lumped approach, we</span>
<span class="sd">    use the difference between the actual (|DG|) and the equilibrium groundwater depth</span>
<span class="sd">    (|DGEq|) as an indicator for the wetness above the groundwater table.  When |DG|</span>
<span class="sd">    is identical with |DGEq|, soil moisture and groundwater are in equilibrium.  Then,</span>
<span class="sd">    the tension-saturated area is fully developed, and the groundwater table moves</span>
<span class="sd">    quickly (depending on |ThetaR|).  The opposite case is when |DG| is much smaller</span>
<span class="sd">    than |DGEq|.  Such a situation occurs after a fast rise of the groundwater table</span>
<span class="sd">    when the soil water still needs much redistribution before it can be in equilibrium</span>
<span class="sd">    with groundwater.  In the most extreme case, the gain factor is just as large as</span>
<span class="sd">    indicated by the effective pore size alone (depending on |ThetaS|).</span>

<span class="sd">    The above discussion only applies as long as the groundwater table is below the</span>
<span class="sd">    soil surface.  For large-scale ponding (see :cite:`ref-Brauer2014`, section 5.11),</span>
<span class="sd">    we set |GF| to zero.  See the documentation on the methods |Calc_CDG_V1| and</span>
<span class="sd">    |Calc_FGS_V1| for related discussions.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; thetas(0.4)</span>
<span class="sd">        &gt;&gt;&gt; thetar(0.01)</span>
<span class="sd">        &gt;&gt;&gt; psiae(300.0)</span>
<span class="sd">        &gt;&gt;&gt; b(5.0)</span>
<span class="sd">        &gt;&gt;&gt; sh(0.0)</span>
<span class="sd">        &gt;&gt;&gt; aides.dgeq = 5000.0</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_gf_v1,</span>
<span class="sd">        ...     last_example=16,</span>
<span class="sd">        ...     parseqs=(states.dg, aides.gf)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.dg = (</span>
<span class="sd">        ...     -10.0, -1.0, 0.0, 1.0, 10.0,</span>
<span class="sd">        ...     1000.0, 2000.0, 3000.0, 4000.0, 4500.0, 4600.0,</span>
<span class="sd">        ...     4690.0, 4699.0, 4700.0, 4701.0, 4710.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |     dg |        gf |</span>
<span class="sd">        ----------------------------</span>
<span class="sd">        |   1 |  -10.0 |       0.0 |</span>
<span class="sd">        |   2 |   -1.0 |       0.0 |</span>
<span class="sd">        |   3 |    0.0 |   2.81175 |</span>
<span class="sd">        |   4 |    1.0 |  5.623782 |</span>
<span class="sd">        |   5 |   10.0 |  5.626316 |</span>
<span class="sd">        |   6 | 1000.0 |  5.963555 |</span>
<span class="sd">        |   7 | 2000.0 |  6.496601 |</span>
<span class="sd">        |   8 | 3000.0 |  7.510869 |</span>
<span class="sd">        |   9 | 4000.0 | 10.699902 |</span>
<span class="sd">        |  10 | 4500.0 |  20.88702 |</span>
<span class="sd">        |  11 | 4600.0 | 31.440737 |</span>
<span class="sd">        |  12 | 4690.0 | 79.686112 |</span>
<span class="sd">        |  13 | 4699.0 | 97.470815 |</span>
<span class="sd">        |  14 | 4700.0 |     100.0 |</span>
<span class="sd">        |  15 | 4701.0 |     100.0 |</span>
<span class="sd">        |  16 | 4710.0 |     100.0 |</span>

<span class="sd">        &gt;&gt;&gt; sh(1.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |     dg |        gf |</span>
<span class="sd">        ----------------------------</span>
<span class="sd">        |   1 |  -10.0 |       0.0 |</span>
<span class="sd">        |   2 |   -1.0 |  0.056232 |</span>
<span class="sd">        |   3 |    0.0 |   2.81175 |</span>
<span class="sd">        |   4 |    1.0 |  5.567544 |</span>
<span class="sd">        |   5 |   10.0 |  5.626316 |</span>
<span class="sd">        |   6 | 1000.0 |  5.963555 |</span>
<span class="sd">        |   7 | 2000.0 |  6.496601 |</span>
<span class="sd">        |   8 | 3000.0 |  7.510869 |</span>
<span class="sd">        |   9 | 4000.0 | 10.699902 |</span>
<span class="sd">        |  10 | 4500.0 |  20.88702 |</span>
<span class="sd">        |  11 | 4600.0 | 31.440737 |</span>
<span class="sd">        |  12 | 4690.0 | 79.686112 |</span>
<span class="sd">        |  13 | 4699.0 | 97.465434 |</span>
<span class="sd">        |  14 | 4700.0 | 99.609455 |</span>
<span class="sd">        |  15 | 4701.0 | 99.994314 |</span>
<span class="sd">        |  16 | 4710.0 |     100.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaS</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">ThetaR</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">PsiAE</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">RH1</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_states</span><span class="o">.</span><span class="n">DG</span><span class="p">,</span>
        <span class="n">wland_aides</span><span class="o">.</span><span class="n">DGEq</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_aides</span><span class="o">.</span><span class="n">GF</span><span class="p">,)</span>
    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_DVH_V2</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span><span class="o">.</span><span class="n">gf</span> <span class="o">=</span> <span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_logistic1</span><span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">dg</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">rh1</span><span class="p">)</span> <span class="o">/</span> <span class="n">model</span><span class="o">.</span><span class="n">return_dvh_v2</span><span class="p">(</span>
            <span class="n">aid</span><span class="o">.</span><span class="n">dgeq</span> <span class="o">-</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Calc_CDG_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_CDG_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_CDG_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the change in the groundwater depth due to percolation and</span>
<span class="sd">    capillary rise.</span>

<span class="sd">    Basic equation (discontinuous):</span>
<span class="sd">      :math:`CDG = \frac{DV-min(DVEq, DG)}{CV}`</span>

<span class="sd">    Note that this equation slightly differs from equation 6 of :cite:`ref-Brauer2014`.</span>
<span class="sd">    In case of large-scale ponding, |DVEq| always stays at zero and we let |DG|</span>
<span class="sd">    take control of the speed of the water table movement.  See the documentation</span>
<span class="sd">    on method |Calc_FGS_V1| for additional information on the differences between</span>
<span class="sd">    |wland| and `WALRUS`_ for this rare situation.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&#39;12h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; cv(10.0)</span>
<span class="sd">        &gt;&gt;&gt; sh(0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; states.dv = 100.0</span>
<span class="sd">        &gt;&gt;&gt; states.dg = 1000.0</span>
<span class="sd">        &gt;&gt;&gt; aides.dveq = 80.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_cdg_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.cdg</span>
<span class="sd">        cdg(1.0)</span>

<span class="sd">        Without large-scale ponding:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_cdg_v1,</span>
<span class="sd">        ...     last_example=5,</span>
<span class="sd">        ...     parseqs=(states.dg, fluxes.cdg)</span>
<span class="sd">        ... )</span>

<span class="sd">        With large-scale ponding and without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; states.dv = -10.0</span>
<span class="sd">        &gt;&gt;&gt; aides.dveq = 0.0</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.dg = 10.0, 1.0, 0.0, -1.0, -10.0</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |    dg |   cdg |</span>
<span class="sd">        -----------------------</span>
<span class="sd">        |   1 |  10.0 |  -0.5 |</span>
<span class="sd">        |   2 |   1.0 |  -0.5 |</span>
<span class="sd">        |   3 |   0.0 |  -0.5 |</span>
<span class="sd">        |   4 |  -1.0 | -0.45 |</span>
<span class="sd">        |   5 | -10.0 |   0.0 |</span>

<span class="sd">        With large-scale ponding and with smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(1.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |    dg |       cdg |</span>
<span class="sd">        ---------------------------</span>
<span class="sd">        |   1 |  10.0 |      -0.5 |</span>
<span class="sd">        |   2 |   1.0 | -0.499891 |</span>
<span class="sd">        |   3 |   0.0 | -0.492458 |</span>
<span class="sd">        |   4 |  -1.0 | -0.449891 |</span>
<span class="sd">        |   5 | -10.0 |       0.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_control</span><span class="o">.</span><span class="n">CV</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">RH1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_states</span><span class="o">.</span><span class="n">DG</span><span class="p">,</span>
        <span class="n">wland_states</span><span class="o">.</span><span class="n">DV</span><span class="p">,</span>
        <span class="n">wland_aides</span><span class="o">.</span><span class="n">DVEq</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">CDG</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">nug</span><span class="p">:</span>
            <span class="n">d_target</span> <span class="o">=</span> <span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_min1</span><span class="p">(</span><span class="n">aid</span><span class="o">.</span><span class="n">dveq</span><span class="p">,</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">rh1</span><span class="p">)</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">cdg</span> <span class="o">=</span> <span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">dv</span> <span class="o">-</span> <span class="n">d_target</span><span class="p">)</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">cv</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">cdg</span> <span class="o">=</span> <span class="mf">0.0</span></div>


<div class="viewcode-block" id="Calc_CDG_V2"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_CDG_V2">[docs]</a><span class="k">class</span> <span class="nc">Calc_CDG_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the change in the vadose zone&#39;s storage deficit due to percolation,</span>
<span class="sd">    capillary rise, macropore-infiltration, seepage, groundwater drainage, and</span>
<span class="sd">    channel water infiltration.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`CDG = \frac{DV-min(DVEq, DG)}{CV} + GF \cdot \big( FGS - PV - FXG \big)`</span>

<span class="sd">    Method |Calc_CDG_V2| extends |Calc_CDG_V1|, which implements the (nearly) original</span>
<span class="sd">    `WALRUS`_ relationship defined by equation 6 of :cite:`ref-Brauer2014`).  See the</span>
<span class="sd">    documentation on method |Calc_GF_V1| for a comprehensive explanation of the reason</span>
<span class="sd">    for this extension.</span>

<span class="sd">    Examples:</span>

<span class="sd">        Without large-scale ponding:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&#39;12h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; cv(10.0)</span>
<span class="sd">        &gt;&gt;&gt; sh(0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; states.dv = 100.0</span>
<span class="sd">        &gt;&gt;&gt; states.dg = 1000.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.pv = 1.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fxg = 2.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fgs = 4.0</span>
<span class="sd">        &gt;&gt;&gt; aides.dveq = 80.0</span>
<span class="sd">        &gt;&gt;&gt; aides.gf = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_cdg_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.cdg</span>
<span class="sd">        cdg(3.0)</span>

<span class="sd">        With large-scale ponding and without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_cdg_v2,</span>
<span class="sd">        ...     last_example=5,</span>
<span class="sd">        ...     parseqs=(states.dg, fluxes.cdg)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; aides.gf = 0.0</span>
<span class="sd">        &gt;&gt;&gt; states.dv = -10.0</span>
<span class="sd">        &gt;&gt;&gt; aides.dveq = 0.0</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.dg = 10.0, 1.0, 0.0, -1.0, -10.0</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |    dg |   cdg |</span>
<span class="sd">        -----------------------</span>
<span class="sd">        |   1 |  10.0 |  -0.5 |</span>
<span class="sd">        |   2 |   1.0 |  -0.5 |</span>
<span class="sd">        |   3 |   0.0 |  -0.5 |</span>
<span class="sd">        |   4 |  -1.0 | -0.45 |</span>
<span class="sd">        |   5 | -10.0 |   0.0 |</span>

<span class="sd">        With large-scale ponding and with smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(1.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh1.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |    dg |       cdg |</span>
<span class="sd">        ---------------------------</span>
<span class="sd">        |   1 |  10.0 |      -0.5 |</span>
<span class="sd">        |   2 |   1.0 | -0.499891 |</span>
<span class="sd">        |   3 |   0.0 | -0.492458 |</span>
<span class="sd">        |   4 |  -1.0 | -0.449891 |</span>
<span class="sd">        |   5 | -10.0 |       0.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_control</span><span class="o">.</span><span class="n">CV</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">RH1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PV</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">FGS</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">FXG</span><span class="p">,</span>
        <span class="n">wland_states</span><span class="o">.</span><span class="n">DG</span><span class="p">,</span>
        <span class="n">wland_states</span><span class="o">.</span><span class="n">DV</span><span class="p">,</span>
        <span class="n">wland_aides</span><span class="o">.</span><span class="n">DVEq</span><span class="p">,</span>
        <span class="n">wland_aides</span><span class="o">.</span><span class="n">GF</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">CDG</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">aid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">aides</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">nug</span><span class="p">:</span>
            <span class="n">d_target</span> <span class="o">=</span> <span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_min1</span><span class="p">(</span><span class="n">aid</span><span class="o">.</span><span class="n">dveq</span><span class="p">,</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">rh1</span><span class="p">)</span>
            <span class="n">d_cdg_slow</span> <span class="o">=</span> <span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">dv</span> <span class="o">-</span> <span class="n">d_target</span><span class="p">)</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">cv</span>
            <span class="n">d_cdg_fast</span> <span class="o">=</span> <span class="n">aid</span><span class="o">.</span><span class="n">gf</span> <span class="o">*</span> <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">fgs</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">pv</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">fxg</span><span class="p">)</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">cdg</span> <span class="o">=</span> <span class="n">d_cdg_slow</span> <span class="o">+</span> <span class="n">d_cdg_fast</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">cdg</span> <span class="o">=</span> <span class="mf">0.0</span></div>


<div class="viewcode-block" id="Calc_FGS_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_FGS_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_FGS_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the groundwater drainage or surface water infiltration.</span>

<span class="sd">    For large-scale ponding, |wland| and `WALRUS`_ calculate |FGS| differently</span>
<span class="sd">    (even for discontinuous parameterisations).  The `WALRUS`_  model redistributes</span>
<span class="sd">    water instantaneously in such cases (see :cite:`ref-Brauer2014`, section 5.11),</span>
<span class="sd">    which relates to infinitely high flow velocities and cannot be handled by the</span>
<span class="sd">    numerical integration algorithm underlying |wland|.  Hence, we instead introduce</span>
<span class="sd">    the parameter |CGF|.  Setting it to a value larger zero increases the flow</span>
<span class="sd">    velocity with increasing large-scale ponding.  The larger the value of |CGF|,</span>
<span class="sd">    the stronger the functional similarity of both approaches.  But note that very</span>
<span class="sd">    high values can result in increased computation times.</span>

<span class="sd">    Basic equations (discontinous):</span>
<span class="sd">      :math:`Gradient = CD - DG - HS`</span>

<span class="sd">      :math:`ContactSurface = max \left( CD - DG, HS \right)`</span>

<span class="sd">      :math:`Excess = max \left( -DG, HS - CD, 0 \right)`</span>

<span class="sd">      :math:`Conductivity = \frac{1 + CGF \cdot Excess}{CG}`</span>

<span class="sd">      :math:`FGS = Gradient \cdot ContactSurface \cdot Conductivity`</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&#39;12h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; cd(600.0)</span>
<span class="sd">        &gt;&gt;&gt; cg(10000.0)</span>
<span class="sd">        &gt;&gt;&gt; states.hs = 300.0</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(model=model,</span>
<span class="sd">        ...                 method=model.calc_fgs_v1,</span>
<span class="sd">        ...                 last_example=15,</span>
<span class="sd">        ...                 parseqs=(states.dg, states.hs, fluxes.fgs))</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.dg = (</span>
<span class="sd">        ...     -100.0, -1.0, 0.0, 1.0, 100.0, 200.0, 290.0, 299.0,</span>
<span class="sd">        ...     300.0, 301.0, 310.0, 400.0, 500.0, 600.0, 700.0)</span>

<span class="sd">        Without smoothing and without increased conductivity for large-scale ponding:</span>

<span class="sd">        &gt;&gt;&gt; cgf(0.0)</span>
<span class="sd">        &gt;&gt;&gt; sh(0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh2.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |     dg |    hs |     fgs |</span>
<span class="sd">        ----------------------------------</span>
<span class="sd">        |   1 | -100.0 | 300.0 |    14.0 |</span>
<span class="sd">        |   2 |   -1.0 | 300.0 | 9.04505 |</span>
<span class="sd">        |   3 |    0.0 | 300.0 |     9.0 |</span>
<span class="sd">        |   4 |    1.0 | 300.0 | 8.95505 |</span>
<span class="sd">        |   5 |  100.0 | 300.0 |     5.0 |</span>
<span class="sd">        |   6 |  200.0 | 300.0 |     2.0 |</span>
<span class="sd">        |   7 |  290.0 | 300.0 |   0.155 |</span>
<span class="sd">        |   8 |  299.0 | 300.0 | 0.01505 |</span>
<span class="sd">        |   9 |  300.0 | 300.0 |     0.0 |</span>
<span class="sd">        |  10 |  301.0 | 300.0 |  -0.015 |</span>
<span class="sd">        |  11 |  310.0 | 300.0 |   -0.15 |</span>
<span class="sd">        |  12 |  400.0 | 300.0 |    -1.5 |</span>
<span class="sd">        |  13 |  500.0 | 300.0 |    -3.0 |</span>
<span class="sd">        |  14 |  600.0 | 300.0 |    -4.5 |</span>
<span class="sd">        |  15 |  700.0 | 300.0 |    -6.0 |</span>

<span class="sd">        Without smoothing but with increased conductivity for large-scale ponding:</span>

<span class="sd">        &gt;&gt;&gt; cgf(0.1)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |     dg |    hs |      fgs |</span>
<span class="sd">        -----------------------------------</span>
<span class="sd">        |   1 | -100.0 | 300.0 |    294.0 |</span>
<span class="sd">        |   2 |   -1.0 | 300.0 | 10.85406 |</span>
<span class="sd">        |   3 |    0.0 | 300.0 |      9.0 |</span>
<span class="sd">        |   4 |    1.0 | 300.0 |  8.95505 |</span>
<span class="sd">        |   5 |  100.0 | 300.0 |      5.0 |</span>
<span class="sd">        |   6 |  200.0 | 300.0 |      2.0 |</span>
<span class="sd">        |   7 |  290.0 | 300.0 |    0.155 |</span>
<span class="sd">        |   8 |  299.0 | 300.0 |  0.01505 |</span>
<span class="sd">        |   9 |  300.0 | 300.0 |      0.0 |</span>
<span class="sd">        |  10 |  301.0 | 300.0 |   -0.015 |</span>
<span class="sd">        |  11 |  310.0 | 300.0 |    -0.15 |</span>
<span class="sd">        |  12 |  400.0 | 300.0 |     -1.5 |</span>
<span class="sd">        |  13 |  500.0 | 300.0 |     -3.0 |</span>
<span class="sd">        |  14 |  600.0 | 300.0 |     -4.5 |</span>
<span class="sd">        |  15 |  700.0 | 300.0 |     -6.0 |</span>

<span class="sd">        With smoothing and with increased conductivity for large-scale ponding:</span>

<span class="sd">        &gt;&gt;&gt; sh(1.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh2.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |     dg |    hs |      fgs |</span>
<span class="sd">        -----------------------------------</span>
<span class="sd">        |   1 | -100.0 | 300.0 |    294.0 |</span>
<span class="sd">        |   2 |   -1.0 | 300.0 | 10.87215 |</span>
<span class="sd">        |   3 |    0.0 | 300.0 | 9.369944 |</span>
<span class="sd">        |   4 |    1.0 | 300.0 |  8.97296 |</span>
<span class="sd">        |   5 |  100.0 | 300.0 |      5.0 |</span>
<span class="sd">        |   6 |  200.0 | 300.0 |      2.0 |</span>
<span class="sd">        |   7 |  290.0 | 300.0 |    0.155 |</span>
<span class="sd">        |   8 |  299.0 | 300.0 |  0.01505 |</span>
<span class="sd">        |   9 |  300.0 | 300.0 |      0.0 |</span>
<span class="sd">        |  10 |  301.0 | 300.0 |   -0.015 |</span>
<span class="sd">        |  11 |  310.0 | 300.0 |    -0.15 |</span>
<span class="sd">        |  12 |  400.0 | 300.0 |     -1.5 |</span>
<span class="sd">        |  13 |  500.0 | 300.0 |     -3.0 |</span>
<span class="sd">        |  14 |  600.0 | 300.0 |     -4.5 |</span>
<span class="sd">        |  15 |  700.0 | 300.0 |     -6.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">CD</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">CG</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">CGF</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">NUG</span><span class="p">,</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">RH2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_states</span><span class="o">.</span><span class="n">DG</span><span class="p">,</span>
        <span class="n">wland_states</span><span class="o">.</span><span class="n">HS</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">FGS</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">nug</span><span class="p">:</span>
            <span class="n">d_gradient</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cd</span> <span class="o">-</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span> <span class="o">-</span> <span class="n">sta</span><span class="o">.</span><span class="n">hs</span>
            <span class="n">d_contactsurface</span> <span class="o">=</span> <span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_max1</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">cd</span> <span class="o">-</span> <span class="n">sta</span><span class="o">.</span><span class="n">dg</span><span class="p">,</span> <span class="n">sta</span><span class="o">.</span><span class="n">hs</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">rh2</span><span class="p">)</span>
            <span class="n">d_excess</span> <span class="o">=</span> <span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_max2</span><span class="p">(</span><span class="o">-</span><span class="n">sta</span><span class="o">.</span><span class="n">dg</span><span class="p">,</span> <span class="n">sta</span><span class="o">.</span><span class="n">hs</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">cd</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">rh2</span><span class="p">)</span>
            <span class="n">d_conductivity</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">con</span><span class="o">.</span><span class="n">cgf</span> <span class="o">*</span> <span class="n">d_excess</span><span class="p">)</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">cg</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">fgs</span> <span class="o">=</span> <span class="n">d_gradient</span> <span class="o">*</span> <span class="n">d_contactsurface</span> <span class="o">*</span> <span class="n">d_conductivity</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">fgs</span> <span class="o">=</span> <span class="mf">0.0</span></div>


<div class="viewcode-block" id="Calc_FQS_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_FQS_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_FQS_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the quickflow.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`FQS = \frac{HQ}{CQ}`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&#39;12h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; cq(10.0)</span>
<span class="sd">        &gt;&gt;&gt; states.hq = 100.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_fqs_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fqs</span>
<span class="sd">        fqs(5.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">NU</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">CQ</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">HQ</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">FQS</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">nu</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">fqs</span> <span class="o">=</span> <span class="n">sta</span><span class="o">.</span><span class="n">hq</span> <span class="o">/</span> <span class="n">con</span><span class="o">.</span><span class="n">cq</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">fqs</span> <span class="o">=</span> <span class="mf">0.0</span></div>


<div class="viewcode-block" id="Calc_RH_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_RH_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_RH_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the runoff height.</span>

<span class="sd">    Basic equation (discontinuous):</span>
<span class="sd">      :math:`RH = CS \cdot \left( \frac{max(HS-HSMin, 0)}{CD-HSMin} \right) ^ {XS}`</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&#39;12h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; cs(2.0)</span>
<span class="sd">        &gt;&gt;&gt; cd(5.0)</span>
<span class="sd">        &gt;&gt;&gt; hsmin(2.0)</span>
<span class="sd">        &gt;&gt;&gt; xs(2.0)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import UnitTest</span>
<span class="sd">        &gt;&gt;&gt; test = UnitTest(</span>
<span class="sd">        ...     model=model,</span>
<span class="sd">        ...     method=model.calc_rh_v1,</span>
<span class="sd">        ...     last_example=11,</span>
<span class="sd">        ...     parseqs=(states.hs, fluxes.rh)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; test.nexts.hs = 0.0, 1.0, 1.9, 2.0, 2.1, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0</span>

<span class="sd">        Without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh2.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |  hs |       rh |</span>
<span class="sd">        ------------------------</span>
<span class="sd">        |   1 | 0.0 |      0.0 |</span>
<span class="sd">        |   2 | 1.0 |      0.0 |</span>
<span class="sd">        |   3 | 1.9 |      0.0 |</span>
<span class="sd">        |   4 | 2.0 |      0.0 |</span>
<span class="sd">        |   5 | 2.1 | 0.001111 |</span>
<span class="sd">        |   6 | 3.0 | 0.111111 |</span>
<span class="sd">        |   7 | 4.0 | 0.444444 |</span>
<span class="sd">        |   8 | 5.0 |      1.0 |</span>
<span class="sd">        |   9 | 6.0 | 1.777778 |</span>
<span class="sd">        |  10 | 7.0 | 2.777778 |</span>
<span class="sd">        |  11 | 8.0 |      4.0 |</span>

<span class="sd">        With smoothing:</span>

<span class="sd">        &gt;&gt;&gt; sh(0.1)</span>
<span class="sd">        &gt;&gt;&gt; derived.rh2.update()</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        | ex. |  hs |       rh |</span>
<span class="sd">        ------------------------</span>
<span class="sd">        |   1 | 0.0 |      0.0 |</span>
<span class="sd">        |   2 | 1.0 |      0.0 |</span>
<span class="sd">        |   3 | 1.9 | 0.000011 |</span>
<span class="sd">        |   4 | 2.0 | 0.000187 |</span>
<span class="sd">        |   5 | 2.1 | 0.001344 |</span>
<span class="sd">        |   6 | 3.0 | 0.111111 |</span>
<span class="sd">        |   7 | 4.0 | 0.444444 |</span>
<span class="sd">        |   8 | 5.0 |      1.0 |</span>
<span class="sd">        |   9 | 6.0 | 1.777778 |</span>
<span class="sd">        |  10 | 7.0 | 2.777778 |</span>
<span class="sd">        |  11 | 8.0 |      4.0 |</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">CS</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">CD</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">HSMin</span><span class="p">,</span>
        <span class="n">wland_control</span><span class="o">.</span><span class="n">XS</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">RH2</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">HS</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">RH</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">sta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">d_hs</span> <span class="o">=</span> <span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_logistic2</span><span class="p">(</span><span class="n">sta</span><span class="o">.</span><span class="n">hs</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">hsmin</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">rh2</span><span class="p">)</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">rh</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cs</span> <span class="o">*</span> <span class="p">(</span><span class="n">d_hs</span> <span class="o">/</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">cd</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">hsmin</span><span class="p">))</span> <span class="o">**</span> <span class="n">con</span><span class="o">.</span><span class="n">xs</span></div>


<div class="viewcode-block" id="Update_IC_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Update_IC_V1">[docs]</a><span class="k">class</span> <span class="nc">Update_IC_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Update the interception storage.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`\frac{dIC}{dt} = PC - TF - EI`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nu(1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.pc = 2.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.tf = 1.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.ei = 3.0</span>
<span class="sd">        &gt;&gt;&gt; states.ic.old = 4.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_ic_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.ic</span>
<span class="sd">        ic(2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_control</span><span class="o">.</span><span class="n">NU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PC</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">TF</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">EI</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">IC</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">old</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_old</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_new</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nu</span><span class="p">):</span>
            <span class="n">new</span><span class="o">.</span><span class="n">ic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">ic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">pc</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">tf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">ei</span><span class="p">[</span><span class="n">k</span><span class="p">])</span></div>


<div class="viewcode-block" id="Update_SP_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Update_SP_V1">[docs]</a><span class="k">class</span> <span class="nc">Update_SP_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Update the storage deficit.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`\frac{dSP}{dt} = SF - AM`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nu(1)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.sf = 1.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.am = 2.0</span>
<span class="sd">        &gt;&gt;&gt; states.sp.old = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_sp_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.sp</span>
<span class="sd">        sp(2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_control</span><span class="o">.</span><span class="n">NU</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">SF</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">AM</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">SP</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">old</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_old</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_new</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nu</span><span class="p">):</span>
            <span class="n">new</span><span class="o">.</span><span class="n">sp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">sp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">sf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">am</span><span class="p">[</span><span class="n">k</span><span class="p">])</span></div>


<div class="viewcode-block" id="Update_DV_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Update_DV_V1">[docs]</a><span class="k">class</span> <span class="nc">Update_DV_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Update the storage deficit of the vadose zone.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`\frac{dDV}{dt} = -(FXG + PV - ETV - FGS)`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fxg = 1.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.pv = 2.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.etv = 3.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fgs = 4.0</span>
<span class="sd">        &gt;&gt;&gt; states.dv.old = 5.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_dv_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.dv</span>
<span class="sd">        dv(9.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">NUG</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">FXG</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PV</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">ETV</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">FGS</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">DV</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">old</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_old</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_new</span>
        <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">nug</span><span class="p">:</span>
            <span class="n">new</span><span class="o">.</span><span class="n">dv</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">dv</span> <span class="o">-</span> <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">fxg</span> <span class="o">+</span> <span class="n">flu</span><span class="o">.</span><span class="n">pv</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">etv</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">fgs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new</span><span class="o">.</span><span class="n">dv</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">nan</span></div>


<div class="viewcode-block" id="Update_DG_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Update_DG_V1">[docs]</a><span class="k">class</span> <span class="nc">Update_DG_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Update the groundwater depth.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      :math:`\frac{dDG}{dt} = CDG`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; states.dg.old = 2.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.cdg = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_dg_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.dg</span>
<span class="sd">        dg(5.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">NUG</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">CDG</span><span class="p">,)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">DG</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">old</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_old</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_new</span>
        <span class="k">if</span> <span class="n">der</span><span class="o">.</span><span class="n">nug</span><span class="p">:</span>
            <span class="n">new</span><span class="o">.</span><span class="n">dg</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">dg</span> <span class="o">+</span> <span class="n">flu</span><span class="o">.</span><span class="n">cdg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new</span><span class="o">.</span><span class="n">dg</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">nan</span></div>


<div class="viewcode-block" id="Update_HQ_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Update_HQ_V1">[docs]</a><span class="k">class</span> <span class="nc">Update_HQ_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Update the level of the quickflow reservoir.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      :math:`\frac{dHQ}{dt} = PQ - FQS`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; states.hq.old = 2.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.pq = 3.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fqs = 4.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_hq_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.hq</span>
<span class="sd">        hq(1.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PQ</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">FQS</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">HQ</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">old</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_old</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_new</span>
        <span class="n">new</span><span class="o">.</span><span class="n">hq</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">hq</span> <span class="o">+</span> <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">pq</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">fqs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Update_HS_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Update_HS_V1">[docs]</a><span class="k">class</span> <span class="nc">Update_HS_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Update the surface water level.</span>

<span class="sd">    Basic equations:</span>
<span class="sd">      :math:`\frac{dHS}{dt} = PS - ETS + FXS</span>
<span class="sd">      + \frac{ALR \cdot \left(AGR \cdot FGS + FQS \right) - RH}{ASR}`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.alr(0.8)</span>
<span class="sd">        &gt;&gt;&gt; derived.asr(0.2)</span>
<span class="sd">        &gt;&gt;&gt; derived.agr(1.0)</span>
<span class="sd">        &gt;&gt;&gt; states.hs.old = 2.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fxs = 3.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.ps = 4.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.es = 5.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fgs = 6.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.fqs = 7.0</span>
<span class="sd">        &gt;&gt;&gt; fluxes.rh = 8.0</span>
<span class="sd">        &gt;&gt;&gt; model.update_hs_v1()</span>
<span class="sd">        &gt;&gt;&gt; states.hs</span>
<span class="sd">        hs(16.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">ALR</span><span class="p">,</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">ASR</span><span class="p">,</span>
        <span class="n">wland_derived</span><span class="o">.</span><span class="n">AGR</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">FXS</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">PS</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">ES</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">FGS</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">FQS</span><span class="p">,</span>
        <span class="n">wland_fluxes</span><span class="o">.</span><span class="n">RH</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">UPDATEDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_states</span><span class="o">.</span><span class="n">HS</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">old</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_old</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess_new</span>
        <span class="n">new</span><span class="o">.</span><span class="n">hs</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">old</span><span class="o">.</span><span class="n">hs</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">flu</span><span class="o">.</span><span class="n">fxs</span> <span class="o">+</span> <span class="n">flu</span><span class="o">.</span><span class="n">ps</span> <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">es</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">flu</span><span class="o">.</span><span class="n">rh</span> <span class="o">/</span> <span class="n">der</span><span class="o">.</span><span class="n">asr</span>
            <span class="o">+</span> <span class="n">der</span><span class="o">.</span><span class="n">alr</span> <span class="o">/</span> <span class="n">der</span><span class="o">.</span><span class="n">asr</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">fqs</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">der</span><span class="o">.</span><span class="n">alr</span> <span class="o">*</span> <span class="n">der</span><span class="o">.</span><span class="n">agr</span><span class="p">)</span> <span class="o">/</span> <span class="n">der</span><span class="o">.</span><span class="n">asr</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">fgs</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Calc_R_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Calc_R_V1">[docs]</a><span class="k">class</span> <span class="nc">Calc_R_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the runoff in m/s.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`R = QF \cdot RH`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wland import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; derived.qf(2.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.rh = 3.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_r_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.r</span>
<span class="sd">        r(6.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_derived</span><span class="o">.</span><span class="n">QF</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">RH</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">R</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">der</span><span class="o">.</span><span class="n">qf</span> <span class="o">*</span> <span class="n">flu</span><span class="o">.</span><span class="n">rh</span></div>


<div class="viewcode-block" id="Pass_R_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Pass_R_V1">[docs]</a><span class="k">class</span> <span class="nc">Pass_R_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Update the outlet link sequence.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">       :math:`Q = R`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_fluxes</span><span class="o">.</span><span class="n">R</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wland_outlets</span><span class="o">.</span><span class="n">Q</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">outlets</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">out</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">flu</span><span class="o">.</span><span class="n">r</span></div>


<div class="viewcode-block" id="PegasusDGEq"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.PegasusDGEq">[docs]</a><span class="k">class</span> <span class="nc">PegasusDGEq</span><span class="p">(</span><span class="n">roottools</span><span class="o">.</span><span class="n">Pegasus</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Pegasus iterator for finding the equilibrium groundwater depth.&quot;&quot;&quot;</span>

    <span class="n">METHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_ErrorDV_V1</span><span class="p">,)</span></div>


<div class="viewcode-block" id="QuadDVEq_V1"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.QuadDVEq_V1">[docs]</a><span class="k">class</span> <span class="nc">QuadDVEq_V1</span><span class="p">(</span><span class="n">quadtools</span><span class="o">.</span><span class="n">Quad</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adaptive quadrature method for integrating the equilibrium storage deficit</span>
<span class="sd">    of the vadose zone.&quot;&quot;&quot;</span>

    <span class="n">METHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_DVH_V1</span><span class="p">,)</span></div>


<div class="viewcode-block" id="QuadDVEq_V2"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.QuadDVEq_V2">[docs]</a><span class="k">class</span> <span class="nc">QuadDVEq_V2</span><span class="p">(</span><span class="n">quadtools</span><span class="o">.</span><span class="n">Quad</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adaptive quadrature method for integrating the equilibrium storage deficit</span>
<span class="sd">    of the vadose zone.&quot;&quot;&quot;</span>

    <span class="n">METHODS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Return_DVH_V2</span><span class="p">,)</span></div>


<div class="viewcode-block" id="Model"><a class="viewcode-back" href="../../../../wland.html#hydpy.models.wland.wland_model.Model">[docs]</a><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">ELSModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The *HydPy-W-Land* model.&quot;&quot;&quot;</span>

    <span class="n">SOLVERPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wland_solver</span><span class="o">.</span><span class="n">AbsErrorMax</span><span class="p">,</span>
        <span class="n">wland_solver</span><span class="o">.</span><span class="n">RelErrorMax</span><span class="p">,</span>
        <span class="n">wland_solver</span><span class="o">.</span><span class="n">RelDTMin</span><span class="p">,</span>
        <span class="n">wland_solver</span><span class="o">.</span><span class="n">RelDTMax</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">SOLVERSEQUENCES</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">INLET_METHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_FR_V1</span><span class="p">,</span>
        <span class="n">Calc_PM_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RECEIVER_METHODS</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">ADD_METHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Return_ErrorDV_V1</span><span class="p">,</span>
        <span class="n">Return_DVH_V1</span><span class="p">,</span>
        <span class="n">Return_DVH_V2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">PART_ODE_METHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_FXS_V1</span><span class="p">,</span>
        <span class="n">Calc_FXG_V1</span><span class="p">,</span>
        <span class="n">Calc_PC_V1</span><span class="p">,</span>
        <span class="n">Calc_PETL_V1</span><span class="p">,</span>
        <span class="n">Calc_PES_V1</span><span class="p">,</span>
        <span class="n">Calc_TF_V1</span><span class="p">,</span>
        <span class="n">Calc_EI_V1</span><span class="p">,</span>
        <span class="n">Calc_SF_V1</span><span class="p">,</span>
        <span class="n">Calc_RF_V1</span><span class="p">,</span>
        <span class="n">Calc_AM_V1</span><span class="p">,</span>
        <span class="n">Calc_PS_V1</span><span class="p">,</span>
        <span class="n">Calc_W_V1</span><span class="p">,</span>
        <span class="n">Calc_PV_V1</span><span class="p">,</span>
        <span class="n">Calc_PQ_V1</span><span class="p">,</span>
        <span class="n">Calc_Beta_V1</span><span class="p">,</span>
        <span class="n">Calc_ETV_V1</span><span class="p">,</span>
        <span class="n">Calc_ES_V1</span><span class="p">,</span>
        <span class="n">Calc_FQS_V1</span><span class="p">,</span>
        <span class="n">Calc_FGS_V1</span><span class="p">,</span>
        <span class="n">Calc_RH_V1</span><span class="p">,</span>
        <span class="n">Calc_DVEq_V1</span><span class="p">,</span>
        <span class="n">Calc_DVEq_V2</span><span class="p">,</span>
        <span class="n">Calc_DVEq_V3</span><span class="p">,</span>
        <span class="n">Calc_DVEq_V4</span><span class="p">,</span>
        <span class="n">Calc_DGEq_V1</span><span class="p">,</span>
        <span class="n">Calc_GF_V1</span><span class="p">,</span>
        <span class="n">Calc_CDG_V1</span><span class="p">,</span>
        <span class="n">Calc_CDG_V2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">FULL_ODE_METHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Update_IC_V1</span><span class="p">,</span>
        <span class="n">Update_SP_V1</span><span class="p">,</span>
        <span class="n">Update_DV_V1</span><span class="p">,</span>
        <span class="n">Update_DG_V1</span><span class="p">,</span>
        <span class="n">Update_HQ_V1</span><span class="p">,</span>
        <span class="n">Update_HS_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">OUTLET_METHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_ET_V1</span><span class="p">,</span>
        <span class="n">Calc_R_V1</span><span class="p">,</span>
        <span class="n">Pass_R_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">SENDER_METHODS</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">SUBMODELS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">PegasusDGEq</span><span class="p">,</span>
        <span class="n">QuadDVEq_V1</span><span class="p">,</span>
        <span class="n">QuadDVEq_V2</span><span class="p">,</span>
    <span class="p">)</span></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/HydPy_Logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../../../index.html">Table of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../how_to.html">How to</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../framework.html">Framework Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../modelcollection.html">Model Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples.html">Example Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../zbibliography.html">Bibliography</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">HydPy 4.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">hydpy.models.wland.wland_model</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, HydPy Developers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.2.
    </div>
  </body>
</html>
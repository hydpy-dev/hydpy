<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hydpy.models.wq.wq_model &#8212; HydPy 6.1.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/classic.css?v=127cebf3" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
    
    <script src="../../../../_static/documentation_options.js?v=3b4955ce"></script>
    <script src="../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">HydPy 6.1.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">hydpy.models.wq.wq_model</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/HydPy_Logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="../../../../index.html">Table of Contents</a></h3>
    <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../example_projects.html">Example Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference_manual.html">Reference Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../zbibliography.html">Bibliography</a></li>
</ul>

  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for hydpy.models.wq.wq_model</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># pylint: disable=missing-module-docstring</span>

<span class="c1"># imports...</span>
<span class="c1"># ...from site-packages</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># ...from HydPy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">importtools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">modeltools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">objecttools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.core.typingtools</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.cythons</span><span class="w"> </span><span class="kn">import</span> <span class="n">modelutils</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.cythons</span><span class="w"> </span><span class="kn">import</span> <span class="n">smoothutils</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.interfaces</span><span class="w"> </span><span class="kn">import</span> <span class="n">dischargeinterfaces</span>

<span class="c1"># ...from wq</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models.wq</span><span class="w"> </span><span class="kn">import</span> <span class="n">wq_control</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models.wq</span><span class="w"> </span><span class="kn">import</span> <span class="n">wq_derived</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models.wq</span><span class="w"> </span><span class="kn">import</span> <span class="n">wq_factors</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models.wq</span><span class="w"> </span><span class="kn">import</span> <span class="n">wq_fluxes</span>


<div class="viewcode-block" id="Calculate_Discharge_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calculate_Discharge_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calculate_Discharge_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the discharge based on the water depth given in m according to</span>
<span class="sd">    :cite:t:`ref-Brauer2014` and return it in mm/T.</span>

<span class="sd">    Basic equation (discontinuous):</span>
<span class="sd">      .. math::</span>
<span class="sd">        q = q_{max} \cdot \left( \frac{max(h-h_{max}, \ 0)}{h_{max}-h_{min}} \right)^x</span>
<span class="sd">        \\ \\</span>
<span class="sd">        q = Discharge \\</span>
<span class="sd">        q_{max} = BankfullDischarge \\</span>
<span class="sd">        h = waterdepth \\</span>
<span class="sd">        h_{max} = ChannelDepth \\</span>
<span class="sd">        h_{min} = CrestHeight \\</span>
<span class="sd">        x = DischargeExponent</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq_walrus import *</span>
<span class="sd">        &gt;&gt;&gt; simulationstep(&quot;12h&quot;)</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&quot;1d&quot;)</span>
<span class="sd">        &gt;&gt;&gt; channeldepth(5.0)</span>
<span class="sd">        &gt;&gt;&gt; crestheight(2.0)</span>
<span class="sd">        &gt;&gt;&gt; bankfulldischarge(2.0)</span>
<span class="sd">        &gt;&gt;&gt; dischargeexponent(2.0)</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; hs = 1.0, 1.9, 2.0, 2.1, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0</span>

<span class="sd">        Without smoothing:</span>

<span class="sd">        &gt;&gt;&gt; crestheighttolerance(0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.crestheightregularisation.update()</span>
<span class="sd">        &gt;&gt;&gt; for h in hs:</span>
<span class="sd">        ...     round_([h, model.calculate_discharge_v1(h)])</span>
<span class="sd">        1.0, 0.0</span>
<span class="sd">        1.9, 0.0</span>
<span class="sd">        2.0, 0.0</span>
<span class="sd">        2.1, 0.001111</span>
<span class="sd">        3.0, 0.111111</span>
<span class="sd">        4.0, 0.444444</span>
<span class="sd">        5.0, 1.0</span>
<span class="sd">        6.0, 1.777778</span>
<span class="sd">        7.0, 2.777778</span>
<span class="sd">        8.0, 4.0</span>

<span class="sd">        Without smooting:</span>

<span class="sd">        &gt;&gt;&gt; crestheighttolerance(0.1)</span>
<span class="sd">        &gt;&gt;&gt; derived.crestheightregularisation.update()</span>
<span class="sd">        &gt;&gt;&gt; for h in hs:</span>
<span class="sd">        ...     round_([h, model.calculate_discharge_v1(h)])</span>
<span class="sd">        1.0, 0.0</span>
<span class="sd">        1.9, 0.0</span>
<span class="sd">        2.0, 0.00001</span>
<span class="sd">        2.1, 0.001111</span>
<span class="sd">        3.0, 0.111111</span>
<span class="sd">        4.0, 0.444444</span>
<span class="sd">        5.0, 1.0</span>
<span class="sd">        6.0, 1.777778</span>
<span class="sd">        7.0, 2.777778</span>
<span class="sd">        8.0, 4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">ChannelDepth</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">CrestHeight</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BankfullDischarge</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">DischargeExponent</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_derived</span><span class="o">.</span><span class="n">CrestHeightRegularisation</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">waterdepth</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">h</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">smoothutils</span><span class="o">.</span><span class="n">smooth_logistic2</span><span class="p">(</span>
            <span class="n">waterdepth</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">crestheight</span><span class="p">,</span> <span class="n">der</span><span class="o">.</span><span class="n">crestheightregularisation</span>
        <span class="p">)</span>
        <span class="n">f</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="p">(</span><span class="n">h</span> <span class="o">/</span> <span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">channeldepth</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">crestheight</span><span class="p">))</span> <span class="o">**</span> <span class="n">con</span><span class="o">.</span><span class="n">dischargeexponent</span>
        <span class="k">return</span> <span class="n">con</span><span class="o">.</span><span class="n">bankfulldischarge</span> <span class="o">*</span> <span class="n">f</span></div>



<div class="viewcode-block" id="Calc_WaterDepth_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_WaterDepth_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WaterDepth_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the water depth based on the current water level.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        WaterDepth = max(WaterLevel - BottomLevels_{\,0}, \ 0)</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(2)</span>
<span class="sd">        &gt;&gt;&gt; bottomlevels(2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterlevel(6.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_waterdepth_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.waterdepth</span>
<span class="sd">        waterdepth(4.0)</span>

<span class="sd">        &gt;&gt;&gt; factors.waterlevel(1.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_waterdepth_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.waterdepth</span>
<span class="sd">        waterdepth(0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_control</span><span class="o">.</span><span class="n">BottomLevels</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterLevel</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SegmentModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">fac</span><span class="o">.</span><span class="n">waterdepth</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">fac</span><span class="o">.</span><span class="n">waterlevel</span> <span class="o">-</span> <span class="n">con</span><span class="o">.</span><span class="n">bottomlevels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_WaterDepth_V2">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_WaterDepth_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WaterDepth_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the water depth based on the current wetted area.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        WaterDepth = \begin{cases}</span>
<span class="sd">        a / w &amp;|\ s = 0 \\</span>
<span class="sd">        \left( \sqrt{4 \cdot s \cdot a + w^2} - w \right) / (2 \cdot s) &amp;|\ s &gt; 0 \\</span>
<span class="sd">        \end{cases}</span>
<span class="sd">        \\</span>
<span class="sd">        a = WettedArea \\</span>
<span class="sd">        w = BottomWidth \\</span>
<span class="sd">        s = SideSlope</span>

<span class="sd">    Examples:</span>

<span class="sd">        One can understand |Calc_WaterDepth_V2| as an inverse method of</span>
<span class="sd">        |Calc_WettedAreas_V1| (and |Calc_WettedArea_V1|).  Hence, the following</span>
<span class="sd">        convenience function allows the creation of examples that are directly</span>
<span class="sd">        comparable to those on method |Calc_WettedAreas_V1|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import print_vector, round_</span>
<span class="sd">        &gt;&gt;&gt; def test(*wettedareas):</span>
<span class="sd">        ...     derived.trapezeheights.update()</span>
<span class="sd">        ...     derived.slopewidths.update()</span>
<span class="sd">        ...     derived.trapezeareas.update()</span>
<span class="sd">        ...     for a in wettedareas:</span>
<span class="sd">        ...         factors.wettedarea = a</span>
<span class="sd">        ...         model.calc_waterdepth_v2()</span>
<span class="sd">        ...         print_vector([a, factors.waterdepth.value])</span>

<span class="sd">        The first example deals with identical rectangular trapezes.  We pass different</span>
<span class="sd">        wetted areas to the test function.  These are the sums of the wetted areas of</span>
<span class="sd">        the different trapeze ranges calculated in the first example on method</span>
<span class="sd">        |Calc_WettedAreas_V1|.  As expected, method |Calc_WaterDepth_V2| finds the</span>
<span class="sd">        water depths used as input data for this example.  However, note that negative</span>
<span class="sd">        wetted areas result in zero water depths:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(3)</span>
<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedarea = 0.0</span>
<span class="sd">        &gt;&gt;&gt; test(-0.5, 0.0, 1.0, 2.0, 4.0, 6.0, 9.0, 12.0, 15.0, 18.0)</span>
<span class="sd">        -0.5, 0.0</span>
<span class="sd">        0.0, 0.0</span>
<span class="sd">        1.0, 0.5</span>
<span class="sd">        2.0, 1.0</span>
<span class="sd">        4.0, 1.5</span>
<span class="sd">        6.0, 2.0</span>
<span class="sd">        9.0, 2.5</span>
<span class="sd">        12.0, 3.0</span>
<span class="sd">        15.0, 3.5</span>
<span class="sd">        18.0, 4.0</span>

<span class="sd">        The second example deals with identical triangular trapezes and corresponds to</span>
<span class="sd">        the second example on method |Calc_WettedAreas_V1|:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(0.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(2.0)</span>
<span class="sd">        &gt;&gt;&gt; test(-0.5, 0.0, 0.5, 2.0, 4.5, 8.0, 12.5, 18.0, 24.5, 32.0)</span>
<span class="sd">        -0.5, 0.0</span>
<span class="sd">        0.0, 0.0</span>
<span class="sd">        0.5, 0.5</span>
<span class="sd">        2.0, 1.0</span>
<span class="sd">        4.5, 1.5</span>
<span class="sd">        8.0, 2.0</span>
<span class="sd">        12.5, 2.5</span>
<span class="sd">        18.0, 3.0</span>
<span class="sd">        24.5, 3.5</span>
<span class="sd">        32.0, 4.0</span>

<span class="sd">        The third example deals with identical &quot;complete&quot; trapezes and corresponds to</span>
<span class="sd">        the third example on method |Calc_WettedAreas_V1|:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(2.0)</span>
<span class="sd">        &gt;&gt;&gt; test(-0.5, 0.0, 1.5, 4.0, 8.5, 14.0, 21.5, 30.0, 39.5, 50.0)</span>
<span class="sd">        -0.5, 0.0</span>
<span class="sd">        0.0, 0.0</span>
<span class="sd">        1.5, 0.5</span>
<span class="sd">        4.0, 1.0</span>
<span class="sd">        8.5, 1.5</span>
<span class="sd">        14.0, 2.0</span>
<span class="sd">        21.5, 2.5</span>
<span class="sd">        30.0, 3.0</span>
<span class="sd">        39.5, 3.5</span>
<span class="sd">        50.0, 4.0</span>

<span class="sd">        The fourth example mixes three different geometries and corresponds to the</span>
<span class="sd">        fourth example on method |Calc_WettedAreas_V1|:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 3.0, 4.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0, 0.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0, 2.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; test(-0.5, 0.0, 1.0, 2.0, 3.0, 4.0, 5.5, 8.0, 12.5, 18.0)</span>
<span class="sd">        -0.5, 0.0</span>
<span class="sd">        0.0, 0.0</span>
<span class="sd">        1.0, 0.5</span>
<span class="sd">        2.0, 1.0</span>
<span class="sd">        3.0, 1.5</span>
<span class="sd">        4.0, 2.0</span>
<span class="sd">        5.5, 2.5</span>
<span class="sd">        8.0, 3.0</span>
<span class="sd">        12.5, 3.5</span>
<span class="sd">        18.0, 4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomWidths</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">SideSlopes</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">TrapezeHeights</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">SlopeWidths</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">TrapezeAreas</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedArea</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SegmentModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">a</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">wettedarea</span>
        <span class="n">d</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">w</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbtrapezes</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="n">der</span><span class="o">.</span><span class="n">trapezeareas</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">a</span> <span class="o">-=</span> <span class="n">der</span><span class="o">.</span><span class="n">trapezeareas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">d</span> <span class="o">+=</span> <span class="n">der</span><span class="o">.</span><span class="n">trapezeheights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">w</span> <span class="o">+=</span> <span class="n">con</span><span class="o">.</span><span class="n">bottomwidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">der</span><span class="o">.</span><span class="n">slopewidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">w</span> <span class="o">+=</span> <span class="n">con</span><span class="o">.</span><span class="n">bottomwidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">ss</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">sideslopes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">ss</span> <span class="o">&gt;</span> <span class="mf">1e-10</span><span class="p">:</span>
                        <span class="n">d</span> <span class="o">+=</span> <span class="p">((</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">ss</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">w</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">ss</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">d</span> <span class="o">+=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">w</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">waterdepth</span> <span class="o">=</span> <span class="n">d</span>
                <span class="k">break</span></div>



<div class="viewcode-block" id="Calc_WaterLevel_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_WaterLevel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WaterLevel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the water level based on the current water depth.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        WaterLevel = WaterDepth + BottomLevels_{\,0}</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(2)</span>
<span class="sd">        &gt;&gt;&gt; bottomlevels(2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterdepth(4.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_waterlevel_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.waterlevel</span>
<span class="sd">        waterlevel(6.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_control</span><span class="o">.</span><span class="n">BottomLevels</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterLevel</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SegmentModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">fac</span><span class="o">.</span><span class="n">waterlevel</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">waterdepth</span> <span class="o">+</span> <span class="n">con</span><span class="o">.</span><span class="n">bottomlevels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>



<div class="viewcode-block" id="Calc_WettedAreas_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_WettedAreas_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WettedAreas_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the wetted area for each trapeze range.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        WettedAreas_i = \begin{cases}</span>
<span class="sd">        0 &amp;|\ d &lt; 0 \\</span>
<span class="sd">        (W_B + S_S\cdot d) \cdot d &amp;|\ 0 \leq d &lt; H_T \\</span>
<span class="sd">        (W_B + W_S / 2) \cdot H_T + (W_B + W_S) \cdot (d - H_T) &amp;|\ H_T \leq d \\</span>
<span class="sd">        \end{cases}</span>
<span class="sd">        \\ \\</span>
<span class="sd">        d = WaterDepth - BottomDepth_i \\</span>
<span class="sd">        H_T = TrapezeHeights_i \\</span>
<span class="sd">        W_B = BottomWidths_i \\</span>
<span class="sd">        S_S = SideSlopes_i \\</span>
<span class="sd">        W_S = SlopeWidths_i</span>

<span class="sd">    Examples:</span>

<span class="sd">        The following convenience function executes |Calc_WettedAreas_V1| for different</span>
<span class="sd">        water depths and prints the resulting wetted areas:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import print_vector, round_</span>
<span class="sd">        &gt;&gt;&gt; def test():</span>
<span class="sd">        ...     derived.bottomdepths.update()</span>
<span class="sd">        ...     derived.trapezeheights.update()</span>
<span class="sd">        ...     derived.slopewidths.update()</span>
<span class="sd">        ...     for d in [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0]:</span>
<span class="sd">        ...         factors.waterdepth = d</span>
<span class="sd">        ...         model.calc_wettedareas_v1()</span>
<span class="sd">        ...         round_(d, end=&quot;: &quot;)</span>
<span class="sd">        ...         print_vector(factors.wettedareas.values)</span>

<span class="sd">        The first example deals with identical rectangular trapezes.  There are no</span>
<span class="sd">        differences except those due to the different bottom levels:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(3)</span>
<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 0.0, 0.0, 0.0</span>
<span class="sd">        0.5: 1.0, 0.0, 0.0</span>
<span class="sd">        1.0: 2.0, 0.0, 0.0</span>
<span class="sd">        1.5: 3.0, 1.0, 0.0</span>
<span class="sd">        2.0: 4.0, 2.0, 0.0</span>
<span class="sd">        2.5: 5.0, 3.0, 1.0</span>
<span class="sd">        3.0: 6.0, 4.0, 2.0</span>
<span class="sd">        3.5: 7.0, 5.0, 3.0</span>
<span class="sd">        4.0: 8.0, 6.0, 4.0</span>

<span class="sd">        The second example deals with identical triangular trapezes.  Here, the heights</span>
<span class="sd">        of the individual trapezes also matter because they mark where the triangular</span>
<span class="sd">        shape switches to a rectangular shape:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(0.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(2.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 0.0, 0.0, 0.0</span>
<span class="sd">        0.5: 0.5, 0.0, 0.0</span>
<span class="sd">        1.0: 2.0, 0.0, 0.0</span>
<span class="sd">        1.5: 4.0, 0.5, 0.0</span>
<span class="sd">        2.0: 6.0, 2.0, 0.0</span>
<span class="sd">        2.5: 8.0, 4.0, 0.5</span>
<span class="sd">        3.0: 10.0, 6.0, 2.0</span>
<span class="sd">        3.5: 12.0, 8.0, 4.5</span>
<span class="sd">        4.0: 14.0, 10.0, 8.0</span>

<span class="sd">        The third example deals with identical &quot;complete&quot; trapezes by combining the</span>
<span class="sd">        first two geometries:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(2.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 0.0, 0.0, 0.0</span>
<span class="sd">        0.5: 1.5, 0.0, 0.0</span>
<span class="sd">        1.0: 4.0, 0.0, 0.0</span>
<span class="sd">        1.5: 7.0, 1.5, 0.0</span>
<span class="sd">        2.0: 10.0, 4.0, 0.0</span>
<span class="sd">        2.5: 13.0, 7.0, 1.5</span>
<span class="sd">        3.0: 16.0, 10.0, 4.0</span>
<span class="sd">        3.5: 19.0, 13.0, 7.5</span>
<span class="sd">        4.0: 22.0, 16.0, 12.0</span>

<span class="sd">        The fourth example mixes three different geometries:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 3.0, 4.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0, 0.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0, 2.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 0.0, 0.0, 0.0</span>
<span class="sd">        0.5: 1.0, 0.0, 0.0</span>
<span class="sd">        1.0: 2.0, 0.0, 0.0</span>
<span class="sd">        1.5: 3.0, 0.0, 0.0</span>
<span class="sd">        2.0: 4.0, 0.0, 0.0</span>
<span class="sd">        2.5: 5.0, 0.5, 0.0</span>
<span class="sd">        3.0: 6.0, 2.0, 0.0</span>
<span class="sd">        3.5: 7.0, 4.0, 1.5</span>
<span class="sd">        4.0: 8.0, 6.0, 4.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomWidths</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">SideSlopes</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">BottomDepths</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">TrapezeHeights</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">SlopeWidths</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedAreas</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SegmentModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbtrapezes</span><span class="p">):</span>
            <span class="n">d</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">waterdepth</span> <span class="o">-</span> <span class="n">der</span><span class="o">.</span><span class="n">bottomdepths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">wettedareas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ht</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">der</span><span class="o">.</span><span class="n">trapezeheights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">wb</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">bottomwidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">ht</span><span class="p">:</span>
                    <span class="n">ss</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">sideslopes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">wettedareas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">wb</span> <span class="o">+</span> <span class="n">ss</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="n">d</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ws</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">der</span><span class="o">.</span><span class="n">slopewidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">wettedareas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">wb</span> <span class="o">+</span> <span class="n">ws</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">ht</span> <span class="o">+</span> <span class="p">(</span><span class="n">wb</span> <span class="o">+</span> <span class="n">ws</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">ht</span><span class="p">)</span></div>



<div class="viewcode-block" id="Calc_WettedArea_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_WettedArea_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WettedArea_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Sum up the individual trapeze ranges&#39; wetted areas.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`WettedArea = \sum_{i=1}^{NmbTrapezes} WettedAreas_i`</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(3)</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedareas(2.0, 3.0, 1.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_wettedarea_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedarea</span>
<span class="sd">        wettedarea(6.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedAreas</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedArea</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">fac</span><span class="o">.</span><span class="n">wettedarea</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbtrapezes</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">wettedarea</span> <span class="o">+=</span> <span class="n">fac</span><span class="o">.</span><span class="n">wettedareas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>



<div class="viewcode-block" id="Calc_WettedPerimeters_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_WettedPerimeters_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WettedPerimeters_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the wetted perimeter for each trapeze range.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        WettedPerimeters_i = \begin{cases}</span>
<span class="sd">        0 &amp;|\ d &lt; 0 \\</span>
<span class="sd">        W_B + 2 \cdot d \cdot \sqrt{S_S^2 + 1} &amp;|\ 0 \leq d &lt; H_T \\</span>
<span class="sd">        W_B + 2 \cdot H_T \cdot \sqrt{S_S^2 + 1} + 2 \cdot (d - H_T) &amp;|\ H_T \leq d \\</span>
<span class="sd">        \end{cases}</span>
<span class="sd">        \\ \\</span>
<span class="sd">        d = WaterDepth - BottomDepth_i \\</span>
<span class="sd">        H_T = TrapezeHeights_i \\</span>
<span class="sd">        W_B = BottomWidths_i \\</span>
<span class="sd">        S_S = SideSlopes_i</span>

<span class="sd">    Examples:</span>

<span class="sd">        The following convenience function executes |Calc_WettedPerimeters_V1| for</span>
<span class="sd">        different water depths and prints the resulting wetted perimeters:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import print_vector, round_</span>
<span class="sd">        &gt;&gt;&gt; def test():</span>
<span class="sd">        ...     derived.bottomdepths.update()</span>
<span class="sd">        ...     derived.trapezeheights.update()</span>
<span class="sd">        ...     for d in [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0]:</span>
<span class="sd">        ...         factors.waterdepth = d</span>
<span class="sd">        ...         model.calc_wettedperimeters_v1()</span>
<span class="sd">        ...         round_(d, end=&quot;: &quot;)</span>
<span class="sd">        ...         print_vector(factors.wettedperimeters.values)</span>

<span class="sd">        The first example deals with identical rectangular trapezes.  Note that method</span>
<span class="sd">        |Calc_WettedPerimeters_V1| adds the contact surface between two adjacent trapeze</span>
<span class="sd">        ranges only to the wetted perimeter of the inner one:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(3)</span>
<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 2.0, 0.0, 0.0</span>
<span class="sd">        0.5: 3.0, 0.0, 0.0</span>
<span class="sd">        1.0: 4.0, 2.0, 0.0</span>
<span class="sd">        1.5: 5.0, 3.0, 0.0</span>
<span class="sd">        2.0: 6.0, 4.0, 2.0</span>
<span class="sd">        2.5: 7.0, 5.0, 3.0</span>
<span class="sd">        3.0: 8.0, 6.0, 4.0</span>
<span class="sd">        3.5: 9.0, 7.0, 5.0</span>
<span class="sd">        4.0: 10.0, 8.0, 6.0</span>

<span class="sd">        The second example deals with identical triangular trapezes.  Here, the heights</span>
<span class="sd">        of the individual trapezes also matter because they mark where the triangular</span>
<span class="sd">        shape switches to a rectangular shape:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(0.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(2.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 0.0, 0.0, 0.0</span>
<span class="sd">        0.5: 2.236068, 0.0, 0.0</span>
<span class="sd">        1.0: 4.472136, 0.0, 0.0</span>
<span class="sd">        1.5: 5.472136, 2.236068, 0.0</span>
<span class="sd">        2.0: 6.472136, 4.472136, 0.0</span>
<span class="sd">        2.5: 7.472136, 5.472136, 2.236068</span>
<span class="sd">        3.0: 8.472136, 6.472136, 4.472136</span>
<span class="sd">        3.5: 9.472136, 7.472136, 6.708204</span>
<span class="sd">        4.0: 10.472136, 8.472136, 8.944272</span>

<span class="sd">        The third example deals with identical &quot;complete&quot; trapezes by combining the</span>
<span class="sd">        first two geometries:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(2.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 2.0, 0.0, 0.0</span>
<span class="sd">        0.5: 4.236068, 0.0, 0.0</span>
<span class="sd">        1.0: 6.472136, 2.0, 0.0</span>
<span class="sd">        1.5: 7.472136, 4.236068, 0.0</span>
<span class="sd">        2.0: 8.472136, 6.472136, 2.0</span>
<span class="sd">        2.5: 9.472136, 7.472136, 4.236068</span>
<span class="sd">        3.0: 10.472136, 8.472136, 6.472136</span>
<span class="sd">        3.5: 11.472136, 9.472136, 8.708204</span>
<span class="sd">        4.0: 12.472136, 10.472136, 10.944272</span>

<span class="sd">        The fourth example mixes three different geometries:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 3.0, 4.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0, 0.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0, 2.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 2.0, 0.0, 0.0</span>
<span class="sd">        0.5: 3.0, 0.0, 0.0</span>
<span class="sd">        1.0: 4.0, 0.0, 0.0</span>
<span class="sd">        1.5: 5.0, 0.0, 0.0</span>
<span class="sd">        2.0: 6.0, 0.0, 0.0</span>
<span class="sd">        2.5: 7.0, 2.236068, 0.0</span>
<span class="sd">        3.0: 8.0, 4.472136, 2.0</span>
<span class="sd">        3.5: 9.0, 5.472136, 4.236068</span>
<span class="sd">        4.0: 10.0, 6.472136, 6.472136</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomWidths</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">SideSlopes</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_derived</span><span class="o">.</span><span class="n">BottomDepths</span><span class="p">,</span> <span class="n">wq_derived</span><span class="o">.</span><span class="n">TrapezeHeights</span><span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeters</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SegmentModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbtrapezes</span><span class="p">):</span>
            <span class="n">d</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">waterdepth</span> <span class="o">-</span> <span class="n">der</span><span class="o">.</span><span class="n">bottomdepths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">wettedperimeters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ht</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">der</span><span class="o">.</span><span class="n">trapezeheights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">wb</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">bottomwidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">ss</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">sideslopes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">ht</span><span class="p">:</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">wettedperimeters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">wb</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="n">ss</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fac</span><span class="o">.</span><span class="n">wettedperimeters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">wb</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">ht</span> <span class="o">*</span> <span class="p">(</span><span class="n">ss</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">ht</span><span class="p">)</span>
                    <span class="p">)</span></div>



<div class="viewcode-block" id="Calc_WettedPerimeter_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_WettedPerimeter_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WettedPerimeter_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Sum up the individual trapeze ranges&#39; wetted perimeters.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`WettedPerimeter = \sum_{i=1}^{NmbTrapezes} WettedPerimeters_i`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(3)</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedperimeters(2.0, 3.0, 1.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_wettedperimeter_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedperimeter</span>
<span class="sd">        wettedperimeter(6.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeters</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeter</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">fac</span><span class="o">.</span><span class="n">wettedperimeter</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbtrapezes</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">wettedperimeter</span> <span class="o">+=</span> <span class="n">fac</span><span class="o">.</span><span class="n">wettedperimeters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>



<div class="viewcode-block" id="Calc_WettedPerimeterDerivatives_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_WettedPerimeterDerivatives_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_WettedPerimeterDerivatives_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the change in the wetted perimeter of each trapeze range with respect</span>
<span class="sd">    to the water level increase.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        WettedPerimeterDerivatives_i = \begin{cases}</span>
<span class="sd">        0 &amp;|\ d &lt; 0 \\</span>
<span class="sd">        P&#39; &amp;|\ 0 \leq d &lt; H_T \\</span>
<span class="sd">        2 &amp;|\ H_T \leq d \\</span>
<span class="sd">        \end{cases}</span>
<span class="sd">        \\ \\</span>
<span class="sd">        d = WaterDepth - BottomDepth_i \\</span>
<span class="sd">        H_T = TrapezeHeights_i \\</span>
<span class="sd">        P&#39; = PerimeterDerivatives_i</span>

<span class="sd">    Examples:</span>

<span class="sd">        The following convenience function executes |Calc_WettedPerimeterDerivatives_V1|</span>
<span class="sd">        for different water depths and prints the resulting wetted perimeters:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import print_vector, round_</span>
<span class="sd">        &gt;&gt;&gt; def test():</span>
<span class="sd">        ...     derived.bottomdepths.update()</span>
<span class="sd">        ...     derived.trapezeheights.update()</span>
<span class="sd">        ...     derived.perimeterderivatives.update()</span>
<span class="sd">        ...     for d in [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0]:</span>
<span class="sd">        ...         factors.waterdepth = d</span>
<span class="sd">        ...         model.calc_wettedperimeterderivatives_v1()</span>
<span class="sd">        ...         round_(d, end=&quot;: &quot;)</span>
<span class="sd">        ...         print_vector(factors.wettedperimeterderivatives.values)</span>

<span class="sd">        The first example deals with identical rectangular trapezes.  Note that method</span>
<span class="sd">        |Calc_WettedPerimeterDerivatives_V1| adds the contact surface increase between</span>
<span class="sd">        two adjacent trapeze ranges only to the wetted perimeter derivative of the inner</span>
<span class="sd">        one:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(3)</span>
<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 2.0, 0.0, 0.0</span>
<span class="sd">        0.5: 2.0, 0.0, 0.0</span>
<span class="sd">        1.0: 2.0, 2.0, 0.0</span>
<span class="sd">        1.5: 2.0, 2.0, 0.0</span>
<span class="sd">        2.0: 2.0, 2.0, 2.0</span>
<span class="sd">        2.5: 2.0, 2.0, 2.0</span>
<span class="sd">        3.0: 2.0, 2.0, 2.0</span>
<span class="sd">        3.5: 2.0, 2.0, 2.0</span>
<span class="sd">        4.0: 2.0, 2.0, 2.0</span>

<span class="sd">        The second example deals with identical triangular trapezes.  Here, the heights</span>
<span class="sd">        of the individual trapezes also matter because they mark where the triangular</span>
<span class="sd">        shape switches to a rectangular shape:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(0.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(2.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 4.472136, 0.0, 0.0</span>
<span class="sd">        0.5: 4.472136, 0.0, 0.0</span>
<span class="sd">        1.0: 2.0, 4.472136, 0.0</span>
<span class="sd">        1.5: 2.0, 4.472136, 0.0</span>
<span class="sd">        2.0: 2.0, 2.0, 4.472136</span>
<span class="sd">        2.5: 2.0, 2.0, 4.472136</span>
<span class="sd">        3.0: 2.0, 2.0, 4.472136</span>
<span class="sd">        3.5: 2.0, 2.0, 4.472136</span>
<span class="sd">        4.0: 2.0, 2.0, 4.472136</span>

<span class="sd">        The third example deals with identical &quot;complete&quot; trapezes by combining the</span>
<span class="sd">        first two geometries:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(2.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 4.472136, 0.0, 0.0</span>
<span class="sd">        0.5: 4.472136, 0.0, 0.0</span>
<span class="sd">        1.0: 2.0, 4.472136, 0.0</span>
<span class="sd">        1.5: 2.0, 4.472136, 0.0</span>
<span class="sd">        2.0: 2.0, 2.0, 4.472136</span>
<span class="sd">        2.5: 2.0, 2.0, 4.472136</span>
<span class="sd">        3.0: 2.0, 2.0, 4.472136</span>
<span class="sd">        3.5: 2.0, 2.0, 4.472136</span>
<span class="sd">        4.0: 2.0, 2.0, 4.472136</span>

<span class="sd">        The fourth example mixes three different geometries:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 3.0, 4.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0, 0.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0, 2.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 2.0, 0.0, 0.0</span>
<span class="sd">        0.5: 2.0, 0.0, 0.0</span>
<span class="sd">        1.0: 2.0, 0.0, 0.0</span>
<span class="sd">        1.5: 2.0, 0.0, 0.0</span>
<span class="sd">        2.0: 2.0, 4.472136, 0.0</span>
<span class="sd">        2.5: 2.0, 4.472136, 0.0</span>
<span class="sd">        3.0: 2.0, 2.0, 4.472136</span>
<span class="sd">        3.5: 2.0, 2.0, 4.472136</span>
<span class="sd">        4.0: 2.0, 2.0, 4.472136</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">BottomDepths</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">TrapezeHeights</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">PerimeterDerivatives</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeterDerivatives</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SegmentModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbtrapezes</span><span class="p">):</span>
            <span class="n">d</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">waterdepth</span> <span class="o">-</span> <span class="n">der</span><span class="o">.</span><span class="n">bottomdepths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">wettedperimeterderivatives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">elif</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">der</span><span class="o">.</span><span class="n">trapezeheights</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">wettedperimeterderivatives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">der</span><span class="o">.</span><span class="n">perimeterderivatives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">wettedperimeterderivatives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span></div>



<div class="viewcode-block" id="Calc_SurfaceWidths_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_SurfaceWidths_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SurfaceWidths_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the surface width for each trapeze range.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        SurfaceWidths_i = \begin{cases}</span>
<span class="sd">        0 &amp;|\ d &lt; 0 \\</span>
<span class="sd">        W_B + 2 \cdot S_S \cdot d &amp;|\ 0 \leq d &lt; H_T \\</span>
<span class="sd">        W_B + W_S &amp;|\ H_T \leq d \\</span>
<span class="sd">        \end{cases}</span>
<span class="sd">        \\ \\</span>
<span class="sd">        d = WaterDepth - BottomDepth_i \\</span>
<span class="sd">        H_T = TrapezeHeights_i \\</span>
<span class="sd">        W_B = BottomWidths_i \\</span>
<span class="sd">        S_S = SideSlopes_i \\</span>
<span class="sd">        W_S = SlopeWidth_i</span>

<span class="sd">    Example:</span>

<span class="sd">        The following convenience function executes |Calc_SurfaceWidths_V1| for</span>
<span class="sd">        different water depths and prints the surface widths:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import print_vector, round_</span>
<span class="sd">        &gt;&gt;&gt; def test():</span>
<span class="sd">        ...     derived.bottomdepths.update()</span>
<span class="sd">        ...     derived.trapezeheights.update()</span>
<span class="sd">        ...     derived.slopewidths.update()</span>
<span class="sd">        ...     for d in [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0]:</span>
<span class="sd">        ...         factors.waterdepth = d</span>
<span class="sd">        ...         model.calc_surfacewidths_v1()</span>
<span class="sd">        ...         round_(d, end=&quot;: &quot;)</span>
<span class="sd">        ...         print_vector(factors.surfacewidths.values)</span>

<span class="sd">        The first example deals with identical rectangular trapezes.  There are no</span>
<span class="sd">        differences except those due to the different bottom levels:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(3)</span>
<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 2.0, 0.0, 0.0</span>
<span class="sd">        0.5: 2.0, 0.0, 0.0</span>
<span class="sd">        1.0: 2.0, 2.0, 0.0</span>
<span class="sd">        1.5: 2.0, 2.0, 0.0</span>
<span class="sd">        2.0: 2.0, 2.0, 2.0</span>
<span class="sd">        2.5: 2.0, 2.0, 2.0</span>
<span class="sd">        3.0: 2.0, 2.0, 2.0</span>
<span class="sd">        3.5: 2.0, 2.0, 2.0</span>
<span class="sd">        4.0: 2.0, 2.0, 2.0</span>

<span class="sd">        The second example deals with identical triangular trapezes.  Here, the heights</span>
<span class="sd">        of the individual trapezes also matter because they mark where the triangular</span>
<span class="sd">        shape switches to a rectangular shape:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(0.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(2.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 0.0, 0.0, 0.0</span>
<span class="sd">        0.5: 2.0, 0.0, 0.0</span>
<span class="sd">        1.0: 4.0, 0.0, 0.0</span>
<span class="sd">        1.5: 4.0, 2.0, 0.0</span>
<span class="sd">        2.0: 4.0, 4.0, 0.0</span>
<span class="sd">        2.5: 4.0, 4.0, 2.0</span>
<span class="sd">        3.0: 4.0, 4.0, 4.0</span>
<span class="sd">        3.5: 4.0, 4.0, 6.0</span>
<span class="sd">        4.0: 4.0, 4.0, 8.0</span>

<span class="sd">        The third example deals with identical &quot;complete&quot; trapezes by combining the</span>
<span class="sd">        first two geometries:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 2.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(2.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 2.0, 0.0, 0.0</span>
<span class="sd">        0.5: 4.0, 0.0, 0.0</span>
<span class="sd">        1.0: 6.0, 2.0, 0.0</span>
<span class="sd">        1.5: 6.0, 4.0, 0.0</span>
<span class="sd">        2.0: 6.0, 6.0, 2.0</span>
<span class="sd">        2.5: 6.0, 6.0, 4.0</span>
<span class="sd">        3.0: 6.0, 6.0, 6.0</span>
<span class="sd">        3.5: 6.0, 6.0, 8.0</span>
<span class="sd">        4.0: 6.0, 6.0, 10.0</span>

<span class="sd">        The fourth example mixes three different geometries:</span>

<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 3.0, 4.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0, 0.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0, 2.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; test()</span>
<span class="sd">        0.0: 2.0, 0.0, 0.0</span>
<span class="sd">        0.5: 2.0, 0.0, 0.0</span>
<span class="sd">        1.0: 2.0, 0.0, 0.0</span>
<span class="sd">        1.5: 2.0, 0.0, 0.0</span>
<span class="sd">        2.0: 2.0, 0.0, 0.0</span>
<span class="sd">        2.5: 2.0, 2.0, 0.0</span>
<span class="sd">        3.0: 2.0, 4.0, 2.0</span>
<span class="sd">        3.5: 2.0, 4.0, 4.0</span>
<span class="sd">        4.0: 2.0, 4.0, 6.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomWidths</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">SideSlopes</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">BottomDepths</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">TrapezeHeights</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">SlopeWidths</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">SurfaceWidths</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SegmentModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbtrapezes</span><span class="p">):</span>
            <span class="n">d</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">waterdepth</span> <span class="o">-</span> <span class="n">der</span><span class="o">.</span><span class="n">bottomdepths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">surfacewidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">elif</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">der</span><span class="o">.</span><span class="n">trapezeheights</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">surfacewidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">bottomwidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">sideslopes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">d</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">surfacewidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">bottomwidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">der</span><span class="o">.</span><span class="n">slopewidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>



<div class="viewcode-block" id="Calc_SurfaceWidth_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_SurfaceWidth_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_SurfaceWidth_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Sum the individual trapeze ranges&#39; surface widths.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`SurfaceWidth = \sum_{i=1}^{NmbTrapezes} SurfaceWidths_i`</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(3)</span>
<span class="sd">        &gt;&gt;&gt; bottomslope(0.01)</span>
<span class="sd">        &gt;&gt;&gt; factors.surfacewidths(2.0, 3.0, 1.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_surfacewidth_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.surfacewidth</span>
<span class="sd">        surfacewidth(6.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">SurfaceWidths</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">SurfaceWidth</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">fac</span><span class="o">.</span><span class="n">surfacewidth</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbtrapezes</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">surfacewidth</span> <span class="o">+=</span> <span class="n">fac</span><span class="o">.</span><span class="n">surfacewidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>



<div class="viewcode-block" id="Calc_Discharges_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_Discharges_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_Discharges_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the discharge for each trapeze range.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      .. math::</span>
<span class="sd">        Discharges_i = \begin{cases}</span>
<span class="sd">        0 &amp;|\ d &lt; 0 \\</span>
<span class="sd">        C \cdot A^{5/3} \cdot P^{-2/3} \cdot \sqrt{S_B} &amp;|\ 0 \leq d</span>
<span class="sd">        \end{cases}</span>
<span class="sd">        \\ \\</span>
<span class="sd">        d = WaterDepth - BottomDepth_i \\</span>
<span class="sd">        C = StricklerCoefficient_i \\</span>
<span class="sd">        A = WettedAreas_i \\</span>
<span class="sd">        P = WettedPerimeters_i \\</span>
<span class="sd">        S_B = BottomSlope</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(4)</span>
<span class="sd">        &gt;&gt;&gt; bottomslope(0.01)</span>
<span class="sd">        &gt;&gt;&gt; stricklercoefficients(20.0, 40.0, 60.0, 80.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.bottomdepths = 1.0, 2.0, 3.0, 4.0</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedareas = 1.0, 4.0, 8.0, 16.0</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedperimeters = 2.0, 4.0, 6.0, 8.0</span>
<span class="sd">        &gt;&gt;&gt; factors.waterdepth = 4.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_discharges_v1()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.discharges</span>
<span class="sd">        discharges(1.259921, 16.0, 58.147859, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomSlope</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">StricklerCoefficients</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_derived</span><span class="o">.</span><span class="n">BottomDepths</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedAreas</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeters</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_fluxes</span><span class="o">.</span><span class="n">Discharges</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbtrapezes</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fac</span><span class="o">.</span><span class="n">waterdepth</span> <span class="o">&gt;</span> <span class="n">der</span><span class="o">.</span><span class="n">bottomdepths</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">discharges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">stricklercoefficients</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">bottomslope</span><span class="o">**</span><span class="mf">0.5</span>
                    <span class="o">*</span> <span class="n">fac</span><span class="o">.</span><span class="n">wettedareas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="p">(</span><span class="mf">5.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
                    <span class="o">/</span> <span class="n">fac</span><span class="o">.</span><span class="n">wettedperimeters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flu</span><span class="o">.</span><span class="n">discharges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Calc_Discharge_V2">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_Discharge_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_Discharge_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Sum the individual trapeze ranges&#39; discharges.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`Discharge = \sum_{i=1}^{NmbTrapezes} Discharges_i`</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(3)</span>
<span class="sd">        &gt;&gt;&gt; bottomslope(0.01)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.discharges(2.0, 3.0, 1.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_discharge_v2()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.discharge</span>
<span class="sd">        discharge(6.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_fluxes</span><span class="o">.</span><span class="n">Discharges</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_fluxes</span><span class="o">.</span><span class="n">Discharge</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">flu</span><span class="o">.</span><span class="n">discharge</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbtrapezes</span><span class="p">):</span>
            <span class="n">flu</span><span class="o">.</span><span class="n">discharge</span> <span class="o">+=</span> <span class="n">flu</span><span class="o">.</span><span class="n">discharges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>



<div class="viewcode-block" id="Calc_DischargeDerivatives_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_DischargeDerivatives_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DischargeDerivatives_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the discharge change for each trapeze range with respect to a water</span>
<span class="sd">    level increase.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">     .. math::</span>
<span class="sd">        DischargeDerivatives_i = \begin{cases}</span>
<span class="sd">        0 &amp;|\ d &lt; 0 \\</span>
<span class="sd">        C \cdot</span>
<span class="sd">        (A / P)^{5/3} \cdot \frac{5 \cdot P \cdot A&#39; - 2 \cdot A \cdot P&#39;}{3 \cdot P}</span>
<span class="sd">        \cdot \sqrt{S_B} &amp;|\ 0 \leq d</span>
<span class="sd">        \end{cases}</span>
<span class="sd">        \\ \\</span>
<span class="sd">        d = WaterDepth - BottomDepth_i \\</span>
<span class="sd">        C = StricklerCoefficient_i \\</span>
<span class="sd">        A = WettedAreas_i \\</span>
<span class="sd">        A&#39; = SurfaceWidth_i \\</span>
<span class="sd">        P = WettedPerimeters_i \\</span>
<span class="sd">        P&#39; = WettedPerimeterDerivatives_i \\</span>
<span class="sd">        S_B = BottomSlope</span>

<span class="sd">    Example:</span>

<span class="sd">        The given basic equation assumes that the wetted area, the wetted perimeter,</span>
<span class="sd">        and their derivatives are calculated via methods |Calc_WettedAreas_V1|,</span>
<span class="sd">        |Calc_SurfaceWidths_V1|, |Calc_WettedPerimeters_V1|, and</span>
<span class="sd">        |Calc_WettedPerimeterDerivatives_V1|.  Hence, we apply these methods and check</span>
<span class="sd">        that, after also executing |Calc_DischargeDerivatives_V1|, the results are</span>
<span class="sd">        sufficiently similar to the numerical approximations gained when applying</span>
<span class="sd">        |NumericalDifferentiator| to the mentioned methods and method</span>
<span class="sd">        |Calc_Discharges_V1|:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(4)</span>
<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 3.0, 4.0, 5.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0, 0.0, 2.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0, 2.0, 2.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomslope(0.01)</span>
<span class="sd">        &gt;&gt;&gt; stricklercoefficients(20.0, 40.0, 60.0, 60.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterdepth = 3.5</span>
<span class="sd">        &gt;&gt;&gt; derived.bottomdepths.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.trapezeheights.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.slopewidths.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.perimeterderivatives.update()</span>
<span class="sd">        &gt;&gt;&gt; model.calc_wettedareas_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.calc_surfacewidths_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.calc_wettedperimeters_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.calc_wettedperimeterderivatives_v1()</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dischargederivatives_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.dischargederivatives</span>
<span class="sd">        dischargederivatives(3.884141, 18.475494, 16.850223, 0.0)</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import NumericalDifferentiator, pub</span>
<span class="sd">        &gt;&gt;&gt; numdiff = NumericalDifferentiator(</span>
<span class="sd">        ...     xsequence=factors.waterdepth,</span>
<span class="sd">        ...     ysequences=[fluxes.discharges],</span>
<span class="sd">        ...     methods=[model.calc_wettedareas_v1,</span>
<span class="sd">        ...              model.calc_surfacewidths_v1,</span>
<span class="sd">        ...              model.calc_wettedperimeters_v1,</span>
<span class="sd">        ...              model.calc_wettedperimeterderivatives_v1,</span>
<span class="sd">        ...              model.calc_discharges_v1],</span>
<span class="sd">        ...     dx=1e-8)</span>
<span class="sd">        &gt;&gt;&gt; with pub.options.reprdigits(5):</span>
<span class="sd">        ...     numdiff()</span>
<span class="sd">        d_discharges/d_waterdepth: 3.88414, 18.47549, 16.85022, 0.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomSlope</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">StricklerCoefficients</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_derived</span><span class="o">.</span><span class="n">BottomDepths</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedAreas</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeters</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeterDerivatives</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">SurfaceWidths</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">DischargeDerivatives</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">der</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbtrapezes</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fac</span><span class="o">.</span><span class="n">waterdepth</span> <span class="o">&gt;</span> <span class="n">der</span><span class="o">.</span><span class="n">bottomdepths</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">a</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">wettedareas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">da</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">surfacewidths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">wettedperimeters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">dp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">wettedperimeterderivatives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">dischargederivatives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">con</span><span class="o">.</span><span class="n">stricklercoefficients</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="o">*</span> <span class="n">con</span><span class="o">.</span><span class="n">bottomslope</span><span class="o">**</span><span class="mf">0.5</span>
                    <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">p</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
                    <span class="o">*</span> <span class="p">(</span><span class="mf">5.0</span> <span class="o">*</span> <span class="n">p</span> <span class="o">*</span> <span class="n">da</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">dp</span><span class="p">)</span>
                    <span class="o">/</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fac</span><span class="o">.</span><span class="n">dischargederivatives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>



<div class="viewcode-block" id="Calc_DischargeDerivative_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_DischargeDerivative_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_DischargeDerivative_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Sum the individual trapeze ranges&#39; discharge derivatives.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`DischargeDerivative = \sum_{i=1}^{NmbTrapezes} DischargeDerivatives_i`</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(3)</span>
<span class="sd">        &gt;&gt;&gt; bottomslope(0.01)</span>
<span class="sd">        &gt;&gt;&gt; factors.dischargederivatives(2.0, 3.0, 1.0)</span>
<span class="sd">        &gt;&gt;&gt; model.calc_dischargederivative_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.dischargederivative</span>
<span class="sd">        dischargederivative(6.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,)</span>
    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">DischargeDerivatives</span><span class="p">,)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">DischargeDerivative</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">fac</span><span class="o">.</span><span class="n">dischargederivative</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">nmbtrapezes</span><span class="p">):</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">dischargederivative</span> <span class="o">+=</span> <span class="n">fac</span><span class="o">.</span><span class="n">dischargederivatives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>



<div class="viewcode-block" id="Calc_Celerity_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Calc_Celerity_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Calc_Celerity_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the kinematic wave celerity.</span>

<span class="sd">    Basic equation:</span>
<span class="sd">      :math:`Celerity = \frac{DischargeDerivative}{SurfaceWidth}`</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; factors.dischargederivative = 6.0</span>
<span class="sd">        &gt;&gt;&gt; factors.surfacewidth = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_celerity_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.celerity</span>
<span class="sd">        celerity(3.0)</span>

<span class="sd">        &gt;&gt;&gt; factors.surfacewidth = 0.0</span>
<span class="sd">        &gt;&gt;&gt; model.calc_celerity_v1()</span>
<span class="sd">        &gt;&gt;&gt; factors.celerity</span>
<span class="sd">        celerity(nan)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">DischargeDerivative</span><span class="p">,</span> <span class="n">wq_factors</span><span class="o">.</span><span class="n">SurfaceWidth</span><span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">Celerity</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">if</span> <span class="n">fac</span><span class="o">.</span><span class="n">surfacewidth</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">celerity</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">dischargederivative</span> <span class="o">/</span> <span class="n">fac</span><span class="o">.</span><span class="n">surfacewidth</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fac</span><span class="o">.</span><span class="n">celerity</span> <span class="o">=</span> <span class="n">modelutils</span><span class="o">.</span><span class="n">nan</span></div>



<div class="viewcode-block" id="Set_WaterDepth_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Set_WaterDepth_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Set_WaterDepth_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the water depth in m.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; model.set_waterdepth_v1(2.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterdepth</span>
<span class="sd">        waterdepth(2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">waterdepth</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">fac</span><span class="o">.</span><span class="n">waterdepth</span> <span class="o">=</span> <span class="n">waterdepth</span></div>



<div class="viewcode-block" id="Set_WaterLevel_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Set_WaterLevel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Set_WaterLevel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the water level in m.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; model.set_waterlevel_v1(2.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterlevel</span>
<span class="sd">        waterlevel(2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterLevel</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">waterlevel</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">fac</span><span class="o">.</span><span class="n">waterlevel</span> <span class="o">=</span> <span class="n">waterlevel</span></div>



<div class="viewcode-block" id="Set_WettedArea_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Set_WettedArea_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Set_WettedArea_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the wetted area in m².</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; model.set_wettedarea_v1(2.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedarea</span>
<span class="sd">        wettedarea(2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedArea</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">wettedarea</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="n">fac</span><span class="o">.</span><span class="n">wettedarea</span> <span class="o">=</span> <span class="n">wettedarea</span></div>



<div class="viewcode-block" id="Use_WaterDepth_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Use_WaterDepth_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Use_WaterDepth_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">SetAutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the water depth in m and use it to calculate all other properties.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(2)</span>
<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomslope(0.01)</span>
<span class="sd">        &gt;&gt;&gt; stricklercoefficients(20.0, 40.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.bottomdepths.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.trapezeheights.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.slopewidths.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.perimeterderivatives.update()</span>
<span class="sd">        &gt;&gt;&gt; model.use_waterdepth_v1(3.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterdepth</span>
<span class="sd">        waterdepth(3.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterlevel</span>
<span class="sd">        waterlevel(4.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedarea</span>
<span class="sd">        wettedarea(8.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.discharge</span>
<span class="sd">        discharge(14.945466)</span>
<span class="sd">        &gt;&gt;&gt; factors.celerity</span>
<span class="sd">        celerity(2.642957)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Set_WaterDepth_V1</span><span class="p">,</span>
        <span class="n">Calc_WaterLevel_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedAreas_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedArea_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedPerimeters_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedPerimeterDerivatives_V1</span><span class="p">,</span>
        <span class="n">Calc_SurfaceWidths_V1</span><span class="p">,</span>
        <span class="n">Calc_SurfaceWidth_V1</span><span class="p">,</span>
        <span class="n">Calc_Discharges_V1</span><span class="p">,</span>
        <span class="n">Calc_Discharge_V2</span><span class="p">,</span>
        <span class="n">Calc_DischargeDerivatives_V1</span><span class="p">,</span>
        <span class="n">Calc_DischargeDerivative_V1</span><span class="p">,</span>
        <span class="n">Calc_Celerity_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomLevels</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomWidths</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">SideSlopes</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">StricklerCoefficients</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomSlope</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">BottomDepths</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">TrapezeHeights</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">SlopeWidths</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">PerimeterDerivatives</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterLevel</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedAreas</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedArea</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeters</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeterDerivatives</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">SurfaceWidths</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">SurfaceWidth</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">DischargeDerivatives</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">DischargeDerivative</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">Celerity</span><span class="p">,</span>
        <span class="n">wq_fluxes</span><span class="o">.</span><span class="n">Discharges</span><span class="p">,</span>
        <span class="n">wq_fluxes</span><span class="o">.</span><span class="n">Discharge</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Use_WaterDepth_V2">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Use_WaterDepth_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Use_WaterDepth_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">SetAutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the water depth in m and use it to calculate all other properties.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(2)</span>
<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.bottomdepths.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.trapezeheights.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.slopewidths.update()</span>
<span class="sd">        &gt;&gt;&gt; model.use_waterdepth_v2(3.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterdepth</span>
<span class="sd">        waterdepth(3.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterlevel</span>
<span class="sd">        waterlevel(4.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedarea</span>
<span class="sd">        wettedarea(8.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedperimeter</span>
<span class="sd">        wettedperimeter(12.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Set_WaterDepth_V1</span><span class="p">,</span>
        <span class="n">Calc_WaterLevel_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedAreas_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedArea_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedPerimeters_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedPerimeter_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomLevels</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomWidths</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">SideSlopes</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">BottomDepths</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">TrapezeHeights</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">SlopeWidths</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterLevel</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedAreas</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedArea</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeters</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeter</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Use_WaterLevel_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Use_WaterLevel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Use_WaterLevel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">SetAutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the water level in m and use it to calculate all other properties.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(2)</span>
<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomslope(0.01)</span>
<span class="sd">        &gt;&gt;&gt; stricklercoefficients(20.0, 40.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.bottomdepths.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.trapezeheights.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.slopewidths.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.perimeterderivatives.update()</span>
<span class="sd">        &gt;&gt;&gt; model.use_waterlevel_v1(4.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterdepth</span>
<span class="sd">        waterdepth(3.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterlevel</span>
<span class="sd">        waterlevel(4.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedarea</span>
<span class="sd">        wettedarea(8.0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.discharge</span>
<span class="sd">        discharge(14.945466)</span>
<span class="sd">        &gt;&gt;&gt; factors.celerity</span>
<span class="sd">        celerity(2.642957)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Set_WaterLevel_V1</span><span class="p">,</span>
        <span class="n">Calc_WaterDepth_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedAreas_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedArea_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedPerimeters_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedPerimeterDerivatives_V1</span><span class="p">,</span>
        <span class="n">Calc_SurfaceWidths_V1</span><span class="p">,</span>
        <span class="n">Calc_SurfaceWidth_V1</span><span class="p">,</span>
        <span class="n">Calc_Discharges_V1</span><span class="p">,</span>
        <span class="n">Calc_Discharge_V2</span><span class="p">,</span>
        <span class="n">Calc_DischargeDerivatives_V1</span><span class="p">,</span>
        <span class="n">Calc_DischargeDerivative_V1</span><span class="p">,</span>
        <span class="n">Calc_Celerity_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomLevels</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomWidths</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">SideSlopes</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">StricklerCoefficients</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomSlope</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">BottomDepths</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">TrapezeHeights</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">SlopeWidths</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">PerimeterDerivatives</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterLevel</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedAreas</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedArea</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeters</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeterDerivatives</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">SurfaceWidths</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">SurfaceWidth</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">DischargeDerivatives</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">DischargeDerivative</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">Celerity</span><span class="p">,</span>
        <span class="n">wq_fluxes</span><span class="o">.</span><span class="n">Discharges</span><span class="p">,</span>
        <span class="n">wq_fluxes</span><span class="o">.</span><span class="n">Discharge</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Use_WaterLevel_V2">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Use_WaterLevel_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Use_WaterLevel_V2</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">SetAutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the water level in m and use it to calculate all other properties.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(2)</span>
<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.bottomdepths.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.trapezeheights.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.slopewidths.update()</span>
<span class="sd">        &gt;&gt;&gt; model.use_waterlevel_v2(4.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterdepth</span>
<span class="sd">        waterdepth(3.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterlevel</span>
<span class="sd">        waterlevel(4.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedarea</span>
<span class="sd">        wettedarea(8.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedperimeter</span>
<span class="sd">        wettedperimeter(12.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Set_WaterLevel_V1</span><span class="p">,</span>
        <span class="n">Calc_WaterDepth_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedAreas_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedArea_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedPerimeters_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedPerimeter_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomLevels</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomWidths</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">SideSlopes</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">BottomDepths</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">TrapezeHeights</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">SlopeWidths</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterLevel</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedAreas</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedArea</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeters</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeter</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Use_WettedArea_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Use_WettedArea_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Use_WettedArea_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">SetAutoMethod</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the wetted area in m² and use it to calculate all other properties.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; nmbtrapezes(2)</span>
<span class="sd">        &gt;&gt;&gt; bottomlevels(1.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; bottomwidths(2.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; sideslopes(0.0, 0.0)</span>
<span class="sd">        &gt;&gt;&gt; derived.bottomdepths.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.trapezeheights.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.slopewidths.update()</span>
<span class="sd">        &gt;&gt;&gt; derived.trapezeareas.update()</span>
<span class="sd">        &gt;&gt;&gt; model.use_wettedarea_v1(8.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterdepth</span>
<span class="sd">        waterdepth(3.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.waterlevel</span>
<span class="sd">        waterlevel(4.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedarea</span>
<span class="sd">        wettedarea(8.0)</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedperimeter</span>
<span class="sd">        wettedperimeter(12.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SUBMETHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Set_WettedArea_V1</span><span class="p">,</span>
        <span class="n">Calc_WaterDepth_V2</span><span class="p">,</span>
        <span class="n">Calc_WaterLevel_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedAreas_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedArea_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedPerimeters_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedPerimeter_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">CONTROLPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">NmbTrapezes</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomLevels</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">BottomWidths</span><span class="p">,</span>
        <span class="n">wq_control</span><span class="o">.</span><span class="n">SideSlopes</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">DERIVEDPARAMETERS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">BottomDepths</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">TrapezeHeights</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">SlopeWidths</span><span class="p">,</span>
        <span class="n">wq_derived</span><span class="o">.</span><span class="n">TrapezeAreas</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">RESULTSEQUENCES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterLevel</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedAreas</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedArea</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeters</span><span class="p">,</span>
        <span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeter</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Get_WaterDepth_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Get_WaterDepth_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_WaterDepth_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the water depth in m.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; factors.waterdepth = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.get_waterdepth_v1()</span>
<span class="sd">        2.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterDepth</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">fac</span><span class="o">.</span><span class="n">waterdepth</span></div>



<div class="viewcode-block" id="Get_WaterLevel_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Get_WaterLevel_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_WaterLevel_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the water level in m.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; factors.waterlevel = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.get_waterlevel_v1()</span>
<span class="sd">        2.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WaterLevel</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">fac</span><span class="o">.</span><span class="n">waterlevel</span></div>



<div class="viewcode-block" id="Get_WettedArea_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Get_WettedArea_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_WettedArea_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the wetted area in m².</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedarea = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.get_wettedarea_v1()</span>
<span class="sd">        2.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedArea</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">fac</span><span class="o">.</span><span class="n">wettedarea</span></div>



<div class="viewcode-block" id="Get_WettedPerimeter_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Get_WettedPerimeter_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_WettedPerimeter_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the wetted perimeter in m.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; factors.wettedperimeter = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.get_wettedperimeter_v1()</span>
<span class="sd">        2.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">WettedPerimeter</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">fac</span><span class="o">.</span><span class="n">wettedperimeter</span></div>



<div class="viewcode-block" id="Get_SurfaceWidth_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Get_SurfaceWidth_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_SurfaceWidth_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the surface width in m.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; factors.surfacewidth = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.get_surfacewidth_v1()</span>
<span class="sd">        2.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">SurfaceWidth</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">fac</span><span class="o">.</span><span class="n">surfacewidth</span></div>



<div class="viewcode-block" id="Get_Discharge_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Get_Discharge_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_Discharge_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the discharge in m³/s.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; fluxes.discharge = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.get_discharge_v1()</span>
<span class="sd">        2.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_fluxes</span><span class="o">.</span><span class="n">Discharge</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">flu</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">flu</span><span class="o">.</span><span class="n">discharge</span></div>



<div class="viewcode-block" id="Get_Celerity_V1">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Get_Celerity_V1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Get_Celerity_V1</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">Method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the wave celerity in m/s.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; factors.celerity = 2.0</span>
<span class="sd">        &gt;&gt;&gt; model.get_celerity_v1()</span>
<span class="sd">        2.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REQUIREDSEQUENCES</span> <span class="o">=</span> <span class="p">(</span><span class="n">wq_factors</span><span class="o">.</span><span class="n">Celerity</span><span class="p">,)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">fac</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">fastaccess</span>

        <span class="k">return</span> <span class="n">fac</span><span class="o">.</span><span class="n">celerity</span></div>



<div class="viewcode-block" id="Model">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Model">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Model</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">,</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">SubmodelInterface</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;|wq.DOCNAME.complete|.&quot;&quot;&quot;</span>

    <span class="n">DOCNAME</span> <span class="o">=</span> <span class="n">modeltools</span><span class="o">.</span><span class="n">DocName</span><span class="p">(</span><span class="n">short</span><span class="o">=</span><span class="s2">&quot;WQ&quot;</span><span class="p">)</span>
    <span class="n">__HYDPY_ROOTMODEL__</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">INLET_METHODS</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">RECEIVER_METHODS</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">RUN_METHODS</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">INTERFACE_METHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calculate_Discharge_V1</span><span class="p">,</span>
        <span class="n">Set_WaterDepth_V1</span><span class="p">,</span>
        <span class="n">Set_WaterLevel_V1</span><span class="p">,</span>
        <span class="n">Set_WettedArea_V1</span><span class="p">,</span>
        <span class="n">Use_WaterDepth_V1</span><span class="p">,</span>
        <span class="n">Use_WaterDepth_V2</span><span class="p">,</span>
        <span class="n">Use_WaterLevel_V1</span><span class="p">,</span>
        <span class="n">Use_WaterLevel_V2</span><span class="p">,</span>
        <span class="n">Use_WettedArea_V1</span><span class="p">,</span>
        <span class="n">Get_WaterDepth_V1</span><span class="p">,</span>
        <span class="n">Get_WaterLevel_V1</span><span class="p">,</span>
        <span class="n">Get_WettedArea_V1</span><span class="p">,</span>
        <span class="n">Get_WettedPerimeter_V1</span><span class="p">,</span>
        <span class="n">Get_SurfaceWidth_V1</span><span class="p">,</span>
        <span class="n">Get_Discharge_V1</span><span class="p">,</span>
        <span class="n">Get_Celerity_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ADD_METHODS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Calc_WaterDepth_V1</span><span class="p">,</span>
        <span class="n">Calc_WaterDepth_V2</span><span class="p">,</span>
        <span class="n">Calc_WaterLevel_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedAreas_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedArea_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedPerimeters_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedPerimeter_V1</span><span class="p">,</span>
        <span class="n">Calc_WettedPerimeterDerivatives_V1</span><span class="p">,</span>
        <span class="n">Calc_SurfaceWidths_V1</span><span class="p">,</span>
        <span class="n">Calc_SurfaceWidth_V1</span><span class="p">,</span>
        <span class="n">Calc_Discharges_V1</span><span class="p">,</span>
        <span class="n">Calc_Discharge_V2</span><span class="p">,</span>
        <span class="n">Calc_DischargeDerivatives_V1</span><span class="p">,</span>
        <span class="n">Calc_DischargeDerivative_V1</span><span class="p">,</span>
        <span class="n">Calc_Celerity_V1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">OUTLET_METHODS</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">SENDER_METHODS</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">SUBMODELINTERFACES</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">SUBMODELS</span> <span class="o">=</span> <span class="p">()</span></div>



<div class="viewcode-block" id="TrapezeModel">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.TrapezeModel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TrapezeModel</span><span class="p">(</span><span class="n">modeltools</span><span class="o">.</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |wq.DOCNAME.long| models that rely on trapezoidal geometries.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="TrapezeModel.plot">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.TrapezeModel.plot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ymax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">color</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the channel profile.</span>

<span class="sd">        See the main documentation of application model |wq_trapeze| for more</span>
<span class="sd">        information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span>
        <span class="n">der</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">derived</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">nmbtrapezes</span><span class="o">.</span><span class="n">value</span>
        <span class="n">bl</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">bottomlevels</span><span class="o">.</span><span class="n">values</span>
        <span class="n">bw</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">bottomwidths</span><span class="o">.</span><span class="n">values</span>
        <span class="n">ss</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">sideslopes</span><span class="o">.</span><span class="n">values</span>
        <span class="n">sw</span> <span class="o">=</span> <span class="n">der</span><span class="o">.</span><span class="n">slopewidths</span><span class="o">.</span><span class="n">values</span>
        <span class="n">th</span> <span class="o">=</span> <span class="n">der</span><span class="o">.</span><span class="n">trapezeheights</span><span class="o">.</span><span class="n">values</span>

        <span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">bl</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_add</span><span class="p">(</span><span class="n">dx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dy</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx</span><span class="p">)</span>
            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dy</span><span class="p">)</span>
            <span class="n">xs</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">xs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ys</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">_add</span><span class="p">(</span><span class="n">dx</span><span class="o">=</span><span class="n">bw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">_add</span><span class="p">(</span><span class="n">dx</span><span class="o">=</span><span class="n">sw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">th</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">ymax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ymax</span> <span class="o">&lt;=</span> <span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="n">bl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">bw</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="k">if</span> <span class="n">bw</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span> <span class="k">else</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="n">bl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">bl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bl</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">dy_</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">-</span> <span class="n">bl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dx_</span> <span class="o">=</span> <span class="n">dy_</span> <span class="o">*</span> <span class="n">ss</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">_add</span><span class="p">(</span><span class="n">dx</span><span class="o">=</span><span class="n">dx_</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy_</span><span class="p">)</span>

        <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;distance from centre [m]&quot;</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;elevation [m]&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">label</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
            <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="Base_DischargeModel_V2">
<a class="viewcode-back" href="../../../../wq.html#hydpy.models.wq.wq_model.Base_DischargeModel_V2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Base_DischargeModel_V2</span><span class="p">(</span><span class="n">dischargeinterfaces</span><span class="o">.</span><span class="n">DischargeModel_V2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for |wq.DOCNAME.long| models that comply with the |DischargeModel_V2|</span>
<span class="sd">    submodel interface.&quot;&quot;&quot;</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">wq_control</span><span class="o">.</span><span class="n">ChannelDepth</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_channeldepth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channeldepth</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the channel depth in m.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq_walrus import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; model.prepare_channeldepth(2.0)</span>
<span class="sd">        &gt;&gt;&gt; channeldepth</span>
<span class="sd">        channeldepth(2.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">channeldepth</span><span class="p">(</span><span class="n">channeldepth</span><span class="p">)</span>

    <span class="nd">@importtools</span><span class="o">.</span><span class="n">define_targetparameter</span><span class="p">(</span><span class="n">wq_control</span><span class="o">.</span><span class="n">CrestHeightTolerance</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_tolerance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the depth-related smoothing parameter in m.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.wq_walrus import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; model.prepare_tolerance(2.0)</span>
<span class="sd">        &gt;&gt;&gt; crestheighttolerance</span>
<span class="sd">        crestheighttolerance(2.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">crestheighttolerance</span><span class="p">(</span><span class="n">tolerance</span><span class="p">)</span></div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">HydPy 6.1.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">hydpy.models.wq.wq_model</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2013-2025, HydPy Developers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>modeltools &#8212; HydPy 4.0.1 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="netcdftools" href="netcdftools.html" />
    <link rel="prev" title="masktools" href="masktools.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="netcdftools.html" title="netcdftools"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="masktools.html" title="masktools"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HydPy 4.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="framework.html" >Framework Tools</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="core.html" accesskey="U">Core Tools</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">modeltools</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="modeltools">
<span id="id1"></span><h1>modeltools<a class="headerlink" href="#modeltools" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-hydpy.core.modeltools"></span><p>This module provides features for applying and implementing
hydrological models.</p>
<p>Module <a class="reference internal" href="#module-hydpy.core.modeltools" title="hydpy.core.modeltools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">modeltools</span></code></a> implements the following members:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#hydpy.core.modeltools.AideSequences" title="hydpy.core.modeltools.AideSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">AideSequences</span></code></a> Aide sequences of model modeltools.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.FluxSequences" title="hydpy.core.modeltools.FluxSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">FluxSequences</span></code></a> Flux sequences of model modeltools.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.InletSequences" title="hydpy.core.modeltools.InletSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">InletSequences</span></code></a> Inlet sequences of model modeltools.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.InputSequences" title="hydpy.core.modeltools.InputSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">InputSequences</span></code></a> Input sequences of model modeltools.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.LogSequences" title="hydpy.core.modeltools.LogSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">LogSequences</span></code></a> Log sequences of model modeltools.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.OutletSequences" title="hydpy.core.modeltools.OutletSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">OutletSequences</span></code></a> Outlet sequences of model modeltools.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.ReceiverSequences" title="hydpy.core.modeltools.ReceiverSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReceiverSequences</span></code></a> Receiver sequences of model modeltools.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.SenderSequences" title="hydpy.core.modeltools.SenderSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">SenderSequences</span></code></a> Sender sequences of model modeltools.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.StateSequences" title="hydpy.core.modeltools.StateSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSequences</span></code></a> State sequences of model modeltools.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.Method" title="hydpy.core.modeltools.Method"><code class="xref py py-class docutils literal notranslate"><span class="pre">Method</span></code></a> Base class for defining (hydrological) calculation methods.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.IndexProperty" title="hydpy.core.modeltools.IndexProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexProperty</span></code></a> Base class for index descriptors like <a class="reference internal" href="#hydpy.core.modeltools.Idx_Sim" title="hydpy.core.modeltools.Idx_Sim"><code class="xref py py-class docutils literal notranslate"><span class="pre">Idx_Sim</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.Idx_Sim" title="hydpy.core.modeltools.Idx_Sim"><code class="xref py py-class docutils literal notranslate"><span class="pre">Idx_Sim</span></code></a> The simulation step index.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.Idx_HRU" title="hydpy.core.modeltools.Idx_HRU"><code class="xref py py-class docutils literal notranslate"><span class="pre">Idx_HRU</span></code></a> The hydrological response unit index.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.Model" title="hydpy.core.modeltools.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> Base class for all hydrological models.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.AdHocModel" title="hydpy.core.modeltools.AdHocModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdHocModel</span></code></a> Base class for models solving the underlying differential equations in an “ad hoc manner”.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.SolverModel" title="hydpy.core.modeltools.SolverModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SolverModel</span></code></a> Base class for hydrological models which solve ordinary differential equations with numerical integration algorithms.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.NumConstsELS" title="hydpy.core.modeltools.NumConstsELS"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumConstsELS</span></code></a> Configuration options for using the “Explicit Lobatto Sequence” implemented by class <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.NumVarsELS" title="hydpy.core.modeltools.NumVarsELS"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumVarsELS</span></code></a> Intermediate results of the “Explicit Lobatto Sequence” implemented by class <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a> Base class for hydrological models using the “Explicit Lobatto Sequence” for solving ordinary differential equations.</p></li>
<li><p><a class="reference internal" href="#hydpy.core.modeltools.Submodel" title="hydpy.core.modeltools.Submodel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodel</span></code></a> Base class for implementing “submodels” that serve to deal with (possibly complicated) general mathematical algorithms (e.g. root-finding algorithms) within hydrological model methods.</p></li>
</ul>
</div></blockquote>
<hr class="docutils" />
<dl class="py class">
<dt id="hydpy.core.modeltools.Method">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">Method</span></code><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Method" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for defining (hydrological) calculation methods.</p>
</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.IndexProperty">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">IndexProperty</span></code><a class="reference internal" href="_modules/hydpy/core/modeltools.html#IndexProperty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.IndexProperty" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for index descriptors like <a class="reference internal" href="#hydpy.core.modeltools.Idx_Sim" title="hydpy.core.modeltools.Idx_Sim"><code class="xref py py-class docutils literal notranslate"><span class="pre">Idx_Sim</span></code></a>.</p>
</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.Idx_Sim">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">Idx_Sim</span></code><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Idx_Sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Idx_Sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hydpy.core.modeltools.IndexProperty" title="hydpy.core.modeltools.IndexProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.modeltools.IndexProperty</span></code></a></p>
<p>The simulation step index.</p>
<p>Some model methods require to know the index of the current simulation
step (with respect to the initialisation period), which one usually
updates by passing it to <a class="reference internal" href="#hydpy.core.modeltools.Model.simulate" title="hydpy.core.modeltools.Model.simulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">simulate()</span></code></a>.  However, you are allowed
to change it manually via the <a class="reference internal" href="#hydpy.core.modeltools.Idx_Sim" title="hydpy.core.modeltools.Idx_Sim"><code class="xref py py-class docutils literal notranslate"><span class="pre">Idx_Sim</span></code></a> descriptor, which is
often beneficial during testing:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.hland_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">(</span><span class="s2">&quot;1d&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Like other objects of <a class="reference internal" href="#hydpy.core.modeltools.IndexProperty" title="hydpy.core.modeltools.IndexProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexProperty</span></code></a> subclasses, <a class="reference internal" href="#hydpy.core.modeltools.Idx_Sim" title="hydpy.core.modeltools.Idx_Sim"><code class="xref py py-class docutils literal notranslate"><span class="pre">Idx_Sim</span></code></a> objects
are aware of their name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Model</span><span class="o">.</span><span class="n">idx_sim</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;idx_sim&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.Idx_HRU">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">Idx_HRU</span></code><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Idx_HRU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Idx_HRU" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hydpy.core.modeltools.IndexProperty" title="hydpy.core.modeltools.IndexProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.modeltools.IndexProperty</span></code></a></p>
<p>The hydrological response unit index.</p>
<p>See class <a class="reference internal" href="#hydpy.core.modeltools.Idx_HRU" title="hydpy.core.modeltools.Idx_HRU"><code class="xref py py-class docutils literal notranslate"><span class="pre">Idx_HRU</span></code></a> for an
explanation  on the purpose and handling of objects of
<a class="reference internal" href="#hydpy.core.modeltools.IndexProperty" title="hydpy.core.modeltools.IndexProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexProperty</span></code></a> subclasses.</p>
</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.Model">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">Model</span></code><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for all hydrological models.</p>
<p>Class <a class="reference internal" href="#hydpy.core.modeltools.Model" title="hydpy.core.modeltools.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> provides everything to create a usable application
model, except method <a class="reference internal" href="#hydpy.core.modeltools.Model.simulate" title="hydpy.core.modeltools.Model.simulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">simulate()</span></code></a>.  See class <a class="reference internal" href="#hydpy.core.modeltools.AdHocModel" title="hydpy.core.modeltools.AdHocModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdHocModel</span></code></a> and
<a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a>, which implement this method.</p>
<p>Each final <a class="reference internal" href="#hydpy.core.modeltools.Model" title="hydpy.core.modeltools.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> object has two attributes named <cite>parameters</cite> and
<cite>sequences</cite>, providing access to all parameter and sequence values,
respectively.  For example, the application model <a class="reference internal" href="hland_v1.html#module-hydpy.models.hland_v1" title="hydpy.models.hland_v1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hland_v1</span></code></a> so
provides access to the control parameter <a class="reference internal" href="hland.html#hydpy.models.hland.hland_control.NmbZones" title="hydpy.models.hland.hland_control.NmbZones"><code class="xref py py-class docutils literal notranslate"><span class="pre">NmbZones</span></code></a>
and the input sequence <a class="reference internal" href="hland.html#hydpy.models.hland.hland_inputs.P" title="hydpy.models.hland.hland_inputs.P"><code class="xref py py-class docutils literal notranslate"><span class="pre">P</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.hland_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">(</span><span class="s2">&quot;1d&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">nmbzones</span>
<span class="go">nmbzones(?)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">p</span>
<span class="go">p(nan)</span>
</pre></div>
</div>
<p>Both attributes are dynamic.  You need to add them manually whenever
you want to prepare a workable <a class="reference internal" href="#hydpy.core.modeltools.Model" title="hydpy.core.modeltools.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> object on your own (see the
factory functions <a class="reference internal" href="importtools.html#hydpy.core.importtools.prepare_model" title="hydpy.core.importtools.prepare_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_model()</span></code></a> and <a class="reference internal" href="importtools.html#hydpy.core.importtools.parameterstep" title="hydpy.core.importtools.parameterstep"><code class="xref py py-func docutils literal notranslate"><span class="pre">parameterstep()</span></code></a>, which do this
regularly).  In case you forget to do so, you get the following
error message:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.hland_v1</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Model</span><span class="p">()</span><span class="o">.</span><span class="n">parameters</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">The dynamic attribute `parameters` of `hland_v1` of element `?` is not available at the moment.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Model</span><span class="p">()</span><span class="o">.</span><span class="n">sequences</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">The dynamic attribute `sequences` of `hland_v1` of element `?` is not available at the moment.</span>
</pre></div>
</div>
<p>Other wrong attribute names result in the familiar error message:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Model</span><span class="p">()</span><span class="o">.</span><span class="n">wrong</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;Model&#39; object has no attribute &#39;wrong&#39;</span>
</pre></div>
</div>
<p>Similar to <cite>parameters</cite> and <cite>sequences</cite>, there is also the dynamic
<cite>masks</cite> attribute, making all predefined masks of the actual model
type available within in a <a class="reference internal" href="masktools.html#hydpy.core.masktools.Masks" title="hydpy.core.masktools.Masks"><code class="xref py py-class docutils literal notranslate"><span class="pre">Masks</span></code></a> objects:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">masks</span>
<span class="go">complete of module hydpy.models.hland.hland_masks</span>
<span class="go">land of module hydpy.models.hland.hland_masks</span>
<span class="go">noglacier of module hydpy.models.hland.hland_masks</span>
<span class="go">soil of module hydpy.models.hland.hland_masks</span>
<span class="go">field of module hydpy.models.hland.hland_masks</span>
<span class="go">forest of module hydpy.models.hland.hland_masks</span>
<span class="go">ilake of module hydpy.models.hland.hland_masks</span>
<span class="go">glacier of module hydpy.models.hland.hland_masks</span>
</pre></div>
</div>
<p>You can use these masks, for example, to average the zone-specific
precipitation values handled by sequence <a class="reference internal" href="hland.html#hydpy.models.hland.hland_fluxes.PC" title="hydpy.models.hland.hland_fluxes.PC"><code class="xref py py-class docutils literal notranslate"><span class="pre">PC</span></code></a>.
When passing no argument, method <a class="reference internal" href="variabletools.html#hydpy.core.variabletools.Variable.average_values" title="hydpy.core.variabletools.Variable.average_values"><code class="xref py py-func docutils literal notranslate"><span class="pre">average_values()</span></code></a>
applies the <cite>complete</cite> mask.  Pass mask <cite>land</cite> to average the
values of all zones except those of type <a class="reference internal" href="hland.html#hydpy.models.hland.hland_constants.ILAKE" title="hydpy.models.hland.hland_constants.ILAKE"><code class="xref py py-const docutils literal notranslate"><span class="pre">ILAKE</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nmbzones</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zonetype</span><span class="p">(</span><span class="n">FIELD</span><span class="p">,</span> <span class="n">FOREST</span><span class="p">,</span> <span class="n">GLACIER</span><span class="p">,</span> <span class="n">ILAKE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zonearea</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">7.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">pc</span><span class="o">.</span><span class="n">average_values</span><span class="p">()</span>
<span class="go">4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">pc</span><span class="o">.</span><span class="n">average_values</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">masks</span><span class="o">.</span><span class="n">land</span><span class="p">)</span>
<span class="go">3.0</span>
</pre></div>
</div>
<p>Attribute <cite>masks</cite> is, in contrast to attributes <cite>parameters</cite> and
<cite>sequences</cite>, optional, which we indicate by a different error message:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">prepare_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;test_v1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">masks</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">Model ``test_v1` of element `?`` does not handle a group of masks (at the moment).</span>
</pre></div>
</div>
<dl class="py attribute">
<dt id="hydpy.core.modeltools.Model.parameters">
<code class="sig-name descname"><span class="pre">parameters</span></code><em class="property"><span class="pre">:</span> <a class="reference internal" href="parametertools.html#hydpy.core.parametertools.Parameters" title="hydpy.core.parametertools.Parameters"><span class="pre">hydpy.core.parametertools.Parameters</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.Model.parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.Model.sequences">
<code class="sig-name descname"><span class="pre">sequences</span></code><em class="property"><span class="pre">:</span> <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sequences" title="hydpy.core.sequencetools.Sequences"><span class="pre">hydpy.core.sequencetools.Sequences</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.Model.sequences" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.Model.masks">
<code class="sig-name descname"><span class="pre">masks</span></code><em class="property"><span class="pre">:</span> <span class="pre">masktools.Masks</span></em><a class="headerlink" href="#hydpy.core.modeltools.Model.masks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.Model.idx_sim">
<code class="sig-name descname"><span class="pre">idx_sim</span></code><a class="headerlink" href="#hydpy.core.modeltools.Model.idx_sim" title="Permalink to this definition">¶</a></dt>
<dd><p>The simulation step index.</p>
<p>Some model methods require to know the index of the current simulation
step (with respect to the initialisation period), which one usually
updates by passing it to <a class="reference internal" href="#hydpy.core.modeltools.Model.simulate" title="hydpy.core.modeltools.Model.simulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">simulate()</span></code></a>.  However, you are allowed
to change it manually via the <a class="reference internal" href="#hydpy.core.modeltools.Idx_Sim" title="hydpy.core.modeltools.Idx_Sim"><code class="xref py py-class docutils literal notranslate"><span class="pre">Idx_Sim</span></code></a> descriptor, which is
often beneficial during testing:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.hland_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">(</span><span class="s2">&quot;1d&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Like other objects of <a class="reference internal" href="#hydpy.core.modeltools.IndexProperty" title="hydpy.core.modeltools.IndexProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexProperty</span></code></a> subclasses, <a class="reference internal" href="#hydpy.core.modeltools.Idx_Sim" title="hydpy.core.modeltools.Idx_Sim"><code class="xref py py-class docutils literal notranslate"><span class="pre">Idx_Sim</span></code></a> objects
are aware of their name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Model</span><span class="o">.</span><span class="n">idx_sim</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;idx_sim&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.Model.METHOD_GROUPS">
<code class="sig-name descname"><span class="pre">METHOD_GROUPS</span></code><em class="property"><span class="pre">:</span> <span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hydpy.core.modeltools.Method" title="hydpy.core.modeltools.Method"><span class="pre">hydpy.core.modeltools.Method</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">…</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.modeltools.Model.METHOD_GROUPS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.Model.cymodel">
<code class="sig-name descname"><span class="pre">cymodel</span></code><em class="property"><span class="pre">:</span> <span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="typingtools.html#hydpy.core.typingtools.CyModelProtocol" title="hydpy.core.typingtools.CyModelProtocol"><span class="pre">hydpy.core.typingtools.CyModelProtocol</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.modeltools.Model.cymodel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.Model.element">
<code class="sig-name descname"><span class="pre">element</span></code><em class="property"><span class="pre">:</span> <span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">devicetools.Element</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.modeltools.Model.element" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.Model.connect">
<code class="sig-name descname"><span class="pre">connect</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Model.connect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Model.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect all <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.LinkSequence" title="hydpy.core.sequencetools.LinkSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinkSequence</span></code></a> objects and the selected <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.InputSequence" title="hydpy.core.sequencetools.InputSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">InputSequence</span></code></a>
and <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.OutputSequence" title="hydpy.core.sequencetools.OutputSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">OutputSequence</span></code></a> objects of the actual model to the corresponding
<a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.NodeSequence" title="hydpy.core.sequencetools.NodeSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeSequence</span></code></a> objects.</p>
<p>You cannot connect any sequences until the <a class="reference internal" href="#hydpy.core.modeltools.Model" title="hydpy.core.modeltools.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> object itself
is connected to an <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Element" title="hydpy.core.devicetools.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a> object referencing the required <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Node" title="hydpy.core.devicetools.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a>
objects:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">prepare_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hstream_v1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">While trying to build the node connection of the `input` sequences of the model handled by element `?`, the following error occurred: &#39;NoneType&#39; object has no attribute &#39;inputs&#39;</span>
</pre></div>
</div>
<p>The application model <a class="reference internal" href="hstream_v1.html#module-hydpy.models.hstream_v1" title="hydpy.models.hstream_v1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hstream_v1</span></code></a> can receive inflow from an
arbitrary number of upstream nodes and passes its outflow to
a single downstream node (note that property <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Element.model" title="hydpy.core.devicetools.Element.model"><code class="xref py py-const docutils literal notranslate"><span class="pre">model</span></code></a> of
class <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Element" title="hydpy.core.devicetools.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a> calls method <a class="reference internal" href="#hydpy.core.modeltools.Model.connect" title="hydpy.core.modeltools.Model.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a> automatically):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">Element</span><span class="p">,</span> <span class="n">Node</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">in1</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;in1&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;Q&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">in2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;in2&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;Q&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out1</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;out1&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;Q&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element1</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;element1&quot;</span><span class="p">,</span> <span class="n">inlets</span><span class="o">=</span><span class="p">(</span><span class="n">in1</span><span class="p">,</span> <span class="n">in2</span><span class="p">),</span> <span class="n">outlets</span><span class="o">=</span><span class="n">out1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element1</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hstream_v1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now all connections work as expected:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">in1</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">in2</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out1</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inlets</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(1.0, 2.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">outlets</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(3.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inlets</span><span class="o">.</span><span class="n">q</span> <span class="o">*=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">outlets</span><span class="o">.</span><span class="n">q</span> <span class="o">*=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">in1</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span>
<span class="go">sim(2.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">in2</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span>
<span class="go">sim(4.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out1</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span>
<span class="go">sim(6.0)</span>
</pre></div>
</div>
<p>To show some possible errors and related error messages, we
define three additional nodes, two handling variables different
from discharge (<cite>Q</cite>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">in3</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;in3&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;out2&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;Q&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out3</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;out3&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Link sequence names must match the <cite>variable</cite> a node is handling:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element2</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;element2&quot;</span><span class="p">,</span> <span class="n">inlets</span><span class="o">=</span><span class="p">(</span><span class="n">in1</span><span class="p">,</span> <span class="n">in2</span><span class="p">),</span> <span class="n">outlets</span><span class="o">=</span><span class="n">out3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element2</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hstream_v1&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">While trying to build the node connection of the `outlet` sequences of the model handled by element `element2`, the following error occurred: Sequence `q` of element `element2` cannot be connected due to no available node handling variable `Q`.</span>
</pre></div>
</div>
<p>One can connect a 0-dimensional link sequence to a single node
sequence only:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element3</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;element3&quot;</span><span class="p">,</span> <span class="n">inlets</span><span class="o">=</span><span class="p">(</span><span class="n">in1</span><span class="p">,</span> <span class="n">in2</span><span class="p">),</span> <span class="n">outlets</span><span class="o">=</span><span class="p">(</span><span class="n">out1</span><span class="p">,</span> <span class="n">out2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element3</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hstream_v1&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">While trying to build the node connection of the `outlet` sequences of the model handled by element `element3`, the following error occurred: Sequence `q` cannot be connected as it is 0-dimensional but multiple nodes are available which are handling variable `Q`.</span>
</pre></div>
</div>
<p>Method <a class="reference internal" href="#hydpy.core.modeltools.Model.connect" title="hydpy.core.modeltools.Model.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a> generally reports about unusable node
sequences:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element4</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;element4&quot;</span><span class="p">,</span> <span class="n">inlets</span><span class="o">=</span><span class="p">(</span><span class="n">in1</span><span class="p">,</span> <span class="n">in2</span><span class="p">),</span> <span class="n">outlets</span><span class="o">=</span><span class="p">(</span><span class="n">out1</span><span class="p">,</span> <span class="n">out3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element4</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hstream_v1&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">While trying to build the node connection of the `outlet` sequences of the model handled by element `element4`, the following error occurred: The following nodes have not been connected to any sequences: out3.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element5</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;element5&quot;</span><span class="p">,</span> <span class="n">inlets</span><span class="o">=</span><span class="p">(</span><span class="n">in1</span><span class="p">,</span> <span class="n">in2</span><span class="p">,</span> <span class="n">in3</span><span class="p">),</span> <span class="n">outlets</span><span class="o">=</span><span class="n">out1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element5</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hstream_v1&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">While trying to build the node connection of the `inlet` sequences of the model handled by element `element5`, the following error occurred: The following nodes have not been connected to any sequences: in3.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element6</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;element6&quot;</span><span class="p">,</span> <span class="n">inlets</span><span class="o">=</span><span class="n">in1</span><span class="p">,</span> <span class="n">outlets</span><span class="o">=</span><span class="n">out1</span><span class="p">,</span> <span class="n">receivers</span><span class="o">=</span><span class="n">in2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element6</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hstream_v1&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">While trying to build the node connection of the `receiver` sequences of the model handled by element `element6`, the following error occurred: The following nodes have not been connected to any sequences: in2.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element7</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;element7&quot;</span><span class="p">,</span> <span class="n">inlets</span><span class="o">=</span><span class="n">in1</span><span class="p">,</span> <span class="n">outlets</span><span class="o">=</span><span class="n">out1</span><span class="p">,</span> <span class="n">senders</span><span class="o">=</span><span class="n">in2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element7</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hstream_v1&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">While trying to build the node connection of the `sender` sequences of the model handled by element `element7`, the following error occurred: The following nodes have not been connected to any sequences: in2.</span>
</pre></div>
</div>
<p>The above examples explain how to connect link sequences to their
nodes.  Such connections are relatively hard requirements
(<a class="reference internal" href="hstream_v1.html#module-hydpy.models.hstream_v1" title="hydpy.models.hstream_v1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hstream_v1</span></code></a> definitively needs inflow provided from a node,
which the node itself typically receives from another model).
In contrast, connections between input or output sequences and nodes
are optional.  If one defines such a connection for an input sequence,
it receives data from the related node; otherwise, it uses its
individually managed data, usually read from a file.  If one defines
such a connection for an output sequence, it passes its internal
data to the related node; otherwise, nothing happens.</p>
<p>We demonstrate this functionality by focussing on the input sequences
<a class="reference internal" href="hland.html#hydpy.models.hland.hland_inputs.T" title="hydpy.models.hland.hland_inputs.T"><code class="xref py py-class docutils literal notranslate"><span class="pre">T</span></code></a> and <a class="reference internal" href="hland.html#hydpy.models.hland.hland_inputs.P" title="hydpy.models.hland.hland_inputs.P"><code class="xref py py-class docutils literal notranslate"><span class="pre">P</span></code></a> and the output sequences
<a class="reference internal" href="hland.html#hydpy.models.hland.hland_fluxes.Q0" title="hydpy.models.hland.hland_fluxes.Q0"><code class="xref py py-class docutils literal notranslate"><span class="pre">Q0</span></code></a> and <a class="reference internal" href="hland.html#hydpy.models.hland.hland_states.UZ" title="hydpy.models.hland.hland_states.UZ"><code class="xref py py-class docutils literal notranslate"><span class="pre">UZ</span></code></a> of application model <a class="reference internal" href="hland_v1.html#module-hydpy.models.hland_v1" title="hydpy.models.hland_v1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hland_v1</span></code></a>.
<a class="reference internal" href="hland.html#hydpy.models.hland.hland_inputs.T" title="hydpy.models.hland.hland_inputs.T"><code class="xref py py-class docutils literal notranslate"><span class="pre">T</span></code></a> uses its own data (which we define manually, but we
could read it from a file as well), whereas <a class="reference internal" href="hland.html#hydpy.models.hland.hland_inputs.P" title="hydpy.models.hland.hland_inputs.P"><code class="xref py py-class docutils literal notranslate"><span class="pre">P</span></code></a> gets its
data from node <cite>inp1</cite>.  Flux sequence <a class="reference internal" href="hland.html#hydpy.models.hland.hland_fluxes.Q0" title="hydpy.models.hland.hland_fluxes.Q0"><code class="xref py py-class docutils literal notranslate"><span class="pre">Q0</span></code></a> and state
sequence <a class="reference internal" href="hland.html#hydpy.models.hland.hland_states.UZ" title="hydpy.models.hland.hland_states.UZ"><code class="xref py py-class docutils literal notranslate"><span class="pre">UZ</span></code></a> pass their data to two separate output
nodes, whereas all other fluxes and states do not.  This functionality
requires to tell each node which sequence it should connect to, which
we do by passing the sequence types (or the globally available aliases
<cite>hland_P</cite>, <cite>hland_Q0</cite>, and <cite>hland_UZ</cite>) to the <cite>variable</cite> keyword
of different node objects:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">pub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.inputs</span> <span class="kn">import</span> <span class="n">hland_P</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.outputs</span> <span class="kn">import</span> <span class="n">hland_Q0</span><span class="p">,</span> <span class="n">hland_UZ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span> <span class="o">=</span> <span class="s2">&quot;2000-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2000-01-06&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">inp1</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;inp1&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">hland_P</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outp1</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;outp1&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">hland_Q0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outp2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;outp2&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">hland_UZ</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element8</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;element8&quot;</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">outlets</span><span class="o">=</span><span class="n">out1</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">inputs</span><span class="o">=</span><span class="n">inp1</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">outp1</span><span class="p">,</span> <span class="n">outp2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element8</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hland_v1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element8</span><span class="o">.</span><span class="n">prepare_inputseries</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element8</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">idx_sim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element8</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inp1</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="p">(</span><span class="mf">9.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element8</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element8</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">t</span>
<span class="go">t(3.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element8</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">p</span>
<span class="go">p(9.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element8</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">q0</span> <span class="o">=</span> <span class="mf">99.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element8</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">uz</span> <span class="o">=</span> <span class="mf">999.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element8</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">update_outputs</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outp1</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span>
<span class="go">sim(99.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outp2</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span>
<span class="go">sim(999.0)</span>
</pre></div>
</div>
<p>Instead of using single <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.InputSequence" title="hydpy.core.sequencetools.InputSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">InputSequence</span></code></a> and <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.OutputSequence" title="hydpy.core.sequencetools.OutputSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">OutputSequence</span></code></a>
subclasses, one can create and apply fused variables, combining
multiple subclasses (see the documentation on class <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.FusedVariable" title="hydpy.core.devicetools.FusedVariable"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusedVariable</span></code></a>
for more information and a more realistic example):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">FusedVariable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.inputs</span> <span class="kn">import</span> <span class="n">lland_Nied</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.outputs</span> <span class="kn">import</span> <span class="n">lland_QDGZ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Precip</span> <span class="o">=</span> <span class="n">FusedVariable</span><span class="p">(</span><span class="s2">&quot;Precip&quot;</span><span class="p">,</span> <span class="n">hland_P</span><span class="p">,</span> <span class="n">lland_Nied</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inp2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;inp2&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">Precip</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FastRunoff</span> <span class="o">=</span> <span class="n">FusedVariable</span><span class="p">(</span><span class="s2">&quot;FastRunoff&quot;</span><span class="p">,</span> <span class="n">hland_Q0</span><span class="p">,</span> <span class="n">lland_QDGZ</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outp3</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;outp3&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">FastRunoff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element9</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;element9&quot;</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">outlets</span><span class="o">=</span><span class="n">out1</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">inputs</span><span class="o">=</span><span class="n">inp2</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">outputs</span><span class="o">=</span><span class="n">outp3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element9</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hland_v1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inp2</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="p">(</span><span class="mf">9.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element9</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element9</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">p</span>
<span class="go">p(9.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element9</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">q0</span> <span class="o">=</span> <span class="mf">99.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element9</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">update_outputs</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outp3</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span>
<span class="go">sim(99.0)</span>
</pre></div>
</div>
<p>Method <a class="reference internal" href="#hydpy.core.modeltools.Model.connect" title="hydpy.core.modeltools.Model.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a> reports if one of the given fused variables
does not find a fitting sequence:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.inputs</span> <span class="kn">import</span> <span class="n">lland_TemL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Wrong</span> <span class="o">=</span> <span class="n">FusedVariable</span><span class="p">(</span><span class="s2">&quot;Wrong&quot;</span><span class="p">,</span> <span class="n">lland_Nied</span><span class="p">,</span> <span class="n">lland_TemL</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inp3</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;inp3&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">Wrong</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element10</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;element10&quot;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">outlets</span><span class="o">=</span><span class="n">out1</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">inputs</span><span class="o">=</span><span class="n">inp3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element10</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hland_v1&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">While trying to build the node connection of the `input` sequences of the model handled by element `element10`, the following error occurred: None of the input sequences of model `hland_v1` is among the sequences of the fused variable `Wrong` of node `inp3`.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">outp4</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;outp4&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">Wrong</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element11</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;element11&quot;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">outlets</span><span class="o">=</span><span class="n">out1</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">outputs</span><span class="o">=</span><span class="n">outp4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element11</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hland_v1&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">While trying to build the node connection of the `output` sequences of the model handled by element `element11`, the following error occurred: None of the output sequences of model `hland_v1` is among the sequences of the fused variable `Wrong` of node `outp4`.</span>
</pre></div>
</div>
<p>Selecting wrong sequences results in the following errors messages:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">outp5</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;outp5&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">hland_Q0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element12</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;element12&quot;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">outlets</span><span class="o">=</span><span class="n">out1</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">inputs</span><span class="o">=</span><span class="n">outp5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element12</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hland_v1&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">While trying to build the node connection of the `input` sequences of the model handled by element `element12`, the following error occurred: No input sequence of model hland_v1` is named `q0`.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">inp5</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;inp5&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">hland_P</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element13</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;element13&quot;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">outlets</span><span class="o">=</span><span class="n">out1</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">outputs</span><span class="o">=</span><span class="n">inp5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element13</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hland_v1&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">While trying to build the node connection of the `output` sequences of the model handled by element `element13`, the following error occurred: No flux or state sequence of model `hland_v1` is named `p`.</span>
</pre></div>
</div>
<p>So far, you can build connections to 0-dimensional output sequences
only:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.hland.hland_fluxes</span> <span class="kn">import</span> <span class="n">PC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outp6</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;outp6&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">PC</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element14</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;element14&quot;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">outlets</span><span class="o">=</span><span class="n">out1</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">outputs</span><span class="o">=</span><span class="n">outp6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element14</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hland_v1&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">While trying to build the node connection of the `output` sequences of the model handled by element `element14`, the following error occurred: Only connections with 0-dimensional output sequences are supported, but sequence `pc` is 1-dimensional.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.Model.name">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">name</span></code><a class="headerlink" href="#hydpy.core.modeltools.Model.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the model type.</p>
<p>For base models, <a class="reference internal" href="#hydpy.core.modeltools.Model.name" title="hydpy.core.modeltools.Model.name"><code class="xref py py-const docutils literal notranslate"><span class="pre">name</span></code></a> corresponds to the package name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">prepare_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hland</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hland&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hland</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;hland&#39;</span>
</pre></div>
</div>
<p>For application models, <a class="reference internal" href="#hydpy.core.modeltools.Model.name" title="hydpy.core.modeltools.Model.name"><code class="xref py py-const docutils literal notranslate"><span class="pre">name</span></code></a> corresponds the module name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hland_v1</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;hland_v1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hland_v1</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;hland_v1&#39;</span>
</pre></div>
</div>
<p>This last example has only technical reasons:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hland</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;hland&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.Model.simulate">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">simulate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Model.simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Model.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a simulation run over a single simulation time step.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.Model.load_data">
<code class="sig-name descname"><span class="pre">load_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Model.load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Model.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Call method <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sequences.load_data" title="hydpy.core.sequencetools.Sequences.load_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_data()</span></code></a> of attribute <cite>sequences</cite>.</p>
<p>When working in Cython mode, the standard model import overrides
this generic Python version with a model-specific Cython version.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.Model.save_data">
<code class="sig-name descname"><span class="pre">save_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Model.save_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Model.save_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Call method <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sequences.save_data" title="hydpy.core.sequencetools.Sequences.save_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_data()</span></code></a> of attribute <cite>sequences</cite>.</p>
<p>When working in Cython mode, the standard model import overrides
this generic Python version with a model-specific Cython version.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.Model.update_inlets">
<code class="sig-name descname"><span class="pre">update_inlets</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Model.update_inlets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Model.update_inlets" title="Permalink to this definition">¶</a></dt>
<dd><p>Call all methods defined as “INLET_METHODS” in the defined order.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.modeltools</span> <span class="kn">import</span> <span class="n">AdHocModel</span><span class="p">,</span> <span class="n">Method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">print_1</span><span class="p">(</span><span class="n">Method</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@staticmethod</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">print_2</span><span class="p">(</span><span class="n">Method</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@staticmethod</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Test</span><span class="p">(</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">INLET_METHODS</span> <span class="o">=</span> <span class="n">print_1</span><span class="p">,</span> <span class="n">print_2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Test</span><span class="p">()</span><span class="o">.</span><span class="n">update_inlets</span><span class="p">()</span>
<span class="go">1</span>
<span class="go">2</span>
</pre></div>
</div>
<p>When working in Cython mode, the standard model import overrides
this generic Python version with a model-specific Cython version.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.Model.update_outlets">
<code class="sig-name descname"><span class="pre">update_outlets</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Model.update_outlets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Model.update_outlets" title="Permalink to this definition">¶</a></dt>
<dd><p>Call all methods defined as “OUTLET_METHODS” in the defined order.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.modeltools</span> <span class="kn">import</span> <span class="n">AdHocModel</span><span class="p">,</span> <span class="n">Method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">print_1</span><span class="p">(</span><span class="n">Method</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@staticmethod</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">print_2</span><span class="p">(</span><span class="n">Method</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@staticmethod</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Test</span><span class="p">(</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">OUTLET_METHODS</span> <span class="o">=</span> <span class="n">print_1</span><span class="p">,</span> <span class="n">print_2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Test</span><span class="p">()</span><span class="o">.</span><span class="n">update_outlets</span><span class="p">()</span>
<span class="go">1</span>
<span class="go">2</span>
</pre></div>
</div>
<p>When working in Cython mode, the standard model import overrides
this generic Python version with a model-specific Cython version.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.Model.update_receivers">
<code class="sig-name descname"><span class="pre">update_receivers</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Model.update_receivers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Model.update_receivers" title="Permalink to this definition">¶</a></dt>
<dd><p>Call all methods defined as “RECEIVER_METHODS” in the defined order.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.modeltools</span> <span class="kn">import</span> <span class="n">AdHocModel</span><span class="p">,</span> <span class="n">Method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">print_1</span><span class="p">(</span><span class="n">Method</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@staticmethod</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>       <span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">idx_sim</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">print_2</span><span class="p">(</span><span class="n">Method</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@staticmethod</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">idx_sim</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Test</span><span class="p">(</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">RECEIVER_METHODS</span> <span class="o">=</span> <span class="n">print_1</span><span class="p">,</span> <span class="n">print_2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">Test</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="o">.</span><span class="n">update_receivers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="go">3</span>
</pre></div>
</div>
<p>When working in Cython mode, the standard model import overrides
this generic Python version with a model-specific Cython version.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.Model.update_senders">
<code class="sig-name descname"><span class="pre">update_senders</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Model.update_senders"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Model.update_senders" title="Permalink to this definition">¶</a></dt>
<dd><p>Call all methods defined as “SENDER_METHODS” in the defined order.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.modeltools</span> <span class="kn">import</span> <span class="n">AdHocModel</span><span class="p">,</span> <span class="n">Method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">print_1</span><span class="p">(</span><span class="n">Method</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@staticmethod</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>       <span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">idx_sim</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">print_2</span><span class="p">(</span><span class="n">Method</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@staticmethod</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">idx_sim</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Test</span><span class="p">(</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">SENDER_METHODS</span> <span class="o">=</span> <span class="n">print_1</span><span class="p">,</span> <span class="n">print_2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">Test</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="o">.</span><span class="n">update_senders</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="go">3</span>
</pre></div>
</div>
<p>When working in Cython mode, the standard model import overrides
this generic Python version with a model-specific Cython version.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.Model.new2old">
<code class="sig-name descname"><span class="pre">new2old</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Model.new2old"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Model.new2old" title="Permalink to this definition">¶</a></dt>
<dd><p>Call method <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.StateSequences.new2old" title="hydpy.core.sequencetools.StateSequences.new2old"><code class="xref py py-func docutils literal notranslate"><span class="pre">new2old()</span></code></a> of subattribute
<cite>sequences.states</cite>.</p>
<p>When working in Cython mode, the standard model import overrides
this generic Python version with a model-specific Cython version.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.Model.update_outputs">
<code class="sig-name descname"><span class="pre">update_outputs</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Model.update_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Model.update_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Call method <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.OutputSequences.update_outputs" title="hydpy.core.sequencetools.OutputSequences.update_outputs"><code class="xref py py-func docutils literal notranslate"><span class="pre">update_outputs()</span></code></a> of subattributes
<cite>sequences.fluxes</cite> and <cite>sequences.states</cite>.</p>
<p>When working in Cython mode, the standard model import overrides
this generic Python version with a model-specific Cython version.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.Model.get_methods">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">get_methods</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hydpy.core.modeltools.Method" title="hydpy.core.modeltools.Method"><span class="pre">hydpy.core.modeltools.Method</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Model.get_methods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Model.get_methods" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience method for iterating through all methods selected by
a <a class="reference internal" href="#hydpy.core.modeltools.Model" title="hydpy.core.modeltools.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> subclass.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models</span> <span class="kn">import</span> <span class="n">hland_v1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">hland_v1</span><span class="o">.</span><span class="n">Model</span><span class="o">.</span><span class="n">get_methods</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>   
<span class="go">Calc_TC_V1</span>
<span class="go">Calc_TMean_V1</span>
<span class="gp">...</span>
<span class="go">Calc_QT_V1</span>
<span class="go">Pass_Q_v1</span>
</pre></div>
</div>
<p>Note that function <a class="reference internal" href="#hydpy.core.modeltools.Model.get_methods" title="hydpy.core.modeltools.Model.get_methods"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_methods()</span></code></a> returns the “raw” <a class="reference internal" href="#hydpy.core.modeltools.Method" title="hydpy.core.modeltools.Method"><code class="xref py py-class docutils literal notranslate"><span class="pre">Method</span></code></a>
objects instead of the modified Python or Cython functions used
for performing calculations.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.AdHocModel">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">AdHocModel</span></code><a class="reference internal" href="_modules/hydpy/core/modeltools.html#AdHocModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.AdHocModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hydpy.core.modeltools.Model" title="hydpy.core.modeltools.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.modeltools.Model</span></code></a></p>
<p>Base class for models solving the underlying differential equations
in an “ad hoc manner”.</p>
<p>“Ad hoc” stands for the classical approaches in hydrology, to calculate
individual fluxes separately (often sequentially) and without error
control (see <a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2009WR008894">Clark and Kavetski</a>).</p>
<dl class="py attribute">
<dt id="hydpy.core.modeltools.AdHocModel.METHOD_GROUPS">
<code class="sig-name descname"><span class="pre">METHOD_GROUPS</span></code><em class="property"><span class="pre">:</span> <span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hydpy.core.modeltools.Method" title="hydpy.core.modeltools.Method"><span class="pre">Method</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">…</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"> <span class="pre">=</span> <span class="pre">('RECEIVER_METHODS',</span> <span class="pre">'INLET_METHODS',</span> <span class="pre">'RUN_METHODS',</span> <span class="pre">'ADD_METHODS',</span> <span class="pre">'OUTLET_METHODS',</span> <span class="pre">'SENDER_METHODS')</span></em><a class="headerlink" href="#hydpy.core.modeltools.AdHocModel.METHOD_GROUPS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.AdHocModel.simulate">
<code class="sig-name descname"><span class="pre">simulate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#AdHocModel.simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.AdHocModel.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a simulation run over a single simulation time step.</p>
<p>The required argument <cite>idx</cite> corresponds to property <cite>idx_sim</cite>
(see the main documentation on class <a class="reference internal" href="#hydpy.core.modeltools.Model" title="hydpy.core.modeltools.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>).</p>
<p>You can integrate method <a class="reference internal" href="#hydpy.core.modeltools.Model.simulate" title="hydpy.core.modeltools.Model.simulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">simulate()</span></code></a> into your workflows for
tailor-made simulation runs.  Method <a class="reference internal" href="#hydpy.core.modeltools.Model.simulate" title="hydpy.core.modeltools.Model.simulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">simulate()</span></code></a> is complete
enough to allow for consecutive calls.  However, note that it
does neither call <a class="reference internal" href="#hydpy.core.modeltools.Model.save_data" title="hydpy.core.modeltools.Model.save_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_data()</span></code></a>, <a class="reference internal" href="#hydpy.core.modeltools.Model.update_receivers" title="hydpy.core.modeltools.Model.update_receivers"><code class="xref py py-func docutils literal notranslate"><span class="pre">update_receivers()</span></code></a>,
nor <a class="reference internal" href="#hydpy.core.modeltools.Model.update_senders" title="hydpy.core.modeltools.Model.update_senders"><code class="xref py py-func docutils literal notranslate"><span class="pre">update_senders()</span></code></a>.  Also, one would have to reset the
related node sequences, as done in the following example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.examples</span> <span class="kn">import</span> <span class="n">prepare_full_example_2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hp</span><span class="p">,</span> <span class="n">pub</span><span class="p">,</span> <span class="n">TestIO</span> <span class="o">=</span> <span class="n">prepare_full_example_2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">land_dill</span><span class="o">.</span><span class="n">model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">hp</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">dill</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hp</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">dill</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="go">sim(11.78038)</span>
<span class="go">sim(8.901179)</span>
<span class="go">sim(7.131072)</span>
<span class="go">sim(6.017787)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hp</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">dill</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span>
<span class="go">InfoArray([ nan,  nan,  nan,  nan])</span>
</pre></div>
</div>
<p>The results above are identical to those of method <a class="reference internal" href="hydpytools.html#hydpy.core.hydpytools.HydPy.simulate" title="hydpy.core.hydpytools.HydPy.simulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">simulate()</span></code></a>
of class <a class="reference internal" href="hydpytools.html#hydpy.core.hydpytools.HydPy" title="hydpy.core.hydpytools.HydPy"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydPy</span></code></a>, which is the standard method to perform simulation
runs (except that method <a class="reference internal" href="hydpytools.html#hydpy.core.hydpytools.HydPy.simulate" title="hydpy.core.hydpytools.HydPy.simulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">simulate()</span></code></a> of class <a class="reference internal" href="hydpytools.html#hydpy.core.hydpytools.HydPy" title="hydpy.core.hydpytools.HydPy"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydPy</span></code></a> also
performs the steps neglected by method <a class="reference internal" href="#hydpy.core.modeltools.Model.simulate" title="hydpy.core.modeltools.Model.simulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">simulate()</span></code></a> of class
<a class="reference internal" href="#hydpy.core.modeltools.Model" title="hydpy.core.modeltools.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> mentioned above):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hp</span><span class="o">.</span><span class="n">reset_conditions</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hp</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">hp</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">dill</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span><span class="p">)</span>
<span class="go">11.78038, 8.901179, 7.131072, 6.017787</span>
</pre></div>
</div>
<p>When working in Cython mode, the standard model import overrides
this generic Python version with a model-specific Cython version.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.AdHocModel.run">
<code class="sig-name descname"><span class="pre">run</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#AdHocModel.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.AdHocModel.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Call all methods defined as “RUN_METHODS” in the defined order.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.modeltools</span> <span class="kn">import</span> <span class="n">AdHocModel</span><span class="p">,</span> <span class="n">Method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">print_1</span><span class="p">(</span><span class="n">Method</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@staticmethod</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">print_2</span><span class="p">(</span><span class="n">Method</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@staticmethod</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Test</span><span class="p">(</span><span class="n">AdHocModel</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">RUN_METHODS</span> <span class="o">=</span> <span class="n">print_1</span><span class="p">,</span> <span class="n">print_2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Test</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="go">1</span>
<span class="go">2</span>
</pre></div>
</div>
<p>When working in Cython mode, the standard model import overrides
this generic Python version with a model-specific Cython version.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.SolverModel">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">SolverModel</span></code><a class="reference internal" href="_modules/hydpy/core/modeltools.html#SolverModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.SolverModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hydpy.core.modeltools.Model" title="hydpy.core.modeltools.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.modeltools.Model</span></code></a></p>
<p>Base class for hydrological models which solve ordinary differential
equations with numerical integration algorithms.</p>
<dl class="py method">
<dt id="hydpy.core.modeltools.SolverModel.solve">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">solve</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#SolverModel.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.SolverModel.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve all <cite>FULL_ODE_METHODS</cite> in parallel.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.NumConstsELS">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">NumConstsELS</span></code><a class="reference internal" href="_modules/hydpy/core/modeltools.html#NumConstsELS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.NumConstsELS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Configuration options for using the “Explicit Lobatto Sequence”
implemented by class <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a>.</p>
<p>You can change the following solver options at your own risk.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.modeltools</span> <span class="kn">import</span> <span class="n">NumConstsELS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">consts</span> <span class="o">=</span> <span class="n">NumConstsELS</span><span class="p">()</span>
</pre></div>
</div>
<p>The maximum number of Runge Kutta submethods to be applied (the
higher, the better the theoretical accuracy, but also the worse
the time spent unsuccessful when the theory does not apply):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">consts</span><span class="o">.</span><span class="n">nmb_methods</span>
<span class="go">10</span>
</pre></div>
</div>
<p>The number of entries to handle the stages of the highest order method
(must agree with the maximum number of methods):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">consts</span><span class="o">.</span><span class="n">nmb_stages</span>
<span class="go">11</span>
</pre></div>
</div>
<p>The maximum increase of the integration step size in case of success:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">consts</span><span class="o">.</span><span class="n">dt_increase</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>The maximum decrease of the integration step size in case of failure:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">consts</span><span class="o">.</span><span class="n">dt_decrease</span>
<span class="go">10.0</span>
</pre></div>
</div>
<p>The Runge Kutta coefficients, one matrix for each submethod:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">consts</span><span class="o">.</span><span class="n">a_coefs</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(11, 12, 11)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumConstsELS.a_coeffs">
<code class="sig-name descname"><span class="pre">a_coeffs</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><span class="pre">numpy.ndarray</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumConstsELS.a_coeffs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumConstsELS.nmb_methods">
<code class="sig-name descname"><span class="pre">nmb_methods</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumConstsELS.nmb_methods" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumConstsELS.nmb_stages">
<code class="sig-name descname"><span class="pre">nmb_stages</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumConstsELS.nmb_stages" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumConstsELS.dt_increase">
<code class="sig-name descname"><span class="pre">dt_increase</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumConstsELS.dt_increase" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumConstsELS.dt_decrease">
<code class="sig-name descname"><span class="pre">dt_decrease</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumConstsELS.dt_decrease" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.NumVarsELS">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">NumVarsELS</span></code><a class="reference internal" href="_modules/hydpy/core/modeltools.html#NumVarsELS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Intermediate results of the “Explicit Lobatto Sequence” implemented
by class <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a>.</p>
<p>Class <a class="reference internal" href="#hydpy.core.modeltools.NumVarsELS" title="hydpy.core.modeltools.NumVarsELS"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumVarsELS</span></code></a> should be of relevance for model developers,
as it helps to evaluate how efficient newly implemented models
are solved (see the documentation on method <a class="reference internal" href="#hydpy.core.modeltools.ELSModel.solve" title="hydpy.core.modeltools.ELSModel.solve"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve()</span></code></a> of
class <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a> as an example).</p>
<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.use_relerror">
<code class="sig-name descname"><span class="pre">use_relerror</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.use_relerror" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.nmb_calls">
<code class="sig-name descname"><span class="pre">nmb_calls</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.nmb_calls" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.t0">
<code class="sig-name descname"><span class="pre">t0</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.t0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.t1">
<code class="sig-name descname"><span class="pre">t1</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.t1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.dt_est">
<code class="sig-name descname"><span class="pre">dt_est</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.dt_est" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.dt">
<code class="sig-name descname"><span class="pre">dt</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.dt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.idx_method">
<code class="sig-name descname"><span class="pre">idx_method</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.idx_method" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.idx_stage">
<code class="sig-name descname"><span class="pre">idx_stage</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.idx_stage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.abserror">
<code class="sig-name descname"><span class="pre">abserror</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.abserror" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.relerror">
<code class="sig-name descname"><span class="pre">relerror</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.relerror" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.last_abserror">
<code class="sig-name descname"><span class="pre">last_abserror</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.last_abserror" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.last_relerror">
<code class="sig-name descname"><span class="pre">last_relerror</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.last_relerror" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.extrapolated_abserror">
<code class="sig-name descname"><span class="pre">extrapolated_abserror</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.extrapolated_abserror" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.extrapolated_relerror">
<code class="sig-name descname"><span class="pre">extrapolated_relerror</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.extrapolated_relerror" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.NumVarsELS.f0_ready">
<code class="sig-name descname"><span class="pre">f0_ready</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.NumVarsELS.f0_ready" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.ELSModel">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">ELSModel</span></code><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hydpy.core.modeltools.SolverModel" title="hydpy.core.modeltools.SolverModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.modeltools.SolverModel</span></code></a></p>
<p>Base class for hydrological models using the “Explicit Lobatto
Sequence” for solving ordinary differential equations.</p>
<p>The “Explicit Lobatto Sequence” is a variable order Runge Kutta
method combining different Lobatto methods.  Its main idea is to
first calculate a solution with a lower order method, then to use
these results to apply the next higher-order method, and to compare
both results.  If they are close enough, the latter results are
accepted.  If not, the next higher-order method is applied (or,
if no higher-order method is available, the step size is
decreased, and the algorithm restarts with the method of the
lowest order).  So far, the <a class="reference external" href="http://www.hydrology.ruhr-uni-bochum.de/hydrolgy/mam/download/schriftenreihe_29.pdf">thorough description</a> of the
algorithm is available in German only.</p>
<p>Note the strengths and weaknesses of class <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a> discussed
in the documentation on method <a class="reference internal" href="#hydpy.core.modeltools.ELSModel.solve" title="hydpy.core.modeltools.ELSModel.solve"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve()</span></code></a>.  Model developers
should not derive from class <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a> when trying to implement
models with a high potential for stiff parameterisations.
Discontinuities should be regularised, for example by the
“smoothing functions” provided by module <a class="reference internal" href="smoothtools.html#module-hydpy.auxs.smoothtools" title="hydpy.auxs.smoothtools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">smoothtools</span></code></a>.  Model
users should be careful not to define two small smoothing factors,
to avoid needlessly long simulation times.</p>
<dl class="py attribute">
<dt id="hydpy.core.modeltools.ELSModel.METHOD_GROUPS">
<code class="sig-name descname"><span class="pre">METHOD_GROUPS</span></code><em class="property"><span class="pre">:</span> <span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hydpy.core.modeltools.Method" title="hydpy.core.modeltools.Method"><span class="pre">Method</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">…</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"> <span class="pre">=</span> <span class="pre">('RECEIVER_METHODS',</span> <span class="pre">'INLET_METHODS',</span> <span class="pre">'PART_ODE_METHODS',</span> <span class="pre">'FULL_ODE_METHODS',</span> <span class="pre">'ADD_METHODS',</span> <span class="pre">'OUTLET_METHODS',</span> <span class="pre">'SENDER_METHODS')</span></em><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.METHOD_GROUPS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.ELSModel.numconsts">
<code class="sig-name descname"><span class="pre">numconsts</span></code><em class="property"><span class="pre">:</span> <a class="reference internal" href="#hydpy.core.modeltools.NumConstsELS" title="hydpy.core.modeltools.NumConstsELS"><span class="pre">hydpy.core.modeltools.NumConstsELS</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.numconsts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.ELSModel.numvars">
<code class="sig-name descname"><span class="pre">numvars</span></code><em class="property"><span class="pre">:</span> <a class="reference internal" href="#hydpy.core.modeltools.NumVarsELS" title="hydpy.core.modeltools.NumVarsELS"><span class="pre">hydpy.core.modeltools.NumVarsELS</span></a></em><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.numvars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.simulate">
<code class="sig-name descname"><span class="pre">simulate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to method <a class="reference internal" href="#hydpy.core.modeltools.Model.simulate" title="hydpy.core.modeltools.Model.simulate"><code class="xref py py-func docutils literal notranslate"><span class="pre">simulate()</span></code></a> of class <a class="reference internal" href="#hydpy.core.modeltools.AdHocModel" title="hydpy.core.modeltools.AdHocModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdHocModel</span></code></a> but
calls method <a class="reference internal" href="#hydpy.core.modeltools.ELSModel.solve" title="hydpy.core.modeltools.ELSModel.solve"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve()</span></code></a> instead of <a class="reference internal" href="#hydpy.core.modeltools.AdHocModel.run" title="hydpy.core.modeltools.AdHocModel.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a>.</p>
<p>When working in Cython mode, the standard model import overrides
this generic Python version with a model-specific Cython version.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.solve">
<code class="sig-name descname"><span class="pre">solve</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve all <cite>FULL_ODE_METHODS</cite> in parallel.</p>
<p>Implementing numerical integration algorithms that (hopefully)
always work well in practice is a tricky task.  The following
exhaustive examples show how well our “Explicit Lobatto
Sequence” algorithm performs for the numerical test models
<a class="reference internal" href="test_v1.html#module-hydpy.models.test_v1" title="hydpy.models.test_v1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">test_v1</span></code></a> and <a class="reference internal" href="test_v2.html#module-hydpy.models.test_v2" title="hydpy.models.test_v2"><code class="xref py py-mod docutils literal notranslate"><span class="pre">test_v2</span></code></a>.  We hope to cover all possible
corner-cases.  Please tell us if you find one we missed.</p>
<p>First, we set the value of parameter <a class="reference internal" href="test.html#hydpy.models.test.test_control.K" title="hydpy.models.test.test_control.K"><code class="xref py py-class docutils literal notranslate"><span class="pre">K</span></code></a> to zero,
resulting in no changes at all, and thus defining the simplest
test case possible:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Second, we assign values to the solver parameters
<a class="reference internal" href="test.html#hydpy.models.test.test_solver.AbsErrorMax" title="hydpy.models.test.test_solver.AbsErrorMax"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsErrorMax</span></code></a>, <a class="reference internal" href="test.html#hydpy.models.test.test_solver.RelDTMin" title="hydpy.models.test.test_solver.RelDTMin"><code class="xref py py-class docutils literal notranslate"><span class="pre">RelDTMin</span></code></a>, and
<a class="reference internal" href="test.html#hydpy.models.test.test_solver.RelDTMax" title="hydpy.models.test.test_solver.RelDTMax"><code class="xref py py-class docutils literal notranslate"><span class="pre">RelDTMax</span></code></a> to specify the required numerical accuracy
and the smallest and largest internal integration step size allowed:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">abserrormax</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">reldtmin</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">reldtmax</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Additionally, we set <a class="reference internal" href="test.html#hydpy.models.test.test_solver.RelErrorMax" title="hydpy.models.test.test_solver.RelErrorMax"><code class="xref py py-class docutils literal notranslate"><span class="pre">RelErrorMax</span></code></a> to <code class="xref py py-const docutils literal notranslate"><span class="pre">nan</span></code>,
which disables taking relative errors into account:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">relerrormax</span><span class="p">(</span><span class="n">nan</span><span class="p">)</span>
</pre></div>
</div>
<p>Calling method <a class="reference internal" href="#hydpy.core.modeltools.ELSModel.solve" title="hydpy.core.modeltools.ELSModel.solve"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve()</span></code></a> correctly calculates zero
discharge (<a class="reference internal" href="test.html#hydpy.models.test.test_fluxes.Q" title="hydpy.models.test.test_fluxes.Q"><code class="xref py py-class docutils literal notranslate"><span class="pre">Q</span></code></a>) and thus does not change the water
storage (<a class="reference internal" href="test.html#hydpy.models.test.test_states.S" title="hydpy.models.test.test_states.S"><code class="xref py py-class docutils literal notranslate"><span class="pre">S</span></code></a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(1.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.0)</span>
</pre></div>
</div>
<p>The achieve the above result, <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a> requires two function
calls, one for the initial guess (using the Explicit Euler Method)
and the other one (extending the Explicit Euler method to the
Explicit Heun method) to confirm the first guess meets the
required accuracy:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">dt</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span>
<span class="go">2</span>
</pre></div>
</div>
<p>With moderate changes due to setting the value of parameter
<a class="reference internal" href="test.html#hydpy.models.test.test_control.K" title="hydpy.models.test.test_control.K"><code class="xref py py-class docutils literal notranslate"><span class="pre">K</span></code></a> to 0.1, two method calls are still sufficient:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.905)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.095)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Calculating the analytical solution shows <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a> did not
exceed the given tolerance value:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>
<span class="go">0.904837</span>
</pre></div>
</div>
<p>After decreasing the allowed error by one order of magnitude,
<a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a> requires four method calls (again, one for the
first order and one for the second-order method, and two
additional calls for the third-order method):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">abserrormax</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.904833)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.095167)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span>
<span class="go">4</span>
</pre></div>
</div>
<p>After decreasing <a class="reference internal" href="test.html#hydpy.models.test.test_solver.AbsErrorMax" title="hydpy.models.test.test_solver.AbsErrorMax"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsErrorMax</span></code></a> by a factor of ten
again, <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a> needs one further higher-order method, which
requires three additional calls, making a sum of seven:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">abserrormax</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.904837)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.095163)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span>
<span class="go">7</span>
</pre></div>
</div>
<p><a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a> achieves even a very extreme numerical precision
(just for testing, way beyond hydrological requirements), in
one single step, but now requires a total of 29 method calls:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">abserrormax</span><span class="p">(</span><span class="mf">1e-12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.904837)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.095163)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">dt</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span>
<span class="go">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span>
<span class="go">29</span>
</pre></div>
</div>
<p>With a more dynamical parameterisation, where the storage decreases
by about 40% per time step, <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a> needs seven method calls
to meet a “normal” error tolerance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">abserrormax</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.606771)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.393229)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span>
<span class="go">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>
<span class="go">0.606531</span>
</pre></div>
</div>
<p>Being an explicit integration method, the “Explicit Lobatto
Sequence” can be inefficient for solving stiff initial value
problems.  Setting <a class="reference internal" href="test.html#hydpy.models.test.test_control.K" title="hydpy.models.test.test_control.K"><code class="xref py py-class docutils literal notranslate"><span class="pre">K</span></code></a> to 2.0 forces <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a>
to solve the problem in two substeps, requiring a total of
22 method calls:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>
<span class="go">0.135335</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.134658)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.865342)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
<span class="go">0.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span>
<span class="go">22</span>
</pre></div>
</div>
<p>Increasing the stiffness of the initial value problem further
can increase computation times rapidly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>
<span class="go">0.018316</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.019774)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.980226)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
<span class="go">0.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span>
<span class="go">44</span>
</pre></div>
</div>
<p>If we prevent <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a> from compensating its problems by
disallowing it to reduce its integration step size, it does not
achieve satisfying results:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">reldtmin</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.09672)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.90328)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span>
<span class="go">46</span>
</pre></div>
</div>
<p>You can restrict the allowed maximum integration step size, which
can help to prevent from loosing to much performance due to trying
to solve too stiff problems, repeatedly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">reldtmin</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">reldtmax</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.016806)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.983194)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
<span class="go">0.25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span>
<span class="go">33</span>
</pre></div>
</div>
<p>Alternatively, you can restrict the available number of Lobatto
methods.  Using two methods only is an inefficient choice for the
given initial value problem, but at least solves it with the
required accuracy:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">reldtmax</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numconsts</span><span class="o">.</span><span class="n">nmb_methods</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.020284)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.979716)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
<span class="go">0.156698</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span>
<span class="go">74</span>
</pre></div>
</div>
<p>In the above examples, we control numerical accuracies based on
absolute error estimates only via parameter <a class="reference internal" href="test.html#hydpy.models.test.test_solver.AbsErrorMax" title="hydpy.models.test.test_solver.AbsErrorMax"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbsErrorMax</span></code></a>.
After assigning an actual value to parameter <a class="reference internal" href="test.html#hydpy.models.test.test_solver.RelErrorMax" title="hydpy.models.test.test_solver.RelErrorMax"><code class="xref py py-class docutils literal notranslate"><span class="pre">RelErrorMax</span></code></a>,
<a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a> also takes relative errors into account.  We modify some
of the above examples to show how this works.</p>
<p>Generally, it is sufficient to meet one of both criteria.  If we
repeat the second example with a relaxed absolute but a strict
relative tolerance, we reproduce the original result due to our
absolute criteria being the relevant one:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">abserrormax</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">relerrormax</span><span class="p">(</span><span class="mf">0.000001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.905)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.095)</span>
</pre></div>
</div>
<p>The same holds for the opposite case of a strict absolute but a
relaxed relative tolerance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">abserrormax</span><span class="p">(</span><span class="mf">0.000001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">relerrormax</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.905)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.095)</span>
</pre></div>
</div>
<p>Reiterating the “more dynamical parameterisation” example results
in slightly different but also correct results:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.607196)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.392804)</span>
</pre></div>
</div>
<p>Reiterating the stiffest example with a relative instead of an
absolute error tolerance of 0.1 achieves higher accuracy, as
to be expected due to the value of <a class="reference internal" href="test.html#hydpy.models.test.test_states.S" title="hydpy.models.test.test_states.S"><code class="xref py py-class docutils literal notranslate"><span class="pre">S</span></code></a> being far
below 1.0 for some time:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.0185)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.9815)</span>
</pre></div>
</div>
<p>Besides its weaknesses with stiff problems, <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a> cannot
solve discontinuous problems well.  We use the <a class="reference internal" href="test_v1.html#module-hydpy.models.test_v1" title="hydpy.models.test_v1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">test_v1</span></code></a> example
model to demonstrate how <a class="reference internal" href="#hydpy.core.modeltools.ELSModel" title="hydpy.core.modeltools.ELSModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELSModel</span></code></a> behaves when confronted
with such a problem.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">reverse_model_wildcard_import</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse_model_wildcard_import</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v2</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
</pre></div>
</div>
<p>Everything works fine, as long as the discontinuity does not
affect the considered simulation step:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">abserrormax</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">reldtmin</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">reldtmax</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span><span class="o">.</span><span class="n">relerrormax</span><span class="p">(</span><span class="n">nan</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(0.5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">dt</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span>
<span class="go">2</span>
</pre></div>
</div>
<p>The occurrence of a discontinuity within the simulation step
often increases computation times more than a stiff parameterisation:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(-0.006827)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(1.006827)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span>
<span class="go">58</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">(</span><span class="mf">2.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span>
<span class="go">s(-0.00072)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(1.00072)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">nmb_calls</span>
<span class="go">50</span>
</pre></div>
</div>
<p>When working in Cython mode, the standard model import overrides
this generic Python version with a model-specific Cython version.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.calculate_single_terms">
<code class="sig-name descname"><span class="pre">calculate_single_terms</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.calculate_single_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.calculate_single_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply all methods stored in the <cite>PART_ODE_METHODS</cite> tuple.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">calculate_single_terms</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(0.25)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.calculate_full_terms">
<code class="sig-name descname"><span class="pre">calculate_full_terms</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.calculate_full_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.calculate_full_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply all methods stored in the <cite>FULL_ODE_METHODS</cite> tuple.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">old</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">calculate_full_terms</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">old</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">new</span>
<span class="go">0.75</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.get_point_states">
<code class="sig-name descname"><span class="pre">get_point_states</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.get_point_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.get_point_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the states corresponding to the actual stage.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">old</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">new</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_stage</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_s_points</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">get_point_states</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">old</span><span class="p">)</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">new</span><span class="p">)</span>
<span class="go">1.0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">reverse_model_wildcard_import</span><span class="p">,</span> <span class="n">print_values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse_model_wildcard_import</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v3</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">sv</span><span class="o">.</span><span class="n">old</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">sv</span><span class="o">.</span><span class="n">new</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_stage</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_sv_points</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">get_point_states</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">states</span><span class="o">.</span><span class="n">sv</span><span class="o">.</span><span class="n">old</span><span class="p">)</span>
<span class="go">3.0, 3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">states</span><span class="o">.</span><span class="n">sv</span><span class="o">.</span><span class="n">new</span><span class="p">)</span>
<span class="go">1.0, 2.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.set_point_states">
<code class="sig-name descname"><span class="pre">set_point_states</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.set_point_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.set_point_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the states corresponding to the actual stage.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">print_values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">old</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">new</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_stage</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_s_points</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_point_states</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">points</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
<span class="go">0.0, 0.0, 1.0, 0.0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">reverse_model_wildcard_import</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse_model_wildcard_import</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v3</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">sv</span><span class="o">.</span><span class="n">old</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">sv</span><span class="o">.</span><span class="n">new</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_stage</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_sv_points</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_point_states</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">points</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">0.0, 0.0, 1.0, 0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">points</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">0.0, 0.0, 2.0, 0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.set_result_states">
<code class="sig-name descname"><span class="pre">set_result_states</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.set_result_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.set_result_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the final states of the actual method.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">print_values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">old</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">new</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_s_results</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_result_states</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">results</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
<span class="go">0.0, 0.0, 1.0, 0.0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">reverse_model_wildcard_import</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse_model_wildcard_import</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v3</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">sv</span><span class="o">.</span><span class="n">old</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">states</span><span class="o">.</span><span class="n">sv</span><span class="o">.</span><span class="n">new</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">states</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_sv_results</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_result_states</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">results</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">0.0, 0.0, 1.0, 0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">results</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">0.0, 0.0, 2.0, 0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.get_sum_fluxes">
<code class="sig-name descname"><span class="pre">get_sum_fluxes</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.get_sum_fluxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.get_sum_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the sum of the fluxes calculated so far.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_q_sum</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">get_sum_fluxes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(1.0)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">reverse_model_wildcard_import</span><span class="p">,</span> <span class="n">print_values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse_model_wildcard_import</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v3</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">qv</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_qv_sum</span><span class="p">)[:]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">get_sum_fluxes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">qv</span>
<span class="go">qv(1.0, 2.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.set_point_fluxes">
<code class="sig-name descname"><span class="pre">set_point_fluxes</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.set_point_fluxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.set_point_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the fluxes corresponding to the actual stage.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">print_values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_stage</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_q_points</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_point_fluxes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">points</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
<span class="go">0.0, 0.0, 1.0, 0.0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">reverse_model_wildcard_import</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse_model_wildcard_import</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v3</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">qv</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_stage</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_qv_points</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_point_fluxes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">points</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">0.0, 0.0, 1.0, 0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">points</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">0.0, 0.0, 2.0, 0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.set_result_fluxes">
<code class="sig-name descname"><span class="pre">set_result_fluxes</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.set_result_fluxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.set_result_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the final fluxes of the actual method.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">print_values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_q_results</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_result_fluxes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">results</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
<span class="go">0.0, 0.0, 1.0, 0.0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">reverse_model_wildcard_import</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse_model_wildcard_import</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v3</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">qv</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_qv_results</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_result_fluxes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">results</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">0.0, 0.0, 1.0, 0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">results</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">0.0, 0.0, 2.0, 0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.integrate_fluxes">
<code class="sig-name descname"><span class="pre">integrate_fluxes</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.integrate_fluxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.integrate_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a dot multiplication between the fluxes and the
A coefficients associated with the different stages of the
actual method.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">print_values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_stage</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_q_points</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">999.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">integrate_fluxes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">pub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numconsts</span><span class="o">.</span><span class="n">a_coefs</span><span class="p">)[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="go">0.375, 0.125</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span>
<span class="go">q(2.9375)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">reverse_model_wildcard_import</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse_model_wildcard_import</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v3</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_stage</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_qv_points</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">999.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">999.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">integrate_fluxes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numconsts</span><span class="o">.</span><span class="n">a_coefs</span><span class="p">)[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="go">0.375, 0.125</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">qv</span>
<span class="go">qv(0.25, 2.9375)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.reset_sum_fluxes">
<code class="sig-name descname"><span class="pre">reset_sum_fluxes</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.reset_sum_fluxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.reset_sum_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the sum of the fluxes calculated so far to zero.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_q_sum</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">reset_sum_fluxes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_q_sum</span>
<span class="go">0.0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">reverse_model_wildcard_import</span><span class="p">,</span> <span class="n">print_values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse_model_wildcard_import</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v3</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sums</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_qv_sum</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sums</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">reset_sum_fluxes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_qv_sum</span><span class="p">)</span>
<span class="go">0.0, 0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.addup_fluxes">
<code class="sig-name descname"><span class="pre">addup_fluxes</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.addup_fluxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.addup_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Add up the sum of the fluxes calculated so far.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_q_sum</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">q</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">addup_fluxes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_q_sum</span>
<span class="go">3.0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">reverse_model_wildcard_import</span><span class="p">,</span> <span class="n">print_values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse_model_wildcard_import</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v3</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sums</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_qv_sum</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sums</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fluxes</span><span class="o">.</span><span class="n">qv</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">addup_fluxes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">sums</span><span class="p">)</span>
<span class="go">4.0, 6.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.calculate_error">
<code class="sig-name descname"><span class="pre">calculate_error</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.calculate_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.calculate_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the numerical error based on the relevant fluxes
calculated by the current and the last method.</p>
<p>“Relevant fluxes” are those contained within the <cite>SOLVERSEQUENCES</cite>
tuple.  If this tuple is empty, method <a class="reference internal" href="#hydpy.core.modeltools.ELSModel.calculate_error" title="hydpy.core.modeltools.ELSModel.calculate_error"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_error()</span></code></a>
selects all flux sequences of the respective model with a <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>
<cite>NUMERIC</cite> attribute.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_q_results</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">use_relerror</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">calculate_error</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">abserror</span><span class="p">)</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">relerror</span>
<span class="go">inf</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">use_relerror</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">calculate_error</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">abserror</span><span class="p">)</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">relerror</span><span class="p">)</span>
<span class="go">0.25</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">calculate_error</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">abserror</span><span class="p">)</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">relerror</span><span class="p">)</span>
<span class="go">0.0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">calculate_error</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">abserror</span><span class="p">)</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">relerror</span>
<span class="go">inf</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">reverse_model_wildcard_import</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reverse_model_wildcard_import</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v3</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">use_relerror</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fluxes</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">_qv_results</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">calculate_error</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">abserror</span><span class="p">)</span>
<span class="go">4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">relerror</span><span class="p">)</span>
<span class="go">1.0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">calculate_error</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">abserror</span><span class="p">)</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">relerror</span><span class="p">)</span>
<span class="go">0.0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">calculate_error</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">abserror</span><span class="p">)</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">relerror</span>
<span class="go">inf</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.core.modeltools.ELSModel.extrapolate_error">
<code class="sig-name descname"><span class="pre">extrapolate_error</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/core/modeltools.html#ELSModel.extrapolate_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.ELSModel.extrapolate_error" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Estimate the numerical error expected when applying all methods</dt><dd><p>available based on the results of the current and the last method.</p>
</dd>
</dl>
<p>Note that you cannot apply this extrapolation strategy on the first
method.   If the current method is the first one, method
<a class="reference internal" href="#hydpy.core.modeltools.ELSModel.extrapolate_error" title="hydpy.core.modeltools.ELSModel.extrapolate_error"><code class="xref py py-func docutils literal notranslate"><span class="pre">extrapolate_error()</span></code></a> returns <cite>-999.9</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.models.test_v1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameterstep</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">use_relerror</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">abserror</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">last_abserror</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extrapolate_error</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">extrapolated_abserror</span><span class="p">)</span>
<span class="go">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">extrapolated_relerror</span>
<span class="go">inf</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">use_relerror</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">relerror</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">last_relerror</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extrapolate_error</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">extrapolated_abserror</span><span class="p">)</span>
<span class="go">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">extrapolated_relerror</span><span class="p">)</span>
<span class="go">0.001</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">idx_method</span> <span class="o">=</span> <span class="mi">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extrapolate_error</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">extrapolated_abserror</span><span class="p">)</span>
<span class="go">0.001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">extrapolated_relerror</span><span class="p">)</span>
<span class="go">0.0001</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">relerror</span> <span class="o">=</span> <span class="n">inf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extrapolate_error</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">extrapolated_relerror</span><span class="p">)</span>
<span class="go">inf</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">abserror</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extrapolate_error</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">extrapolated_abserror</span><span class="p">)</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">numvars</span><span class="o">.</span><span class="n">extrapolated_relerror</span><span class="p">)</span>
<span class="go">0.0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.AideSequences">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">AideSequences</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sequences" title="hydpy.core.sequencetools.Sequences"><span class="pre">hydpy.core.sequencetools.Sequences</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_fastaccess</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">FastAccessType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cymodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="typingtools.html#hydpy.core.typingtools.CyModelProtocol" title="hydpy.core.typingtools.CyModelProtocol"><span class="pre">hydpy.core.typingtools.CyModelProtocol</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.core.modeltools.AideSequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.ModelSequences" title="hydpy.core.sequencetools.ModelSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.sequencetools.ModelSequences</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">AideSequence</span></code>, <a class="reference internal" href="variabletools.html#hydpy.core.variabletools.FastAccess" title="hydpy.core.variabletools.FastAccess"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.variabletools.FastAccess</span></code></a>]</p>
<p>Aide sequences of model modeltools.</p>
</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.FluxSequences">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">FluxSequences</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sequences" title="hydpy.core.sequencetools.Sequences"><span class="pre">hydpy.core.sequencetools.Sequences</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_fastaccess</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">FastAccessType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cymodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="typingtools.html#hydpy.core.typingtools.CyModelProtocol" title="hydpy.core.typingtools.CyModelProtocol"><span class="pre">hydpy.core.typingtools.CyModelProtocol</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.core.modeltools.FluxSequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.OutputSequences" title="hydpy.core.sequencetools.OutputSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.sequencetools.OutputSequences</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">FluxSequence</span></code>]</p>
<p>Flux sequences of model modeltools.</p>
</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.InletSequences">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">InletSequences</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sequences" title="hydpy.core.sequencetools.Sequences"><span class="pre">hydpy.core.sequencetools.Sequences</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_fastaccess</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">FastAccessType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cymodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="typingtools.html#hydpy.core.typingtools.CyModelProtocol" title="hydpy.core.typingtools.CyModelProtocol"><span class="pre">hydpy.core.typingtools.CyModelProtocol</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.core.modeltools.InletSequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.LinkSequences" title="hydpy.core.sequencetools.LinkSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.sequencetools.LinkSequences</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">InletSequence</span></code>]</p>
<p>Inlet sequences of model modeltools.</p>
</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.InputSequences">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">InputSequences</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sequences" title="hydpy.core.sequencetools.Sequences"><span class="pre">hydpy.core.sequencetools.Sequences</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_fastaccess</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">FastAccessType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cymodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="typingtools.html#hydpy.core.typingtools.CyModelProtocol" title="hydpy.core.typingtools.CyModelProtocol"><span class="pre">hydpy.core.typingtools.CyModelProtocol</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.core.modeltools.InputSequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.ModelIOSequences" title="hydpy.core.sequencetools.ModelIOSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.sequencetools.ModelIOSequences</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">InputSequence</span></code>, <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.FastAccessInputSequence" title="hydpy.core.sequencetools.FastAccessInputSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.sequencetools.FastAccessInputSequence</span></code></a>]</p>
<p>Input sequences of model modeltools.</p>
</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.LogSequences">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">LogSequences</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sequences" title="hydpy.core.sequencetools.Sequences"><span class="pre">hydpy.core.sequencetools.Sequences</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_fastaccess</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">FastAccessType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cymodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="typingtools.html#hydpy.core.typingtools.CyModelProtocol" title="hydpy.core.typingtools.CyModelProtocol"><span class="pre">hydpy.core.typingtools.CyModelProtocol</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.core.modeltools.LogSequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.ModelSequences" title="hydpy.core.sequencetools.ModelSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.sequencetools.ModelSequences</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">LogSequence</span></code>, <a class="reference internal" href="variabletools.html#hydpy.core.variabletools.FastAccess" title="hydpy.core.variabletools.FastAccess"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.variabletools.FastAccess</span></code></a>]</p>
<p>Log sequences of model modeltools.</p>
</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.OutletSequences">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">OutletSequences</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sequences" title="hydpy.core.sequencetools.Sequences"><span class="pre">hydpy.core.sequencetools.Sequences</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_fastaccess</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">FastAccessType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cymodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="typingtools.html#hydpy.core.typingtools.CyModelProtocol" title="hydpy.core.typingtools.CyModelProtocol"><span class="pre">hydpy.core.typingtools.CyModelProtocol</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.core.modeltools.OutletSequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.LinkSequences" title="hydpy.core.sequencetools.LinkSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.sequencetools.LinkSequences</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">OutletSequence</span></code>]</p>
<p>Outlet sequences of model modeltools.</p>
</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.ReceiverSequences">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">ReceiverSequences</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sequences" title="hydpy.core.sequencetools.Sequences"><span class="pre">hydpy.core.sequencetools.Sequences</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_fastaccess</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">FastAccessType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cymodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="typingtools.html#hydpy.core.typingtools.CyModelProtocol" title="hydpy.core.typingtools.CyModelProtocol"><span class="pre">hydpy.core.typingtools.CyModelProtocol</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.core.modeltools.ReceiverSequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.LinkSequences" title="hydpy.core.sequencetools.LinkSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.sequencetools.LinkSequences</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ReceiverSequence</span></code>]</p>
<p>Receiver sequences of model modeltools.</p>
</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.SenderSequences">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">SenderSequences</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sequences" title="hydpy.core.sequencetools.Sequences"><span class="pre">hydpy.core.sequencetools.Sequences</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_fastaccess</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">FastAccessType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cymodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="typingtools.html#hydpy.core.typingtools.CyModelProtocol" title="hydpy.core.typingtools.CyModelProtocol"><span class="pre">hydpy.core.typingtools.CyModelProtocol</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.core.modeltools.SenderSequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.LinkSequences" title="hydpy.core.sequencetools.LinkSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.sequencetools.LinkSequences</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">SenderSequence</span></code>]</p>
<p>Sender sequences of model modeltools.</p>
</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.StateSequences">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">StateSequences</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sequences" title="hydpy.core.sequencetools.Sequences"><span class="pre">hydpy.core.sequencetools.Sequences</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_fastaccess</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">FastAccessType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cymodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="typingtools.html#hydpy.core.typingtools.CyModelProtocol" title="hydpy.core.typingtools.CyModelProtocol"><span class="pre">hydpy.core.typingtools.CyModelProtocol</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.core.modeltools.StateSequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.OutputSequences" title="hydpy.core.sequencetools.OutputSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.core.sequencetools.OutputSequences</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">StateSequence</span></code>]</p>
<p>State sequences of model modeltools.</p>
</dd></dl>

<dl class="py class">
<dt id="hydpy.core.modeltools.Submodel">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.core.modeltools.</span></code><code class="sig-name descname"><span class="pre">Submodel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#hydpy.core.modeltools.Model" title="hydpy.core.modeltools.Model"><span class="pre">hydpy.core.modeltools.Model</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/core/modeltools.html#Submodel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.core.modeltools.Submodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for implementing “submodels” that serve to deal with
(possibly complicated) general mathematical algorithms (e.g.
root-finding algorithms) within hydrological model methods.</p>
<p>You might find class <a class="reference internal" href="#hydpy.core.modeltools.Submodel" title="hydpy.core.modeltools.Submodel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodel</span></code></a> useful when trying to implement
algorithms requiring some interaction with the respective model
without any Python overhead.  See the modules <a class="reference internal" href="roottools.html#module-hydpy.auxs.roottools" title="hydpy.auxs.roottools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">roottools</span></code></a> and
<cite>rootutils</cite> as an example, implementing Python interfaces and
Cython implementations of a root-finding algorithms, respectively.</p>
<dl class="py attribute">
<dt id="hydpy.core.modeltools.Submodel.METHODS">
<code class="sig-name descname"><span class="pre">METHODS</span></code><em class="property"><span class="pre">:</span> <span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hydpy.core.modeltools.Method" title="hydpy.core.modeltools.Method"><span class="pre">hydpy.core.modeltools.Method</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="p"><span class="pre">…</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.modeltools.Submodel.METHODS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.Submodel.CYTHONBASECLASS">
<code class="sig-name descname"><span class="pre">CYTHONBASECLASS</span></code><em class="property"><span class="pre">:</span> <span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.modeltools.Submodel.CYTHONBASECLASS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.core.modeltools.Submodel.PYTHONCLASS">
<code class="sig-name descname"><span class="pre">PYTHONCLASS</span></code><em class="property"><span class="pre">:</span> <span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hydpy.core.modeltools.Submodel.PYTHONCLASS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/HydPy_Logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to.html">How to…</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="framework.html">Framework Tools</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="core.html">Core Tools</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="aliastools.html">aliastools</a></li>
<li class="toctree-l3"><a class="reference internal" href="autodoctools.html">autodoctools</a></li>
<li class="toctree-l3"><a class="reference internal" href="auxfiletools.html">auxfiletools</a></li>
<li class="toctree-l3"><a class="reference internal" href="devicetools.html">devicetools</a></li>
<li class="toctree-l3"><a class="reference internal" href="exceptiontools.html">exceptiontools</a></li>
<li class="toctree-l3"><a class="reference internal" href="filetools.html">filetools</a></li>
<li class="toctree-l3"><a class="reference internal" href="hydpytools.html">hydpytools</a></li>
<li class="toctree-l3"><a class="reference internal" href="importtools.html">importtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="indextools.html">indextools</a></li>
<li class="toctree-l3"><a class="reference internal" href="itemtools.html">itemtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="masktools.html">masktools</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">modeltools</a></li>
<li class="toctree-l3"><a class="reference internal" href="netcdftools.html">netcdftools</a></li>
<li class="toctree-l3"><a class="reference internal" href="objecttools.html">objecttools</a></li>
<li class="toctree-l3"><a class="reference internal" href="optiontools.html">optiontools</a></li>
<li class="toctree-l3"><a class="reference internal" href="parametertools.html">parametertools</a></li>
<li class="toctree-l3"><a class="reference internal" href="printtools.html">printtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="propertytools.html">propertytools</a></li>
<li class="toctree-l3"><a class="reference internal" href="pubtools.html">pubtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="selectiontools.html">selectiontools</a></li>
<li class="toctree-l3"><a class="reference internal" href="sequencetools.html">sequencetools</a></li>
<li class="toctree-l3"><a class="reference internal" href="seriestools.html">seriestools</a></li>
<li class="toctree-l3"><a class="reference internal" href="testtools.html">testtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="timetools.html">timetools</a></li>
<li class="toctree-l3"><a class="reference internal" href="typingtools.html">typingtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="variabletools.html">variabletools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="execution.html">Execution Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="cythons.html">Cython Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="auxiliaries.html">Auxiliary Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modelcollection.html">Model Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="zbibliography.html">Bibliography</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="masktools.html"
                        title="previous chapter">masktools</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="netcdftools.html"
                        title="next chapter">netcdftools</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/modeltools.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="netcdftools.html" title="netcdftools"
             >next</a> |</li>
        <li class="right" >
          <a href="masktools.html" title="masktools"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HydPy 4.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="framework.html" >Framework Tools</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="core.html" >Core Tools</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">modeltools</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, HydPy Developers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.2.
    </div>
  </body>
</html>
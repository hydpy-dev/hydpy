
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>anntools &#8212; HydPy 4.0.1 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"displayAlign": "left"})</script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="armatools" href="armatools.html" />
    <link rel="prev" title="Auxiliary Tools" href="auxiliaries.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="armatools.html" title="armatools"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="auxiliaries.html" title="Auxiliary Tools"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HydPy 4.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="framework.html" >Framework Tools</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="auxiliaries.html" accesskey="U">Auxiliary Tools</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">anntools</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="anntools">
<span id="id1"></span><h1>anntools<a class="headerlink" href="#anntools" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-hydpy.auxs.anntools"></span><p>This module implements rudimentary artificial neural network tools
required for some models implemented in the <em>HydPy</em> framework.</p>
<p>The relevant models apply some of the neural network features during
simulation runs, which is why we implement these features in the Cython
extension module <code class="xref py py-mod docutils literal notranslate"><span class="pre">annutils</span></code>.</p>
<p>Module <a class="reference internal" href="#module-hydpy.auxs.anntools" title="hydpy.auxs.anntools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">anntools</span></code></a> implements the following members:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#hydpy.auxs.anntools.BaseANN" title="hydpy.auxs.anntools.BaseANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseANN</span></code></a> Base for implementing artificial neural networks classes.</p></li>
<li><p><a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> Multi-layer feed-forward artificial neural network.</p></li>
<li><p><a class="reference internal" href="#hydpy.auxs.anntools.ann" title="hydpy.auxs.anntools.ann"><code class="xref py py-func docutils literal notranslate"><span class="pre">ann()</span></code></a> Return a new stand-alone <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> object with the given parameter values.</p></li>
<li><p><a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a> Handles relationships described by artificial neural networks that vary within an annual cycle.</p></li>
</ul>
</div></blockquote>
<hr class="docutils" />
<dl class="py class">
<dt id="hydpy.auxs.anntools.BaseANN">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.auxs.anntools.</span></code><code class="sig-name descname"><span class="pre">BaseANN</span></code><a class="reference internal" href="_modules/hydpy/auxs/anntools.html#BaseANN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.auxs.anntools.BaseANN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base for implementing artificial neural networks classes.</p>
<dl class="py attribute">
<dt id="hydpy.auxs.anntools.BaseANN.XLABEL">
<code class="sig-name descname"><span class="pre">XLABEL</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></em><a class="headerlink" href="#hydpy.auxs.anntools.BaseANN.XLABEL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.BaseANN.YLABEL">
<code class="sig-name descname"><span class="pre">YLABEL</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></em><a class="headerlink" href="#hydpy.auxs.anntools.BaseANN.YLABEL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydpy.auxs.anntools.ANN">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.auxs.anntools.</span></code><code class="sig-name descname"><span class="pre">ANN</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subvars</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="parametertools.html#hydpy.core.parametertools.SubParameters" title="hydpy.core.parametertools.SubParameters"><span class="pre">hydpy.core.parametertools.SubParameters</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/auxs/anntools.html#ANN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.auxs.anntools.ANN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hydpy.auxs.anntools.BaseANN" title="hydpy.auxs.anntools.BaseANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.auxs.anntools.BaseANN</span></code></a></p>
<p>Multi-layer feed-forward artificial neural network.</p>
<p>By default, class <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> uses the logistic function
<span class="math notranslate nohighlight">\(f(x) = \frac{1}{1+exp(-x)}\)</span> to calculate the activation of
the neurons of the hidden layer.  Alternatively, one can select the
identity function <span class="math notranslate nohighlight">\(f(x) = x\)</span> or a variant of the logistic
function for filtering specific inputs.  See property
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.activation" title="hydpy.auxs.anntools.ANN.activation"><code class="xref py py-const docutils literal notranslate"><span class="pre">activation</span></code></a> for more information on how to do this.</p>
<p>Usually, one applies class <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> for the derivation of very
complex control parameters.  Its original purpose was to allow for
defining arbitrary continuous relationships between the water stored
in a dam and the associated water stage (see model <a class="reference internal" href="dam_v001.html#module-hydpy.models.dam_v001" title="hydpy.models.dam_v001"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dam_v001</span></code></a>).
However, for testing purposes class <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> can also be applied
directly, as shown in the following examples.</p>
<p>Firstly, define the most simple artificial neural network consisting of
only one input node, one hidden neuron, and one output node, and pass
some arbitrary network parameters:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span><span class="p">,</span> <span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">weights_input</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intercepts_hidden</span><span class="o">=-</span><span class="mf">16.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>The following loop subsequently sets the values 0 to 8 as input values,
performs the calculation, and prints out the final output.  As to be
expected, the results show the shape of the logistic function:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">input_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">([</span><span class="n">input_</span><span class="p">,</span> <span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="go">0, -1.0</span>
<span class="go">1, -0.999982</span>
<span class="go">2, -0.998994</span>
<span class="go">3, -0.946041</span>
<span class="go">4, 0.5</span>
<span class="go">5, 1.946041</span>
<span class="go">6, 1.998994</span>
<span class="go">7, 1.999982</span>
<span class="go">8, 2.0</span>
</pre></div>
</div>
<p>One can also directly plot the resulting graph:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use the <cite>pyplot</cite> API of <cite>matplotlib</cite> to modify the figure
or to save it to disk (or print it to the screen, in case the
interactive mode of <cite>matplotlib</cite> is disabled):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.testtools</span> <span class="kn">import</span> <span class="n">save_autofig</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_autofig</span><span class="p">(</span><span class="s2">&quot;ANN_plot.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/ANN_plot.png" src="_images/ANN_plot.png" />
<p>Some models might require the derivative of certain outputs with respect
to individual inputs.  One example is application model the <a class="reference internal" href="dam_v006.html#module-hydpy.models.dam_v006" title="hydpy.models.dam_v006"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dam_v006</span></code></a>,
which uses class <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> to model the relationship between water
storage and stage of a lake.  During a simulation run , it additionally
needs to know the area of the water surface, which is the derivative of
storage with respect to stage.  For such purposes, class <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a>
provides method <a class="reference internal" href="#hydpy.auxs.anntools.ANN.calculate_derivatives" title="hydpy.auxs.anntools.ANN.calculate_derivatives"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_derivatives()</span></code></a>.  In the following
example, we apply this method and compare its results with finite
difference approximations:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d_input</span> <span class="o">=</span> <span class="mf">1e-8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">input_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span><span class="o">-</span><span class="n">d_input</span><span class="o">/</span><span class="mf">2.0</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">value0</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span><span class="o">+</span><span class="n">d_input</span><span class="o">/</span><span class="mf">2.0</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">value1</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">derivative</span> <span class="o">=</span> <span class="p">(</span><span class="n">value1</span><span class="o">-</span><span class="n">value0</span><span class="p">)</span><span class="o">/</span><span class="n">d_input</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_derivatives</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">([</span><span class="n">input_</span><span class="p">,</span> <span class="n">derivative</span><span class="p">,</span> <span class="n">ann</span><span class="o">.</span><span class="n">output_derivatives</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="go">0, 0.000001, 0.000001</span>
<span class="go">1, 0.000074, 0.000074</span>
<span class="go">2, 0.004023, 0.004023</span>
<span class="go">3, 0.211952, 0.211952</span>
<span class="go">4, 3.0, 3.0</span>
<span class="go">5, 0.211952, 0.211952</span>
<span class="go">6, 0.004023, 0.004023</span>
<span class="go">7, 0.000074, 0.000074</span>
<span class="go">8, 0.000001, 0.000001</span>
</pre></div>
</div>
<p>Note the following two potential pitfalls (both due to improving the
computational efficiency of method <a class="reference internal" href="#hydpy.auxs.anntools.ANN.calculate_derivatives" title="hydpy.auxs.anntools.ANN.calculate_derivatives"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_derivatives()</span></code></a>):
First, for networks with more than one hidden layer, you must call
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.calculate_values" title="hydpy.auxs.anntools.ANN.calculate_values"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_values()</span></code></a> before calling
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.calculate_derivatives" title="hydpy.auxs.anntools.ANN.calculate_derivatives"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_derivatives()</span></code></a>.  Second, method
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.calculate_derivatives" title="hydpy.auxs.anntools.ANN.calculate_derivatives"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_derivatives()</span></code></a> calculates the derivatives
with respect to a single input only, to be selected by the <cite>idx_input</cite>
argument.  However, it works fine to call method
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.calculate_values" title="hydpy.auxs.anntools.ANN.calculate_values"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_values()</span></code></a> ones and to call
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.calculate_derivatives" title="hydpy.auxs.anntools.ANN.calculate_derivatives"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_derivatives()</span></code></a> multiple times afterwards. Then
you can subsequently pass different index values to calculate the
derivatives with respect to multiple inputs.</p>
<p>The following example shows that everything works well for more complex
single layer networks also (we checked the results manually using a
spreadsheet program):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_inputs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_neurons</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_outputs</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_input</span> <span class="o">=</span> <span class="p">[[</span> <span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7</span><span class="p">,</span>  <span class="mf">0.6</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span> <span class="mf">0.9</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>  <span class="mf">2.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_output</span> <span class="o">=</span> <span class="p">[[</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">2.0</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="p">[</span> <span class="mf">0.4</span><span class="p">,</span>  <span class="mf">2.4</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="p">[</span> <span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">intercepts_hidden</span> <span class="o">=</span> <span class="p">[</span> <span class="mf">0.9</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">intercepts_output</span> <span class="o">=</span> <span class="p">[</span> <span class="mf">1.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>  <span class="mf">1.3</span><span class="p">,</span>  <span class="mf">1.6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span>
<span class="go">1.822222, 1.876983</span>
</pre></div>
</div>
<p>We again validate the calculated derivatives by comparison with numerical
approximations:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">idx_input</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_derivatives</span><span class="p">(</span><span class="n">idx_input</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">ann</span><span class="o">.</span><span class="n">output_derivatives</span><span class="p">)</span>
<span class="go">0.099449, -0.103039</span>
<span class="go">-0.01303, 0.365739</span>
<span class="go">0.027041, -0.203965</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d_input</span> <span class="o">=</span> <span class="mf">1e-8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">idx_input</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">input_</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span><span class="o">-</span><span class="n">d_input</span><span class="o">/</span><span class="mf">2.0</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">values0</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span><span class="o">+</span><span class="n">d_input</span><span class="o">/</span><span class="mf">2.0</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">values1</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">((</span><span class="n">values1</span><span class="o">-</span><span class="n">values0</span><span class="p">)</span><span class="o">/</span><span class="n">d_input</span><span class="p">)</span>
<span class="go">0.099449, -0.103039</span>
<span class="go">-0.01303, 0.365739</span>
<span class="go">0.027041, -0.203965</span>
</pre></div>
</div>
<p>The next example shows how to solve the XOR problem with a two-layer
network.  As usual, <cite>1</cite> stands for <cite>True</cite> and <cite>0</cite> stands for <cite>False</cite>.</p>
<p>We define a network with two inputs (<cite>I1</cite> and <cite>I2</cite>), two neurons in
the first hidden layer (<cite>H11</cite> and <cite>H12</cite>), one neuron in the second
hidden layer (<cite>H2</cite>), and a single output (<cite>O1</cite>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_inputs</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_neurons</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_outputs</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The value of <cite>O1</cite> shall be identical with the activation of <cite>H2</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_output</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">intercepts_output</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>We set all intercepts of the neurons of the hidden layer to 750
(and initialise unnecessary matrix entries with “nan” to avoid
confusion). Therefore, an input of 500 or 1000 results in an
activation state of approximately zero or one, respectively. :</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">intercepts_hidden</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mf">750.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">750.0</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span><span class="o">-</span><span class="mf">750.0</span><span class="p">,</span> <span class="n">nan</span><span class="p">]]</span>
</pre></div>
</div>
<p>The weighting factor between both inputs and <cite>H11</cite> is 1000.
Hence, one <cite>True</cite> input is sufficient to activate <cite>H1</cite>.  In contrast,
the weighting factor between both inputs and <cite>H12</cite> is 500.
Hence, two <cite>True</cite> inputs are required to activate <cite>H12</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_input</span><span class="o">=</span> <span class="p">[[</span><span class="mf">1000.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mf">1000.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">]]</span>
</pre></div>
</div>
<p>The weighting factor between <cite>H11</cite> and <cite>H2</cite> is 1000.  Hence, in
principle, <cite>H11</cite> can activate <cite>H2</cite>.  However, the weighting factor
between <cite>H12</cite> and <cite>H2</cite> is -1000.  Hence, <cite>H12</cite> prevents <cite>H2</cite> from
becoming activated even when <cite>H11</cite> is activated:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_hidden</span><span class="o">=</span> <span class="p">[[[</span><span class="mf">1000.0</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span><span class="o">-</span><span class="mf">1000.0</span><span class="p">]]]</span>
</pre></div>
</div>
<p>To recapitulate, <cite>H11</cite> determines if at least one input is <cite>True</cite>,
<cite>H12</cite> determines if both inputs are <cite>True</cite>, and <cite>H2</cite> determines if
precisely  one input is <cite>True</cite>, which is the solution for the XOR-problem:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span>
<span class="go">ann(</span>
<span class="go">    nmb_inputs=2,</span>
<span class="go">    nmb_neurons=(2, 1),</span>
<span class="go">    weights_input=[[1000.0, 500.0],</span>
<span class="go">                   [1000.0, 500.0]],</span>
<span class="go">    weights_hidden=[[[1000.0],</span>
<span class="go">                     [-1000.0]]],</span>
<span class="go">    weights_output=[[1.0]],</span>
<span class="go">    intercepts_hidden=[[-750.0, -750.0],</span>
<span class="go">                       [-750.0, nan]],</span>
<span class="go">    intercepts_output=[0.0],</span>
<span class="go">)</span>
</pre></div>
</div>
<p>The following calculation confirms the proper configuration of our network:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">inputs</span> <span class="ow">in</span> <span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)):</span>
<span class="gp">... </span>   <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span>
<span class="gp">... </span>   <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>   <span class="n">round_</span><span class="p">([</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="go">0.0, 0.0, 0.0</span>
<span class="go">1.0, 0.0, 1.0</span>
<span class="go">0.0, 1.0, 1.0</span>
<span class="go">1.0, 1.0, 0.0</span>
</pre></div>
</div>
<p>To elaborate on the last calculation, we show the corresponding
activations of the hidden neurons. As both inputs are <cite>True</cite>, both
<cite>H12</cite> (upper left value) and <cite>H22</cite> (upper right value) are activated,
but <cite>H2</cite> (lower left value) is not:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">neurons</span>
<span class="go">array([[ 1.,  1.],</span>
<span class="go">       [ 0.,  0.]])</span>
</pre></div>
</div>
<p>Due to sharp response function, the derivatives with respect to both
inputs are approximately zero:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">inputs</span> <span class="ow">in</span> <span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)):</span>
<span class="gp">... </span>   <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span>
<span class="gp">... </span>   <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>   <span class="n">ann</span><span class="o">.</span><span class="n">calculate_derivatives</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>   <span class="n">round_</span><span class="p">([</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ann</span><span class="o">.</span><span class="n">output_derivatives</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="go">0.0, 0.0, 0.0</span>
<span class="go">1.0, 0.0, 0.0</span>
<span class="go">0.0, 1.0, 0.0</span>
<span class="go">1.0, 1.0, 0.0</span>
</pre></div>
</div>
<p>To better validate the calculation of derivatives for multi-layer
networks, we decrease the weights (and, accordingly, the intercepts)
of our network, making its response more smooth:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">weights_input</span><span class="o">=</span><span class="p">[[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">weights_hidden</span><span class="o">=</span><span class="p">[[[</span><span class="mf">10.0</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span><span class="o">-</span><span class="mf">10.0</span><span class="p">]]],</span>
<span class="gp">... </span>    <span class="n">weights_output</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.0</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">intercepts_hidden</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mf">7.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.5</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="p">[</span><span class="o">-</span><span class="mf">7.5</span><span class="p">,</span> <span class="n">nan</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">intercepts_output</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">])</span>
</pre></div>
</div>
<p>The results of method <a class="reference internal" href="#hydpy.auxs.anntools.ANN.calculate_derivatives" title="hydpy.auxs.anntools.ANN.calculate_derivatives"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_derivatives()</span></code></a> again agree
with those of the finite difference approximation:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">inputs</span> <span class="ow">in</span> <span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_derivatives</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">derivative1</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">output_derivatives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_derivatives</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">derivative2</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">output_derivatives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">([</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">derivative1</span><span class="p">,</span> <span class="n">derivative2</span><span class="p">])</span>
<span class="go">0.0, 0.0, 0.000015, 0.000015</span>
<span class="go">1.0, 0.0, 0.694609, 0.694609</span>
<span class="go">0.0, 1.0, 0.694609, 0.694609</span>
<span class="go">1.0, 1.0, -0.004129, -0.004129</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d_input</span> <span class="o">=</span> <span class="mf">1e-8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">inputs</span> <span class="ow">in</span> <span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
<span class="gp">... </span>               <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">derivatives</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">idx_input</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span>
<span class="gp">... </span>        <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span><span class="o">-</span><span class="n">d_input</span><span class="o">/</span><span class="mf">2.0</span>
<span class="gp">... </span>        <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">value0</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>        <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span><span class="o">+</span><span class="n">d_input</span><span class="o">/</span><span class="mf">2.0</span>
<span class="gp">... </span>        <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">value1</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>        <span class="n">derivatives</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">value1</span><span class="o">-</span><span class="n">value0</span><span class="p">)</span><span class="o">/</span><span class="n">d_input</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">([</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="n">derivatives</span><span class="p">)</span>
<span class="go">0.0, 0.0, 0.000015, 0.000015</span>
<span class="go">1.0, 0.0, 0.694609, 0.694609</span>
<span class="go">0.0, 1.0, 0.694609, 0.694609</span>
<span class="go">1.0, 1.0, -0.004129, -0.004129</span>
</pre></div>
</div>
<p>Note that Python class <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> handles a corresponding Cython
extension class defined in <code class="xref py py-mod docutils literal notranslate"><span class="pre">annutils</span></code>, which does not protect itself
against segmentation faults. But class  <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> takes up this
task, meaning using its public members should always result in readable
exceptions instead of program crashes, e.g.:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">nmb_layers</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">hydpy.core.exceptiontools.AttributeNotReady</span>: <span class="n">Attribute `nmb_layers` of object `ann` is not usable so far.  At least, you have to prepare attribute `nmb_inputs` first.</span>
</pre></div>
</div>
<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.NDIM">
<code class="sig-name descname"><span class="pre">NDIM</span></code><em class="property"> <span class="pre">=</span> <span class="pre">0</span></em><a class="headerlink" href="#hydpy.auxs.anntools.ANN.NDIM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.TYPE">
<code class="sig-name descname"><span class="pre">TYPE</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'annutils.ANN'</span></em><a class="headerlink" href="#hydpy.auxs.anntools.ANN.TYPE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.TIME">
<code class="sig-name descname"><span class="pre">TIME</span></code><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#hydpy.auxs.anntools.ANN.TIME" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.SPAN">
<code class="sig-name descname"><span class="pre">SPAN</span></code><em class="property"> <span class="pre">=</span> <span class="pre">(None,</span> <span class="pre">None)</span></em><a class="headerlink" href="#hydpy.auxs.anntools.ANN.SPAN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.nmb_inputs">
<code class="sig-name descname"><span class="pre">nmb_inputs</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.nmb_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of input nodes.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_inputs</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_inputs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_inputs</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.nmb_outputs">
<code class="sig-name descname"><span class="pre">nmb_outputs</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.nmb_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of output nodes.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_outputs</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_outputs</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_outputs</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">ann</span><span class="o">.</span><span class="n">nmb_outputs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_outputs</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">hydpy.core.exceptiontools.AttributeNotReady</span>: <span class="n">Attribute `nmb_outputs` of object `ann` has not been prepared so far.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.nmb_neurons">
<code class="sig-name descname"><span class="pre">nmb_neurons</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.nmb_neurons" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of neurons of the hidden layers.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_neurons</span>
<span class="go">(2, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_neurons</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_neurons</span>
<span class="go">(3,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">ann</span><span class="o">.</span><span class="n">nmb_neurons</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_neurons</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">hydpy.core.exceptiontools.AttributeNotReady</span>: <span class="n">Attribute `nmb_neurons` of object `ann` has not been prepared so far.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.nmb_weights_input">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nmb_weights_input</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.nmb_weights_input" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of input weights.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_weights_input</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.shape_weights_input">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape_weights_input</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.shape_weights_input" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the array containing the input weights.</p>
<p>The first integer value is the number of input nodes; the second
integer value is the number of neurons of the first hidden layer:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">shape_weights_input</span>
<span class="go">(3, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.weights_input">
<code class="sig-name descname"><span class="pre">weights_input</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.weights_input" title="Permalink to this definition">¶</a></dt>
<dd><p>The weights between all input nodes and neurons of the first 
hidden layer.</p>
<p>The “weight properties” of class <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> are usable as 
explained in-depth for the input weights below.</p>
<p>The input nodes and the neurons vary on the first axis and the
second axis of the 2-dimensional array, respectively (see property 
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.shape_weights_input" title="hydpy.auxs.anntools.ANN.shape_weights_input"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape_weights_input</span></code></a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_input</span>
<span class="go">array([[ 0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.]])</span>
</pre></div>
</div>
<p>The following error occurs when either the number of input nodes or 
of hidden neurons is unknown:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">ann</span><span class="o">.</span><span class="n">nmb_inputs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_input</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">hydpy.core.exceptiontools.AttributeNotReady</span>: <span class="n">Attribute `weights_input` of object `ann` is not usable so far.  At least, you have to prepare attribute `nmb_inputs` first.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_inputs</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
<p>It is allowed to set values via slicing:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_input</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_input</span>
<span class="go">array([[ 1.,  0.,  0.],</span>
<span class="go">       [ 1.,  0.,  0.]])</span>
</pre></div>
</div>
<p>If possible, property <a class="reference internal" href="#hydpy.auxs.anntools.ANN.weights_input" title="hydpy.auxs.anntools.ANN.weights_input"><code class="xref py py-const docutils literal notranslate"><span class="pre">weights_input</span></code></a> performs type 
conversions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_input</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_input</span>
<span class="go">array([[ 2.,  2.,  2.],</span>
<span class="go">       [ 2.,  2.,  2.]])</span>
</pre></div>
</div>
<p>One can assign whole matrices directly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_input</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_input</span>
<span class="go">array([[ 1.,  0.,  0.],</span>
<span class="go">       [ 0.,  1.,  0.]])</span>
</pre></div>
</div>
<p>One can also delete the values contained in the array:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">ann</span><span class="o">.</span><span class="n">weights_input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_input</span>
<span class="go">array([[ 0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.]])</span>
</pre></div>
</div>
<p>Errors like wrong shapes (or unconvertible inputs) result in error
messages:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">weights_input</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">While trying to set the input weights of the artificial neural network `ann` of element `?`, the following error occurred: could not broadcast input array from shape (3,3) into shape (2,3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.shape_weights_output">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape_weights_output</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.shape_weights_output" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the array containing the output weights.</p>
<p>The first integer value is the number of neurons of the first hidden
layer; the second integer value is the number of output nodes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">shape_weights_output</span>
<span class="go">(1, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.nmb_weights_output">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nmb_weights_output</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.nmb_weights_output" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of output weights.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_weights_output</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.weights_output">
<code class="sig-name descname"><span class="pre">weights_output</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.weights_output" title="Permalink to this definition">¶</a></dt>
<dd><p>The weights between all neurons of the last hidden layer and 
the output nodes.</p>
<p>See the documentation on properties <a class="reference internal" href="#hydpy.auxs.anntools.ANN.shape_weights_output" title="hydpy.auxs.anntools.ANN.shape_weights_output"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape_weights_output</span></code></a>
and <a class="reference internal" href="#hydpy.auxs.anntools.ANN.weights_input" title="hydpy.auxs.anntools.ANN.weights_input"><code class="xref py py-const docutils literal notranslate"><span class="pre">weights_input</span></code></a> for further information.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.shape_weights_hidden">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape_weights_hidden</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.shape_weights_hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the array containing the activation of the hidden
neurons.</p>
<p>The first integer value is the number of connection between the
hidden layers. The second integer value is the maximum number of
neurons of all hidden layers feeding information into another
hidden layer (all except the last one). The third integer
value is the maximum number of the neurons of all hidden layers
receiving information from another hidden layer (all except the
first one):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">shape_weights_hidden</span>
<span class="go">(2, 4, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">shape_weights_hidden</span>
<span class="go">(0, 0, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.nmb_weights_hidden">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nmb_weights_hidden</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.nmb_weights_hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of hidden weights.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_weights_hidden</span>
<span class="go">18</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.weights_hidden">
<code class="sig-name descname"><span class="pre">weights_hidden</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.weights_hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>The weights between the neurons of the different hidden layers.</p>
<p>See the documentation on properties <a class="reference internal" href="#hydpy.auxs.anntools.ANN.shape_weights_hidden" title="hydpy.auxs.anntools.ANN.shape_weights_hidden"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape_weights_hidden</span></code></a>
and <a class="reference internal" href="#hydpy.auxs.anntools.ANN.weights_input" title="hydpy.auxs.anntools.ANN.weights_input"><code class="xref py py-const docutils literal notranslate"><span class="pre">weights_input</span></code></a> for further information.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.shape_intercepts_hidden">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape_intercepts_hidden</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.shape_intercepts_hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the array containing the intercepts of neurons of
the hidden layers.</p>
<p>The first integer value is to the number of hidden layers;
the second integer value is the maximum number of neurons of
all hidden layers:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">shape_intercepts_hidden</span>
<span class="go">(3, 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.nmb_intercepts_hidden">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nmb_intercepts_hidden</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.nmb_intercepts_hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of input intercepts.</p>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.intercepts_hidden">
<code class="sig-name descname"><span class="pre">intercepts_hidden</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.intercepts_hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>The intercepts of all neurons of the hidden layers.</p>
<p>See the documentation on properties 
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.shape_intercepts_hidden" title="hydpy.auxs.anntools.ANN.shape_intercepts_hidden"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape_intercepts_hidden</span></code></a> and 
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.weights_input" title="hydpy.auxs.anntools.ANN.weights_input"><code class="xref py py-const docutils literal notranslate"><span class="pre">weights_input</span></code></a> for further information.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.shape_intercepts_output">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape_intercepts_output</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.shape_intercepts_output" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the array containing the intercepts of neurons of
the hidden layers.</p>
<p>The only integer value is the number of output nodes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">shape_intercepts_output</span>
<span class="go">(3,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.nmb_intercepts_output">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nmb_intercepts_output</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.nmb_intercepts_output" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of output intercepts.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_intercepts_output</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.intercepts_output">
<code class="sig-name descname"><span class="pre">intercepts_output</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.intercepts_output" title="Permalink to this definition">¶</a></dt>
<dd><p>The intercepts of all output nodes.</p>
<p>See the documentation on properties 
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.shape_intercepts_output" title="hydpy.auxs.anntools.ANN.shape_intercepts_output"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape_intercepts_output</span></code></a> and 
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.weights_input" title="hydpy.auxs.anntools.ANN.weights_input"><code class="xref py py-const docutils literal notranslate"><span class="pre">weights_input</span></code></a> for further information.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.shape_activation">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape_activation</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.shape_activation" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the array defining the activation function for each
neuron of the hidden layers.</p>
<p>The first integer value is to the number of hidden layers;
the second integer value is the maximum number of neurons of
all hidden layers:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">shape_activation</span>
<span class="go">(3, 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.activation">
<code class="sig-name descname"><span class="pre">activation</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.activation" title="Permalink to this definition">¶</a></dt>
<dd><p>Indices for selecting suitable activation functions for the
neurons of the hidden layers.</p>
<p>By default, <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> uses the logistic function for calculating 
the activation of the neurons of the hidden layers and uses the 
identity function for the output nodes.  However, property 
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.activation" title="hydpy.auxs.anntools.ANN.activation"><code class="xref py py-const docutils literal notranslate"><span class="pre">activation</span></code></a> allows defining other activation functions 
for the hidden neurons individually.  So far, one can select the
identity function and a “filter version” of the logistic function
as alternatives – others might follow.</p>
<p>Assume a neuron receives input <span class="math notranslate nohighlight">\(i_1\)</span> and <span class="math notranslate nohighlight">\(i_2\)</span> from 
two nodes of the input layer or its upstream hidden layer.  We 
weight these input values as usual:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(x_1 = c + w_1 \cdot i_1 + w_2 \cdot i_2\)</span></p>
</div></blockquote>
<p>When selecting the identity function through setting the index value 
“0”, the activation of the considered neuron is:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(a_1 = x_1\)</span></p>
</div></blockquote>
<p>Using the identity function is helpful for educational examples
and for bypassing input through one layer without introducing
nonlinearity.</p>
<p>When selecting the logistic function through setting the index value 
“1”, the activation of the considered neuron is:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(a_1 = 1-\frac{1}{1+exp(x_1)}\)</span></p>
</div></blockquote>
<p>The logistic function is a standard function for constructing neural 
networks.  It allows to approximate any relationship within a specific 
range and accuracy, provided the neural network is large enough.</p>
<p>When selecting the “filter version” of the logistic function through 
setting the index value “2”, the activation of the considered neuron 
is:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(a_1 = 1-\frac{1}{1+exp(x_1)} \cdot i_1\)</span></p>
</div></blockquote>
<p>“Filter version” means that our neuron now filters the input of the 
single input node placed at the corresponding position of its layer.  
This activation function helps force the output of a neural network 
to be zero but never negative beyond a certain threshold.</p>
<p>Similar to the main documentation on class <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a>, we define 
a relatively complex network to show that both the “normal” and
the derivative calculations work.  This time, we set the activation
function explicitly.  “1” stands for the logistic function, which
we first use for all hidden neurons:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.auxs.anntools</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">weights_input</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="o">-</span><span class="mf">1.7</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">weights_hidden</span><span class="o">=</span><span class="p">[[[</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">]]],</span>
<span class="gp">... </span>    <span class="n">weights_output</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">intercepts_hidden</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="p">[</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">intercepts_output</span><span class="o">=</span><span class="p">[</span><span class="mf">1.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">activation</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>    
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>  <span class="mf">1.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span>
<span class="go">2.074427, -2.734692</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">idx_input</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_derivatives</span><span class="p">(</span><span class="n">idx_input</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">ann</span><span class="o">.</span><span class="n">output_derivatives</span><span class="p">)</span>
<span class="go">-0.006199, 0.006571</span>
<span class="go">0.039804, -0.044169</span>
</pre></div>
</div>
<p>In the next example, we want to apply the identity function for the
second neuron of the first hidden layer and the first neuron of the
second hidden layer.  Therefore, we pass its index value “0” to the 
corresponding <a class="reference internal" href="#hydpy.auxs.anntools.ANN.activation" title="hydpy.auxs.anntools.ANN.activation"><code class="xref py py-const docutils literal notranslate"><span class="pre">activation</span></code></a> entries:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span>
<span class="go">ann(</span>
<span class="go">    nmb_inputs=2,</span>
<span class="go">    nmb_neurons=(2, 2),</span>
<span class="go">    nmb_outputs=2,</span>
<span class="go">    weights_input=[[0.2, -0.1],</span>
<span class="go">                   [-1.7, 0.6]],</span>
<span class="go">    weights_hidden=[[[-0.5, 1.0],</span>
<span class="go">                     [0.4, 2.4]]],</span>
<span class="go">    weights_output=[[0.8, -0.9],</span>
<span class="go">                    [0.5, -0.4]],</span>
<span class="go">    intercepts_hidden=[[0.9, 0.0],</span>
<span class="go">                       [-0.4, -0.2]],</span>
<span class="go">    intercepts_output=[1.3, -2.0],</span>
<span class="go">    activation=[[1, 0],</span>
<span class="go">                [0, 1]],</span>
<span class="go">)</span>
</pre></div>
</div>
<p>The agreement between the analytical and the numerical derivatives 
gives us confidence everything works fine:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span>
<span class="go">1.584373, -2.178468</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">idx_input</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_derivatives</span><span class="p">(</span><span class="n">idx_input</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">ann</span><span class="o">.</span><span class="n">output_derivatives</span><span class="p">)</span>
<span class="go">-0.056898, 0.060219</span>
<span class="go">0.369807, -0.394801</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d_input</span> <span class="o">=</span> <span class="mf">1e-8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">idx_input</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">input_</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span><span class="o">-</span><span class="n">d_input</span><span class="o">/</span><span class="mf">2.0</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">values0</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span><span class="o">+</span><span class="n">d_input</span><span class="o">/</span><span class="mf">2.0</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">values1</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">((</span><span class="n">values1</span><span class="o">-</span><span class="n">values0</span><span class="p">)</span><span class="o">/</span><span class="n">d_input</span><span class="p">)</span>
<span class="go">-0.056898, 0.060219</span>
<span class="go">0.369807, -0.394801</span>
</pre></div>
</div>
<p>Finally, we perform the same check for the “filter version” of the
logistic function:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span>
<span class="go">1.825606, -2.445682</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">idx_input</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_derivatives</span><span class="p">(</span><span class="n">idx_input</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">(</span><span class="n">ann</span><span class="o">.</span><span class="n">output_derivatives</span><span class="p">)</span>
<span class="go">0.009532, -0.011236</span>
<span class="go">-0.001715, 0.02872</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d_input</span> <span class="o">=</span> <span class="mf">1e-8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">idx_input</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">input_</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span><span class="o">-</span><span class="n">d_input</span><span class="o">/</span><span class="mf">2.0</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">values0</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span><span class="o">+</span><span class="n">d_input</span><span class="o">/</span><span class="mf">2.0</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">values1</span> <span class="o">=</span> <span class="n">ann</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="n">idx_input</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">((</span><span class="n">values1</span><span class="o">-</span><span class="n">values0</span><span class="p">)</span><span class="o">/</span><span class="n">d_input</span><span class="p">)</span>
<span class="go">0.009532, -0.011236</span>
<span class="go">-0.001715, 0.02872</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.shape_inputs">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape_inputs</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.shape_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the array containing the input values.</p>
<p>The only integer value is the number of input nodes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">shape_inputs</span>
<span class="go">(5,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.inputs">
<code class="sig-name descname"><span class="pre">inputs</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>The values of the input nodes.</p>
<p>See the documentation on properties <a class="reference internal" href="#hydpy.auxs.anntools.ANN.shape_inputs" title="hydpy.auxs.anntools.ANN.shape_inputs"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape_inputs</span></code></a>
and <a class="reference internal" href="#hydpy.auxs.anntools.ANN.weights_input" title="hydpy.auxs.anntools.ANN.weights_input"><code class="xref py py-const docutils literal notranslate"><span class="pre">weights_input</span></code></a> for further information.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.shape_outputs">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape_outputs</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.shape_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the array containing the output values.</p>
<p>The only integer value is the number of output nodes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">shape_outputs</span>
<span class="go">(6,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.outputs">
<code class="sig-name descname"><span class="pre">outputs</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>The values of the output nodes.</p>
<p>See the documentation on properties <a class="reference internal" href="#hydpy.auxs.anntools.ANN.shape_outputs" title="hydpy.auxs.anntools.ANN.shape_outputs"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape_outputs</span></code></a>
and <a class="reference internal" href="#hydpy.auxs.anntools.ANN.weights_input" title="hydpy.auxs.anntools.ANN.weights_input"><code class="xref py py-const docutils literal notranslate"><span class="pre">weights_input</span></code></a> for further information.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.shape_output_derivatives">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape_output_derivatives</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.shape_output_derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the array containing the output derivatives.</p>
<p>The only integer value is the number of output nodes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">shape_output_derivatives</span>
<span class="go">(6,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.output_derivatives">
<code class="sig-name descname"><span class="pre">output_derivatives</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.output_derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>The derivatives of the output nodes.</p>
<p>See the documentation on properties 
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.shape_output_derivatives" title="hydpy.auxs.anntools.ANN.shape_output_derivatives"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape_output_derivatives</span></code></a> and 
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.weights_input" title="hydpy.auxs.anntools.ANN.weights_input"><code class="xref py py-const docutils literal notranslate"><span class="pre">weights_input</span></code></a> for further information.</p>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.nmb_layers">
<code class="sig-name descname"><span class="pre">nmb_layers</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.nmb_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of hidden layers.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_layers</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.shape_neurons">
<code class="sig-name descname"><span class="pre">shape_neurons</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.shape_neurons" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the array containing the activities of the neurons
of the hidden layers.</p>
<p>The first integer value is the number of hidden layers; the
second integer value is the maximum number of neurons of all
hidden layers:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">shape_neurons</span>
<span class="go">(3, 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.neurons">
<code class="sig-name descname"><span class="pre">neurons</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.neurons" title="Permalink to this definition">¶</a></dt>
<dd><p>The derivatives of the activation of the neurons of the 
hidden layers.</p>
<p>See the documentation on properties <a class="reference internal" href="#hydpy.auxs.anntools.ANN.shape_neurons" title="hydpy.auxs.anntools.ANN.shape_neurons"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape_neurons</span></code></a>
and <a class="reference internal" href="#hydpy.auxs.anntools.ANN.weights_input" title="hydpy.auxs.anntools.ANN.weights_input"><code class="xref py py-const docutils literal notranslate"><span class="pre">weights_input</span></code></a> for further information.</p>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.shape_neuron_derivatives">
<code class="sig-name descname"><span class="pre">shape_neuron_derivatives</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.shape_neuron_derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the array containing the derivatives of the activities
of the neurons of the hidden layers.</p>
<p>The first integer value is the number of hidden layers; the
second integer value is the maximum number of neurons of all
hidden layers:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">shape_neuron_derivatives</span>
<span class="go">(3, 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.neuron_derivatives">
<code class="sig-name descname"><span class="pre">neuron_derivatives</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.neuron_derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>The derivatives of the activation of the neurons of the 
hidden layers.</p>
<p>See the documentation on properties 
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.shape_neuron_derivatives" title="hydpy.auxs.anntools.ANN.shape_neuron_derivatives"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape_neuron_derivatives</span></code></a> and 
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.weights_input" title="hydpy.auxs.anntools.ANN.weights_input"><code class="xref py py-const docutils literal notranslate"><span class="pre">weights_input</span></code></a> for further information.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.calculate_values">
<code class="sig-name descname"><span class="pre">calculate_values</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/auxs/anntools.html#ANN.calculate_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.auxs.anntools.ANN.calculate_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the network output values based on the input values
defined previously.</p>
<p>For more information, see the documentation on class <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.calculate_derivatives">
<code class="sig-name descname"><span class="pre">calculate_derivatives</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx_input</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/auxs/anntools.html#ANN.calculate_derivatives"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.auxs.anntools.ANN.calculate_derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the derivatives of the network output values with
respect to the input value of the given index.</p>
<p>For more information, see the documentation on class <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.nmb_weights">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nmb_weights</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.nmb_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of all input, inner, and output weights.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_weights</span>
<span class="go">20</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.nmb_intercepts">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nmb_intercepts</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.nmb_intercepts" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of all inner and output intercepts.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_intercepts</span>
<span class="go">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.nmb_parameters">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nmb_parameters</span></code><a class="headerlink" href="#hydpy.auxs.anntools.ANN.nmb_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>The sum of <a class="reference internal" href="#hydpy.auxs.anntools.ANN.nmb_weights" title="hydpy.auxs.anntools.ANN.nmb_weights"><code class="xref py py-const docutils literal notranslate"><span class="pre">nmb_weights</span></code></a> and
<a class="reference internal" href="#hydpy.auxs.anntools.ANN.nmb_intercepts" title="hydpy.auxs.anntools.ANN.nmb_intercepts"><code class="xref py py-const docutils literal notranslate"><span class="pre">nmb_intercepts</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span> <span class="o">=</span> <span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann</span><span class="o">.</span><span class="n">nmb_parameters</span>
<span class="go">29</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.verify">
<code class="sig-name descname"><span class="pre">verify</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/auxs/anntools.html#ANN.verify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.auxs.anntools.ANN.verify" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> if the network’s shape is not defined
completely.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The shape of the the artificial neural network parameter `ann` of element `?` has not been defined so far.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.assignrepr">
<code class="sig-name descname"><span class="pre">assignrepr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><a class="reference internal" href="_modules/hydpy/auxs/anntools.html#ANN.assignrepr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.auxs.anntools.ANN.assignrepr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string representation of the actual <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> object
prefixed with the given string.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.ANN.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_input</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_output</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/auxs/anntools.html#ANN.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.auxs.anntools.ANN.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the relationship between a particular input (<cite>idx_input</cite>)
and a particular output (<cite>idx_output</cite>) variable described by the
actual <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> object.</p>
<p>Define the lower and the upper bound of the x-axis via arguments
<cite>xmin</cite> and <cite>xmax</cite>.  Modify the number of plotted points via
argument <cite>points</cite>.  Pass additional <cite>matplotlib</cite> plotting arguments
as keyword arguments.</p>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'ann'</span></em><a class="headerlink" href="#hydpy.auxs.anntools.ANN.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.XLABEL">
<code class="sig-name descname"><span class="pre">XLABEL</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></em><a class="headerlink" href="#hydpy.auxs.anntools.ANN.XLABEL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.ANN.YLABEL">
<code class="sig-name descname"><span class="pre">YLABEL</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></em><a class="headerlink" href="#hydpy.auxs.anntools.ANN.YLABEL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="hydpy.auxs.anntools.ann">
<code class="sig-prename descclassname"><span class="pre">hydpy.auxs.anntools.</span></code><code class="sig-name descname"><span class="pre">ann</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><span class="pre">hydpy.auxs.anntools.ANN</span></a><a class="reference internal" href="_modules/hydpy/auxs/anntools.html#ann"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.auxs.anntools.ann" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new stand-alone <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> object with the given parameter
values.</p>
<p>The purpose of this function is to allow for string representations of
parameters containing multiple <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> instances.</p>
<p>When passing no arguments, the default values of class <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a>
apply:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ann</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann1</span> <span class="o">=</span> <span class="n">ann</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann1</span>
<span class="go">ann(</span>
<span class="go">    weights_input=[[0.0]],</span>
<span class="go">    weights_output=[[0.0]],</span>
<span class="go">    intercepts_hidden=[[0.0]],</span>
<span class="go">    intercepts_output=[0.0],</span>
<span class="go">)</span>
</pre></div>
</div>
<p>Of course, you can change any parameter value:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann2</span> <span class="o">=</span> <span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">weights_input</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">intercepts_hidden</span><span class="o">=-</span><span class="mf">16.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ann2</span>
<span class="go">ann(</span>
<span class="go">    weights_input=[[4.0]],</span>
<span class="go">    weights_output=[[3.0]],</span>
<span class="go">    intercepts_hidden=[[-16.0]],</span>
<span class="go">    intercepts_output=[-1.0],</span>
<span class="go">)</span>
</pre></div>
</div>
<p>The following line clarifies that we initialised two independent
<a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> objects (instead of changing the values of an existing
<a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> object vai its <cite>call</cite> method):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ann1</span> <span class="ow">is</span> <span class="n">ann2</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="hydpy.auxs.anntools.SeasonalANN">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydpy.auxs.anntools.</span></code><code class="sig-name descname"><span class="pre">SeasonalANN</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subvars</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="parametertools.html#hydpy.core.parametertools.SubParameters" title="hydpy.core.parametertools.SubParameters"><span class="pre">hydpy.core.parametertools.SubParameters</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydpy/auxs/anntools.html#SeasonalANN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hydpy.auxs.anntools.BaseANN" title="hydpy.auxs.anntools.BaseANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydpy.auxs.anntools.BaseANN</span></code></a></p>
<p>Handles relationships described by artificial neural networks that
vary within an annual cycle.</p>
<p>Class <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a> is an alternative implementation of class
<a class="reference internal" href="parametertools.html#hydpy.core.parametertools.SeasonalParameter" title="hydpy.core.parametertools.SeasonalParameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalParameter</span></code></a> specifically designed for handling multiple
<a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> objects that are valid for different times of the year,
described by <a class="reference internal" href="timetools.html#hydpy.core.timetools.TOY" title="hydpy.core.timetools.TOY"><code class="xref py py-class docutils literal notranslate"><span class="pre">TOY</span></code></a> objects.  The total output of a <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a>
object is a weighted mean of the output of one or two “normal” neural
networks.  Property <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN.ratios" title="hydpy.auxs.anntools.SeasonalANN.ratios"><code class="xref py py-const docutils literal notranslate"><span class="pre">ratios</span></code></a> provides the weights
for the different times of the year.</p>
<p>To explain this in more detail, we modify an example of the documentation
on class.  let us define a <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a> object that contains
three “normal” networks for January, 1, March, 1, and July, 1,
respectively:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">ann</span><span class="p">,</span> <span class="n">pub</span><span class="p">,</span> <span class="n">SeasonalANN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">reprdigits</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span> <span class="o">=</span> <span class="s2">&quot;2000-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2000-10-01&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span> <span class="o">=</span> <span class="n">SeasonalANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">_1_1_12</span><span class="o">=</span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">weights_input</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">intercepts_hidden</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">_7_1_12</span><span class="o">=</span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">weights_input</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">intercepts_hidden</span><span class="o">=-</span><span class="mf">16.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">_3_1_12</span><span class="o">=</span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">weights_input</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">intercepts_hidden</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">))</span>
</pre></div>
</div>
<p>The confusing time order in the initialization call above does not pose a
problem, as class <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a> performs time sorting internally:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span>
<span class="go">seasonalann(</span>
<span class="go">    toy_1_1_12_0_0=ann(</span>
<span class="go">        weights_input=[[0.0]],</span>
<span class="go">        weights_output=[[0.0]],</span>
<span class="go">        intercepts_hidden=[[0.0]],</span>
<span class="go">        intercepts_output=[1.0],</span>
<span class="go">    ),</span>
<span class="go">    toy_3_1_12_0_0=ann(</span>
<span class="go">        weights_input=[[0.0]],</span>
<span class="go">        weights_output=[[0.0]],</span>
<span class="go">        intercepts_hidden=[[0.0]],</span>
<span class="go">        intercepts_output=[-1.0],</span>
<span class="go">    ),</span>
<span class="go">    toy_7_1_12_0_0=ann(</span>
<span class="go">        weights_input=[[4.0]],</span>
<span class="go">        weights_output=[[3.0]],</span>
<span class="go">        intercepts_hidden=[[-16.0]],</span>
<span class="go">        intercepts_output=[-1.0],</span>
<span class="go">    ),</span>
<span class="go">)</span>
</pre></div>
</div>
<p>One can easily plot the resulting graphs of all networks:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use the <cite>pyplot</cite> API of <cite>matplotlib</cite> to modify the figure
or to save it to disk (or print it to the screen, in case the
interactive mode of <cite>matplotlib</cite> is disabled):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy.core.testtools</span> <span class="kn">import</span> <span class="n">save_autofig</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_autofig</span><span class="p">(</span><span class="s2">&quot;SeasonalANN_plot.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/SeasonalANN_plot.png" src="_images/SeasonalANN_plot.png" />
<p>The property <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN.shape" title="hydpy.auxs.anntools.SeasonalANN.shape"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape</span></code></a> does reflect the number of
required weighting ratios for each time of year (in this example
366 days per year) and each neural network (in this example three):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(366, 3)</span>
</pre></div>
</div>
<p>For safety reasons, <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN.shape" title="hydpy.auxs.anntools.SeasonalANN.shape"><code class="xref py py-const docutils literal notranslate"><span class="pre">shape</span></code></a> should normally not
be changed manually:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">366</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">can&#39;t set attribute</span>
</pre></div>
</div>
<p>The following interactive plot shows the <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN.ratios" title="hydpy.auxs.anntools.SeasonalANN.ratios"><code class="xref py py-const docutils literal notranslate"><span class="pre">ratios</span></code></a>
used for weighting(note the missing values for October, November, and
December, being not relevant for the initialisation period):</p>
<iframe
    src="anntools.SeasonalANN.ratios.html"
    width="100%"
    height="300px"
    frameborder=0
></iframe><p>For example, on July, 1 (which is the 183rd day of a leap year),
only the output of the third network is relevant:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">print_values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">seasonalann</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="mi">182</span><span class="p">])</span>
<span class="go">0.0, 0.0, 1.0</span>
</pre></div>
</div>
<p>On Juni, 30, and July, 2, also the second and the first neural network
are relevant, respectively:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">seasonalann</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="mi">181</span><span class="p">])</span>
<span class="go">0.0, 0.008197, 0.991803</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">seasonalann</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="mi">183</span><span class="p">])</span>
<span class="go">0.005435, 0.0, 0.994565</span>
</pre></div>
</div>
<p>Inserting data, processing this data, and fetching the output works
as explained for class <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a>, except that you must additionally
pass the index of the actual time of year.  Passing the index value
<cite>182</cite> activates the third network only, being configured as the one
exemplifying class <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">input_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">seasonalann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span>
<span class="gp">... </span>    <span class="n">seasonalann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">(</span><span class="mi">182</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">([</span><span class="n">input_</span><span class="p">,</span> <span class="n">seasonalann</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="go">0, -1.0</span>
<span class="go">1, -0.999982</span>
<span class="go">2, -0.998994</span>
<span class="go">3, -0.946041</span>
<span class="go">4, 0.5</span>
<span class="go">5, 1.946041</span>
<span class="go">6, 1.998994</span>
<span class="go">7, 1.999982</span>
<span class="go">8, 2.0</span>
</pre></div>
</div>
<p>To see that the final output values are actually the weighted mean
of the output values of the single neural networks, we repeat the
above example for January, 13, where the first and the second neural
network have ratios of 0.8 and 0.2 respectively:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print_values</span><span class="p">(</span><span class="n">seasonalann</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>
<span class="go">0.8, 0.2, 0.0</span>
</pre></div>
</div>
<p>For both networks, all parameters except the output intercepts are
zero.  Hence, the calculated output is independent of the given input.
The output of the first network (1.0) dominates the output of the
second network (-1.0):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">input_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">seasonalann</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_</span>
<span class="gp">... </span>    <span class="n">seasonalann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">round_</span><span class="p">([</span><span class="n">input_</span><span class="p">,</span> <span class="n">seasonalann</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="go">0, 0.6</span>
<span class="go">1, 0.6</span>
<span class="go">2, 0.6</span>
<span class="go">3, 0.6</span>
<span class="go">4, 0.6</span>
<span class="go">5, 0.6</span>
<span class="go">6, 0.6</span>
<span class="go">7, 0.6</span>
<span class="go">8, 0.6</span>
</pre></div>
</div>
<p>It is of great importance that all contained neural networks are
consistent.  Hence class <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a> performs some
related checks:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span> <span class="o">=</span> <span class="n">SeasonalANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">calculate_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The seasonal neural network collection `seasonalann` of element `?` has not been properly prepared so far.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Type `int` is not (a subclass of) type `ANN`.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">_13_1_12</span><span class="o">=</span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">weights_input</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">intercepts_hidden</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=</span><span class="mf">1.0</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">While trying to add a season specific neural network to parameter `seasonalann` of element `?`, the following error occurred: While trying to initialise a TOY object based on argument value `_13_1_12` of type `str`, the following error occurred: While trying to retrieve the month, the following error occurred: The value of property `month` of TOY (time of year) objects must lie within the range `(1, 12)`, but the given value is `13`.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">weights_input</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">intercepts_hidden</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=</span><span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span>
<span class="go">seasonalann(</span>
<span class="go">    ann(</span>
<span class="go">        nmb_inputs=2,</span>
<span class="go">        weights_input=[[0.0],</span>
<span class="go">                       [0.0]],</span>
<span class="go">        weights_output=[[0.0]],</span>
<span class="go">        intercepts_hidden=[[0.0]],</span>
<span class="go">        intercepts_output=[1.0],</span>
<span class="go">    )</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">weights_input</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">intercepts_hidden</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">_7_1_12</span><span class="o">=</span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">weights_input</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">intercepts_hidden</span><span class="o">=-</span><span class="mf">16.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">_3_1_12</span><span class="o">=</span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">weights_input</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">intercepts_hidden</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Type `SeasonalANN` accepts either a single positional argument or an arbitrary number of keyword arguments, but for the corresponding parameter of element `?` 1 positional and 2 keyword arguments have been given.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">_1_1_12</span><span class="o">=</span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">weights_input</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">intercepts_hidden</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">_7_1_12</span><span class="o">=</span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">weights_input</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">intercepts_hidden</span><span class="o">=-</span><span class="mf">16.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">_3_1_12</span><span class="o">=</span><span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">weights_input</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">intercepts_hidden</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The number of input and output values of all neural networks contained by a seasonal neural network collection must be identical and be known by the containing object.  But the seasonal neural network collection `seasonalann` of element `?` assumes `2` input and `1` output values, while the network corresponding to the time of year `toy_3_1_12_0_0` requires `1` input and `1` output values.</span>
</pre></div>
</div>
<p>For safety, each failure results in a total loss of the previously
defined networks:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span>
<span class="go">seasonalann()</span>
</pre></div>
</div>
<p>Alternatively, neural networks can be added individually via
attribute access:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">jan</span> <span class="o">=</span> <span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">weights_input</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">intercepts_hidden</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">toy_1_1_12</span> <span class="o">=</span> <span class="n">jan</span>
</pre></div>
</div>
<p>If you set an attribute, everything updates automatically, e.g.:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">seasonalann</span><span class="o">.</span><span class="n">ratios</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1.0</span>
</pre></div>
</div>
<p>The mentioned safety checks do also apply when adding networks
via attribute access, e.g.:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">toy_7_1_12</span> <span class="o">=</span> <span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span>
<span class="gp">... </span>                             <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">weights_input</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">weights_output</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">intercepts_hidden</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">intercepts_output</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">While trying to assign a new neural network to the seasonal neural network collection `seasonalann` of element `?` based on name `toy_7_1_12`, the following error occurred: The number of input and output values of all neural networks contained by a seasonal neural network collection must be identical and be known by the containing object.  But the seasonal neural network collection `seasonalann` of element `?` assumes `1` input and `1` output values, while the network corresponding to the time of year `toy_7_1_12_0_0` requires `2` input and `1` output values.</span>
</pre></div>
</div>
<p>Besides setting new networks, getting and deleting them also works:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">toy_1_1_12</span> <span class="o">=</span> <span class="n">jan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">toy_1_1_12</span>
<span class="go">ann(</span>
<span class="go">    weights_input=[[0.0]],</span>
<span class="go">    weights_output=[[0.0]],</span>
<span class="go">    intercepts_hidden=[[0.0]],</span>
<span class="go">    intercepts_output=[1.0],</span>
<span class="go">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">seasonalann</span><span class="o">.</span><span class="n">toy_1_1_12</span>
</pre></div>
</div>
<p>These are the error messages related to attribute access problems:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">toy_1_1_12</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">While trying to look up for a neural network handled by the seasonal neural network collection `seasonalann` of element `?` based on name `toy_1_1_12`, the following error occurred: No neural network is registered under a TOY object named `toy_1_1_12_0_0`.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">seasonalann</span><span class="o">.</span><span class="n">toy_1_1_12</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">While trying to remove a new neural network from the seasonal neural network collection `seasonalann` of element `?` based on name `toy_1_1_12`, the following error occurred: No neural network is registered under a TOY object named `toy_1_1_12_0_0`.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">toy_1_1_12</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">While trying to assign a new neural network to the seasonal neural network collection `seasonalann` of element `?` based on name `toy_1_1_12`, the following error occurred: Value `1` of type `int` has been given, but a value of type `ANN` is required.</span>
</pre></div>
</div>
<p>Setting and deleting “normal” attributes is supported:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> <span class="mi">999</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">temp</span>
<span class="go">999</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">seasonalann</span><span class="o">.</span><span class="n">temp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">temp</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;SeasonalANN&#39; object has no attribute &#39;temp&#39;</span>
</pre></div>
</div>
<dl class="py attribute">
<dt id="hydpy.auxs.anntools.SeasonalANN.NDIM">
<code class="sig-name descname"><span class="pre">NDIM</span></code><em class="property"> <span class="pre">=</span> <span class="pre">0</span></em><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.NDIM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.SeasonalANN.TYPE">
<code class="sig-name descname"><span class="pre">TYPE</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'annutils.SeasonalANN'</span></em><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.TYPE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.SeasonalANN.TIME">
<code class="sig-name descname"><span class="pre">TIME</span></code><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.TIME" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.SeasonalANN.SPAN">
<code class="sig-name descname"><span class="pre">SPAN</span></code><em class="property"> <span class="pre">=</span> <span class="pre">(None,</span> <span class="pre">None)</span></em><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.SPAN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.SeasonalANN.refresh">
<code class="sig-name descname"><span class="pre">refresh</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/auxs/anntools.html#SeasonalANN.refresh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.refresh" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the actual <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a> object for calculations.</p>
<p>Class <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a> stores its <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> objects by
reference.  Therefore, despite all automated refreshings (explained
in the general documentation on class <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a>), it
is still possible to destroy the inner consistency of a
<a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a> instance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">SeasonalANN</span><span class="p">,</span> <span class="n">ann</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span> <span class="o">=</span> <span class="n">SeasonalANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">simulationstep</span> <span class="o">=</span> <span class="s2">&quot;1d&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jan</span> <span class="o">=</span> <span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">weights_input</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">intercepts_hidden</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="p">(</span><span class="n">_1_1_12</span><span class="o">=</span><span class="n">jan</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jan</span><span class="o">.</span><span class="n">nmb_inputs</span><span class="p">,</span> <span class="n">jan</span><span class="o">.</span><span class="n">nmb_outputs</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jan</span><span class="o">.</span><span class="n">nmb_inputs</span><span class="p">,</span> <span class="n">jan</span><span class="o">.</span><span class="n">nmb_outputs</span>
<span class="go">(2, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">nmb_inputs</span><span class="p">,</span> <span class="n">seasonalann</span><span class="o">.</span><span class="n">nmb_outputs</span>
<span class="go">(1, 1)</span>
</pre></div>
</div>
<p>Due to the C level implementation of the mathematical core of
both <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> and <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a> in module <code class="xref py py-mod docutils literal notranslate"><span class="pre">annutils</span></code>,
such an inconsistency might result in a program crash without any
informative error message.  Whenever you are think some inconsistency
might have crept in and you want to repair it, call method
<a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN.refresh" title="hydpy.auxs.anntools.SeasonalANN.refresh"><code class="xref py py-func docutils literal notranslate"><span class="pre">refresh()</span></code></a> explicitly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jan</span><span class="o">.</span><span class="n">nmb_inputs</span><span class="p">,</span> <span class="n">jan</span><span class="o">.</span><span class="n">nmb_outputs</span>
<span class="go">(2, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">nmb_inputs</span><span class="p">,</span> <span class="n">seasonalann</span><span class="o">.</span><span class="n">nmb_outputs</span>
<span class="go">(2, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.SeasonalANN.verify">
<code class="sig-name descname"><span class="pre">verify</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/auxs/anntools.html#SeasonalANN.verify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.verify" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> and remove all handled neural networks,
if they are defined inconsistently.</p>
<p>Class <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a> stores its <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> objects by
reference.  Therefore, despite all automated refreshings (explained
in the general documentation on class <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a>), it
is still possible to destroy the inner consistency of a
<a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a> instance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hydpy</span> <span class="kn">import</span> <span class="n">SeasonalANN</span><span class="p">,</span> <span class="n">ann</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span> <span class="o">=</span> <span class="n">SeasonalANN</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">simulationstep</span> <span class="o">=</span> <span class="s2">&quot;1d&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jan</span> <span class="o">=</span> <span class="n">ann</span><span class="p">(</span><span class="n">nmb_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nmb_neurons</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">nmb_outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">weights_input</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">weights_output</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">intercepts_hidden</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">intercepts_output</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="p">(</span><span class="n">_1_1_12</span><span class="o">=</span><span class="n">jan</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jan</span><span class="o">.</span><span class="n">nmb_inputs</span><span class="p">,</span> <span class="n">jan</span><span class="o">.</span><span class="n">nmb_outputs</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jan</span><span class="o">.</span><span class="n">nmb_inputs</span><span class="p">,</span> <span class="n">jan</span><span class="o">.</span><span class="n">nmb_outputs</span>
<span class="go">(2, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">nmb_inputs</span><span class="p">,</span> <span class="n">seasonalann</span><span class="o">.</span><span class="n">nmb_outputs</span>
<span class="go">(1, 1)</span>
</pre></div>
</div>
<p>Due to the C level implementation of the mathematical core of both
<a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> and <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a> in module <code class="xref py py-mod docutils literal notranslate"><span class="pre">annutils</span></code>,
such an inconsistency might result in a program crash without any
informative error message. Whenever you think some inconsistency
might have crept in and you want to find out if your suspicion is
right, call method <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN.verify" title="hydpy.auxs.anntools.SeasonalANN.verify"><code class="xref py py-func docutils literal notranslate"><span class="pre">verify()</span></code></a> explicitly.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The number of input and output values of all neural networks contained by a seasonal neural network collection must be identical and be known by the containing object.  But the seasonal neural network collection `seasonalann` of element `?` assumes `1` input and `1` output values, while the network corresponding to the time of year `toy_1_1_12_0_0` requires `2` input and `3` output values.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span>
<span class="go">seasonalann()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seasonalann</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">Seasonal artificial neural network collections need to handle at least one &quot;normal&quot; single neural network, but for the seasonal neural network `seasonalann` of element `?` none has been defined so far.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.SeasonalANN.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of array <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN.ratios" title="hydpy.auxs.anntools.SeasonalANN.ratios"><code class="xref py py-const docutils literal notranslate"><span class="pre">ratios</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.SeasonalANN.toys">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">toys</span></code><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.toys" title="Permalink to this definition">¶</a></dt>
<dd><p>A sorted <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> of all contained <a class="reference internal" href="timetools.html#hydpy.core.timetools.TOY" title="hydpy.core.timetools.TOY"><code class="xref py py-class docutils literal notranslate"><span class="pre">TOY</span></code></a> objects.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.SeasonalANN.anns">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">anns</span></code><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.anns" title="Permalink to this definition">¶</a></dt>
<dd><p>A sorted <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> of all contained <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> objects.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.SeasonalANN.ratios">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ratios</span></code><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.ratios" title="Permalink to this definition">¶</a></dt>
<dd><p>The ratios for weighting the single neural network outputs.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.SeasonalANN.nmb_inputs">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nmb_inputs</span></code><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.nmb_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of input values of all neural networks.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.SeasonalANN.inputs">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">inputs</span></code><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>The general input data for all neural networks.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.SeasonalANN.nmb_outputs">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">nmb_outputs</span></code><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.nmb_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of output values of all neural networks.</p>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.SeasonalANN.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'seasonalann'</span></em><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.SeasonalANN.outputs">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">outputs</span></code><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>The weighted output of the individual neural networks.</p>
</dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.SeasonalANN.XLABEL">
<code class="sig-name descname"><span class="pre">XLABEL</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></em><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.XLABEL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydpy.auxs.anntools.SeasonalANN.YLABEL">
<code class="sig-name descname"><span class="pre">YLABEL</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></em><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.YLABEL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.SeasonalANN.calculate_values">
<code class="sig-name descname"><span class="pre">calculate_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx_toy</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/auxs/anntools.html#SeasonalANN.calculate_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.calculate_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the network output values based on the input values
defined previously for the given index referencing the actual
time of year.</p>
</dd></dl>

<dl class="py method">
<dt id="hydpy.auxs.anntools.SeasonalANN.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/hydpy/auxs/anntools.html#SeasonalANN.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.auxs.anntools.SeasonalANN.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Call method <a class="reference internal" href="#hydpy.auxs.anntools.ANN.plot" title="hydpy.auxs.anntools.ANN.plot"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot()</span></code></a> of all <a class="reference internal" href="#hydpy.auxs.anntools.ANN" title="hydpy.auxs.anntools.ANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANN</span></code></a> objects
handled by the actual <a class="reference internal" href="#hydpy.auxs.anntools.SeasonalANN" title="hydpy.auxs.anntools.SeasonalANN"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalANN</span></code></a> object.</p>
</dd></dl>

</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/HydPy_Logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to.html">How to…</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="framework.html">Framework Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="core.html">Core Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="execution.html">Execution Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="cythons.html">Cython Tools</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="auxiliaries.html">Auxiliary Tools</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">anntools</a></li>
<li class="toctree-l3"><a class="reference internal" href="armatools.html">armatools</a></li>
<li class="toctree-l3"><a class="reference internal" href="calibtools.html">calibtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="iuhtools.html">iuhtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="networktools.html">networktools</a></li>
<li class="toctree-l3"><a class="reference internal" href="quadtools.html">quadtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="roottools.html">roottools</a></li>
<li class="toctree-l3"><a class="reference internal" href="smoothtools.html">smoothtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="statstools.html">statstools</a></li>
<li class="toctree-l3"><a class="reference internal" href="validtools.html">validtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="xmltools.html">xmltools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modelcollection.html">Model Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="zbibliography.html">Bibliography</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="auxiliaries.html"
                        title="previous chapter">Auxiliary Tools</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="armatools.html"
                        title="next chapter">armatools</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/anntools.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="armatools.html" title="armatools"
             >next</a> |</li>
        <li class="right" >
          <a href="auxiliaries.html" title="Auxiliary Tools"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HydPy 4.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="framework.html" >Framework Tools</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="auxiliaries.html" >Auxiliary Tools</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">anntools</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, HydPy Developers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.2.
    </div>
  </body>
</html>
<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>sw1d_network &#8212; HydPy 6.2dev6 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css?v=127cebf3" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    
    <script src="_static/documentation_options.js?v=fd5328d9"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>window.MathJax = {"chtml": {"displayAlign": "left"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="sw1d_storage" href="sw1d_storage.html" />
    <link rel="prev" title="sw1d_channel" href="sw1d_channel.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sw1d_storage.html" title="sw1d_storage"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sw1d_channel.html" title="sw1d_channel"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HydPy 6.2dev6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="reference_manual.html" >Reference Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="model_families.html" >Model Families</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="HydPy-SW1D.html" accesskey="U">HydPy-SW1D (Shallow Water 1D)</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">sw1d_network</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/HydPy_Logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_projects.html">Example Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_guide.html">Developer Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="reference_manual.html">Reference Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="framework_tools.html">Framework Tools</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="model_families.html">Model Families</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="HydPy-ARMA.html">HydPy-ARMA</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-Conv.html">HydPy-Conv</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-Exch.html">HydPy-Exch</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-Evap.html">HydPy-Evap</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-Dam.html">HydPy-Dam</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-Dummy.html">HydPy-Dummy</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-G.html">HydPy-G (GR)</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-GA.html">HydPy-GA (Green-Ampt)</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-H.html">HydPy-H (HBV)</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-KinW.html">HydPy-KinW</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-L.html">HydPy-L (LARSIM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-Meteo.html">HydPy-Meteo</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-Musk.html">HydPy-Musk (Muskingum)</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-Rconc.html">HydPy-Rconc</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="HydPy-SW1D.html">HydPy-SW1D (Shallow Water 1D)</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="sw1d.html">sw1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="sw1d_channel.html">sw1d_channel</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">sw1d_network</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#integration-tests">Integration tests</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#zero-inflow-and-outflow">Zero inflow and outflow</a></li>
<li class="toctree-l6"><a class="reference internal" href="#weir-outflow">Weir outflow</a></li>
<li class="toctree-l6"><a class="reference internal" href="#confluences">Confluences</a></li>
<li class="toctree-l6"><a class="reference internal" href="#bifurcations">Bifurcations</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.models.sw1d_network.Model"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a><ul>
<li class="toctree-l6"><a class="reference internal" href="#hydpy.models.sw1d_network.Model.DOCNAME"><code class="docutils literal notranslate"><span class="pre">Model.DOCNAME</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#hydpy.models.sw1d_network.Model.COMPOSITE"><code class="docutils literal notranslate"><span class="pre">Model.COMPOSITE</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#hydpy.models.sw1d_network.Model.OBSERVER_METHODS"><code class="docutils literal notranslate"><span class="pre">Model.OBSERVER_METHODS</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#hydpy.models.sw1d_network.Model.channelmodels"><code class="docutils literal notranslate"><span class="pre">Model.channelmodels</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#hydpy.models.sw1d_network.Model.storagemodels"><code class="docutils literal notranslate"><span class="pre">Model.storagemodels</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#hydpy.models.sw1d_network.Model.routingmodels"><code class="docutils literal notranslate"><span class="pre">Model.routingmodels</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#hydpy.models.sw1d_network.Model.check_waterbalance"><code class="docutils literal notranslate"><span class="pre">Model.check_waterbalance()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#hydpy.models.sw1d_network.Model.REUSABLE_METHODS"><code class="docutils literal notranslate"><span class="pre">Model.REUSABLE_METHODS</span></code></a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.models.sw1d_network.DerivedParameters"><code class="docutils literal notranslate"><span class="pre">DerivedParameters</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#hydpy.models.sw1d_network.FactorSequences"><code class="docutils literal notranslate"><span class="pre">FactorSequences</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="sw1d_storage.html">sw1d_storage</a></li>
<li class="toctree-l4"><a class="reference internal" href="sw1d_q_in.html">sw1d_q_in</a></li>
<li class="toctree-l4"><a class="reference internal" href="sw1d_lias.html">sw1d_lias</a></li>
<li class="toctree-l4"><a class="reference internal" href="sw1d_lias_sluice.html">sw1d_lias_sluice</a></li>
<li class="toctree-l4"><a class="reference internal" href="sw1d_pump.html">sw1d_pump</a></li>
<li class="toctree-l4"><a class="reference internal" href="sw1d_q_out.html">sw1d_q_out</a></li>
<li class="toctree-l4"><a class="reference internal" href="sw1d_weir_out.html">sw1d_weir_out</a></li>
<li class="toctree-l4"><a class="reference internal" href="sw1d_gate_out.html">sw1d_gate_out</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-Test.html">HydPy-Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-W.html">HydPy-W (WALRUS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-WHMod.html">HydPy-WHMod</a></li>
<li class="toctree-l3"><a class="reference internal" href="HydPy-WQ.html">HydPy-WQ</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="submodel_interfaces.html">Submodel Interfaces</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="zbibliography.html">Bibliography</a></li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="sw1d_channel.html"
                          title="previous chapter">sw1d_channel</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="sw1d_storage.html"
                          title="next chapter">sw1d_storage</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/sw1d_network.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   
<h3>Versions</h3>
<ul>
<li><a href="../6/sw1d_network.html">6</a></li>
<li><a href="../master/sw1d_network.html">master</a></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="sw1d-network">
<span id="id1"></span><h1>HydPy-SW1D-Network ("composite model" for solving the 1-dimensional shallow water equations in channel networks)<a class="headerlink" href="#sw1d-network" title="Link to this heading">¶</a></h1>
<p id="module-hydpy.models.sw1d_network">The HydPy-SW1D model family member <a class="reference internal" href="#module-hydpy.models.sw1d_network" title="hydpy.models.sw1d_network"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_network</span></code></a> allows combining different
storage and routing submodels for representing the 1-dimensional flow processes within
a complete channel network.</p>
<p>Technically, <a class="reference internal" href="#module-hydpy.models.sw1d_network" title="hydpy.models.sw1d_network"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_network</span></code></a> is quite similar to <a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a>, but both serve
different purposes and complement each other.  <a class="reference internal" href="#module-hydpy.models.sw1d_network" title="hydpy.models.sw1d_network"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_network</span></code></a> is a “composite model”,
of which <em>HydPy</em> automatically creates instances, each of them combining the
submodels of multiple <a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a> instances.  So, framework users do usually not
need to configure <a class="reference internal" href="#module-hydpy.models.sw1d_network" title="hydpy.models.sw1d_network"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_network</span></code></a> directly but do so indirectly by preparing seemingly
independent <a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a> models for the individual reaches of a channel network.
Nevertheless, reading the following notes (after reading the <a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a>
documentation) might give some relevant insights as <a class="reference internal" href="#module-hydpy.models.sw1d_network" title="hydpy.models.sw1d_network"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_network</span></code></a> actually does the
simulation job and makes some demands regarding the “completeness” of the underlying
<a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a> models.</p>
<section id="integration-tests">
<h2>Integration tests<a class="headerlink" href="#integration-tests" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When new to <em>HydPy</em>, consider reading section <a class="reference internal" href="how_to_read_the_reference_manual.html#integration-tests"><span class="std std-ref">Integration Tests</span></a> first.</p>
</div>
<p>The following examples build on the ones of the <a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a> documentation.  So, we
select the same simulation period:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hydpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">pub</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span> <span class="o">=</span> <span class="s2">&quot;2000-01-01 00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;2000-01-01 05:00&quot;</span><span class="p">,</span> <span class="s2">&quot;5m&quot;</span>
</pre></div>
</div>
<p>We split the 20 km channel from the <a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a> documentation into two identical
parts.</p>
<p>We take the 20 km channel from the <a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a> documentation but split it into two
identical parts.  So, one <a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a> model, handled by the <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Element" title="hydpy.core.devicetools.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a> <cite>channel1a</cite>,
covers the first four segments and another one, handled by the <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Element" title="hydpy.core.devicetools.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a> <cite>channel2</cite>,
covers the last four segments.  But first, we need to define three nodes that are
connectable to the inlet sequence <a class="reference internal" href="sw1d.html#hydpy.models.sw1d.sw1d_inlets.LongQ" title="hydpy.models.sw1d.sw1d_inlets.LongQ"><code class="xref py py-class docutils literal notranslate"><span class="pre">LongQ</span></code></a> and outlet sequence
<a class="reference internal" href="sw1d.html#hydpy.models.sw1d.sw1d_outlets.LongQ" title="hydpy.models.sw1d.sw1d_outlets.LongQ"><code class="xref py py-class docutils literal notranslate"><span class="pre">LongQ</span></code></a>, which is simplest by defining their variable via a string:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hydpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">Node</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q_1a_in</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;q_1a_in&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;LongQ&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q_1to2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;q_1to2&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;LongQ&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q_2_out</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;q_2_out&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;LongQ&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The remarkable thing about defining the two elements is that we must associate them
with the same <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Element.collective" title="hydpy.core.devicetools.Element.collective"><code class="xref py py-attr docutils literal notranslate"><span class="pre">collective</span></code></a> so that <em>HydPy</em> knows it must combine their “user
models” into one “composite model”:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hydpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">Element</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel1a</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;channel1a&quot;</span><span class="p">,</span> <span class="n">collective</span><span class="o">=</span><span class="s2">&quot;network&quot;</span><span class="p">,</span> <span class="n">inlets</span><span class="o">=</span><span class="n">q_1a_in</span><span class="p">,</span> <span class="n">outlets</span><span class="o">=</span><span class="n">q_1to2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel2</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;channel2&quot;</span><span class="p">,</span> <span class="n">collective</span><span class="o">=</span><span class="s2">&quot;network&quot;</span><span class="p">,</span> <span class="n">inlets</span><span class="o">=</span><span class="n">q_1to2</span><span class="p">,</span> <span class="n">outlets</span><span class="o">=</span><span class="n">q_2_out</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we set up all submodels as in the <a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a> documentation but assign each to
one of two main models, which in turn are handled by the two already available
elements:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hydpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">prepare_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">sw1d_channel</span><span class="p">,</span> <span class="n">sw1d_storage</span><span class="p">,</span> <span class="n">sw1d_lias</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lengths</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="n">channel1a</span><span class="p">,</span> <span class="n">channel2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">channel</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="n">sw1d_channel</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">channel</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">nmbsegments</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">length_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lengths</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">with</span> <span class="n">channel</span><span class="o">.</span><span class="n">add_storagemodel_v1</span><span class="p">(</span><span class="n">sw1d_storage</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">i</span><span class="p">):</span>
<span class="gp">... </span>            <span class="n">length</span><span class="p">(</span><span class="n">length_</span><span class="p">)</span>
<span class="gp">... </span>            <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">add_crosssection_v2</span><span class="p">(</span><span class="s2">&quot;wq_trapeze&quot;</span><span class="p">):</span>
<span class="gp">... </span>                <span class="n">nmbtrapezes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>                <span class="n">bottomlevels</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">... </span>                <span class="n">bottomwidths</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">... </span>                <span class="n">sideslopes</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span> <span class="k">if</span> <span class="n">element</span> <span class="ow">is</span> <span class="n">channel1a</span> <span class="k">else</span> <span class="mi">4</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">with</span> <span class="n">channel</span><span class="o">.</span><span class="n">add_routingmodel_v2</span><span class="p">(</span><span class="n">sw1d_lias</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">i</span><span class="p">):</span>
<span class="gp">... </span>            <span class="n">lengthupstream</span><span class="p">(</span><span class="mf">2.0</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">else</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">lengthdownstream</span><span class="p">(</span><span class="mf">3.0</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">else</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">stricklercoefficient</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">0.03</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">timestepfactor</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">diffusionfactor</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="gp">... </span>            <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">add_crosssection_v2</span><span class="p">(</span><span class="s2">&quot;wq_trapeze&quot;</span><span class="p">):</span>
<span class="gp">... </span>                <span class="n">nmbtrapezes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>                <span class="n">bottomlevels</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">... </span>                <span class="n">bottomwidths</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">... </span>                <span class="n">sideslopes</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">element</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">channel</span>
</pre></div>
</div>
<p>The following test function object finds all nodes and elements automatically upon
initialisation:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.core.testtools</span><span class="w"> </span><span class="kn">import</span> <span class="n">IntegrationTest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">IntegrationTest</span><span class="p">()</span>
</pre></div>
</div>
<p>We again define a convenience function for preparing the initial conditions.  This one
accepts individual water depths for different elements but generally sets the “old”
discharge to zero:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">prepare_inits</span><span class="p">(</span><span class="o">**</span><span class="n">name2depth</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">inits</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">name2depth</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>        <span class="n">e</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">storagemodels</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">length</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">length</span>
<span class="gp">... </span>            <span class="n">c</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">crosssection</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span>
<span class="gp">... </span>            <span class="n">v</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">bottomwidths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">sideslopes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">length</span>
<span class="gp">... </span>            <span class="n">inits</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">watervolume</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">routingmodels</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>                <span class="n">inits</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">r</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">discharge</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">test</span><span class="o">.</span><span class="n">inits</span> <span class="o">=</span> <span class="n">inits</span>
</pre></div>
</div>
<section id="zero-inflow-and-outflow">
<span id="sw1d-network-zero-inflow-and-outflow"></span><h3>Zero inflow and outflow<a class="headerlink" href="#zero-inflow-and-outflow" title="Link to this heading">¶</a></h3>
<p>The following water depths agree with the configuration of the
<a class="reference internal" href="sw1d_channel.html#sw1d-channel-zero-inflow-and-outflow"><span class="std std-ref">Zero inflow and outflow</span></a> example of <a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prepare_inits</span><span class="p">(</span><span class="n">channel1a</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">channel2</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Albeit irrelevant for the first simulation, we set the inflow represented by the (still
unused) node <cite>q_1a_in</cite> to zero to avoid <cite>nan</cite> values in the following result table:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q_1a_in</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>The discharge simulated for node <cite>q_1to2</cite> is identical to the one simulated for the
middle position in the <a class="reference internal" href="sw1d_channel.html#sw1d-channel-zero-inflow-and-outflow"><span class="std std-ref">Zero inflow and outflow</span></a> example of
<a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a>, which shows that the <a class="reference internal" href="#module-hydpy.models.sw1d_network" title="hydpy.models.sw1d_network"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_network</span></code></a> instance here works as a correct
composite of the two user models:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conditions</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">get_conditions</span><span class="o">=</span><span class="s2">&quot;2000-01-01 00:00&quot;</span><span class="p">)</span>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script><a href="javascript:showhide(document.getElementById('__hydpy_integrationtest_300__'))">Click to see the table</a><br /><div id="__hydpy_integrationtest_300__" style="display: none"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="go">|                date |  timestep | q_1a_in |    q_1to2 | q_2_out |</span>
<span class="go">-------------------------------------------------------------------</span>
<span class="go">| 2000-01-01 00:00:00 | 41.932744 |     0.0 | 17.116697 |     0.0 |</span>
<span class="go">| 2000-01-01 00:05:00 | 41.932744 |     0.0 |  6.434402 |     0.0 |</span>
<span class="go">| 2000-01-01 00:10:00 |  41.86989 |     0.0 |  7.317577 |     0.0 |</span>
<span class="go">| 2000-01-01 00:15:00 | 40.570615 |     0.0 |  6.771817 |     0.0 |</span>
<span class="go">| 2000-01-01 00:20:00 | 38.464288 |     0.0 |  6.441228 |     0.0 |</span>
<span class="go">| 2000-01-01 00:25:00 | 36.060713 |     0.0 |  6.111343 |     0.0 |</span>
<span class="go">| 2000-01-01 00:30:00 | 33.726739 |     0.0 |  5.814913 |     0.0 |</span>
<span class="go">| 2000-01-01 00:35:00 | 31.578426 |     0.0 |  5.548742 |     0.0 |</span>
<span class="go">| 2000-01-01 00:40:00 | 29.590331 |     0.0 |  5.307354 |     0.0 |</span>
<span class="go">| 2000-01-01 00:45:00 | 27.697934 |     0.0 |  5.084325 |     0.0 |</span>
<span class="go">| 2000-01-01 00:50:00 | 25.854608 |     0.0 |  4.875904 |     0.0 |</span>
<span class="go">| 2000-01-01 00:55:00 | 24.044617 |     0.0 |  4.680467 |     0.0 |</span>
<span class="go">| 2000-01-01 01:00:00 | 22.271186 |     0.0 |  4.497034 |     0.0 |</span>
<span class="go">| 2000-01-01 01:05:00 | 20.541621 |     0.0 |  4.324343 |     0.0 |</span>
<span class="go">| 2000-01-01 01:10:00 | 18.859766 |     0.0 |  4.160846 |     0.0 |</span>
<span class="go">| 2000-01-01 01:15:00 | 17.225223 |     0.0 |   4.00511 |     0.0 |</span>
<span class="go">| 2000-01-01 01:20:00 | 15.635338 |     0.0 |  3.856098 |     0.0 |</span>
<span class="go">| 2000-01-01 01:25:00 | 14.087165 |     0.0 |  3.713189 |     0.0 |</span>
<span class="go">| 2000-01-01 01:30:00 | 12.578396 |     0.0 |  3.576035 |     0.0 |</span>
<span class="go">| 2000-01-01 01:35:00 | 11.107466 |     0.0 |  3.444403 |     0.0 |</span>
<span class="go">| 2000-01-01 01:40:00 |   9.67329 |     0.0 |  3.318058 |     0.0 |</span>
<span class="go">| 2000-01-01 01:45:00 |  8.274999 |     0.0 |  3.196719 |     0.0 |</span>
<span class="go">| 2000-01-01 01:50:00 |   6.91179 |     0.0 |  3.080056 |     0.0 |</span>
<span class="go">| 2000-01-01 01:55:00 |  5.582889 |     0.0 |  2.967695 |     0.0 |</span>
<span class="go">| 2000-01-01 02:00:00 |  4.287568 |     0.0 |  2.859236 |     0.0 |</span>
<span class="go">| 2000-01-01 02:05:00 |  3.025166 |     0.0 |  2.754256 |     0.0 |</span>
<span class="go">| 2000-01-01 02:10:00 |  1.795106 |     0.0 |  2.652318 |     0.0 |</span>
<span class="go">| 2000-01-01 02:15:00 |  0.596896 |     0.0 |  2.552973 |     0.0 |</span>
<span class="go">| 2000-01-01 02:20:00 |     300.0 |     0.0 |  2.455693 |     0.0 |</span>
<span class="go">| 2000-01-01 02:25:00 |     300.0 |     0.0 |  2.370851 |     0.0 |</span>
<span class="go">| 2000-01-01 02:30:00 |     300.0 |     0.0 |  2.278535 |     0.0 |</span>
<span class="go">| 2000-01-01 02:35:00 |     300.0 |     0.0 |  2.186283 |     0.0 |</span>
<span class="go">| 2000-01-01 02:40:00 |     300.0 |     0.0 |  2.094209 |     0.0 |</span>
<span class="go">| 2000-01-01 02:45:00 |     300.0 |     0.0 |  2.001626 |     0.0 |</span>
<span class="go">| 2000-01-01 02:50:00 |     300.0 |     0.0 |  1.908479 |     0.0 |</span>
<span class="go">| 2000-01-01 02:55:00 |     300.0 |     0.0 |  1.814849 |     0.0 |</span>
<span class="go">| 2000-01-01 03:00:00 |     300.0 |     0.0 |  1.720515 |     0.0 |</span>
<span class="go">| 2000-01-01 03:05:00 |     300.0 |     0.0 |  1.625017 |     0.0 |</span>
<span class="go">| 2000-01-01 03:10:00 |     300.0 |     0.0 |  1.527933 |     0.0 |</span>
<span class="go">| 2000-01-01 03:15:00 |     300.0 |     0.0 |  1.429057 |     0.0 |</span>
<span class="go">| 2000-01-01 03:20:00 |     300.0 |     0.0 |  1.328408 |     0.0 |</span>
<span class="go">| 2000-01-01 03:25:00 |     300.0 |     0.0 |   1.22614 |     0.0 |</span>
<span class="go">| 2000-01-01 03:30:00 |     300.0 |     0.0 |  1.122462 |     0.0 |</span>
<span class="go">| 2000-01-01 03:35:00 |     300.0 |     0.0 |  1.017589 |     0.0 |</span>
<span class="go">| 2000-01-01 03:40:00 |     300.0 |     0.0 |  0.911751 |     0.0 |</span>
<span class="go">| 2000-01-01 03:45:00 |     300.0 |     0.0 |  0.805203 |     0.0 |</span>
<span class="go">| 2000-01-01 03:50:00 |     300.0 |     0.0 |  0.698243 |     0.0 |</span>
<span class="go">| 2000-01-01 03:55:00 |     300.0 |     0.0 |  0.591202 |     0.0 |</span>
<span class="go">| 2000-01-01 04:00:00 |     300.0 |     0.0 |  0.484427 |     0.0 |</span>
<span class="go">| 2000-01-01 04:05:00 |     300.0 |     0.0 |  0.378258 |     0.0 |</span>
<span class="go">| 2000-01-01 04:10:00 |     300.0 |     0.0 |  0.273014 |     0.0 |</span>
<span class="go">| 2000-01-01 04:15:00 |     300.0 |     0.0 |   0.16898 |     0.0 |</span>
<span class="go">| 2000-01-01 04:20:00 |     300.0 |     0.0 |  0.066424 |     0.0 |</span>
<span class="go">| 2000-01-01 04:25:00 |     300.0 |     0.0 | -0.034386 |     0.0 |</span>
<span class="go">| 2000-01-01 04:30:00 |     300.0 |     0.0 | -0.131043 |     0.0 |</span>
<span class="go">| 2000-01-01 04:35:00 |     300.0 |     0.0 | -0.214119 |     0.0 |</span>
<span class="go">| 2000-01-01 04:40:00 |     300.0 |     0.0 | -0.278681 |     0.0 |</span>
<span class="go">| 2000-01-01 04:45:00 |     300.0 |     0.0 | -0.323311 |     0.0 |</span>
<span class="go">| 2000-01-01 04:50:00 |     300.0 |     0.0 | -0.349079 |     0.0 |</span>
<span class="go">| 2000-01-01 04:55:00 |     300.0 |     0.0 | -0.358235 |     0.0 |</span>
</pre></div></div></div><a href="2000-01-01 00:00.html" target="_blank" >Click to see the graph</a></pre></div></div><p>There is no indication of an error in the water balance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hydpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">round_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">hydpy</span><span class="o">.</span><span class="n">collectives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">check_waterbalance</span><span class="p">(</span><span class="n">conditions</span><span class="p">))</span>
<span class="go">0.0</span>
</pre></div>
</div>
</section>
<section id="weir-outflow">
<span id="sw1d-network-weir-outflow"></span><h3>Weir outflow<a class="headerlink" href="#weir-outflow" title="Link to this heading">¶</a></h3>
<p>Next, we repeat the <a class="reference internal" href="sw1d_channel.html#sw1d-channel-weir-outflow"><span class="std std-ref">Weir outflow</span></a> example of <a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a> as a
more complex example considering inflow and outflow.</p>
<p>We add an identical <a class="reference internal" href="sw1d_q_in.html#module-hydpy.models.sw1d_q_in" title="hydpy.models.sw1d_q_in"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_q_in</span></code></a> submodel at the inflow position of the upper element’s
model:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">sw1d_q_in</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">channel1a</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_routingmodel_v1</span><span class="p">(</span><span class="n">sw1d_q_in</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">lengthdownstream</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">timestepfactor</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">add_crosssection_v2</span><span class="p">(</span><span class="s2">&quot;wq_trapeze&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">nmbtrapezes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">bottomlevels</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">bottomwidths</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">sideslopes</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel1a</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>
</div>
<p>And we add an identical <a class="reference internal" href="sw1d_weir_out.html#module-hydpy.models.sw1d_weir_out" title="hydpy.models.sw1d_weir_out"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_weir_out</span></code></a> submodel at the outflow position of the lower
element’s model:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">sw1d_weir_out</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">channel2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_routingmodel_v3</span><span class="p">(</span><span class="n">sw1d_weir_out</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">lengthupstream</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">crestheight</span><span class="p">(</span><span class="mf">7.0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">crestwidth</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">flowcoefficient</span><span class="p">(</span><span class="mf">0.58</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">timestepfactor</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>
</div>
<p>Further, we set the time step factor, the constant inflow, and the initial conditions to
the same values as in the <a class="reference internal" href="sw1d_channel.html#sw1d-channel-weir-outflow"><span class="std std-ref">Weir outflow</span></a> example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">IntegrationTest</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="n">channel1a</span><span class="p">,</span> <span class="n">channel2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">routingmodel</span> <span class="ow">in</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">routingmodels</span><span class="o">.</span><span class="n">submodels</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">routingmodel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">routingmodel</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">timestepfactor</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q_1a_in</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prepare_inits</span><span class="p">(</span><span class="n">channel1a</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">channel2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
<p>The following discharges are identical to those available in the results table of the
<a class="reference internal" href="sw1d_channel.html#sw1d-channel-weir-outflow"><span class="std std-ref">Weir outflow</span></a> example of <a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conditions</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">get_conditions</span><span class="o">=</span><span class="s2">&quot;2000-01-01 00:00&quot;</span><span class="p">)</span>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script><a href="javascript:showhide(document.getElementById('__hydpy_integrationtest_301__'))">Click to see the table</a><br /><div id="__hydpy_integrationtest_301__" style="display: none"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="go">|                date |  timestep | q_1a_in |   q_1to2 |  q_2_out |</span>
<span class="go">-------------------------------------------------------------------</span>
<span class="go">| 2000-01-01 00:00:00 | 29.522473 |     1.0 | 0.000084 |      0.0 |</span>
<span class="go">| 2000-01-01 00:05:00 | 30.437257 |     1.0 | 0.010297 |      0.0 |</span>
<span class="go">| 2000-01-01 00:10:00 | 31.047327 |     1.0 | 0.057861 |      0.0 |</span>
<span class="go">| 2000-01-01 00:15:00 | 31.487924 |     1.0 |  0.13627 | 0.000003 |</span>
<span class="go">| 2000-01-01 00:20:00 | 31.831217 |     1.0 | 0.223131 | 0.000031 |</span>
<span class="go">| 2000-01-01 00:25:00 | 32.115718 |     1.0 | 0.303889 | 0.000173 |</span>
<span class="go">| 2000-01-01 00:30:00 | 32.362765 |     1.0 | 0.372712 | 0.000611 |</span>
<span class="go">| 2000-01-01 00:35:00 | 32.584688 |     1.0 | 0.428534 | 0.001597 |</span>
<span class="go">| 2000-01-01 00:40:00 | 32.788919 |     1.0 | 0.472255 | 0.003371 |</span>
<span class="go">| 2000-01-01 00:45:00 | 32.980171 |     1.0 | 0.505411 | 0.006095 |</span>
<span class="go">| 2000-01-01 00:50:00 | 33.161638 |     1.0 |  0.52966 | 0.009817 |</span>
<span class="go">| 2000-01-01 00:55:00 | 33.335665 |     1.0 | 0.546602 | 0.014488 |</span>
<span class="go">| 2000-01-01 01:00:00 |   33.5041 |     1.0 | 0.557716 | 0.019988 |</span>
<span class="go">| 2000-01-01 01:05:00 | 33.668478 |     1.0 | 0.564322 |  0.02617 |</span>
<span class="go">| 2000-01-01 01:10:00 | 33.830091 |     1.0 | 0.567571 | 0.032882 |</span>
<span class="go">| 2000-01-01 01:15:00 | 33.990019 |     1.0 | 0.568434 | 0.039987 |</span>
<span class="go">| 2000-01-01 01:20:00 | 34.149135 |     1.0 | 0.567713 | 0.047372 |</span>
<span class="go">| 2000-01-01 01:25:00 | 34.308116 |     1.0 | 0.566046 | 0.054949 |</span>
<span class="go">| 2000-01-01 01:30:00 | 34.467448 |     1.0 | 0.563931 | 0.062652 |</span>
<span class="go">| 2000-01-01 01:35:00 | 34.627446 |     1.0 |  0.56174 | 0.070436 |</span>
<span class="go">| 2000-01-01 01:40:00 | 34.788273 |     1.0 | 0.559739 | 0.078272 |</span>
<span class="go">| 2000-01-01 01:45:00 | 34.949971 |     1.0 |  0.55811 | 0.086141 |</span>
<span class="go">| 2000-01-01 01:50:00 | 35.112477 |     1.0 | 0.556964 | 0.094032 |</span>
<span class="go">| 2000-01-01 01:55:00 | 35.275657 |     1.0 | 0.556359 | 0.101942 |</span>
<span class="go">| 2000-01-01 02:00:00 | 35.439325 |     1.0 | 0.556315 | 0.109869 |</span>
<span class="go">| 2000-01-01 02:05:00 | 35.603263 |     1.0 | 0.556821 | 0.117813 |</span>
<span class="go">| 2000-01-01 02:10:00 | 35.767241 |     1.0 | 0.557846 | 0.125776 |</span>
<span class="go">| 2000-01-01 02:15:00 | 35.931023 |     1.0 | 0.559348 | 0.133758 |</span>
<span class="go">| 2000-01-01 02:20:00 | 36.094387 |     1.0 | 0.561277 | 0.141761 |</span>
<span class="go">| 2000-01-01 02:25:00 | 36.257123 |     1.0 | 0.563583 | 0.149785 |</span>
<span class="go">| 2000-01-01 02:30:00 | 36.419042 |     1.0 | 0.566213 |  0.15783 |</span>
<span class="go">| 2000-01-01 02:35:00 | 36.579976 |     1.0 | 0.569119 | 0.165895 |</span>
<span class="go">| 2000-01-01 02:40:00 | 36.739783 |     1.0 | 0.572257 |  0.17398 |</span>
<span class="go">| 2000-01-01 02:45:00 |  36.89834 |     1.0 | 0.575586 | 0.182081 |</span>
<span class="go">| 2000-01-01 02:50:00 | 37.055547 |     1.0 |  0.57907 | 0.190197 |</span>
<span class="go">| 2000-01-01 02:55:00 |  37.21132 |     1.0 | 0.582678 | 0.198324 |</span>
<span class="go">| 2000-01-01 03:00:00 | 37.365596 |     1.0 | 0.586386 |  0.20646 |</span>
<span class="go">| 2000-01-01 03:05:00 | 37.518323 |     1.0 | 0.590169 |   0.2146 |</span>
<span class="go">| 2000-01-01 03:10:00 | 37.669464 |     1.0 | 0.594011 | 0.222742 |</span>
<span class="go">| 2000-01-01 03:15:00 |  37.81899 |     1.0 | 0.597895 | 0.230882 |</span>
<span class="go">| 2000-01-01 03:20:00 | 37.966882 |     1.0 |  0.60181 | 0.239015 |</span>
<span class="go">| 2000-01-01 03:25:00 | 38.113129 |     1.0 | 0.605746 | 0.247138 |</span>
<span class="go">| 2000-01-01 03:30:00 | 38.257724 |     1.0 | 0.609694 | 0.255248 |</span>
<span class="go">| 2000-01-01 03:35:00 | 38.400665 |     1.0 | 0.613648 | 0.263341 |</span>
<span class="go">| 2000-01-01 03:40:00 | 38.541953 |     1.0 | 0.617604 | 0.271413 |</span>
<span class="go">| 2000-01-01 03:45:00 | 38.681592 |     1.0 | 0.621557 | 0.279461 |</span>
<span class="go">| 2000-01-01 03:50:00 |  38.81959 |     1.0 | 0.625503 | 0.287482 |</span>
<span class="go">| 2000-01-01 03:55:00 | 38.955953 |     1.0 | 0.629441 | 0.295473 |</span>
<span class="go">| 2000-01-01 04:00:00 | 39.090692 |     1.0 | 0.633368 |  0.30343 |</span>
<span class="go">| 2000-01-01 04:05:00 | 39.223815 |     1.0 | 0.637282 | 0.311352 |</span>
<span class="go">| 2000-01-01 04:10:00 | 39.355334 |     1.0 | 0.641182 | 0.319235 |</span>
<span class="go">| 2000-01-01 04:15:00 |  39.48526 |     1.0 | 0.645068 | 0.327078 |</span>
<span class="go">| 2000-01-01 04:20:00 | 39.613604 |     1.0 | 0.648937 | 0.334877 |</span>
<span class="go">| 2000-01-01 04:25:00 | 39.740379 |     1.0 | 0.652788 | 0.342631 |</span>
<span class="go">| 2000-01-01 04:30:00 | 39.865596 |     1.0 | 0.656622 | 0.350339 |</span>
<span class="go">| 2000-01-01 04:35:00 | 39.989269 |     1.0 | 0.660437 | 0.357997 |</span>
<span class="go">| 2000-01-01 04:40:00 | 40.111408 |     1.0 | 0.664232 | 0.365604 |</span>
<span class="go">| 2000-01-01 04:45:00 | 40.232028 |     1.0 | 0.668006 |  0.37316 |</span>
<span class="go">| 2000-01-01 04:50:00 | 40.351141 |     1.0 |  0.67176 | 0.380661 |</span>
<span class="go">| 2000-01-01 04:55:00 |  40.46876 |     1.0 | 0.675491 | 0.388108 |</span>
</pre></div></div></div><a href="2000-01-01 00:00.html" target="_blank" >Click to see the graph</a></pre></div></div><p>There is no indication of an error in the water balance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">hydpy</span><span class="o">.</span><span class="n">collectives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">check_waterbalance</span><span class="p">(</span><span class="n">conditions</span><span class="p">))</span>
<span class="go">0.0</span>
</pre></div>
</div>
</section>
<section id="confluences">
<span id="sw1d-network-confluences"></span><h3>Confluences<a class="headerlink" href="#confluences" title="Link to this heading">¶</a></h3>
<p>Now, we illustrate how to build real networks by connecting more than two elements with
the same node.  We will handle the existing two subchannels as a main channel.  The one
upstream of the junction (<cite>channel1a</cite>) has a width of 8 mm, and the one downstream of
the junction (<cite>channel2</cite>) has a width of 10 m:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span><span class="p">,</span> <span class="n">width</span> <span class="ow">in</span> <span class="p">([</span><span class="n">channel1a</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">],</span> <span class="p">[</span><span class="n">channel2</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">storagemodel</span> <span class="ow">in</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">storagemodels</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">storagemodel</span><span class="o">.</span><span class="n">crosssection</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">bottomwidths</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">routingmodel</span> <span class="ow">in</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">routingmodels</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">routingmodel</span><span class="p">,</span> <span class="p">(</span><span class="n">sw1d_lias</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span> <span class="n">sw1d_q_in</span><span class="o">.</span><span class="n">Model</span><span class="p">)):</span>
<span class="gp">... </span>            <span class="n">routingmodel</span><span class="o">.</span><span class="n">crosssection</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">bottomwidths</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
</pre></div>
</div>
<p>The new 10 km long side channel also consists of four segments but is only 2 m wide:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">prepare_model</span><span class="p">(</span><span class="s2">&quot;sw1d_channel&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">nmbsegments</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">length_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lengths</span><span class="p">[:</span><span class="mi">4</span><span class="p">]):</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">channel</span><span class="o">.</span><span class="n">add_storagemodel_v1</span><span class="p">(</span><span class="n">sw1d_storage</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">i</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">length</span><span class="p">(</span><span class="n">length_</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">add_crosssection_v2</span><span class="p">(</span><span class="s2">&quot;wq_trapeze&quot;</span><span class="p">):</span>
<span class="gp">... </span>            <span class="n">nmbtrapezes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">bottomlevels</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">bottomwidths</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">sideslopes</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<p>It receives a separate inflow via another <a class="reference internal" href="sw1d_q_in.html#module-hydpy.models.sw1d_q_in" title="hydpy.models.sw1d_q_in"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_q_in</span></code></a> instance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">channel</span><span class="o">.</span><span class="n">add_routingmodel_v1</span><span class="p">(</span><span class="n">sw1d_q_in</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">lengthdownstream</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">timestepfactor</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">add_crosssection_v2</span><span class="p">(</span><span class="s2">&quot;wq_trapeze&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">nmbtrapezes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">bottomlevels</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">bottomwidths</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">sideslopes</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<p>We add <a class="reference internal" href="sw1d_lias.html#module-hydpy.models.sw1d_lias" title="hydpy.models.sw1d_lias"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_lias</span></code></a> models for all other possible positions, including the last one:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">channel</span><span class="o">.</span><span class="n">add_routingmodel_v2</span><span class="p">(</span><span class="n">sw1d_lias</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">i</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">lengthupstream</span><span class="p">(</span><span class="mf">2.0</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">else</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">lengthdownstream</span><span class="p">(</span><span class="mf">3.0</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">else</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">stricklercoefficient</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">0.03</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">timestepfactor</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">diffusionfactor</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">add_crosssection_v2</span><span class="p">(</span><span class="s2">&quot;wq_trapeze&quot;</span><span class="p">):</span>
<span class="gp">... </span>            <span class="n">nmbtrapezes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">bottomlevels</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">bottomwidths</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">sideslopes</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<p>So, now the <a class="reference internal" href="sw1d_channel.html#module-hydpy.models.sw1d_channel" title="hydpy.models.sw1d_channel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_channel</span></code></a> models of the elements <cite>channel1a</cite> and <cite>channel1b</cite> have
routing models at their outflow locations, and the one of element <cite>channel2</cite> does not
have a routing model at its inflow location.  This is the typical configuration for
modelling confluences, where one strives to couple each reach upstream of the junction
with the single reach downstream.  This setting has the effect that <cite>channel2</cite>
exchanges water with <cite>channel1a</cite> and <cite>channel1b</cite> directly, while <cite>channel1a</cite> and
<cite>channel1b</cite> can do so only indirectly via the first segment of <cite>channel2</cite>.</p>
<p>We assign the third channel model to another element, that we connect to a new inlet
node (for adding inflow) and to the already existing node <cite>q_1to2</cite> (for coupling with
the main channel):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q_1b_in</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;q_1b_in&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;LongQ&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel1b</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;channel1b&quot;</span><span class="p">,</span> <span class="n">collective</span><span class="o">=</span><span class="s2">&quot;network&quot;</span><span class="p">,</span> <span class="n">inlets</span><span class="o">=</span><span class="n">q_1b_in</span><span class="p">,</span> <span class="n">outlets</span><span class="o">=</span><span class="n">q_1to2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel1b</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">channel</span>
</pre></div>
</div>
<p>The initial water depth is 1 m throughout the whole network:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">IntegrationTest</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prepare_inits</span><span class="p">(</span><span class="n">channel1a</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">channel1b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">channel2</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>The main and the side channels receive constant inflows of 1 and 0.5 m³/s,
respectively:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q_1a_in</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q_1b_in</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">0.5</span>
</pre></div>
</div>
<p>Unfortunately, the usual standard table does not provide much information for in-depth
evaluations:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conditions</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">get_conditions</span><span class="o">=</span><span class="s2">&quot;2000-01-01 00:00&quot;</span><span class="p">)</span>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script><a href="javascript:showhide(document.getElementById('__hydpy_integrationtest_302__'))">Click to see the table</a><br /><div id="__hydpy_integrationtest_302__" style="display: none"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="go">|                date |  timestep | q_1a_in | q_1b_in |   q_1to2 | q_2_out |</span>
<span class="go">----------------------------------------------------------------------------</span>
<span class="go">| 2000-01-01 00:00:00 | 45.030299 |     1.0 |     0.5 |      0.0 |     0.0 |</span>
<span class="go">| 2000-01-01 00:05:00 | 46.242118 |     1.0 |     0.5 | 0.003008 |     0.0 |</span>
<span class="go">| 2000-01-01 00:10:00 | 47.155436 |     1.0 |     0.5 | 0.025525 |     0.0 |</span>
<span class="go">| 2000-01-01 00:15:00 | 47.892762 |     1.0 |     0.5 | 0.071726 |     0.0 |</span>
<span class="go">| 2000-01-01 00:20:00 | 48.522333 |     1.0 |     0.5 | 0.129271 |     0.0 |</span>
<span class="go">| 2000-01-01 00:25:00 | 49.080523 |     1.0 |     0.5 | 0.187172 |     0.0 |</span>
<span class="go">| 2000-01-01 00:30:00 | 49.587791 |     1.0 |     0.5 | 0.240134 |     0.0 |</span>
<span class="go">| 2000-01-01 00:35:00 | 50.056456 |     1.0 |     0.5 | 0.286648 |     0.0 |</span>
<span class="go">| 2000-01-01 00:40:00 | 50.494442 |     1.0 |     0.5 | 0.326895 |     0.0 |</span>
<span class="go">| 2000-01-01 00:45:00 |  50.90715 |     1.0 |     0.5 | 0.361611 |     0.0 |</span>
<span class="go">| 2000-01-01 00:50:00 | 51.298454 |     1.0 |     0.5 | 0.391611 |     0.0 |</span>
<span class="go">| 2000-01-01 00:55:00 | 51.671261 |     1.0 |     0.5 | 0.417633 |     0.0 |</span>
<span class="go">| 2000-01-01 01:00:00 | 52.027843 |     1.0 |     0.5 |  0.44031 |     0.0 |</span>
<span class="go">| 2000-01-01 01:05:00 | 52.370039 |     1.0 |     0.5 | 0.460176 |     0.0 |</span>
<span class="go">| 2000-01-01 01:10:00 | 52.699381 |     1.0 |     0.5 |  0.47769 |     0.0 |</span>
<span class="go">| 2000-01-01 01:15:00 | 53.017173 |     1.0 |     0.5 | 0.493237 |     0.0 |</span>
<span class="go">| 2000-01-01 01:20:00 | 53.324545 |     1.0 |     0.5 |  0.50715 |     0.0 |</span>
<span class="go">| 2000-01-01 01:25:00 | 53.622482 |     1.0 |     0.5 | 0.519705 |     0.0 |</span>
<span class="go">| 2000-01-01 01:30:00 | 53.911854 |     1.0 |     0.5 | 0.531136 |     0.0 |</span>
<span class="go">| 2000-01-01 01:35:00 | 54.193429 |     1.0 |     0.5 | 0.541633 |     0.0 |</span>
<span class="go">| 2000-01-01 01:40:00 | 54.467891 |     1.0 |     0.5 | 0.551355 |     0.0 |</span>
<span class="go">| 2000-01-01 01:45:00 | 54.735849 |     1.0 |     0.5 | 0.560428 |     0.0 |</span>
<span class="go">| 2000-01-01 01:50:00 | 54.997846 |     1.0 |     0.5 | 0.568953 |     0.0 |</span>
<span class="go">| 2000-01-01 01:55:00 | 55.254368 |     1.0 |     0.5 | 0.577012 |     0.0 |</span>
<span class="go">| 2000-01-01 02:00:00 | 55.505854 |     1.0 |     0.5 | 0.584668 |     0.0 |</span>
<span class="go">| 2000-01-01 02:05:00 | 55.752694 |     1.0 |     0.5 | 0.591971 |     0.0 |</span>
<span class="go">| 2000-01-01 02:10:00 | 55.995245 |     1.0 |     0.5 | 0.598961 |     0.0 |</span>
<span class="go">| 2000-01-01 02:15:00 | 56.233826 |     1.0 |     0.5 | 0.605669 |     0.0 |</span>
<span class="go">| 2000-01-01 02:20:00 | 56.468727 |     1.0 |     0.5 | 0.612118 |     0.0 |</span>
<span class="go">| 2000-01-01 02:25:00 | 56.700214 |     1.0 |     0.5 | 0.618328 |     0.0 |</span>
<span class="go">| 2000-01-01 02:30:00 | 56.928527 |     1.0 |     0.5 | 0.624314 |     0.0 |</span>
<span class="go">| 2000-01-01 02:35:00 | 57.153887 |     1.0 |     0.5 | 0.630087 |     0.0 |</span>
<span class="go">| 2000-01-01 02:40:00 | 57.376496 |     1.0 |     0.5 | 0.635659 |     0.0 |</span>
<span class="go">| 2000-01-01 02:45:00 |  57.59654 |     1.0 |     0.5 | 0.641038 |     0.0 |</span>
<span class="go">| 2000-01-01 02:50:00 | 57.814191 |     1.0 |     0.5 | 0.646232 |     0.0 |</span>
<span class="go">| 2000-01-01 02:55:00 | 58.029607 |     1.0 |     0.5 | 0.651246 |     0.0 |</span>
<span class="go">| 2000-01-01 03:00:00 | 58.242934 |     1.0 |     0.5 | 0.656087 |     0.0 |</span>
<span class="go">| 2000-01-01 03:05:00 |  58.45431 |     1.0 |     0.5 | 0.660761 |     0.0 |</span>
<span class="go">| 2000-01-01 03:10:00 | 58.663861 |     1.0 |     0.5 | 0.665273 |     0.0 |</span>
<span class="go">| 2000-01-01 03:15:00 | 58.871705 |     1.0 |     0.5 | 0.669628 |     0.0 |</span>
<span class="go">| 2000-01-01 03:20:00 | 59.077952 |     1.0 |     0.5 |  0.67383 |     0.0 |</span>
<span class="go">| 2000-01-01 03:25:00 | 59.282705 |     1.0 |     0.5 | 0.677885 |     0.0 |</span>
<span class="go">| 2000-01-01 03:30:00 |  59.48606 |     1.0 |     0.5 | 0.681797 |     0.0 |</span>
<span class="go">| 2000-01-01 03:35:00 | 59.688108 |     1.0 |     0.5 | 0.685571 |     0.0 |</span>
<span class="go">| 2000-01-01 03:40:00 | 59.888932 |     1.0 |     0.5 | 0.689211 |     0.0 |</span>
<span class="go">| 2000-01-01 03:45:00 |  0.135626 |     1.0 |     0.5 | 0.692729 |     0.0 |</span>
<span class="go">| 2000-01-01 03:50:00 |  0.384228 |     1.0 |     0.5 | 0.698366 |     0.0 |</span>
<span class="go">| 2000-01-01 03:55:00 |  0.632218 |     1.0 |     0.5 | 0.701582 |     0.0 |</span>
<span class="go">| 2000-01-01 04:00:00 |  0.879114 |     1.0 |     0.5 | 0.704443 |     0.0 |</span>
<span class="go">| 2000-01-01 04:05:00 |  1.124822 |     1.0 |     0.5 | 0.707155 |     0.0 |</span>
<span class="go">| 2000-01-01 04:10:00 |  1.369384 |     1.0 |     0.5 | 0.709781 |     0.0 |</span>
<span class="go">| 2000-01-01 04:15:00 |  1.612877 |     1.0 |     0.5 | 0.712341 |     0.0 |</span>
<span class="go">| 2000-01-01 04:20:00 |  1.855383 |     1.0 |     0.5 | 0.714841 |     0.0 |</span>
<span class="go">| 2000-01-01 04:25:00 |  2.096978 |     1.0 |     0.5 | 0.717279 |     0.0 |</span>
<span class="go">| 2000-01-01 04:30:00 |  2.337734 |     1.0 |     0.5 | 0.719653 |     0.0 |</span>
<span class="go">| 2000-01-01 04:35:00 |  2.577714 |     1.0 |     0.5 | 0.721961 |     0.0 |</span>
<span class="go">| 2000-01-01 04:40:00 |  2.816978 |     1.0 |     0.5 | 0.724201 |     0.0 |</span>
<span class="go">| 2000-01-01 04:45:00 |   3.05558 |     1.0 |     0.5 | 0.726373 |     0.0 |</span>
<span class="go">| 2000-01-01 04:50:00 |  3.293568 |     1.0 |     0.5 | 0.728475 |     0.0 |</span>
<span class="go">| 2000-01-01 04:55:00 |   3.53099 |     1.0 |     0.5 | 0.730509 |     0.0 |</span>
</pre></div></div></div><a href="2000-01-01 00:00.html" target="_blank" >Click to see the graph</a></pre></div></div><p>Therefore, we define the following function for plotting the water level profiles
gained for the simulation period’s end:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">plot_waterlevels</span><span class="p">(</span><span class="n">figname</span><span class="p">):</span>
<span class="gp">... </span>     <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="gp">... </span>     <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span>
<span class="gp">... </span>     <span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.core.testtools</span><span class="w"> </span><span class="kn">import</span> <span class="n">save_autofig</span>
<span class="gp">... </span>     <span class="n">stations</span> <span class="o">=</span> <span class="p">((</span><span class="n">cs</span> <span class="o">:=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cumsum</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,)</span> <span class="o">+</span> <span class="n">lengths</span><span class="p">))[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">cs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="gp">... </span>     <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="n">channel1a</span><span class="p">,</span> <span class="n">channel1b</span><span class="p">,</span> <span class="n">channel2</span><span class="p">):</span>
<span class="gp">... </span>         <span class="n">ss</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">element</span> <span class="ow">is</span> <span class="n">channel2</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">]</span>
<span class="gp">... </span>         <span class="n">ws</span> <span class="o">=</span> <span class="p">[</span><span class="n">sm</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">waterlevel</span> <span class="k">for</span> <span class="n">sm</span> <span class="ow">in</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">storagemodels</span><span class="p">]</span>
<span class="gp">... </span>         <span class="n">_</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">element</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">... </span>     <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">(</span><span class="n">channel1a</span><span class="p">,</span> <span class="n">channel1b</span><span class="p">):</span>
<span class="gp">... </span>         <span class="n">ss</span> <span class="o">=</span> <span class="n">stations</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">stations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>
<span class="gp">... </span>         <span class="n">ws</span> <span class="o">=</span> <span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">storagemodels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">waterlevel</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">channel2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">storagemodels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">factors</span><span class="o">.</span><span class="n">waterlevel</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="gp">... </span>         <span class="n">_</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>
<span class="gp">... </span>     <span class="n">_</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">... </span>     <span class="n">_</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;station [km]&quot;</span><span class="p">)</span>
<span class="gp">... </span>     <span class="n">_</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;water level [m]&quot;</span><span class="p">)</span>
<span class="gp">... </span>     <span class="n">save_autofig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span>
</pre></div>
</div>
<p>The simulated water levels look reasonable and are sufficiently similar to those we
calculated with a fully hydrodynamic model for comparison:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_waterlevels</span><span class="p">(</span><span class="s2">&quot;sw1d_network_confluences.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/sw1d_network_confluences.png" src="_images/sw1d_network_confluences.png" />
<p>There is no indication of an error in the water balance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">hydpy</span><span class="o">.</span><span class="n">collectives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">check_waterbalance</span><span class="p">(</span><span class="n">conditions</span><span class="p">))</span>
<span class="go">0.0</span>
</pre></div>
</div>
</section>
<section id="bifurcations">
<span id="sw1d-network-bifurcations"></span><h3>Bifurcations<a class="headerlink" href="#bifurcations" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="#module-hydpy.models.sw1d_network" title="hydpy.models.sw1d_network"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_network</span></code></a> also allows us to model the bifurcation of channels.  We could
demonstrate this by building an entirely new setting but prefer to reuse the existing
network and just let the water flow “upstream”, which is the same in the end.</p>
<p>First, we break the connections to the <a class="reference internal" href="sw1d_weir_out.html#module-hydpy.models.sw1d_weir_out" title="hydpy.models.sw1d_weir_out"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_weir_out</span></code></a> submodel at the outlet location
of <cite>channel2</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">channel2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">storagemodels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">routingmodelsdownstream</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">routingmodels</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">routingmodelsdownstream</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Second, we replace the weir model with an instance of <a class="reference internal" href="sw1d_q_out.html#module-hydpy.models.sw1d_q_out" title="hydpy.models.sw1d_q_out"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_q_out</span></code></a>, which is
functionally nearly identical to <a class="reference internal" href="sw1d_q_in.html#module-hydpy.models.sw1d_q_in" title="hydpy.models.sw1d_q_in"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_q_in</span></code></a> but to be placed at outlet locations:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hydpy.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">sw1d_q_out</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">channel2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_routingmodel_v3</span><span class="p">(</span><span class="n">sw1d_q_out</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">lengthupstream</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">timestepfactor</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">model</span><span class="o">.</span><span class="n">add_crosssection_v2</span><span class="p">(</span><span class="s2">&quot;wq_trapeze&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">nmbtrapezes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">bottomlevels</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">bottomwidths</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">sideslopes</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">channel2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>
</div>
<p>We set the initial conditions as in the <a class="reference internal" href="#sw1d-network-confluences"><span class="std std-ref">Confluences</span></a> example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">IntegrationTest</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prepare_inits</span><span class="p">(</span><span class="n">channel1a</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">channel1b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">channel2</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>We let the same amount of water flow in the opposite direction by setting the inflow of
<cite>channel1a</cite> and <cite>channel1b</cite> to zero and the outflow of <cite>channel2</cite> to -1.5 m³/s:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q_1a_in</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q_1b_in</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q_2_out</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span>
</pre></div>
</div>
<p>The outlet node <cite>q_2_out</cite> needs further attention.  Usually, outlet nodes receive data
from their entry elements, but this one is supposed to send data “upstream”, which is
possible by choosing one of the available “bidirectional” deploy modes.  We select
<cite>oldsim_bi</cite> (the documentation on <a class="reference internal" href="devicetools.html#hydpy.core.devicetools.Node.deploymode" title="hydpy.core.devicetools.Node.deploymode"><code class="xref py py-const docutils literal notranslate"><span class="pre">deploymode</span></code></a> explains this and the further
options in more detail):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q_2_out</span><span class="o">.</span><span class="n">deploymode</span> <span class="o">=</span> <span class="s2">&quot;oldsim_bi&quot;</span>
</pre></div>
</div>
<p>Considering the absolute amount, the discharge simulated at the central node <cite>q_1to2</cite>
is quite similar to the one of the <a class="reference internal" href="#sw1d-network-confluences"><span class="std std-ref">Confluences</span></a> example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conditions</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="s2">&quot;sw1d_network_branch&quot;</span><span class="p">,</span> <span class="n">get_conditions</span><span class="o">=</span><span class="s2">&quot;2000-01-01 00:00&quot;</span><span class="p">)</span>
<script type="text/javascript">
    function showhide(element){
        if (!document.getElementById)
            return
        if (element.style.display == "block")
            element.style.display = "none"
        else
            element.style.display = "block"
    };
</script><a href="javascript:showhide(document.getElementById('__hydpy_integrationtest_303__'))">Click to see the table</a><br /><div id="__hydpy_integrationtest_303__" style="display: none"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="go">|                date |  timestep | q_1a_in | q_1b_in |    q_1to2 | q_2_out |</span>
<span class="go">-----------------------------------------------------------------------------</span>
<span class="go">| 2000-01-01 00:00:00 | 44.830004 |     0.0 |     0.0 |       0.0 |    -1.5 |</span>
<span class="go">| 2000-01-01 00:05:00 | 45.741893 |     0.0 |     0.0 | -0.002955 |    -1.5 |</span>
<span class="go">| 2000-01-01 00:10:00 | 46.659139 |     0.0 |     0.0 | -0.026069 |    -1.5 |</span>
<span class="go">| 2000-01-01 00:15:00 | 47.456384 |     0.0 |     0.0 | -0.075937 |    -1.5 |</span>
<span class="go">| 2000-01-01 00:20:00 | 48.151282 |     0.0 |     0.0 | -0.140683 |    -1.5 |</span>
<span class="go">| 2000-01-01 00:25:00 | 48.772646 |     0.0 |     0.0 | -0.207348 |    -1.5 |</span>
<span class="go">| 2000-01-01 00:30:00 | 49.341144 |     0.0 |     0.0 | -0.268565 |    -1.5 |</span>
<span class="go">| 2000-01-01 00:35:00 | 49.870269 |     0.0 |     0.0 | -0.321749 |    -1.5 |</span>
<span class="go">| 2000-01-01 00:40:00 | 50.368827 |     0.0 |     0.0 | -0.366871 |    -1.5 |</span>
<span class="go">| 2000-01-01 00:45:00 | 50.842694 |     0.0 |     0.0 | -0.404905 |    -1.5 |</span>
<span class="go">| 2000-01-01 00:50:00 | 51.295919 |     0.0 |     0.0 | -0.437038 |    -1.5 |</span>
<span class="go">| 2000-01-01 00:55:00 | 51.731393 |     0.0 |     0.0 | -0.464363 |    -1.5 |</span>
<span class="go">| 2000-01-01 01:00:00 | 52.151263 |     0.0 |     0.0 | -0.487801 |    -1.5 |</span>
<span class="go">| 2000-01-01 01:05:00 | 52.557188 |     0.0 |     0.0 | -0.508095 |    -1.5 |</span>
<span class="go">| 2000-01-01 01:10:00 |   52.9505 |     0.0 |     0.0 | -0.525847 |    -1.5 |</span>
<span class="go">| 2000-01-01 01:15:00 | 53.332303 |     0.0 |     0.0 | -0.541542 |    -1.5 |</span>
<span class="go">| 2000-01-01 01:20:00 | 53.703533 |     0.0 |     0.0 |  -0.55557 |    -1.5 |</span>
<span class="go">| 2000-01-01 01:25:00 | 54.065003 |     0.0 |     0.0 | -0.568243 |    -1.5 |</span>
<span class="go">| 2000-01-01 01:30:00 | 54.417423 |     0.0 |     0.0 | -0.579812 |    -1.5 |</span>
<span class="go">| 2000-01-01 01:35:00 | 54.761425 |     0.0 |     0.0 | -0.590476 |    -1.5 |</span>
<span class="go">| 2000-01-01 01:40:00 | 55.097571 |     0.0 |     0.0 | -0.600391 |    -1.5 |</span>
<span class="go">| 2000-01-01 01:45:00 | 55.426366 |     0.0 |     0.0 | -0.609678 |    -1.5 |</span>
<span class="go">| 2000-01-01 01:50:00 | 55.748265 |     0.0 |     0.0 | -0.618434 |    -1.5 |</span>
<span class="go">| 2000-01-01 01:55:00 | 56.063683 |     0.0 |     0.0 | -0.626729 |    -1.5 |</span>
<span class="go">| 2000-01-01 02:00:00 | 56.372995 |     0.0 |     0.0 | -0.634621 |    -1.5 |</span>
<span class="go">| 2000-01-01 02:05:00 | 56.676546 |     0.0 |     0.0 | -0.642152 |    -1.5 |</span>
<span class="go">| 2000-01-01 02:10:00 | 56.974651 |     0.0 |     0.0 | -0.649356 |    -1.5 |</span>
<span class="go">| 2000-01-01 02:15:00 | 57.267603 |     0.0 |     0.0 | -0.656257 |    -1.5 |</span>
<span class="go">| 2000-01-01 02:20:00 | 57.555671 |     0.0 |     0.0 | -0.662874 |    -1.5 |</span>
<span class="go">| 2000-01-01 02:25:00 | 57.839105 |     0.0 |     0.0 | -0.669225 |    -1.5 |</span>
<span class="go">| 2000-01-01 02:30:00 | 58.118138 |     0.0 |     0.0 | -0.675321 |    -1.5 |</span>
<span class="go">| 2000-01-01 02:35:00 | 58.392989 |     0.0 |     0.0 | -0.681174 |    -1.5 |</span>
<span class="go">| 2000-01-01 02:40:00 |  58.66386 |     0.0 |     0.0 | -0.686793 |    -1.5 |</span>
<span class="go">| 2000-01-01 02:45:00 | 58.930943 |     0.0 |     0.0 | -0.692186 |    -1.5 |</span>
<span class="go">| 2000-01-01 02:50:00 | 59.194418 |     0.0 |     0.0 |  -0.69736 |    -1.5 |</span>
<span class="go">| 2000-01-01 02:55:00 | 59.454452 |     0.0 |     0.0 | -0.702325 |    -1.5 |</span>
<span class="go">| 2000-01-01 03:00:00 | 59.711205 |     0.0 |     0.0 | -0.707085 |    -1.5 |</span>
<span class="go">| 2000-01-01 03:05:00 | 59.964827 |     0.0 |     0.0 | -0.711648 |    -1.5 |</span>
<span class="go">| 2000-01-01 03:10:00 |   0.30038 |     0.0 |     0.0 | -0.716007 |    -1.5 |</span>
<span class="go">| 2000-01-01 03:15:00 |  0.611639 |     0.0 |     0.0 | -0.719329 |    -1.5 |</span>
<span class="go">| 2000-01-01 03:20:00 |   0.92016 |     0.0 |     0.0 |  -0.72384 |    -1.5 |</span>
<span class="go">| 2000-01-01 03:25:00 |  1.224742 |     0.0 |     0.0 | -0.728033 |    -1.5 |</span>
<span class="go">| 2000-01-01 03:30:00 |   1.52568 |     0.0 |     0.0 | -0.731932 |    -1.5 |</span>
<span class="go">| 2000-01-01 03:35:00 |   1.82326 |     0.0 |     0.0 | -0.735573 |    -1.5 |</span>
<span class="go">| 2000-01-01 03:40:00 |  2.117718 |     0.0 |     0.0 | -0.738988 |    -1.5 |</span>
<span class="go">| 2000-01-01 03:45:00 |  2.409252 |     0.0 |     0.0 | -0.742203 |    -1.5 |</span>
<span class="go">| 2000-01-01 03:50:00 |  2.698035 |     0.0 |     0.0 |  -0.74524 |    -1.5 |</span>
<span class="go">| 2000-01-01 03:55:00 |   2.98422 |     0.0 |     0.0 | -0.748116 |    -1.5 |</span>
<span class="go">| 2000-01-01 04:00:00 |  3.267941 |     0.0 |     0.0 | -0.750845 |    -1.5 |</span>
<span class="go">| 2000-01-01 04:05:00 |  3.549322 |     0.0 |     0.0 | -0.753437 |    -1.5 |</span>
<span class="go">| 2000-01-01 04:10:00 |  3.828473 |     0.0 |     0.0 | -0.755902 |    -1.5 |</span>
<span class="go">| 2000-01-01 04:15:00 |  4.105495 |     0.0 |     0.0 | -0.758246 |    -1.5 |</span>
<span class="go">| 2000-01-01 04:20:00 |  4.380482 |     0.0 |     0.0 | -0.760477 |    -1.5 |</span>
<span class="go">| 2000-01-01 04:25:00 |  4.653521 |     0.0 |     0.0 |   -0.7626 |    -1.5 |</span>
<span class="go">| 2000-01-01 04:30:00 |  4.924693 |     0.0 |     0.0 |  -0.76462 |    -1.5 |</span>
<span class="go">| 2000-01-01 04:35:00 |  5.194073 |     0.0 |     0.0 |  -0.76654 |    -1.5 |</span>
<span class="go">| 2000-01-01 04:40:00 |  5.461733 |     0.0 |     0.0 | -0.768366 |    -1.5 |</span>
<span class="go">| 2000-01-01 04:45:00 |  5.727738 |     0.0 |     0.0 |   -0.7701 |    -1.5 |</span>
<span class="go">| 2000-01-01 04:50:00 |  5.992153 |     0.0 |     0.0 | -0.771747 |    -1.5 |</span>
<span class="go">| 2000-01-01 04:55:00 |  6.255037 |     0.0 |     0.0 |  -0.77331 |    -1.5 |</span>
</pre></div></div></div><a href="sw1d_network_branch.html" target="_blank" >Click to see the graph</a></pre></div></div><p>Again, the simulated water levels at the end of the simulation period seem reasonable
and sufficiently similar to those we calculated with a fully hydrodynamic model:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_waterlevels</span><span class="p">(</span><span class="s2">&quot;sw1d_network_bifurcations.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/sw1d_network_bifurcations.png" src="_images/sw1d_network_bifurcations.png" />
<p>There is no indication of an error in the water balance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">round_</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">hydpy</span><span class="o">.</span><span class="n">collectives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">check_waterbalance</span><span class="p">(</span><span class="n">conditions</span><span class="p">))</span>
<span class="go">0.0</span>
</pre></div>
</div>
</section>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="hydpy.models.sw1d_network.Model">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hydpy.models.sw1d_network.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><a class="reference internal" href="_modules/hydpy/models/sw1d_network.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.models.sw1d_network.Model" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="modeltools.html#hydpy.core.modeltools.SubstepModel" title="hydpy.core.modeltools.SubstepModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubstepModel</span></code></a></p>
<p>HydPy-SW1D-Network (“composite model” for solving the 1-dimensional shallow water equations in channel networks).</p>
<dl class="simple">
<dt>The following “run methods” are called in the given sequence during each simulation step:</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="sw1d.html#hydpy.models.sw1d.sw1d_model.Calc_MaxTimeSteps_V1" title="hydpy.models.sw1d.sw1d_model.Calc_MaxTimeSteps_V1"><code class="xref py py-class docutils literal notranslate"><span class="pre">Calc_MaxTimeSteps_V1</span></code></a> Order all submodels that follow the <a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.RoutingModel_V1" title="hydpy.interfaces.routinginterfaces.RoutingModel_V1"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutingModel_V1</span></code></a>, <a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.RoutingModel_V2" title="hydpy.interfaces.routinginterfaces.RoutingModel_V2"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutingModel_V2</span></code></a>, or <a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.RoutingModel_V3" title="hydpy.interfaces.routinginterfaces.RoutingModel_V3"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutingModel_V3</span></code></a> interface to estimate the highest possible computation time step.</p></li>
<li><p><a class="reference internal" href="sw1d.html#hydpy.models.sw1d.sw1d_model.Calc_TimeStep_V1" title="hydpy.models.sw1d.sw1d_model.Calc_TimeStep_V1"><code class="xref py py-class docutils literal notranslate"><span class="pre">Calc_TimeStep_V1</span></code></a> Determine the computation time step for which we can expect stability for a complete channel network.</p></li>
<li><p><a class="reference internal" href="sw1d.html#hydpy.models.sw1d.sw1d_model.Send_TimeStep_V1" title="hydpy.models.sw1d.sw1d_model.Send_TimeStep_V1"><code class="xref py py-class docutils literal notranslate"><span class="pre">Send_TimeStep_V1</span></code></a> Send the actual computation time step to all submodels following the <a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.StorageModel_V1" title="hydpy.interfaces.routinginterfaces.StorageModel_V1"><code class="xref py py-class docutils literal notranslate"><span class="pre">StorageModel_V1</span></code></a>, <a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.RoutingModel_V1" title="hydpy.interfaces.routinginterfaces.RoutingModel_V1"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutingModel_V1</span></code></a>, <a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.RoutingModel_V2" title="hydpy.interfaces.routinginterfaces.RoutingModel_V2"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutingModel_V2</span></code></a>, or <a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.RoutingModel_V3" title="hydpy.interfaces.routinginterfaces.RoutingModel_V3"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutingModel_V3</span></code></a> interface.</p></li>
<li><p><a class="reference internal" href="sw1d.html#hydpy.models.sw1d.sw1d_model.Calc_Discharges_V1" title="hydpy.models.sw1d.sw1d_model.Calc_Discharges_V1"><code class="xref py py-class docutils literal notranslate"><span class="pre">Calc_Discharges_V1</span></code></a> Let a network model order all routing submodels following the <a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.RoutingModel_V1" title="hydpy.interfaces.routinginterfaces.RoutingModel_V1"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutingModel_V1</span></code></a>, <a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.RoutingModel_V2" title="hydpy.interfaces.routinginterfaces.RoutingModel_V2"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutingModel_V2</span></code></a>, or <a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.RoutingModel_V3" title="hydpy.interfaces.routinginterfaces.RoutingModel_V3"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutingModel_V3</span></code></a> interface to determine their individual discharge values.</p></li>
<li><p><a class="reference internal" href="sw1d.html#hydpy.models.sw1d.sw1d_model.Update_Storages_V1" title="hydpy.models.sw1d.sw1d_model.Update_Storages_V1"><code class="xref py py-class docutils literal notranslate"><span class="pre">Update_Storages_V1</span></code></a> Let a network model order all storage submodels to update their storage contents and their dependent factors.</p></li>
</ul>
</dd>
<dt>Users can hook submodels into the defined main model if they satisfy one of the following interfaces:</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.RoutingModel_V1" title="hydpy.interfaces.routinginterfaces.RoutingModel_V1"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutingModel_V1</span></code></a> Interface for calculating the inflow into a channel.</p></li>
<li><p><a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.RoutingModel_V2" title="hydpy.interfaces.routinginterfaces.RoutingModel_V2"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutingModel_V2</span></code></a> Interface for calculating the discharge between two channel segments.</p></li>
<li><p><a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.RoutingModel_V3" title="hydpy.interfaces.routinginterfaces.RoutingModel_V3"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutingModel_V3</span></code></a> Interface for calculating the outflow of a channel.</p></li>
<li><p><a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.StorageModel_V1" title="hydpy.interfaces.routinginterfaces.StorageModel_V1"><code class="xref py py-class docutils literal notranslate"><span class="pre">StorageModel_V1</span></code></a> Interface for calculating the water amount stored in a single channel segment.</p></li>
<li><p><a class="reference internal" href="routinginterfaces.html#hydpy.interfaces.routinginterfaces.ChannelModel_V1" title="hydpy.interfaces.routinginterfaces.ChannelModel_V1"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelModel_V1</span></code></a> Interface for handling routing and storage submodels.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.models.sw1d_network.Model.DOCNAME">
<span class="sig-name descname"><span class="pre">DOCNAME</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="modeltools.html#hydpy.core.modeltools.DocName" title="hydpy.core.modeltools.DocName"><span class="pre">DocName</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('SW1D-Network',</span> <span class="pre">'&quot;composite</span> <span class="pre">model&quot;</span> <span class="pre">for</span> <span class="pre">solving</span> <span class="pre">the</span> <span class="pre">1-dimensional</span> <span class="pre">shallow</span> <span class="pre">water</span> <span class="pre">equations</span> <span class="pre">in</span> <span class="pre">channel</span> <span class="pre">networks')</span></em><a class="headerlink" href="#hydpy.models.sw1d_network.Model.DOCNAME" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.models.sw1d_network.Model.COMPOSITE">
<span class="sig-name descname"><span class="pre">COMPOSITE</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#hydpy.models.sw1d_network.Model.COMPOSITE" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#module-hydpy.models.sw1d_network" title="hydpy.models.sw1d_network"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_network</span></code></a> is a composite model.  (One usually only works with it 
indirectly.)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.models.sw1d_network.Model.OBSERVER_METHODS">
<span class="sig-name descname"><span class="pre">OBSERVER_METHODS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="modeltools.html#hydpy.core.modeltools.Method" title="hydpy.core.modeltools.Method"><span class="pre">Method</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">()</span></em><a class="headerlink" href="#hydpy.models.sw1d_network.Model.OBSERVER_METHODS" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.models.sw1d_network.Model.channelmodels">
<span class="sig-name descname"><span class="pre">channelmodels</span></span><a class="headerlink" href="#hydpy.models.sw1d_network.Model.channelmodels" title="Link to this definition">¶</a></dt>
<dd><p>Vector of submodels that comply with the following interface: ChannelModel_V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.models.sw1d_network.Model.storagemodels">
<span class="sig-name descname"><span class="pre">storagemodels</span></span><a class="headerlink" href="#hydpy.models.sw1d_network.Model.storagemodels" title="Link to this definition">¶</a></dt>
<dd><p>Vector of submodels that comply with the following interface: StorageModel_V1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.models.sw1d_network.Model.routingmodels">
<span class="sig-name descname"><span class="pre">routingmodels</span></span><a class="headerlink" href="#hydpy.models.sw1d_network.Model.routingmodels" title="Link to this definition">¶</a></dt>
<dd><p>Vector of submodels that comply with the following interfaces: RoutingModel_V1, RoutingModel_V2, or RoutingModel_V3.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydpy.models.sw1d_network.Model.check_waterbalance">
<span class="sig-name descname"><span class="pre">check_waterbalance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_conditions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></span><a class="reference internal" href="_modules/hydpy/models/sw1d_network.html#Model.check_waterbalance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydpy.models.sw1d_network.Model.check_waterbalance" title="Link to this definition">¶</a></dt>
<dd><p>Determine the water balance error of the previous simulation in 1000 m³.</p>
<p>Method <a class="reference internal" href="#hydpy.models.sw1d_network.Model.check_waterbalance" title="hydpy.models.sw1d_network.Model.check_waterbalance"><code class="xref py py-func docutils literal notranslate"><span class="pre">check_waterbalance()</span></code></a> calculates the balance error as follows:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}Error =  \Sigma In - \Sigma Out + \Sigma Lat - \Delta Vol \\
\\
\Sigma In = \sum_{t=t_0}^{t_1} \sum_{i=1}^{R_1} DischargeVolume_t^i  \\
\Sigma Out = \sum_{t=t_0}^{t_1} \sum_{i=1}^{R_3} DischargeVolume_t^i  \\
\Sigma Lat = Seconds \cdot
\sum_{t=t_0}^{t_1} \sum_{i=1}^{S_1} LateralFlow_t^i \\
\Delta Vol = 1000 \cdot
\sum_{i=1}^{S_1} WaterVolume_{t_1}^i - WaterVolume_{t_0}^i \\
\\
S_1 = N(StorageModel\_V1) \\
R_1 = N(RoutingModel\_V1) \\
R_3 = N(RoutingModel\_V3)\end{split}\]</div>
</div></blockquote>
<p>The returned error should always be in scale with numerical precision so that
it does not affect the simulation results in any relevant manner.</p>
<p>Pick the required initial conditions before starting the simulation run via
property <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sequences.conditions" title="hydpy.core.sequencetools.Sequences.conditions"><code class="xref py py-const docutils literal notranslate"><span class="pre">conditions</span></code></a>.  See the application model <a class="reference internal" href="#module-hydpy.models.sw1d_network" title="hydpy.models.sw1d_network"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_network</span></code></a> for
integration tests some examples.</p>
<dl class="simple">
<dt>ToDo: So far, <a class="reference internal" href="#hydpy.models.sw1d_network.Model.check_waterbalance" title="hydpy.models.sw1d_network.Model.check_waterbalance"><code class="xref py py-func docutils literal notranslate"><span class="pre">check_waterbalance()</span></code></a> works only safely with application</dt><dd><p>models <a class="reference internal" href="sw1d_storage.html#module-hydpy.models.sw1d_storage" title="hydpy.models.sw1d_storage"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_storage</span></code></a>, <a class="reference internal" href="sw1d_q_in.html#module-hydpy.models.sw1d_q_in" title="hydpy.models.sw1d_q_in"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_q_in</span></code></a>, <a class="reference internal" href="sw1d_lias.html#module-hydpy.models.sw1d_lias" title="hydpy.models.sw1d_lias"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_lias</span></code></a>, <a class="reference internal" href="sw1d_lias_sluice.html#module-hydpy.models.sw1d_lias_sluice" title="hydpy.models.sw1d_lias_sluice"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_lias_sluice</span></code></a>,
<a class="reference internal" href="sw1d_q_out.html#module-hydpy.models.sw1d_q_out" title="hydpy.models.sw1d_q_out"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_q_out</span></code></a>, <a class="reference internal" href="sw1d_weir_out.html#module-hydpy.models.sw1d_weir_out" title="hydpy.models.sw1d_weir_out"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_weir_out</span></code></a>, and <a class="reference internal" href="sw1d_gate_out.html#module-hydpy.models.sw1d_gate_out" title="hydpy.models.sw1d_gate_out"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sw1d_gate_out</span></code></a> and might fail for o
ther models.  We need to implement a more general solution when we
implement incompatible models.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydpy.models.sw1d_network.Model.REUSABLE_METHODS">
<span class="sig-name descname"><span class="pre">REUSABLE_METHODS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="modeltools.html#hydpy.core.modeltools.ReusableMethod" title="hydpy.core.modeltools.ReusableMethod"><span class="pre">ReusableMethod</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">()</span></em><a class="headerlink" href="#hydpy.models.sw1d_network.Model.REUSABLE_METHODS" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hydpy.models.sw1d_network.DerivedParameters">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hydpy.models.sw1d_network.</span></span><span class="sig-name descname"><span class="pre">DerivedParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="parametertools.html#hydpy.core.parametertools.Parameters" title="hydpy.core.parametertools.Parameters"><span class="pre">Parameters</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_fastaccess</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="parametertools.html#hydpy.core.parametertools.FastAccessParameter" title="hydpy.core.parametertools.FastAccessParameter"><span class="pre">FastAccessParameter</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cymodel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="typingtools.html#hydpy.core.typingtools.CyModelProtocol" title="hydpy.core.typingtools.CyModelProtocol"><span class="pre">CyModelProtocol</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.models.sw1d_network.DerivedParameters" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="parametertools.html#hydpy.core.parametertools.SubParameters" title="hydpy.core.parametertools.SubParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubParameters</span></code></a></p>
<p>Derived parameters of model sw1d_network.</p>
<dl class="simple">
<dt>The following classes are selected:</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="sw1d.html#hydpy.models.sw1d.sw1d_derived.Seconds" title="hydpy.models.sw1d.sw1d_derived.Seconds"><code class="xref py py-func docutils literal notranslate"><span class="pre">Seconds()</span></code></a> The length of the actual simulation step size in seconds [s].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hydpy.models.sw1d_network.FactorSequences">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hydpy.models.sw1d_network.</span></span><span class="sig-name descname"><span class="pre">FactorSequences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.Sequences" title="hydpy.core.sequencetools.Sequences"><span class="pre">Sequences</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_fastaccess</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">TypeFastAccess_co</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cymodel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="typingtools.html#hydpy.core.typingtools.CyModelProtocol" title="hydpy.core.typingtools.CyModelProtocol"><span class="pre">CyModelProtocol</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hydpy.models.sw1d_network.FactorSequences" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sequencetools.html#hydpy.core.sequencetools.FactorSequences" title="hydpy.core.sequencetools.FactorSequences"><code class="xref py py-class docutils literal notranslate"><span class="pre">FactorSequences</span></code></a></p>
<p>Factor sequences of model sw1d_network.</p>
<dl class="simple">
<dt>The following classes are selected:</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="sw1d.html#hydpy.models.sw1d.sw1d_factors.TimeStep" title="hydpy.models.sw1d.sw1d_factors.TimeStep"><code class="xref py py-func docutils literal notranslate"><span class="pre">TimeStep()</span></code></a> The actual computation step according to global stability considerations [s].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sw1d_storage.html" title="sw1d_storage"
             >next</a> |</li>
        <li class="right" >
          <a href="sw1d_channel.html" title="sw1d_channel"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HydPy 6.2dev6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="reference_manual.html" >Reference Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="model_families.html" >Model Families</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="HydPy-SW1D.html" >HydPy-SW1D (Shallow Water 1D)</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">sw1d_network</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2013-2025, HydPy Developers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>